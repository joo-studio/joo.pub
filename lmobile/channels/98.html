<!DOCTYPE html>
<html lang="zh" class="no-js">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="renderer" content="webkit">
<title>乐猫通信 | 提供更极致的即时通讯服务 </title>
<meta name="keywords" content="短信验证码,验证码短信,短信验证码平台,手机短信验证码,手机短信验证码平台,106短信平台,语音验证码,国际短信验证码,语音验证,流量营销,流量产品,营销短信,短信营销 | 乐猫通信" />
<meta name="description" content="乐猫通信短信验证码平台拥有独立的短信验证码通道,三网合一端口号,致力于为客户提供优质的106短信平台,App短信验证码等行业短信服务.为每一条短信验证码负责,乐猫通信短信验证码广泛应用于用户注册、密码找回、登陆保护等验证码短信应用场景.  | 乐猫通信" />
<!-- Le fav and touch icons -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/lmobile/assets/ico/apple-touch-icon-144-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/lmobile/assets/ico/apple-touch-icon-114-precomposed.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/lmobile/assets/ico/apple-touch-icon-72-precomposed.png">
<link rel="apple-touch-icon-precomposed" href="/lmobile/assets/ico/apple-touch-icon-57-precomposed.png">
<link rel="shortcut icon" href="/lmobile/assets/ico/favicon.ico">
<link rel="shortcut icon" href="/lmobile/assets/ico/favicon.png">

    <link href="/lmobile/css/bootstrap.min.css" rel="stylesheet">
<link href="/lmobile/css/swiper-3.3.1.min.css" rel="stylesheet">
<link href="/lmobile/fonts/FontAwesome/font-awesome.css" rel="stylesheet">
<link href="/lmobile/css/animate.css" rel="stylesheet">
<link href="/lmobile/css/bootsnav.css" rel="stylesheet">
<link href="/lmobile/css/style.css" rel="stylesheet">
<link href="/lmobile/css/content.css" rel="stylesheet">

<script>var $pageInfo = { publishmentSystemID : 2, channelID : 98, contentID : 0, siteUrl : "/lmobile", homeUrl : "/lmobile/center", currentUrl : "/lmobile/channels/98.html", rootUrl : "", apiUrl : "/api" }</script>
</head>

<body>
    <nav class="navbar navbar-default navbar-fixed no-background white bootsnav">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
                <i class="fa fa-bars"></i>
            </button>
            <a href="/lmobile" class="navbar-brand">
                <img src="/lmobile/images/logo.png" class="logo logo-display" alt="乐猫通信">
                <img src="/lmobile/images/logo2.png" class="logo logo-scrolled" alt="乐猫通信">
            </img></img></a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-menu">
            <ul class="nav navbar-nav navbar-right" data-in="fadeInDown" data-out="fadeOutUp">
                
                        <li>
                            <a href="/lmobile">首页</a>
                        </li>
                    
                
                    
                            <li class="dropdown">
                                <a href="/lmobile/channels/36.html" class="dropdown-toggle" data-toggle="dropdown">产品</a>
                                <ul class="dropdown-menu">
                                    
                                        <li>
                                            <a href="/lmobile/channels/36.html">行业短信</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/37.html">营销短信</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/38.html">语音验证</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/39.html">彩信产品</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/40.html">流量产品</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                
                    
                            <li class="dropdown">
                                <a href="/lmobile/channels/43.html" class="dropdown-toggle" data-toggle="dropdown">帮助</a>
                                <ul class="dropdown-menu">
                                    
                                        <li>
                                            <a href="/lmobile/channels/43.html">短信服务</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/44.html">彩信服务</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/45.html">语音验证</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/46.html">流量产品</a>
                                        </li>
                                    
                                        <li>
                                            <a href="/lmobile/channels/53.html">常见问题</a>
                                        </li>
                                    
                                </ul>
                            </li>
                        
                
                    
                            <li>
                                <a href="/lmobile/channels/94.html">API接口</a>
                            </li>
                        
                
                <li class="userFun">
                    <a href="/lmobile/channels/98.html">登录</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

    <section class="m2ban" style="background-image:url(/lmobile/images/api.jpg)">
 <div class="m2banTxt">
  <div class="m2ban_p2">API接口</div>
 </div>
</section>
    <div class="container">
        <div class="m2posBox">
            <ol class="breadcrumb">
                <li>当前位置：首页</li>
                <li>API接口</li>
                <li>
                    彩信接口
                </li>
                <li>
                    代码示例
                </li>
            </ol>
        </div>
        <div class="m2apiBox clearfix">
            <div class="m2apiMenu">
    <div class="m2apiNm1"><i class="fa fa-file-code-o"></i> API接口</div>
    <dl class="m2apiDl">
        
            
                    <dt>
                        <a href="/lmobile/channels/94.html" class="m2apiMenu_a1" title="短信接口">
                            短信接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/94.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                            
                                    <li>
                                        <a href="/lmobile/channels/95.html" title="代码示例" class="m2apiMenu_a2">代码示例</a>
                                    </li>
                                
                    </dd>
                
        
            
                    <dt class="on">
                        <a href="/lmobile/channels/97.html" class="m2apiMenu_a1" title="彩信接口">
                            彩信接口</a>
                    </dt>
                    <dd>
                        <ul class="m2apiUl">
                            
                                
                                        <li>
                                            <a href="/lmobile/channels/97.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                        </li>
                                    
                                
                                        <li>
                                            <a href="/lmobile/channels/98.html" title="代码示例" class="m2apiMenu_a2 on">代码示例</a>
                                        </li>
                                    
                        </ul>
                    </dd>
                
        
            
                    <dt>
                        <a href="/lmobile/channels/100.html" class="m2apiMenu_a1" title="语音接口">
                            语音接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/100.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                            
                                    <li>
                                        <a href="/lmobile/channels/101.html" title="代码示例" class="m2apiMenu_a2">代码示例</a>
                                    </li>
                                
                    </dd>
                
        
            
                    <dt>
                        <a href="/lmobile/channels/103.html" class="m2apiMenu_a1" title="流量接口">
                            流量接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/103.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                    </dd>
                
        
            
                    <dt>
                        <a href="/lmobile/channels/105.html" class="m2apiMenu_a1" title="状态报告查询接口">
                            状态报告查询接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/105.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                            
                                    <li>
                                        <a href="/lmobile/channels/106.html" title="代码示例" class="m2apiMenu_a2">代码示例</a>
                                    </li>
                                
                    </dd>
                
        
            
                    <dt>
                        <a href="/lmobile/channels/108.html" class="m2apiMenu_a1" title="个性化短信接口">
                            个性化短信接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/108.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                            
                                    <li>
                                        <a href="/lmobile/channels/109.html" title="代码示例" class="m2apiMenu_a2">代码示例</a>
                                    </li>
                                
                    </dd>
                
        
            
                    <dt>
                        <a href="/lmobile/channels/111.html" class="m2apiMenu_a1" title="用户上行查询接口">
                            用户上行查询接口</a>
                    </dt>
                    <dd class="dsNone">
                        
                            
                                    <li>
                                        <a href="/lmobile/channels/111.html" title="接口说明" class="m2apiMenu_a2">接口说明</a>
                                    </li>
                                
                            
                                    <li>
                                        <a href="/lmobile/channels/112.html" title="代码示例" class="m2apiMenu_a2">代码示例</a>
                                    </li>
                                
                    </dd>
                
        
    </dl>
</div>

            <!-- code begin -->
            <div class="m2apiCon">
        <div class="m2apiMnm" id="cd-placeholder-1">代码示例</div>
        <div class="m2apiEditor autoMaxImg">
          <!--<p>测试时，请使用正式内容进行测试，请勿给同一手机号连续发送相同内容，运营商已进行规则调整以应对短信炸弹问题。</p>
          <p class="cor_red">所有短信均有监控，请勿发送以下内容：营销广告、不合法、要挟、虚假、私人信息、滥发、邀请类。</p>
          <p class="cor_red">网页应用于手机验证，请务必增加图形验证（以防止被他人利用，被用于短信轰炸用途），否则不予以接入。</p>
          <p>&nbsp;</p>
          <p>发送之前请务必仔细阅读内容审核的相关规则<a href="#" class="m2api_btn1">点此查看</a></p>
          <p>&nbsp;</p>-->
          <div class="m2api_t1" id="cd-placeholder-1_1">ASP</div>
            <div class="m2apiCoder">
<pre>
mms_include.asp 文件
<%
Function Int2S(intp)
    rs = ""
    for i = 0 to 3 
    rs = rs & CHRw(intp AND 255)
    intp = RShift(intp, 8)
    next
    Int2S = rs  
End Function
Function Post(url,data)
    dim Https 
    set Https=server.createobject("MSXML2.XMLHTTP")
    Https.open "POST",url,false
    Https.setRequestHeader "Content-Type", "text/xml; charset=utf-8"
    Https.setRequestHeader "Content-Length",LEN(data)
    Https.setRequestHeader "SOAPAction", "http://MmsWebInterface.org/SubmitMms"
    Https.send (data)
    
    if Https.readystate=4 then
        dim objstream 
        set objstream = Server.CreateObject("adodb.stream")
        objstream.Type = 1
        objstream.Mode =3
        objstream.Open
        objstream.Write Https.responseBody
        objstream.Position = 0
        objstream.Type = 2
        objstream.Charset = "utf-8"
        Post = objstream.ReadText
        objstream.Close
        set objstream = nothing
        set https=nothing
        
    end if
End Function
Function ReadBinaryFile(FileName)'二进制获取元素内容 
     Const adTypeBinary = 1   
     'Create Stream object   
     Dim BinaryStream   
     Set BinaryStream = CreateObject("ADODB.Stream")   
     'Specify stream type - we want To get binary data.   
     BinaryStream.Type = adTypeBinary          
     'Open the stream  
     'BinaryStream.Charset = "gb2312"  
     BinaryStream.Open           
     'Load the file data from disk To stream object   
     BinaryStream.LoadFromFile FileName          
     'Open the stream And get binary data from the object   
     ReadBinaryFile = BinaryStream.Read 
End Function
Function ReadTextFile(FileName)'二进制获取元素内容 
      Const adTypeText = 2 
      Const adTypeBinary = 1   
     'Create Stream object   
     Dim BinaryStream   
     Set BinaryStream = CreateObject("ADODB.Stream")   
     'Specify stream type - we want To get binary data.   
     BinaryStream.Type = 2          
     'Open the stream  
     BinaryStream.Charset = "iso-8859-15"  
     BinaryStream.Open           
     'Load the file data from disk To stream object   
     BinaryStream.LoadFromFile FileName          
     'Open the stream And get binary data from the object   
     ReadTextFile = BinaryStream.ReadText
End Function
Function Stream_ToBinary(arr) 
      Const adTypeText = 2 
      Const adTypeBinary = 1 
      Dim name,f_name,file_len,data 
      Dim BinaryStream 'As New Stream 
      Set BinaryStream = CreateObject("ADODB.Stream") 
          
            BinaryStream.Type = 2 
            BinaryStream.Open 
            BinaryStream.Charset ="iso-8859-15" '"windows-1252"
                for i=0 to Ubound(arr)
                       file_name=Server.MapPath("mmsfile/"&arr(i))
                       name=mid(file_name,instrrev(file_name,"\")+1) '元素1名称（即元素1的文件名，包括文件名后缀）   
                       f_name=name&chr(0) '元素1名称（即元素1的文件名，包括文件名后缀）+一个字符串结束符
                       data =ReadTextFile(file_name)
                       file_len=(int)(len(data))                         
                       BinaryStream.WriteText f_name
                       BinaryStream.WriteText Int2S(Clng(file_len))
                       BinaryStream.WriteText data
                next
        BinaryStream.Position = 0
        BinaryStream.SaveToFile Server.MapPath("mmsfile\tms.tms"),2
        BinaryStream.Type = adTypeBinary            
      Stream_ToBinary = BinaryStream.Read 
     'Stream_ToBinary=Clng((int)(len(data)))
      Set BinaryStream = Nothing 
End Function 
Function Base64Encode(Binarystream)
    Dim oXML, oNode
    Set oXML = CreateObject("Msxml2.DOMDocument.3.0") 
    Set oNode = oXML.CreateElement("base64") 
    oNode.dataType = "bin.base64" 
    oNode.nodeTypedValue =Binarystream
    Base64Encode = oNode.text'Mid(oNode.text,5) 
    Set oNode = Nothing 
    Set oXML = Nothing 
End Function 
' 按位左移
Public Function LShift(ByVal val, ByVal n)
    LShift = val * 2 ^ n
End Function
' 按位右移
Public Function RShift(ByVal val, Byval n) 
    RShift = val \ (2 ^ n)
End Function
%>

mms.asp 文件
<%@LANGUAGE="VBSCRIPT" CODEPAGE="65001"%>
<!--#include file="mms_include.asp"-->
<%
dim file_name,tmsdata,strbase64,target,post_data
strpath="99338.jpg"&","&"test.txt"&","&"wee.smil"'要发送的彩信文件列表
arr=split(strpath,",")
'res=Stream_ToBinary(arr)
Dim objFSO         '声明一个名称为   objFSO   的变量以存放对象实例   
Set objFSO = Server.CreateObject("Scripting.FileSystemObject")
If  objFSO.FileExists(Server.MapPath("mmsfile/Tms.tms"))   Then 
'接口提交部分
    strbase64=Base64Encode(ReadBinaryFile(Server.MapPath("mmsfile/Tms.tms")))'获取生成的TMS文件
    target = "http://cf.51welink.com/submitdata/MmsWebInterface.asmx"  '彩信接口地址，以接口文档里的地址为准
    strxml =  "<?xml version="" 1.0"" encoding="" utf-8""?>"
    strxml = strxml + "<soap:Envelope xmlns:xsi="" http//www.w3.org/2001/XMLSchema-instance"" xmlns:xsd=""http://www.w3.org/2001/XMLSchema"" "
    strxml = strxml + " xmlns:soap=""http://schemas.xmlsoap.org/soap/envelope/"">"
    strxml = strxml + "<soap:Body>"
    strxml = strxml +"<SubmitMms xmlns="" http//MmsWebInterface.org/"">"
    strxml = strxml +"<UserID>dlzyang0</UserID>"
    strxml = strxml +"<Password>123</Password>"
    strxml = strxml +"<CorpID></CorpID>"
    strxml = strxml +"<PrdID>2012128</PrdID>"
    strxml = strxml +"<DstID></DstID>"
    strxml = strxml +"<MmsSubject>彩信测试标题</MmsSubject>"
    strxml = strxml +"<TmsBuffer>"&strbase64&"</TmsBuffer>"
    strxml = strxml +"</SubmitMms>"
    strxml = strxml +"</soap:Body>"
    strxml = strxml +"</soap:Envelope>"                 
    'response.Write strxml
    response.Write(Post(target,strxml))
''//请自己解析Post(target,post_data)返回的XML字符串并实现自己的逻辑
''<State>0</State>表示成功,其它的参考文档
else
        Response.Write "生成TMS文件出错，请检查！"
End If
%>
                </pre>
            </div>
          <div class="m2apiLine"></div>
            <div class="m2api_t1" id="cd-placeholder-1_2">Delphi</div>
            <div class="m2apiCoder">
                <pre>
Unit2.pas
unit Unit2;
interface
uses InvokeRegistry, SOAPHTTPClient, Types, XSBuiltIns,classes;
type
MyWebServericeSoap = interface(IInvokable)
    ['{5BA22C24-B55B-44D5-63A4-623BCC4101FC}']
    
    function  SubmitMms(const UserID: WideString; const Password: WideString; const CorpID: WideString; const PrdID: WideString; const DstID: WideString; const MmsSubject: WideString; TmsBuffer: TByteDynArray): WideString; stdcall;
  end;
function GetMyWebServericeSoap(UseWSDL: Boolean=System.False; Addr: string=''; HTTPRIO: THTTPRIO = nil): MyWebServericeSoap;
implementation
function GetMyWebServericeSoap(UseWSDL: Boolean; Addr: string; HTTPRIO: THTTPRIO): MyWebServericeSoap;
const
  defWSDL = 'http://cf.51welink.com/submitdata/MmsWebInterface.asmx?wsdl';
  defURL  = 'http://cf.51welink.com/submitdata/MmsWebInterface.asmx';
  defSvc  = 'Unit2';
  defPrt  = 'MyWebServericeSoap';
var
  RIO: THTTPRIO;
begin
  Result := nil;
  if (Addr = '') then
  begin
    if UseWSDL then
      Addr := defWSDL
    else
      Addr := defURL;
  end;
  if HTTPRIO = nil then
    RIO := THTTPRIO.Create(nil)
  else
    RIO := HTTPRIO;
  try
    Result := (RIO as MyWebServericeSoap);
    if UseWSDL then
    begin
      RIO.WSDLLocation := Addr;
      RIO.Service := defSvc;
      RIO.Port := defPrt;
    end else
      RIO.URL := Addr;
    //
    RIO.HTTPWebNode.UseUTF8InHeader:=True;
    //
  finally
    if (Result = nil) and (HTTPRIO = nil) then
      RIO.Free;
  end;
end;
initialization
  InvRegistry.RegisterInterface(TypeInfo(MyWebServericeSoap), 'http://MmsWebInterface.org/', 'utf-8');
  InvRegistry.RegisterDefaultSOAPAction(TypeInfo(MyWebServericeSoap), 'http://MmsWebInterface.org/%operationName%');
  InvRegistry.RegisterInvokeOptions(TypeInfo(MyWebServericeSoap), ioDocument);
end.

关键调用代码
var
i:integer; tstr:string; ilen:integer;sendstr:string;filename:string; ch:char;
begin
  ch := chr(0);
  MemBuffer:=TMemoryStream.Create;
  for i:=0 to Form1.ControlCount-1 do
  begin
    if(Form1.Controls[i].ClassName = 'TMemo') then
    begin
      tstr := trim(TMemo(Form1.Controls[i]).Text);
      if(Length(tstr)>0) then
      begin
        filename:=ExtractFileName(tstr);
        MemBuffer.WriteBuffer(filename[1],Length(filename));
        MemBuffer.Write(ch,1);
        fs:=TFileStream.Create(tstr,fmOpenRead);
        ilen:=integer(fs.Size);
        MemBuffer.Write(ilen,sizeof(ilen));
        MemBuffer.CopyFrom(fs,fs.Size);
        fs.Free;
      end;
    end;
  end;
    MemBuffer.Position := 0;
    setLength(ByteBuffer,MemBuffer.Size);
    for i:=0 to MemBuffer.Size-1 do
    begin
      MemBuffer.Read(ByteBuffer[i],1);
    end;
  Memo1.Text:=Unit2.GetMyWebServericeSoap(false,'http://cf.51welink.com/submitdata/MmsWebInterface.asmx').SubmitMms('账号','密码','','2012128',edit1.Text,'飞机',ByteBuffer);
  MemBuffer.Clear;
  MemBuffer.Free;
end;
                </pre>
            </div>
          <div class="m2apiLine"></div>
          <div class="m2api_t2" id="cd-placeholder-1_3">JAVA</div>
          <div class="m2apiCoder">
            <pre>
package cn.umob.mms;
import java.io.BufferedReader;
import java.io.DataInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.OutputStreamWriter;
import java.net.HttpURLConnection;
import java.net.URL;
import java.nio.Buffer;
import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import sun.misc.BASE64Encoder;
/**
 *
 * @author umob.cn
 */
public class Send {
    public static String MMS(String postData, String postUrl) {
        try {
            //发送POST请求
            URL url = new URL(postUrl);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            conn.setRequestProperty("Content-Type", "text/xml; charset=utf-8");
            conn.setRequestProperty("SOAPAction", "http://MmsWebInterface.org/SubmitMms");
            conn.setRequestProperty("Connection", "Keep-Alive");
            conn.setUseCaches(false);
            conn.setDoOutput(true);
            conn.setRequestProperty("Content-Length", "" + postData.length());
            OutputStreamWriter out = new OutputStreamWriter(conn.getOutputStream(), "UTF-8");
            out.write(postData);
            out.flush();
            out.close();
            //获取响应状态
            if (conn.getResponseCode() != HttpURLConnection.HTTP_OK) {
                System.out.println("connect failed!");
                return "";
            }
            //获取响应内容体
            String line, result = "";
            BufferedReader in = new BufferedReader(new InputStreamReader(conn.getInputStream(), "utf-8"));
            while ((line = in.readLine()) != null) {
                result += line + "\n";
            }
            in.close();
            return result;
        } catch (IOException e) {
            e.printStackTrace(System.out);
        }
        return "";
    }
    public static String PackMMS(String sname, String spwd, String scorpid, String sprdid, String tels, String title, byte[] mms) {
        StringBuilder sb = new StringBuilder();
        sb.append("<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><SubmitMms xmlns=\"http://MmsWebInterface.org/\">");
        sb.append("<UserID>" + sname + "</UserID>");
        sb.append("<Password>" + spwd + "</Password>");
        sb.append("<CorpID>" + scorpid + "</CorpID>");
        sb.append("<PrdID>" + sprdid + "</PrdID>");
        sb.append("<DstID>" + tels + "</DstID>");
        sb.append("<MmsSubject>" + title + "</MmsSubject>");
        sb.append("<TmsBuffer>" + new sun.misc.BASE64Encoder().encode(mms) + "</TmsBuffer>");
        sb.append("</SubmitMms></soap:Body></soap:Envelope>");
        return sb.toString();
    }
    public static byte[] PackFile(String file) throws IOException {
        File f = new File(file);
        if (f.exists()) {
            String fileName = f.getName();
            int fileSize = (int) f.length();
            try {
                byte[] fileBytes = new byte[fileSize];
                byte[] filenameBytes = (fileName + '\0').getBytes();                         
                FileInputStream stream = new FileInputStream(file);
                DataInputStream ds = new DataInputStream(stream);
                for (int i = 0; i < fileSize; i++) {
                    fileBytes[i] = ds.readByte();
                }
                
                //4 表示文件的大小的int的byte大小
                int length = fileBytes.length + filenameBytes.length + 4;
                ByteBuffer buffer = ByteBuffer.allocate(length);
                buffer.put((fileName + '\0').getBytes());
                ByteBuffer bufferLength = ByteBuffer.allocate(4);
                bufferLength.order(ByteOrder.LITTLE_ENDIAN);
                bufferLength.putInt(fileSize);
                
                buffer.put(bufferLength.array());
                buffer.put(fileBytes);
                return buffer.array();
            } catch (FileNotFoundException ex) {
                ex.printStackTrace();
            }
        }
        return null;
    }
}

前台调用
<%
    byte[] mmsImage = cn.umob.mms.Send.PackFile("D:/jworkspace/PostMMS/web/image.gif");
    byte[] mmsText = cn.umob.mms.Send.PackFile("D:/jworkspace/PostMMS/web/txt.txt");
    byte[] mmsSmil = cn.umob.mms.Send.PackFile("D:/jworkspace/PostMMS/web/wee.smil");
    ByteBuffer mmsBuffer = ByteBuffer.allocate(mmsImage.length + mmsText.length + mmsSmil.length);
    mmsBuffer.put(mmsImage);
    mmsBuffer.put(mmsText);
    mmsBuffer.put(mmsSmil);
    String PostData = cn.umob.mms.Send.PackMMS("kwsm", "kwsm", "", "2012128", "13910862579", "彩信标题", mmsBuffer.array());
    //out.println(PostData);
    String ret = cn.umob.mms.Send.MMS(PostData, "http://cf.51welink.com/submitdata/MmsWebInterface.asmx");
    out.println(ret);
    //请自己反序列化返回的字符串
%>
            </pre>
          </div>
          <div class="m2apiLine"></div>
            <div class="m2api_t2" id="cd-placeholder-1_4">Asp.Net</div>
            <div class="m2apiCoder">
                <pre>
HTTP调用方式
string tels = this.toList.Text.Trim();
//处理上传文件
HttpFileCollection fileColllection = HttpContext.Current.Request.Files;
System.Text.StringBuilder strMsg = new System.Text.StringBuilder();
List<byte> byteList = new List<byte>();
try
{
    for (int iFile = 0; iFile < fileColllection.Count; iFile++)
    {
        //检查文件扩展名字
        HttpPostedFile postedFile = fileColllection[iFile];
        string fileExtension;
        string fileName = System.IO.Path.GetFileName(postedFile.FileName);
        if (!string.IsNullOrEmpty(fileName))
        {
            fileExtension = System.IO.Path.GetExtension(fileName);
            strMsg.Append("上传的文件类型：" + postedFile.ContentType.ToString() + "<br>");
            strMsg.Append("客户端文件地址：" + postedFile.FileName + "<br>");
            strMsg.Append("上传文件的文件名：" + fileName + "<br>");
            strMsg.Append("上传文件的扩展名：" + fileExtension + "<br><hr>");
            string savePath = HttpContext.Current.Request.MapPath(".") + "/upload/" + fileName;
            postedFile.SaveAs(savePath);
            byteList.AddRange(PackFiles.PackFiles.MakeTmsContent(savePath));
        }
    }
}
catch (System.Exception Ex)
{
}
byte[] mmsData = new byte[byteList.Count];
byteList.CopyTo(mmsData);
UTF8Encoding encoding = new UTF8Encoding();
SoapBase64Binary base64Binary = new SoapBase64Binary(mmsData);
string postDataStrTpl = "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><SubmitMms xmlns=\"http://MmsWebInterface.org/\"><UserID>{0}</UserID><Password>{1}</Password><CorpID>{2}</CorpID><PrdID>{3}</PrdID><DstID>{4}</DstID><MmsSubject>{5}</MmsSubject><TmsBuffer>{6}</TmsBuffer></SubmitMms></soap:Body></soap:Envelope>";
string postDataStr = string.Format(postDataStrTpl, sname, spwd, scorpid, sprdid, tels, "彩信title", base64Binary.ToString());
byte[] postData = encoding.GetBytes(postDataStr);
HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(SmsMmsWebService);
myRequest.Method = "POST";
myRequest.ContentType = "text/xml; charset=utf-8";
myRequest.Headers.Add("SOAPAction", "http://MmsWebInterface.org/SubmitMms");
myRequest.ContentLength = postData.Length;
Stream newStream = myRequest.GetRequestStream();
// Send the data.
newStream.Write(postData, 0, postData.Length);
newStream.Flush();
newStream.Close();
HttpWebResponse myResponse = (HttpWebResponse)myRequest.GetResponse();
if (myResponse.StatusCode == HttpStatusCode.OK)
{
    StreamReader reader = new StreamReader(myResponse.GetResponseStream(), Encoding.UTF8);
    upfileMmsMsg.Text = reader.ReadToEnd();
    //反序列化upfileMmsMsg.Text
}
upfileMsg.Text = strMsg.ToString();


Web服务调用方式（需要先引用Web服务）
string tels = this.toList.Text.Trim();
//处理上传文件
HttpFileCollection fileColllection = HttpContext.Current.Request.Files;
System.Text.StringBuilder strMsg = new System.Text.StringBuilder();
List<byte> byteList = new List<byte>();
try
{
    for (int iFile = 0; iFile < fileColllection.Count; iFile++)
    {
        //检查文件扩展名字
        HttpPostedFile postedFile = fileColllection[iFile];
        string fileExtension;
        string fileName = System.IO.Path.GetFileName(postedFile.FileName);
        if (!string.IsNullOrEmpty(fileName))
        {
            fileExtension = System.IO.Path.GetExtension(fileName);
            strMsg.Append("上传的文件类型：" + postedFile.ContentType.ToString() + "<br>");
            strMsg.Append("客户端文件地址：" + postedFile.FileName + "<br>");
            strMsg.Append("上传文件的文件名：" + fileName + "<br>");
            strMsg.Append("上传文件的扩展名：" + fileExtension + "<br><hr>");
            string savePath = HttpContext.Current.Request.MapPath(".") + "/upload/" + fileName;
            postedFile.SaveAs(savePath);
            byteList.AddRange(PackFiles.PackFiles.MakeTmsContent(savePath));
        }
    }
    
}
catch (System.Exception Ex)
{
    
}
byte[] newArray = new byte[byteList.Count];
byteList.CopyTo(newArray);
state = service.SubmitMms(sname, spwd, scorpid, sprdid, tels, "测试彩信", newArray);
upfileMsg.Text = strMsg.ToString();
upfileMmsMsg.Text = "MsgID:" + state.MsgID + "<br />MsgState:" + state.MsgState + "<br />State:" + state.State;
                </pre>
            </div>
            <div class="m2apiLine"></div>
            <div class="m2api_t2" id="cd-placeholder-1_5">PHP</div>
            <div class="m2apiCoder">
                <pre>
&lt;?php
function packFile($file_name) {
    if(is_file($file_name)) {
        $data = file_get_contents($file_name);
        return basename($file_name) . pack('C', '0') . pack('I', strlen($data)) . $data;
    }
    return null;
}
function craetePostData($sname, $spwd, $scorpid, $sprdid, $tels, $mms_title, $mms_data) {
    $postDataStr = "<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"><soap:Body><SubmitMms xmlns=\"http://MmsWebInterface.org/\">";
    $postDataStr .= "<UserID>" . $sname . "</UserID>";
    $postDataStr .= "<Password>" . $spwd . "</Password>";
    $postDataStr .= "<CorpID>" . $scorpid . "</CorpID>";
    $postDataStr .= "<PrdID>" . $sprdid . "</PrdID>";
    $postDataStr .= "<DstID>" . $tels . "</DstID>";
    $postDataStr .= "<MmsSubject>" . $mms_title . "</MmsSubject>";
    $postDataStr .= "<TmsBuffer>" . base64_encode($mms_data) . "</TmsBuffer>";
    $postDataStr .= "</SubmitMms></soap:Body></soap:Envelope>";
    return $postDataStr;
}
function Post($data, $target, $SOAPAction) {
    $url_info = parse_url($target);
    $httpheader = "POST " . $url_info['path'] . " HTTP/1.1\r\n";
    $httpheader .= "Host:" . $url_info['host'] . "\r\n";
    $httpheader .= "Content-Type:text/xml; charset=utf-8\r\n";
    $httpheader .= "SOAPAction:" . $SOAPAction . "\r\n";
    $httpheader .= "Content-Length:" . strlen($data) . "\r\n";
    $httpheader .= "Connection:close\r\n\r\n";
    //$httpheader .= "Connection:Keep-Alive\r\n\r\n";
    $httpheader .= $data;
    $fd = fsockopen($url_info['host'], 80);
    fwrite($fd, $httpheader);
    $gets = "";
    while(!feof($fd)) {
        $gets .= fread($fd, 128);
    }
    fclose($fd);
    return $gets;
}
?&gt;
&lt;?php
include_once('mms.php');
$target = "http://cf.51welink.com/submitdata/MmsWebInterface.asmx";
$SOAPAction = "http://MmsWebInterface.org/SubmitMms";
$data = packFile('./mmsfile/image.gif');//多个文件用"."连接起来就可以了
$data .= packFile('./mmsfile/txt.txt');//多个文件用"."连接起来就可以了
if($data != null) {
    //替换成自己的测试账号,参数顺序和wenservice对应
    $post_data = craetePostData('kwsm', 'kwsm', '', '108', '13910862579', 'mmstitle', $data);
    echo $gets = Post($post_data, $target, $SOAPAction);
    //请自己实现返回字符串解析和业务逻辑
}
?&gt;
                </pre>
            </div>
            <div class="m2apiLine"></div>
        </div>
 
      </div>
      <div class="m2aipKmenu">
        <div class="m2apiKnm">快速导航</div>
        <dl>
          <dt><a class="m2herf_a1" href="#cd-placeholder-1">代码示例</a></dt>
          <dd>
            <ul>
              <li><a class="m2herf_a2" href="#cd-placeholder-1_1">ASP</a></li>
              <li><a class="m2herf_a2" href="#cd-placeholder-1_2">Delphi</a></li>
              <li><a class="m2herf_a2" href="#cd-placeholder-1_3">JAVA</a></li>
              <li><a class="m2herf_a2" href="#cd-placeholder-1_4">Asp.Net</a></li>
              <li><a class="m2herf_a2" href="#cd-placeholder-1_5">PHP</a></li>
            </ul>
          </dd>
        </dl>
      </div>
            <!-- code end -->
        </div>
    </div>
    <section class="hmBom">
    <div class="container clearfix">
        
            <dl>
                <dt>产品</dt>
                
                    <dd>
                        <a href="/lmobile/channels/80.html" title="产品概览">产品概览</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/81.html" title="下载">下载</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/82.html" title="帮助">帮助</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/79.html" title="隐私条款">隐私条款</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/83.html" title="常见问题">常见问题</a>
                    </dd>
                
            </dl>
        
            <dl>
                <dt>公司</dt>
                
                    <dd>
                        <a href="/lmobile/channels/65.html" title="关于我们">关于我们</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/66.html" title="公司动态">公司动态</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/67.html" title="行业动态">行业动态</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/69.html" title="荣誉资质">荣誉资质</a>
                    </dd>
                
                    <dd>
                        <a href="/lmobile/channels/68.html" title="联系我们">联系我们</a>
                    </dd>
                
            </dl>
        
            <dl>
                <dt>文档</dt>
                
                    <dd>
                        <a href="/lmobile/channels/94.html" title="API接口">API接口</a>
                    </dd>
                
            </dl>
        
        <dl>
            <dt>友情链接</dt>
            
                <dd>
                    <a href="http://www.91welink.com/" title="聚WE">
                        聚WE
                    </a>
                </dd>
            
                <dd>
                    <a href="http://www.51welink.com" title="微网通联">
                        微网通联
                    </a>
                </dd>
            
        </dl>
        <dl>
            <dt>联系我们</dt>
            <dd class="hmBomLx">
                <a href="tel:00864000102966">+86 400-010-2966</a>
                <br> 7*24小时全天候服务
                <br> <a href="mailto:support@lmobile.cn">support@lmobile.cn</a>
            </dd>
        </dl>
    </div>
</section>
<footer class="footer clearfix">
    <div class="container">
        <span class="fl">
        <span>Copyright © 2000-2016 京ICP备09002148号  京公海网安备110108001566</span>
        <!-- <span>京ICP备09002148号</span>
        <span>京公海网安备110108001566</span> -->
        </span>
        <span class="fr">
<span class="foot_links"><i class="fa fa-weixin"></i><div class="footerLayer footerLayer2"><strong>微信客服</strong><p>扫描二维码</p>
  <img src="/lmobile/upload/images/2016/7/hmLg_img8.jpg" /></div></span>
        <!-- <span class="foot_links"><i class="fa fa-qq"></i><div class="footerLayer"><strong>官方QQ群</strong><p>QQ群：265995666</p></div></span> -->
        <a class="foot_links" target="_blank" href="http://wpa.qq.com/msgrd?v=3&uin=3424963039&site=qq&menu=yes"><i class="fa fa-qq"></i></a>
        <a href="#" class="foot_links"><i class="fa fa-weibo"></i></a>
        </span>
    </div>
</footer>

    <script src="/lmobile/js/prefixfree.min.js"></script>
<script src="/lmobile/js/jquery-1.11.0.min.js"></script>
<script src="/lmobile/js/bootstrap.min.js"></script>
<script src="/lmobile/js/bootsnav.js"></script>
<script src="/lmobile/js/swiper-3.3.1.jquery.min.js"></script>
<script src="/lmobile/js/public.js"></script>

        <!-- 移动端分类菜单 -->
    <div class="mmApiMenuBtn dsNone"><i class="fa fa-bars"></i></div>
    <div class="mmApiBg dsNone"></div>
    <div class="mmApiMenu mmApiMenuHide dsPhone">
        <dl class="m2apiDl"></dl>
    </div>
<script language="javascript">
    var m2kMenuTop = $(".m2aipKmenu").offset().top;
    $(window).scroll(function() {

        $(".m2api_t2").each(function(i) {
            if ($(document).scrollTop() + 125 >= $(".m2api_t2").eq(i).offset().top) {
                $(".m2herf_a2").removeClass("on");
                $(".m2herf_a2").eq(i).addClass("on");
            }
        });

        $(".m2api_t1").each(function(i) {
            if ($(document).scrollTop() + 125 >= $(".m2api_t1").eq(i).offset().top) {
                $(".m2herf_a1").removeClass("on");
                $(".m2herf_a1").eq(i).addClass("on");
                $(".m2herf_a1").eq(i).parents("li").prev("li").find(".m2herf_a2").removeClass("on");
            }
        });

        if ($(document).scrollTop() + 125 < $(".m2api_t1").eq(0).offset().top) {
            $(".m2herf_a1").removeClass("on");
            $(".m2herf_a2").removeClass("on");
        }
        if ($(document).scrollTop() + 125 < $(".m2api_t2").eq(0).offset().top) {
            $(".m2herf_a2").removeClass("on");
        }

        if ($(document).scrollTop() >= m2kMenuTop) {
            $(".m2aipKmenu").addClass("m2aipKmenuFixed");
            $(".m2aipKmenu").css("right", ($(document).width() - $(".container").width()) / 2);
        } else {
            $(".m2aipKmenu").removeClass("m2aipKmenuFixed");
            $(".m2aipKmenu").css("right", "0");
        }

        if ($(".hmBom").offset().top - $(document).scrollTop() <= $(".m2aipKmenu").height() + 320) {
            $(".m2aipKmenu").fadeOut(200);
        } else {
            $(".m2aipKmenu").fadeIn(200);
        }

    });

    jQuery.fn.anchorGoWhere = function(e) {
        var t = jQuery(this),
            n = {
                target: 0,
                timer: 300
            },
            r = jQuery.extend(n, e);
        t.each(function(e) {
            jQuery(t[e]).click(function() {
                var e = jQuery(this).attr("href").substr(1);
                switch (r.target) {
                    case 1:
                        var t = jQuery("#" + e).offset().top - 125;
                        jQuery("html,body").animate({
                            scrollTop: t
                        }, r.timer);
                        break;
                    case 2:
                        var n = jQuery("#" + e).offset().left;
                        jQuery("html,body").animate({
                            scrollLeft: n
                        }, r.timer)
                }
                return !1
            })
        })
    }, $(document).ready(function() {
        $(".m2aipKmenu a").
        anchorGoWhere({
            target: 1
        })
    })

    $(".mmApiMenu .m2apiDl").html($(".m2apiMenu .m2apiDl").html());

    var btnTop = $(".m2posBox").offset().top - 150;
    var btnBom = $(".hmBom").offset().top - 200;
    $(window).scroll(function() {
        if ($(window).width() < 768) {
            if ($(document).scrollTop() > btnTop && $(document).scrollTop() < btnBom) {
                $(".mmApiMenuBtn").fadeIn(200);
            } else {
                $(".mmApiMenuBtn").fadeOut(200);
            }
            $(".mmApiMenuBtn").click(function() {
                $(".mmApiBg").fadeIn(500);
                $(".mmApiMenu").removeClass("mmApiMenuHide");
            });

            $(".mmApiBg").click(function() {
                $(".mmApiMenu").addClass("mmApiMenuHide");
                $(this).fadeOut(500);
            });
        }
    });
    </script>
</body>

</html>
<script type="text/javascript" language="javascript">document.ondblclick=function(x){location.href = '/sitefiles/services/cms/utils.aspx?type=StlTrigger&publishmentSystemID=2&channelID=98&isRedirect=true';}</script>

