/*
 * jQuery JavaScript Library v1.8.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Thu Sep 20 2012 21:13:05 GMT-0400 (Eastern Daylight Time)
 */
(function(bT,bR){var bg,aN,Q=bT.document,aq=bT.location,ar=bT.navigator,b=bT.jQuery,a=bT.$,w=Array.prototype.push,z=Array.prototype.slice,u=Array.prototype.indexOf,A=Object.prototype.toString,t=Object.prototype.hasOwnProperty,B=String.prototype.trim,ap=function(bZ,e){return new ap.fn.init(bZ,e,bg)},v=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,x=/\S/,y=/\s+/,by=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bn=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,bv=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bF=/^[\],:{}\s]*$/,bE=/(?:^|:|,)(?:\s*\[)+/g,bG=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,bH=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,a7=/^-ms-/,aL=/-([\da-z])/gi,V=function(e,bZ){return(bZ+"").toUpperCase()},R=function(){if(Q.addEventListener){Q.removeEventListener("DOMContentLoaded",R,false);ap.ready()}else{if(Q.readyState==="complete"){Q.detachEvent("onreadystatechange",R);ap.ready()}}},q={};ap.fn=ap.prototype={constructor:ap,init:function(b4,e,b3){var b1,b0,b2,bZ;if(!b4){return this}if(b4.nodeType){this.context=this[0]=b4;this.length=1;return this}if(typeof b4==="string"){if(b4.charAt(0)==="<"&&b4.charAt(b4.length-1)===">"&&b4.length>=3){b1=[null,b4,null]}else{b1=bn.exec(b4)}if(b1&&(b1[1]||!e)){if(b1[1]){e=e instanceof ap?e[0]:e;bZ=(e&&e.nodeType?e.ownerDocument||e:Q);b4=ap.parseHTML(b1[1],bZ,true);if(bv.test(b1[1])&&ap.isPlainObject(e)){this.attr.call(b4,e,true)}return ap.merge(this,b4)}else{b0=Q.getElementById(b1[2]);if(b0&&b0.parentNode){if(b0.id!==b1[2]){return b3.find(b4)}this.length=1;this[0]=b0}this.context=Q;this.selector=b4;return this}}else{if(!e||e.jquery){return(e||b3).find(b4)}else{return this.constructor(e).find(b4)}}}else{if(ap.isFunction(b4)){return b3.ready(b4)}}if(b4.selector!==bR){this.selector=b4.selector;this.context=b4.context}return ap.makeArray(b4,this)},selector:"",jquery:"1.8.2",length:0,size:function(){return this.length},toArray:function(){return z.call(this)},get:function(e){return e==null?this.toArray():(e<0?this[this.length+e]:this[e])},pushStack:function(e,bZ,b1){var b0=ap.merge(this.constructor(),e);b0.prevObject=this;b0.context=this.context;if(bZ==="find"){b0.selector=this.selector+(this.selector?" ":"")+b1}else{if(bZ){b0.selector=this.selector+"."+bZ+"("+b1+")"}}return b0},each:function(bZ,e){return ap.each(this,bZ,e)},ready:function(e){ap.ready.promise().done(e);return this},eq:function(e){e=+e;return e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(z.apply(this,arguments),"slice",z.call(arguments).join(","))},map:function(e){return this.pushStack(ap.map(this,function(bZ,b0){return e.call(bZ,b0,bZ)}))},end:function(){return this.prevObject||this.constructor(null)},push:w,sort:[].sort,splice:[].splice};ap.fn.init.prototype=ap.fn;ap.extend=ap.fn.extend=function(){var b5,b4,b6,bZ,b0,e,b7=arguments[0]||{},b2=1,b3=arguments.length,b1=false;if(typeof b7==="boolean"){b1=b7;b7=arguments[1]||{};b2=2}if(typeof b7!=="object"&&!ap.isFunction(b7)){b7={}}if(b3===b2){b7=this;--b2}for(;b2<b3;b2++){if((b5=arguments[b2])!=null){for(b4 in b5){b6=b7[b4];bZ=b5[b4];if(b7===bZ){continue}if(b1&&bZ&&(ap.isPlainObject(bZ)||(b0=ap.isArray(bZ)))){if(b0){b0=false;e=b6&&ap.isArray(b6)?b6:[]}else{e=b6&&ap.isPlainObject(b6)?b6:{}}b7[b4]=ap.extend(b1,e,bZ)}else{if(bZ!==bR){b7[b4]=bZ}}}}}return b7};ap.extend({noConflict:function(e){if(bT.$===ap){bT.$=a}if(e&&bT.jQuery===ap){bT.jQuery=b}return ap},isReady:false,readyWait:1,holdReady:function(e){if(e){ap.readyWait++}else{ap.ready(true)}},ready:function(e){if(e===true?--ap.readyWait:ap.isReady){return}if(!Q.body){return setTimeout(ap.ready,1)}ap.isReady=true;if(e!==true&&--ap.readyWait>0){return}aN.resolveWith(Q,[ap]);if(ap.fn.trigger){ap(Q).trigger("ready").off("ready")}},isFunction:function(e){return ap.type(e)==="function"},isArray:Array.isArray||function(e){return ap.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):q[A.call(e)]||"object"},isPlainObject:function(b1){if(!b1||ap.type(b1)!=="object"||b1.nodeType||ap.isWindow(b1)){return false}try{if(b1.constructor&&!t.call(b1,"constructor")&&!t.call(b1.constructor.prototype,"isPrototypeOf")){return false}}catch(bZ){return false}var b0;for(b0 in b1){}return b0===bR||t.call(b1,b0)},isEmptyObject:function(bZ){var e;for(e in bZ){return false}return true},error:function(e){throw new Error(e)},parseHTML:function(bZ,e,b1){var b0;if(!bZ||typeof bZ!=="string"){return null}if(typeof e==="boolean"){b1=e;e=0}e=e||Q;if((b0=bv.exec(bZ))){return[e.createElement(b0[1])]}b0=ap.buildFragment([bZ],e,b1?null:[]);return ap.merge([],(b0.cacheable?ap.clone(b0.fragment):b0.fragment).childNodes)},parseJSON:function(e){if(!e||typeof e!=="string"){return null}e=ap.trim(e);if(bT.JSON&&bT.JSON.parse){return bT.JSON.parse(e)}if(bF.test(e.replace(bG,"@").replace(bH,"]").replace(bE,""))){return(new Function("return "+e))()}ap.error("Invalid JSON: "+e)},parseXML:function(bZ){var b2,b1;if(!bZ||typeof bZ!=="string"){return null}try{if(bT.DOMParser){b1=new DOMParser();b2=b1.parseFromString(bZ,"text/xml")}else{b2=new ActiveXObject("Microsoft.XMLDOM");b2.async="false";b2.loadXML(bZ)}}catch(b0){b2=bR}if(!b2||!b2.documentElement||b2.getElementsByTagName("parsererror").length){ap.error("Invalid XML: "+bZ)}return b2},noop:function(){},globalEval:function(e){if(e&&x.test(e)){(bT.execScript||function(bZ){bT["eval"].call(bT,bZ)})(e)}},camelCase:function(e){return e.replace(a7,"ms-").replace(aL,V)},nodeName:function(e,bZ){return e.nodeName&&e.nodeName.toLowerCase()===bZ.toLowerCase()},each:function(b4,bZ,e){var b3,b0=0,b2=b4.length,b1=b2===bR||ap.isFunction(b4);if(e){if(b1){for(b3 in b4){if(bZ.apply(b4[b3],e)===false){break}}}else{for(;b0<b2;){if(bZ.apply(b4[b0++],e)===false){break}}}}else{if(b1){for(b3 in b4){if(bZ.call(b4[b3],b3,b4[b3])===false){break}}}else{for(;b0<b2;){if(bZ.call(b4[b0],b0,b4[b0++])===false){break}}}}return b4},trim:B&&!B.call("\uFEFF\xA0")?function(e){return e==null?"":B.call(e)}:function(e){return e==null?"":(e+"").replace(by,"")},makeArray:function(e,bZ){var b1,b0=bZ||[];if(e!=null){b1=ap.type(e);if(e.length==null||b1==="string"||b1==="function"||b1==="regexp"||ap.isWindow(e)){w.call(b0,e)}else{ap.merge(b0,e)}}return b0},inArray:function(bZ,e,b0){var b1;if(e){if(u){return u.call(e,bZ,b0)}b1=e.length;b0=b0?b0<0?Math.max(0,b1+b0):b0:0;for(;b0<b1;b0++){if(b0 in e&&e[b0]===bZ){return b0}}}return -1},merge:function(e,b2){var b1=b2.length,bZ=e.length,b0=0;if(typeof b1==="number"){for(;b0<b1;b0++){e[bZ++]=b2[b0]}}else{while(b2[b0]!==bR){e[bZ++]=b2[b0++]}}e.length=bZ;return e},grep:function(bZ,e,b1){var b4,b3=[],b0=0,b2=bZ.length;b1=!!b1;for(;b0<b2;b0++){b4=!!e(bZ[b0],b0);if(b1!==b4){b3.push(bZ[b0])}}return b3},map:function(b0,bZ,e){var b6,b3,b5=[],b1=0,b4=b0.length,b2=b0 instanceof ap||b4!==bR&&typeof b4==="number"&&((b4>0&&b0[0]&&b0[b4-1])||b4===0||ap.isArray(b0));if(b2){for(;b1<b4;b1++){b6=bZ(b0[b1],b1,e);if(b6!=null){b5[b5.length]=b6}}}else{for(b3 in b0){b6=bZ(b0[b3],b3,e);if(b6!=null){b5[b5.length]=b6}}}return b5.concat.apply([],b5)},guid:1,proxy:function(b0,bZ){var b2,e,b1;if(typeof bZ==="string"){b2=b0[bZ];bZ=b0;b0=b2}if(!ap.isFunction(b0)){return bR}e=z.call(arguments,2);b1=function(){return b0.apply(bZ,e.concat(z.call(arguments)))};b1.guid=b0.guid=b0.guid||ap.guid++;return b1},access:function(b0,b3,b5,b8,bZ,b1,b7){var b2,e=b5==null,b4=0,b6=b0.length;if(b5&&typeof b5==="object"){for(b4 in b5){ap.access(b0,b3,b4,b5[b4],1,b1,b8)}bZ=1}else{if(b8!==bR){b2=b7===bR&&ap.isFunction(b8);if(e){if(b2){b2=b3;b3=function(b9,ca,cb){return b2.call(ap(b9),cb)}}else{b3.call(b0,b8);b3=null}}if(b3){for(;b4<b6;b4++){b3(b0[b4],b5,b2?b8.call(b0[b4],b4,b3(b0[b4],b5)):b8,b7)}}bZ=1}}return bZ?b0:e?b3.call(b0):b6?b3(b0[0],b5):b1},now:function(){return(new Date()).getTime()}});ap.ready.promise=function(b1){if(!aN){aN=ap.Deferred();if(Q.readyState==="complete"){setTimeout(ap.ready,1)}else{if(Q.addEventListener){Q.addEventListener("DOMContentLoaded",R,false);bT.addEventListener("load",ap.ready,false)}else{Q.attachEvent("onreadystatechange",R);bT.attachEvent("onload",ap.ready);var b2=false;try{b2=bT.frameElement==null&&Q.documentElement}catch(b0){}if(b2&&b2.doScroll){(function bZ(){if(!ap.isReady){try{b2.doScroll("left")}catch(b3){return setTimeout(bZ,50)}ap.ready()}})()}}}}return aN.promise(b1)};ap.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,bZ){q["[object "+bZ+"]"]=bZ.toLowerCase()});bg=ap(Q);var ax={};function E(bZ){var e=ax[bZ]={};ap.each(bZ.split(y),function(b0,b1){e[b1]=true});return e}ap.Callbacks=function(b6){b6=typeof b6==="string"?(ax[b6]||E(b6)):ap.extend({},b6);var b5,bZ,b0,b3,b2,b1,b4=[],b8=!b6.once&&[],e=function(b9){b5=b6.memory&&b9;bZ=true;b1=b3||0;b3=0;b2=b4.length;b0=true;for(;b4&&b1<b2;b1++){if(b4[b1].apply(b9[0],b9[1])===false&&b6.stopOnFalse){b5=false;break}}b0=false;if(b4){if(b8){if(b8.length){e(b8.shift())}}else{if(b5){b4=[]}else{b7.disable()}}}},b7={add:function(){if(b4){var ca=b4.length;(function b9(cb){ap.each(cb,function(cc,cd){var ce=ap.type(cd);if(ce==="function"&&(!b6.unique||!b7.has(cd))){b4.push(cd)}else{if(cd&&cd.length&&ce!=="string"){b9(cd)}}})})(arguments);if(b0){b2=b4.length}else{if(b5){b3=ca;e(b5)}}}return this},remove:function(){if(b4){ap.each(arguments,function(b9,ca){var cb;while((cb=ap.inArray(ca,b4,cb))>-1){b4.splice(cb,1);if(b0){if(cb<=b2){b2--}if(cb<=b1){b1--}}}})}return this},has:function(b9){return ap.inArray(b9,b4)>-1},empty:function(){b4=[];return this},disable:function(){b4=b8=b5=bR;return this},disabled:function(){return !b4},lock:function(){b8=bR;if(!b5){b7.disable()}return this},locked:function(){return !b8},fireWith:function(ca,b9){b9=b9||[];b9=[ca,b9.slice?b9.slice():b9];if(b4&&(!bZ||b8)){if(b0){b8.push(b9)}else{e(b9)}}return this},fire:function(){b7.fireWith(this,arguments);return this},fired:function(){return !!bZ}};return b7};ap.extend({Deferred:function(bZ){var b2=[["resolve","done",ap.Callbacks("once memory"),"resolved"],["reject","fail",ap.Callbacks("once memory"),"rejected"],["notify","progress",ap.Callbacks("memory")]],b1="pending",b0={state:function(){return b1},always:function(){e.done(arguments).fail(arguments);return this},then:function(){var b3=arguments;return ap.Deferred(function(b4){ap.each(b2,function(b7,b8){var b5=b8[0],b6=b3[b7];e[b8[1]](ap.isFunction(b6)?function(){var b9=b6.apply(this,arguments);if(b9&&ap.isFunction(b9.promise)){b9.promise().done(b4.resolve).fail(b4.reject).progress(b4.notify)}else{b4[b5+"With"](this===e?b4:this,[b9])}}:b4[b5])});b3=null}).promise()},promise:function(b3){return b3!=null?ap.extend(b3,b0):b0}},e={};b0.pipe=b0.then;ap.each(b2,function(b3,b6){var b4=b6[2],b5=b6[3];b0[b6[1]]=b4.add;if(b5){b4.add(function(){b1=b5},b2[b3^1][2].disable,b2[2][2].lock)}e[b6[0]]=b4.fire;e[b6[0]+"With"]=b4.fireWith});b0.promise(e);if(bZ){bZ.call(e,e)}return e},when:function(b6){var bZ=0,b5=z.call(arguments),b0=b5.length,b3=b0!==1||(b6&&ap.isFunction(b6.promise))?b0:0,e=b3===1?b6:ap.Deferred(),b7=function(b9,b8,ca){return function(cb){b8[b9]=this;ca[b9]=arguments.length>1?z.call(arguments):cb;if(ca===b2){e.notifyWith(b8,ca)}else{if(!(--b3)){e.resolveWith(b8,ca)}}}},b2,b1,b4;if(b0>1){b2=new Array(b0);b1=new Array(b0);b4=new Array(b0);for(;bZ<b0;bZ++){if(b5[bZ]&&ap.isFunction(b5[bZ].promise)){b5[bZ].promise().done(b7(bZ,b4,b5)).fail(e.reject).progress(b7(bZ,b1,b2))}else{--b3}}}if(!b3){e.resolveWith(b4,b5)}return e.promise()}});ap.support=(function(){var cb,b0,bZ,ca,b9,b7,b5,b4,b6,b8,b1,b2=Q.createElement("div");b2.setAttribute("className","t");b2.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";b0=b2.getElementsByTagName("*");bZ=b2.getElementsByTagName("a")[0];bZ.style.cssText="top:1px;float:left;opacity:.5";if(!b0||!b0.length){return{}}ca=Q.createElement("select");b9=ca.appendChild(Q.createElement("option"));b7=b2.getElementsByTagName("input")[0];cb={leadingWhitespace:(b2.firstChild.nodeType===3),tbody:!b2.getElementsByTagName("tbody").length,htmlSerialize:!!b2.getElementsByTagName("link").length,style:/top/.test(bZ.getAttribute("style")),hrefNormalized:(bZ.getAttribute("href")==="/a"),opacity:/^0.5/.test(bZ.style.opacity),cssFloat:!!bZ.style.cssFloat,checkOn:(b7.value==="on"),optSelected:b9.selected,getSetAttribute:b2.className!=="t",enctype:!!Q.createElement("form").enctype,html5Clone:Q.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:(Q.compatMode==="CSS1Compat"),submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};b7.checked=true;cb.noCloneChecked=b7.cloneNode(true).checked;ca.disabled=true;cb.optDisabled=!b9.disabled;try{delete b2.test}catch(b3){cb.deleteExpando=false}if(!b2.addEventListener&&b2.attachEvent&&b2.fireEvent){b2.attachEvent("onclick",b1=function(){cb.noCloneEvent=false});b2.cloneNode(true).fireEvent("onclick");b2.detachEvent("onclick",b1)}b7=Q.createElement("input");b7.value="t";b7.setAttribute("type","radio");cb.radioValue=b7.value==="t";b7.setAttribute("checked","checked");b7.setAttribute("name","t");b2.appendChild(b7);b5=Q.createDocumentFragment();b5.appendChild(b2.lastChild);cb.checkClone=b5.cloneNode(true).cloneNode(true).lastChild.checked;cb.appendChecked=b7.checked;b5.removeChild(b7);b5.appendChild(b2);if(b2.attachEvent){for(b6 in {submit:true,change:true,focusin:true}){b4="on"+b6;b8=(b4 in b2);if(!b8){b2.setAttribute(b4,"return;");b8=(typeof b2[b4]==="function")}cb[b6+"Bubbles"]=b8}}ap(function(){var cc,cd,cg,cf,ce="padding:0;margin:0;border:0;display:block;overflow:hidden;",e=Q.getElementsByTagName("body")[0];if(!e){return}cc=Q.createElement("div");cc.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";e.insertBefore(cc,e.firstChild);cd=Q.createElement("div");cc.appendChild(cd);cd.innerHTML="<table><tr><td></td><td>t</td></tr></table>";cg=cd.getElementsByTagName("td");cg[0].style.cssText="padding:0;margin:0;border:0;display:none";b8=(cg[0].offsetHeight===0);cg[0].style.display="";cg[1].style.display="none";cb.reliableHiddenOffsets=b8&&(cg[0].offsetHeight===0);cd.innerHTML="";cd.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";cb.boxSizing=(cd.offsetWidth===4);cb.doesNotIncludeMarginInBodyOffset=(e.offsetTop!==1);if(bT.getComputedStyle){cb.pixelPosition=(bT.getComputedStyle(cd,null)||{}).top!=="1%";cb.boxSizingReliable=(bT.getComputedStyle(cd,null)||{width:"4px"}).width==="4px";cf=Q.createElement("div");cf.style.cssText=cd.style.cssText=ce;cf.style.marginRight=cf.style.width="0";cd.style.width="1px";cd.appendChild(cf);cb.reliableMarginRight=!parseFloat((bT.getComputedStyle(cf,null)||{}).marginRight)}if(typeof cd.style.zoom!=="undefined"){cd.innerHTML="";cd.style.cssText=ce+"width:1px;padding:1px;display:inline;zoom:1";cb.inlineBlockNeedsLayout=(cd.offsetWidth===3);cd.style.display="block";cd.style.overflow="visible";cd.innerHTML="<div></div>";cd.firstChild.style.width="5px";cb.shrinkWrapBlocks=(cd.offsetWidth!==3);cc.style.zoom=1}e.removeChild(cc);cc=cd=cg=cf=null});b5.removeChild(b2);b0=bZ=ca=b9=b7=b5=b2=null;return cb})();var aD=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,a8=/([A-Z])/g;ap.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(ap.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(e){e=e.nodeType?ap.cache[e[ap.expando]]:e[ap.expando];return !!e&&!am(e)},data:function(b0,b5,bZ,b6){if(!ap.acceptData(b0)){return}var b8,b7,b3=ap.expando,b1=typeof b5==="string",b4=b0.nodeType,e=b4?ap.cache:b0,b2=b4?b0[b3]:b0[b3]&&b3;if((!b2||!e[b2]||(!b6&&!e[b2].data))&&b1&&bZ===bR){return}if(!b2){if(b4){b0[b3]=b2=ap.deletedIds.pop()||ap.guid++}else{b2=b3}}if(!e[b2]){e[b2]={};if(!b4){e[b2].toJSON=ap.noop}}if(typeof b5==="object"||typeof b5==="function"){if(b6){e[b2]=ap.extend(e[b2],b5)}else{e[b2].data=ap.extend(e[b2].data,b5)}}b8=e[b2];if(!b6){if(!b8.data){b8.data={}}b8=b8.data}if(bZ!==bR){b8[ap.camelCase(b5)]=bZ}if(b1){b7=b8[b5];if(b7==null){b7=b8[ap.camelCase(b5)]}}else{b7=b8}return b7},removeData:function(bZ,b4,b5){if(!ap.acceptData(bZ)){return}var b6,b0,b3,b2=bZ.nodeType,e=b2?ap.cache:bZ,b1=b2?bZ[ap.expando]:ap.expando;if(!e[b1]){return}if(b4){b6=b5?e[b1]:e[b1].data;if(b6){if(!ap.isArray(b4)){if(b4 in b6){b4=[b4]}else{b4=ap.camelCase(b4);if(b4 in b6){b4=[b4]}else{b4=b4.split(" ")}}}for(b0=0,b3=b4.length;b0<b3;b0++){delete b6[b4[b0]]}if(!(b5?am:ap.isEmptyObject)(b6)){return}}}if(!b5){delete e[b1].data;if(!am(e[b1])){return}}if(b2){ap.cleanData([bZ],true)}else{if(ap.support.deleteExpando||e!=e.window){delete e[b1]}else{e[b1]=null}}},_data:function(bZ,b0,e){return ap.data(bZ,b0,e,true)},acceptData:function(e){var bZ=e.nodeName&&ap.noData[e.nodeName.toLowerCase()];return !bZ||bZ!==true&&e.getAttribute("classid")===bZ}});ap.fn.extend({data:function(b2,b7){var b6,b5,e,b4,b3,b0=this[0],b1=0,bZ=null;if(b2===bR){if(this.length){bZ=ap.data(b0);if(b0.nodeType===1&&!ap._data(b0,"parsedAttrs")){e=b0.attributes;for(b3=e.length;b1<b3;b1++){b4=e[b1].name;if(!b4.indexOf("data-")){b4=ap.camelCase(b4.substring(5));O(b0,b4,bZ[b4])}}ap._data(b0,"parsedAttrs",true)}}return bZ}if(typeof b2==="object"){return this.each(function(){ap.data(this,b2)})}b6=b2.split(".",2);b6[1]=b6[1]?"."+b6[1]:"";b5=b6[1]+"!";return ap.access(this,function(b8){if(b8===bR){bZ=this.triggerHandler("getData"+b5,[b6[0]]);if(bZ===bR&&b0){bZ=ap.data(b0,b2);bZ=O(b0,b2,bZ)}return bZ===bR&&b6[1]?this.data(b6[0]):bZ}b6[1]=b8;this.each(function(){var b9=ap(this);b9.triggerHandler("setData"+b5,b6);ap.data(this,b2,b8);b9.triggerHandler("changeData"+b5,b6)})},null,b7,arguments.length>1,null,false)},removeData:function(e){return this.each(function(){ap.removeData(this,e)})}});function O(b1,b2,bZ){if(bZ===bR&&b1.nodeType===1){var b3="data-"+b2.replace(a8,"-$1").toLowerCase();bZ=b1.getAttribute(b3);if(typeof bZ==="string"){try{bZ=bZ==="true"?true:bZ==="false"?false:bZ==="null"?null:+bZ+""===bZ?+bZ:aD.test(bZ)?ap.parseJSON(bZ):bZ}catch(b0){}ap.data(b1,b2,bZ)}else{bZ=bR}}return bZ}function am(bZ){var e;for(e in bZ){if(e==="data"&&ap.isEmptyObject(bZ[e])){continue}if(e!=="toJSON"){return false}}return true}ap.extend({queue:function(bZ,b1,e){var b0;if(bZ){b1=(b1||"fx")+"queue";b0=ap._data(bZ,b1);if(e){if(!b0||ap.isArray(e)){b0=ap._data(bZ,b1,ap.makeArray(e))}else{b0.push(e)}}return b0||[]}},dequeue:function(e,b4){b4=b4||"fx";var b2=ap.queue(e,b4),b3=b2.length,bZ=b2.shift(),b0=ap._queueHooks(e,b4),b1=function(){ap.dequeue(e,b4)};if(bZ==="inprogress"){bZ=b2.shift();b3--}if(bZ){if(b4==="fx"){b2.unshift("inprogress")}delete b0.stop;bZ.call(e,b1,b0)}if(!b3&&b0){b0.empty.fire()}},_queueHooks:function(e,b0){var bZ=b0+"queueHooks";return ap._data(e,bZ)||ap._data(e,bZ,{empty:ap.Callbacks("once memory").add(function(){ap.removeData(e,b0+"queue",true);ap.removeData(e,bZ,true)})})}});ap.fn.extend({queue:function(b0,e){var bZ=2;if(typeof b0!=="string"){e=b0;b0="fx";bZ--}if(arguments.length<bZ){return ap.queue(this[0],b0)}return e===bR?this:this.each(function(){var b1=ap.queue(this,b0,e);ap._queueHooks(this,b0);if(b0==="fx"&&b1[0]!=="inprogress"){ap.dequeue(this,b0)}})},dequeue:function(e){return this.each(function(){ap.dequeue(this,e)})},delay:function(e,bZ){e=ap.fx?ap.fx.speeds[e]||e:e;bZ=bZ||"fx";return this.queue(bZ,function(b1,b0){var b2=setTimeout(b1,e);b0.stop=function(){clearTimeout(b2)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(b5,b2){var b4,e=1,bZ=ap.Deferred(),b0=this,b1=this.length,b3=function(){if(!(--e)){bZ.resolveWith(b0,[b0])}};if(typeof b5!=="string"){b2=b5;b5=bR}b5=b5||"fx";while(b1--){b4=ap._data(b0[b1],b5+"queueHooks");if(b4&&b4.empty){e++;b4.empty.add(b3)}}b3();return bZ.promise(b2)}});var at,o,Y,aH=/[\t\r\n]/g,bp=/\r/g,bA=/^(?:button|input)$/i,aQ=/^(?:button|input|object|select|textarea)$/i,aJ=/^a(?:rea|)$/i,aC=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,ad=ap.support.getSetAttribute;ap.fn.extend({attr:function(e,bZ){return ap.access(this,ap.attr,e,bZ,arguments.length>1)},removeAttr:function(e){return this.each(function(){ap.removeAttr(this,e)})},prop:function(e,bZ){return ap.access(this,ap.prop,e,bZ,arguments.length>1)},removeProp:function(e){e=ap.propFix[e]||e;return this.each(function(){try{this[e]=bR;delete this[e]}catch(bZ){}})},addClass:function(b5){var b0,b2,b3,b1,b4,e,bZ;if(ap.isFunction(b5)){return this.each(function(b6){ap(this).addClass(b5.call(this,b6,this.className))})}if(b5&&typeof b5==="string"){b0=b5.split(y);for(b2=0,b3=this.length;b2<b3;b2++){b1=this[b2];if(b1.nodeType===1){if(!b1.className&&b0.length===1){b1.className=b5}else{b4=" "+b1.className+" ";for(e=0,bZ=b0.length;e<bZ;e++){if(b4.indexOf(" "+b0[e]+" ")<0){b4+=b0[e]+" "}}b1.className=ap.trim(b4)}}}}return this},removeClass:function(b5){var b4,b0,b1,e,bZ,b2,b3;if(ap.isFunction(b5)){return this.each(function(b6){ap(this).removeClass(b5.call(this,b6,this.className))})}if((b5&&typeof b5==="string")||b5===bR){b4=(b5||"").split(y);for(b2=0,b3=this.length;b2<b3;b2++){b1=this[b2];if(b1.nodeType===1&&b1.className){b0=(" "+b1.className+" ").replace(aH," ");for(e=0,bZ=b4.length;e<bZ;e++){while(b0.indexOf(" "+b4[e]+" ")>=0){b0=b0.replace(" "+b4[e]+" "," ")}}b1.className=b5?ap.trim(b0):""}}}return this},toggleClass:function(b1,bZ){var b0=typeof b1,e=typeof bZ==="boolean";if(ap.isFunction(b1)){return this.each(function(b2){ap(this).toggleClass(b1.call(this,b2,this.className,bZ),bZ)})}return this.each(function(){if(b0==="string"){var b2,b4=0,b5=ap(this),b6=bZ,b3=b1.split(y);while((b2=b3[b4++])){b6=e?b6:!b5.hasClass(b2);b5[b6?"addClass":"removeClass"](b2)}}else{if(b0==="undefined"||b0==="boolean"){if(this.className){ap._data(this,"__className__",this.className)}this.className=this.className||b1===false?"":ap._data(this,"__className__")||""}}})},hasClass:function(b1){var e=" "+b1+" ",bZ=0,b0=this.length;for(;bZ<b0;bZ++){if(this[bZ].nodeType===1&&(" "+this[bZ].className+" ").replace(aH," ").indexOf(e)>=0){return true}}return false},val:function(b2){var bZ,b1,b0,e=this[0];if(!arguments.length){if(e){bZ=ap.valHooks[e.type]||ap.valHooks[e.nodeName.toLowerCase()];if(bZ&&"get" in bZ&&(b1=bZ.get(e,"value"))!==bR){return b1}b1=e.value;return typeof b1==="string"?b1.replace(bp,""):b1==null?"":b1}return}b0=ap.isFunction(b2);return this.each(function(b3){var b5,b4=ap(this);if(this.nodeType!==1){return}if(b0){b5=b2.call(this,b3,b4.val())}else{b5=b2}if(b5==null){b5=""}else{if(typeof b5==="number"){b5+=""}else{if(ap.isArray(b5)){b5=ap.map(b5,function(b6){return b6==null?"":b6+""})}}}bZ=ap.valHooks[this.type]||ap.valHooks[this.nodeName.toLowerCase()];if(!bZ||!("set" in bZ)||bZ.set(this,b5,"value")===bR){this.value=b5}})}});ap.extend({valHooks:{option:{get:function(e){var bZ=e.attributes.value;return !bZ||bZ.specified?e.value:e.text}},select:{get:function(e){var b5,bZ,b1,b3,b0=e.selectedIndex,b6=[],b4=e.options,b2=e.type==="select-one";if(b0<0){return null}bZ=b2?b0:0;b1=b2?b0+1:b4.length;for(;bZ<b1;bZ++){b3=b4[bZ];if(b3.selected&&(ap.support.optDisabled?!b3.disabled:b3.getAttribute("disabled")===null)&&(!b3.parentNode.disabled||!ap.nodeName(b3.parentNode,"optgroup"))){b5=ap(b3).val();if(b2){return b5}b6.push(b5)}}if(b2&&!b6.length&&b4.length){return ap(b4[b0]).val()}return b6},set:function(e,bZ){var b0=ap.makeArray(bZ);ap(e).find("option").each(function(){this.selected=ap.inArray(ap(this).val(),b0)>=0});if(!b0.length){e.selectedIndex=-1}return b0}}},attrFn:{},attr:function(e,b0,b5,b3){var b4,bZ,b1,b2=e.nodeType;if(!e||b2===3||b2===8||b2===2){return}if(b3&&ap.isFunction(ap.fn[b0])){return ap(e)[b0](b5)}if(typeof e.getAttribute==="undefined"){return ap.prop(e,b0,b5)}b1=b2!==1||!ap.isXMLDoc(e);if(b1){b0=b0.toLowerCase();bZ=ap.attrHooks[b0]||(aC.test(b0)?o:at)}if(b5!==bR){if(b5===null){ap.removeAttr(e,b0);return}else{if(bZ&&"set" in bZ&&b1&&(b4=bZ.set(e,b5,b0))!==bR){return b4}else{e.setAttribute(b0,b5+"");return b5}}}else{if(bZ&&"get" in bZ&&b1&&(b4=bZ.get(e,b0))!==null){return b4}else{b4=e.getAttribute(b0);return b4===null?bR:b4}}},removeAttr:function(bZ,b4){var b3,e,b2,b1,b0=0;if(b4&&bZ.nodeType===1){e=b4.split(y);for(;b0<e.length;b0++){b2=e[b0];if(b2){b3=ap.propFix[b2]||b2;b1=aC.test(b2);if(!b1){ap.attr(bZ,b2,"")}bZ.removeAttribute(ad?b2:b3);if(b1&&b3 in bZ){bZ[b3]=false}}}}},attrHooks:{type:{set:function(e,b0){if(bA.test(e.nodeName)&&e.parentNode){ap.error("type property can't be changed")}else{if(!ap.support.radioValue&&b0==="radio"&&ap.nodeName(e,"input")){var bZ=e.value;e.setAttribute("type",b0);if(bZ){e.value=bZ}return b0}}}},value:{get:function(e,bZ){if(at&&ap.nodeName(e,"button")){return at.get(e,bZ)}return bZ in e?e.value:null},set:function(e,b0,bZ){if(at&&ap.nodeName(e,"button")){return at.set(e,b0,bZ)}e.value=b0}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,b0,b4){var b3,bZ,b1,b2=e.nodeType;if(!e||b2===3||b2===8||b2===2){return}b1=b2!==1||!ap.isXMLDoc(e);if(b1){b0=ap.propFix[b0]||b0;bZ=ap.propHooks[b0]}if(b4!==bR){if(bZ&&"set" in bZ&&(b3=bZ.set(e,b4,b0))!==bR){return b3}else{return(e[b0]=b4)}}else{if(bZ&&"get" in bZ&&(b3=bZ.get(e,b0))!==null){return b3}else{return e[b0]}}},propHooks:{tabIndex:{get:function(bZ){var e=bZ.getAttributeNode("tabindex");return e&&e.specified?parseInt(e.value,10):aQ.test(bZ.nodeName)||aJ.test(bZ.nodeName)&&bZ.href?0:bR}}}});o={get:function(bZ,b0){var e,b1=ap.prop(bZ,b0);return b1===true||typeof b1!=="boolean"&&(e=bZ.getAttributeNode(b0))&&e.nodeValue!==false?b0.toLowerCase():bR},set:function(e,b1,bZ){var b0;if(b1===false){ap.removeAttr(e,bZ)}else{b0=ap.propFix[bZ]||bZ;if(b0 in e){e[b0]=true}e.setAttribute(bZ,bZ.toLowerCase())}return bZ}};if(!ad){Y={name:true,id:true,coords:true};at=ap.valHooks.button={get:function(e,bZ){var b0;b0=e.getAttributeNode(bZ);return b0&&(Y[bZ]?b0.value!=="":b0.specified)?b0.value:bR},set:function(e,b1,bZ){var b0=e.getAttributeNode(bZ);if(!b0){b0=Q.createAttribute(bZ);e.setAttributeNode(b0)}return(b0.value=b1+"")}};ap.each(["width","height"],function(e,bZ){ap.attrHooks[bZ]=ap.extend(ap.attrHooks[bZ],{set:function(b0,b1){if(b1===""){b0.setAttribute(bZ,"auto");return b1}}})});ap.attrHooks.contenteditable={get:at.get,set:function(e,b0,bZ){if(b0===""){b0="false"}at.set(e,b0,bZ)}}}if(!ap.support.hrefNormalized){ap.each(["href","src","width","height"],function(e,bZ){ap.attrHooks[bZ]=ap.extend(ap.attrHooks[bZ],{get:function(b0){var b1=b0.getAttribute(bZ,2);return b1===null?bR:b1}})})}if(!ap.support.style){ap.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||bR},set:function(e,bZ){return(e.style.cssText=bZ+"")}}}if(!ap.support.optSelected){ap.propHooks.selected=ap.extend(ap.propHooks.selected,{get:function(e){var bZ=e.parentNode;if(bZ){bZ.selectedIndex;if(bZ.parentNode){bZ.parentNode.selectedIndex}}return null}})}if(!ap.support.enctype){ap.propFix.enctype="encoding"}if(!ap.support.checkOn){ap.each(["radio","checkbox"],function(){ap.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}})}ap.each(["radio","checkbox"],function(){ap.valHooks[this]=ap.extend(ap.valHooks[this],{set:function(e,bZ){if(ap.isArray(bZ)){return(e.checked=ap.inArray(ap(e).val(),bZ)>=0)}}})});var aS=/^(?:textarea|input|select)$/i,bB=/^([^\.]*|)(?:\.(.+)|)$/,aX=/(?:^|\s)hover(\.\S+|)\b/,a2=/^key/,a6=/^(?:mouse|contextmenu)|click/,aR=/^(?:focusinfocus|focusoutblur)$/,ah=function(e){return ap.event.special.hover?e:e.replace(aX,"mouseenter$1 mouseleave$1")};ap.event={add:function(bZ,cd,b5,e,b8){var b0,b1,b2,ca,cb,cc,b7,b3,b4,b6,b9;if(bZ.nodeType===3||bZ.nodeType===8||!cd||!b5||!(b0=ap._data(bZ))){return}if(b5.handler){b4=b5;b5=b4.handler;b8=b4.selector}if(!b5.guid){b5.guid=ap.guid++}b2=b0.events;if(!b2){b0.events=b2={}}b1=b0.handle;if(!b1){b0.handle=b1=function(ce){return typeof ap!=="undefined"&&(!ce||ap.event.triggered!==ce.type)?ap.event.dispatch.apply(b1.elem,arguments):bR};b1.elem=bZ}cd=ap.trim(ah(cd)).split(" ");for(ca=0;ca<cd.length;ca++){cb=bB.exec(cd[ca])||[];cc=cb[1];b7=(cb[2]||"").split(".").sort();b9=ap.event.special[cc]||{};cc=(b8?b9.delegateType:b9.bindType)||cc;b9=ap.event.special[cc]||{};b3=ap.extend({type:cc,origType:cb[1],data:e,handler:b5,guid:b5.guid,selector:b8,needsContext:b8&&ap.expr.match.needsContext.test(b8),namespace:b7.join(".")},b4);b6=b2[cc];if(!b6){b6=b2[cc]=[];b6.delegateCount=0;if(!b9.setup||b9.setup.call(bZ,e,b7,b1)===false){if(bZ.addEventListener){bZ.addEventListener(cc,b1,false)}else{if(bZ.attachEvent){bZ.attachEvent("on"+cc,b1)}}}}if(b9.add){b9.add.call(bZ,b3);if(!b3.handler.guid){b3.handler.guid=b5.guid}}if(b8){b6.splice(b6.delegateCount++,0,b3)}else{b6.push(b3)}ap.event.global[cc]=true}bZ=null},global:{},remove:function(e,ce,b3,b9,b5){var cb,cc,cd,b8,b6,b7,b4,b0,ca,b1,b2,bZ=ap.hasData(e)&&ap._data(e);if(!bZ||!(b0=bZ.events)){return}ce=ap.trim(ah(ce||"")).split(" ");for(cb=0;cb<ce.length;cb++){cc=bB.exec(ce[cb])||[];cd=b8=cc[1];b6=cc[2];if(!cd){for(cd in b0){ap.event.remove(e,cd+ce[cb],b3,b9,true)}continue}ca=ap.event.special[cd]||{};cd=(b9?ca.delegateType:ca.bindType)||cd;b1=b0[cd]||[];b7=b1.length;b6=b6?new RegExp("(^|\\.)"+b6.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(b4=0;b4<b1.length;b4++){b2=b1[b4];if((b5||b8===b2.origType)&&(!b3||b3.guid===b2.guid)&&(!b6||b6.test(b2.namespace))&&(!b9||b9===b2.selector||b9==="**"&&b2.selector)){b1.splice(b4--,1);if(b2.selector){b1.delegateCount--}if(ca.remove){ca.remove.call(e,b2)}}}if(b1.length===0&&b7!==b1.length){if(!ca.teardown||ca.teardown.call(e,b6,bZ.handle)===false){ap.removeEvent(e,cd,bZ.handle)}delete b0[cd]}}if(ap.isEmptyObject(b0)){delete bZ.handle;ap.removeData(e,"events",true)}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(b3,b1,b2,ca){if(b2&&(b2.nodeType===3||b2.nodeType===8)){return}var bZ,b5,b7,b0,b9,cb,cc,b6,b4,e,cd=b3.type||b3,b8=[];if(aR.test(cd+ap.event.triggered)){return}if(cd.indexOf("!")>=0){cd=cd.slice(0,-1);b5=true}if(cd.indexOf(".")>=0){b8=cd.split(".");cd=b8.shift();b8.sort()}if((!b2||ap.event.customEvent[cd])&&!ap.event.global[cd]){return}b3=typeof b3==="object"?b3[ap.expando]?b3:new ap.Event(cd,b3):new ap.Event(cd);b3.type=cd;b3.isTrigger=true;b3.exclusive=b5;b3.namespace=b8.join(".");b3.namespace_re=b3.namespace?new RegExp("(^|\\.)"+b8.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;cb=cd.indexOf(":")<0?"on"+cd:"";if(!b2){bZ=ap.cache;for(b7 in bZ){if(bZ[b7].events&&bZ[b7].events[cd]){ap.event.trigger(b3,b1,bZ[b7].handle.elem,true)}}return}b3.result=bR;if(!b3.target){b3.target=b2}b1=b1!=null?ap.makeArray(b1):[];b1.unshift(b3);cc=ap.event.special[cd]||{};if(cc.trigger&&cc.trigger.apply(b2,b1)===false){return}b4=[[b2,cc.bindType||cd]];if(!ca&&!cc.noBubble&&!ap.isWindow(b2)){e=cc.delegateType||cd;b0=aR.test(e+cd)?b2:b2.parentNode;for(b9=b2;b0;b0=b0.parentNode){b4.push([b0,e]);b9=b0}if(b9===(b2.ownerDocument||Q)){b4.push([b9.defaultView||b9.parentWindow||bT,e])}}for(b7=0;b7<b4.length&&!b3.isPropagationStopped();b7++){b0=b4[b7][0];b3.type=b4[b7][1];b6=(ap._data(b0,"events")||{})[b3.type]&&ap._data(b0,"handle");if(b6){b6.apply(b0,b1)}b6=cb&&b0[cb];if(b6&&ap.acceptData(b0)&&b6.apply&&b6.apply(b0,b1)===false){b3.preventDefault()}}b3.type=cd;if(!ca&&!b3.isDefaultPrevented()){if((!cc._default||cc._default.apply(b2.ownerDocument,b1)===false)&&!(cd==="click"&&ap.nodeName(b2,"a"))&&ap.acceptData(b2)){if(cb&&b2[cd]&&((cd!=="focus"&&cd!=="blur")||b3.target.offsetWidth!==0)&&!ap.isWindow(b2)){b9=b2[cb];if(b9){b2[cb]=null}ap.event.triggered=cd;b2[cd]();ap.event.triggered=bR;if(b9){b2[cb]=b9}}}}return b3.result},dispatch:function(b1){b1=ap.event.fix(b1||bT.event);var b5,b6,bZ,ca,cd,b7,b8,b2,cc,b9,b4=((ap._data(this,"events")||{})[b1.type]||[]),b0=b4.delegateCount,e=z.call(arguments),cb=!b1.exclusive&&!b1.namespace,ce=ap.event.special[b1.type]||{},b3=[];e[0]=b1;b1.delegateTarget=this;if(ce.preDispatch&&ce.preDispatch.call(this,b1)===false){return}if(b0&&!(b1.button&&b1.type==="click")){for(bZ=b1.target;bZ!=this;bZ=bZ.parentNode||this){if(bZ.disabled!==true||b1.type!=="click"){cd={};b8=[];for(b5=0;b5<b0;b5++){b2=b4[b5];cc=b2.selector;if(cd[cc]===bR){cd[cc]=b2.needsContext?ap(cc,this).index(bZ)>=0:ap.find(cc,this,null,[bZ]).length}if(cd[cc]){b8.push(b2)}}if(b8.length){b3.push({elem:bZ,matches:b8})}}}}if(b4.length>b0){b3.push({elem:this,matches:b4.slice(b0)})}for(b5=0;b5<b3.length&&!b1.isPropagationStopped();b5++){b7=b3[b5];b1.currentTarget=b7.elem;for(b6=0;b6<b7.matches.length&&!b1.isImmediatePropagationStopped();b6++){b2=b7.matches[b6];if(cb||(!b1.namespace&&!b2.namespace)||b1.namespace_re&&b1.namespace_re.test(b2.namespace)){b1.data=b2.data;b1.handleObj=b2;ca=((ap.event.special[b2.origType]||{}).handle||b2.handler).apply(b7.elem,e);if(ca!==bR){b1.result=ca;if(ca===false){b1.preventDefault();b1.stopPropagation()}}}}}if(ce.postDispatch){ce.postDispatch.call(this,b1)}return b1.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,bZ){if(e.which==null){e.which=bZ.charCode!=null?bZ.charCode:bZ.keyCode}return e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b1,b4){var b2,b0,e,bZ=b4.button,b3=b4.fromElement;if(b1.pageX==null&&b4.clientX!=null){b2=b1.target.ownerDocument||Q;b0=b2.documentElement;e=b2.body;b1.pageX=b4.clientX+(b0&&b0.scrollLeft||e&&e.scrollLeft||0)-(b0&&b0.clientLeft||e&&e.clientLeft||0);b1.pageY=b4.clientY+(b0&&b0.scrollTop||e&&e.scrollTop||0)-(b0&&b0.clientTop||e&&e.clientTop||0)}if(!b1.relatedTarget&&b3){b1.relatedTarget=b3===b1.target?b4.toElement:b3}if(!b1.which&&bZ!==bR){b1.which=(bZ&1?1:(bZ&2?3:(bZ&4?2:0)))}return b1}},fix:function(bZ){if(bZ[ap.expando]){return bZ}var b1,b3,b2=bZ,b0=ap.event.fixHooks[bZ.type]||{},e=b0.props?this.props.concat(b0.props):this.props;bZ=ap.Event(b2);for(b1=e.length;b1;){b3=e[--b1];bZ[b3]=b2[b3]}if(!bZ.target){bZ.target=b2.srcElement||Q}if(bZ.target.nodeType===3){bZ.target=bZ.target.parentNode}bZ.metaKey=!!bZ.metaKey;return b0.filter?b0.filter(bZ,b2):bZ},special:{load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,b0,bZ){if(ap.isWindow(this)){this.onbeforeunload=bZ}},teardown:function(bZ,e){if(this.onbeforeunload===e){this.onbeforeunload=null}}}},simulate:function(b3,b1,b2,bZ){var b0=ap.extend(new ap.Event(),b2,{type:b3,isSimulated:true,originalEvent:{}});if(bZ){ap.event.trigger(b0,null,b1)}else{ap.event.dispatch.call(b1,b0)}if(b0.isDefaultPrevented()){b2.preventDefault()}}};ap.event.handle=ap.event.dispatch;ap.removeEvent=Q.removeEventListener?function(e,b0,bZ){if(e.removeEventListener){e.removeEventListener(b0,bZ,false)}}:function(e,b1,bZ){var b0="on"+b1;if(e.detachEvent){if(typeof e[b0]==="undefined"){e[b0]=null}e.detachEvent(b0,bZ)}};ap.Event=function(bZ,e){if(!(this instanceof ap.Event)){return new ap.Event(bZ,e)}if(bZ&&bZ.type){this.originalEvent=bZ;this.type=bZ.type;this.isDefaultPrevented=(bZ.defaultPrevented||bZ.returnValue===false||bZ.getPreventDefault&&bZ.getPreventDefault())?aP:aO}else{this.type=bZ}if(e){ap.extend(this,e)}this.timeStamp=bZ&&bZ.timeStamp||ap.now();this[ap.expando]=true};function aO(){return false}function aP(){return true}ap.Event.prototype={preventDefault:function(){this.isDefaultPrevented=aP;var bZ=this.originalEvent;if(!bZ){return}if(bZ.preventDefault){bZ.preventDefault()}else{bZ.returnValue=false}},stopPropagation:function(){this.isPropagationStopped=aP;var bZ=this.originalEvent;if(!bZ){return}if(bZ.stopPropagation){bZ.stopPropagation()}bZ.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=aP;this.stopPropagation()},isDefaultPrevented:aO,isPropagationStopped:aO,isImmediatePropagationStopped:aO};ap.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(bZ,e){ap.event.special[bZ]={delegateType:e,bindType:e,handle:function(b0){var b3,b5=this,b2=b0.relatedTarget,b1=b0.handleObj,b4=b1.selector;if(!b2||(b2!==b5&&!ap.contains(b5,b2))){b0.type=b1.origType;b3=b1.handler.apply(this,arguments);b0.type=e}return b3}}});if(!ap.support.submitBubbles){ap.event.special.submit={setup:function(){if(ap.nodeName(this,"form")){return false}ap.event.add(this,"click._submit keypress._submit",function(bZ){var b0=bZ.target,b1=ap.nodeName(b0,"input")||ap.nodeName(b0,"button")?b0.form:bR;if(b1&&!ap._data(b1,"_submit_attached")){ap.event.add(b1,"submit._submit",function(e){e._submit_bubble=true});ap._data(b1,"_submit_attached",true)}})},postDispatch:function(e){if(e._submit_bubble){delete e._submit_bubble;if(this.parentNode&&!e.isTrigger){ap.event.simulate("submit",this.parentNode,e,true)}}},teardown:function(){if(ap.nodeName(this,"form")){return false}ap.event.remove(this,"._submit")}}}if(!ap.support.changeBubbles){ap.event.special.change={setup:function(){if(aS.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){ap.event.add(this,"propertychange._change",function(e){if(e.originalEvent.propertyName==="checked"){this._just_changed=true}});ap.event.add(this,"click._change",function(e){if(this._just_changed&&!e.isTrigger){this._just_changed=false}ap.event.simulate("change",this,e,true)})}return false}ap.event.add(this,"beforeactivate._change",function(bZ){var b0=bZ.target;if(aS.test(b0.nodeName)&&!ap._data(b0,"_change_attached")){ap.event.add(b0,"change._change",function(e){if(this.parentNode&&!e.isSimulated&&!e.isTrigger){ap.event.simulate("change",this.parentNode,e,true)}});ap._data(b0,"_change_attached",true)}})},handle:function(bZ){var e=bZ.target;if(this!==e||bZ.isSimulated||bZ.isTrigger||(e.type!=="radio"&&e.type!=="checkbox")){return bZ.handleObj.handler.apply(this,arguments)}},teardown:function(){ap.event.remove(this,"._change");return !aS.test(this.nodeName)}}}if(!ap.support.focusinBubbles){ap.each({focus:"focusin",blur:"focusout"},function(b1,bZ){var e=0,b0=function(b2){ap.event.simulate(bZ,b2.target,ap.event.fix(b2),true)};ap.event.special[bZ]={setup:function(){if(e++===0){Q.addEventListener(b1,b0,true)}},teardown:function(){if(--e===0){Q.removeEventListener(b1,b0,true)}}}})}ap.fn.extend({on:function(b4,b2,e,bZ,b0){var b1,b3;if(typeof b4==="object"){if(typeof b2!=="string"){e=e||b2;b2=bR}for(b3 in b4){this.on(b3,b2,e,b4[b3],b0)}return this}if(e==null&&bZ==null){bZ=b2;e=b2=bR}else{if(bZ==null){if(typeof b2==="string"){bZ=e;e=bR}else{bZ=e;e=b2;b2=bR}}}if(bZ===false){bZ=aO}else{if(!bZ){return this}}if(b0===1){b1=bZ;bZ=function(b5){ap().off(b5);return b1.apply(this,arguments)};bZ.guid=b1.guid||(b1.guid=ap.guid++)}return this.each(function(){ap.event.add(this,b4,bZ,e,b2)})},one:function(b1,b0,e,bZ){return this.on(b1,b0,e,bZ,1)},off:function(b2,b0,e){var bZ,b1;if(b2&&b2.preventDefault&&b2.handleObj){bZ=b2.handleObj;ap(b2.delegateTarget).off(bZ.namespace?bZ.origType+"."+bZ.namespace:bZ.origType,bZ.selector,bZ.handler);return this}if(typeof b2==="object"){for(b1 in b2){this.off(b1,b0,b2[b1])}return this}if(b0===false||typeof b0==="function"){e=b0;b0=bR}if(e===false){e=aO}return this.each(function(){ap.event.remove(this,b2,e,b0)})},bind:function(b0,e,bZ){return this.on(b0,null,e,bZ)},unbind:function(bZ,e){return this.off(bZ,null,e)},live:function(b0,e,bZ){ap(this.context).on(b0,this.selector,e,bZ);return this},die:function(bZ,e){ap(this.context).off(bZ,this.selector||"**",e);return this},delegate:function(b0,b1,e,bZ){return this.on(b1,b0,e,bZ)},undelegate:function(bZ,b0,e){return arguments.length===1?this.off(bZ,"**"):this.off(b0,bZ||"**",e)},trigger:function(bZ,e){return this.each(function(){ap.event.trigger(bZ,e,this)})},triggerHandler:function(bZ,e){if(this[0]){return ap.event.trigger(bZ,e,this[0],true)}},toggle:function(bZ){var e=arguments,b0=bZ.guid||ap.guid++,b1=0,b2=function(b3){var b4=(ap._data(this,"lastToggle"+bZ.guid)||0)%b1;ap._data(this,"lastToggle"+bZ.guid,b4+1);b3.preventDefault();return e[b4].apply(this,arguments)||false};b2.guid=b0;while(b1<e.length){e[b1++].guid=b0}return this.click(b2)},hover:function(bZ,e){return this.mouseenter(bZ).mouseleave(e||bZ)}});ap.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(e,bZ){ap.fn[bZ]=function(b0,b1){if(b1==null){b1=b0;b0=null}return arguments.length>0?this.on(bZ,null,b0,b1):this.trigger(bZ)};if(a2.test(bZ)){ap.event.fixHooks[bZ]=ap.event.keyHooks}if(a6.test(bZ)){ap.event.fixHooks[bZ]=ap.event.mouseHooks}});
/*
 * Sizzle CSS Selector Engine
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://sizzlejs.com/
 */
(function(c6,c4){var b9,b2,cr,cs,cw,cf,cc,cZ,ct,cD,b8=true,c0="undefined",cq=("sizcache"+Math.random()).replace(".",""),c1=String,cm=c6.document,cl=cm.documentElement,ck=0,cn=0,cE=[].pop,cH=[].push,cY=[].slice,cv=[].indexOf||function(e){var c7=0,c8=this.length;for(;c7<c8;c7++){if(this[c7]===e){return c7}}return -1},cx=function(e,c7){e[cq]=c7==null||c7;return e},ch=function(){var e={},c7=[];return cx(function(c8,c9){if(c7.push(c8)>cr.cacheLength){delete e[c7.shift()]}return(e[c8]=c9)},e)},cb=ch(),c2=ch(),cd=ch(),c5="[\\x20\\t\\r\\n\\f]",ca="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",cu=ca.replace("w","w#"),cC="([*^$|!~]?=)",b7="\\["+c5+"*("+ca+")"+c5+"*(?:"+cC+c5+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+cu+")|)|)"+c5+"*\\]",cG=":("+ca+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+b7+")|[^:]|\\\\.)*|.*))\\)|)",cF=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+c5+"*((?:-\\d)?\\d*)"+c5+"*\\)|)(?=[^-]|$)",cS=new RegExp("^"+c5+"+|((?:^|[^\\\\])(?:\\\\.)*)"+c5+"+$","g"),cK=new RegExp("^"+c5+"*,"+c5+"*"),cJ=new RegExp("^"+c5+"*([\\x20\\t\\r\\n\\f>+~])"+c5+"*"),cP=new RegExp(cG),cQ=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,cO=/^:not/,cR=/[\x20\t\r\n\f]*[+~]/,cL=/:not\($/,cM=/h\d/i,cN=/input|select|textarea|button/i,cI=/\\(?!\\)/g,cA={ID:new RegExp("^#("+ca+")"),CLASS:new RegExp("^\\.("+ca+")"),NAME:new RegExp("^\\[name=['\"]?("+ca+")['\"]?\\]"),TAG:new RegExp("^("+ca.replace("w","w*")+")"),ATTR:new RegExp("^"+b7),PSEUDO:new RegExp("^"+cG),POS:new RegExp(cF,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+c5+"*(even|odd|(([+-]|)(\\d*)n|)"+c5+"*(?:([+-]|)"+c5+"*(\\d+)|))"+c5+"*\\)|)","i"),needsContext:new RegExp("^"+c5+"*[>+~]|"+cF,"i")},b0=function(c9){var c7=cm.createElement("div");try{return c9(c7)}catch(c8){return false}finally{c7=null}},b4=b0(function(e){e.appendChild(cm.createComment(""));return !e.getElementsByTagName("*").length}),b3=b0(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild&&typeof e.firstChild.getAttribute!==c0&&e.firstChild.getAttribute("href")==="#"}),b1=b0(function(e){e.innerHTML="<select></select>";var c7=typeof e.lastChild.getAttribute("multiple");return c7!=="boolean"&&c7!=="string"}),b5=b0(function(e){e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";if(!e.getElementsByClassName||!e.getElementsByClassName("e").length){return false}e.lastChild.className="e";return e.getElementsByClassName("e").length===2}),b6=b0(function(e){e.id=cq+0;e.innerHTML="<a name='"+cq+"'></a><div name='"+cq+"'></div>";cl.insertBefore(e,cl.firstChild);var c7=cm.getElementsByName&&cm.getElementsByName(cq).length===2+cm.getElementsByName(cq+0).length;b2=!cm.getElementById(cq);cl.removeChild(e);return c7});try{cY.call(cl.childNodes,0)[0].nodeType}catch(co){cY=function(c7){var e,c8=[];for(;(e=this[c7]);c7++){c8.push(e)}return c8}}function cX(dd,e,db,dc){db=db||[];e=e||cm;var c9,c7,de,c8,da=e.nodeType;if(!dd||typeof dd!=="string"){return db}if(da!==1&&da!==9){return[]}de=cw(e);if(!de&&!dc){if((c9=cQ.exec(dd))){if((c8=c9[1])){if(da===9){c7=e.getElementById(c8);if(c7&&c7.parentNode){if(c7.id===c8){db.push(c7);return db}}else{return db}}else{if(e.ownerDocument&&(c7=e.ownerDocument.getElementById(c8))&&cf(e,c7)&&c7.id===c8){db.push(c7);return db}}}else{if(c9[2]){cH.apply(db,cY.call(e.getElementsByTagName(dd),0));return db}else{if((c8=c9[3])&&b5&&e.getElementsByClassName){cH.apply(db,cY.call(e.getElementsByClassName(c8),0));return db}}}}}return cT(dd.replace(cS,"$1"),e,db,dc,de)}cX.matches=function(c7,e){return cX(c7,null,null,e)};cX.matchesSelector=function(e,c7){return cX(c7,null,null,[e]).length>0};function ci(e){return function(c7){var c8=c7.nodeName.toLowerCase();return c8==="input"&&c7.type===e}}function cg(e){return function(c7){var c8=c7.nodeName.toLowerCase();return(c8==="input"||c8==="button")&&c7.type===e}}function cj(e){return cx(function(c7){c7=+c7;return cx(function(dc,da){var c9,db=e([],dc.length,c7),c8=db.length;while(c8--){if(dc[(c9=db[c8])]){dc[c9]=!(da[c9]=dc[c9])}}})})}cs=cX.getText=function(e){var c8,da="",c7=0,c9=e.nodeType;if(c9){if(c9===1||c9===9||c9===11){if(typeof e.textContent==="string"){return e.textContent}else{for(e=e.firstChild;e;e=e.nextSibling){da+=cs(e)}}}else{if(c9===3||c9===4){return e.nodeValue}}}else{for(;(c8=e[c7]);c7++){da+=cs(c8)}}return da};cw=cX.isXML=function(c7){var e=c7&&(c7.ownerDocument||c7).documentElement;return e?e.nodeName!=="HTML":false};cf=cX.contains=cl.contains?function(e,c8){var c7=e.nodeType===9?e.documentElement:e,c9=c8&&c8.parentNode;return e===c9||!!(c9&&c9.nodeType===1&&c7.contains&&c7.contains(c9))}:cl.compareDocumentPosition?function(e,c7){return c7&&!!(e.compareDocumentPosition(c7)&16)}:function(e,c7){while((c7=c7.parentNode)){if(c7===e){return true}}return false};cX.attr=function(e,c7){var c8,c9=cw(e);if(!c9){c7=c7.toLowerCase()}if((c8=cr.attrHandle[c7])){return c8(e)}if(c9||b1){return e.getAttribute(c7)}c8=e.getAttributeNode(c7);return c8?typeof e[c7]==="boolean"?e[c7]?c7:null:c8.specified?c8.value:null:null};cr=cX.selectors={cacheLength:50,createPseudo:cx,match:cA,attrHandle:b3?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:b2?function(c7,e,c9){if(typeof e.getElementById!==c0&&!c9){var c8=e.getElementById(c7);return c8&&c8.parentNode?[c8]:[]}}:function(c7,e,c9){if(typeof e.getElementById!==c0&&!c9){var c8=e.getElementById(c7);return c8?c8.id===c7||typeof c8.getAttributeNode!==c0&&c8.getAttributeNode("id").value===c7?[c8]:c4:[]}},TAG:b4?function(c7,e){if(typeof e.getElementsByTagName!==c0){return e.getElementsByTagName(c7)}}:function(da,e){var c9=e.getElementsByTagName(da);if(da==="*"){var c7,db=[],c8=0;for(;(c7=c9[c8]);c8++){if(c7.nodeType===1){db.push(c7)}}return db}return c9},NAME:b6&&function(c7,e){if(typeof e.getElementsByName!==c0){return e.getElementsByName(name)}},CLASS:b5&&function(e,c7,c8){if(typeof c7.getElementsByClassName!==c0&&!c8){return c7.getElementsByClassName(e)}}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[1]=e[1].replace(cI,"");e[3]=(e[4]||e[5]||"").replace(cI,"");if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)},CHILD:function(e){e[1]=e[1].toLowerCase();if(e[1]==="nth"){if(!e[2]){cX.error(e[0])}e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd"));e[4]=+((e[6]+e[7])||e[2]==="odd")}else{if(e[2]){cX.error(e[0])}}return e},PSEUDO:function(c7){var c8,e;if(cA.CHILD.test(c7[0])){return null}if(c7[3]){c7[2]=c7[3]}else{if((c8=c7[4])){if(cP.test(c8)&&(e=c3(c8,true))&&(e=c8.indexOf(")",c8.length-e)-c8.length)){c8=c8.slice(0,e);c7[0]=c7[0].slice(0,e)}c7[2]=c8}}return c7.slice(0,3)}},filter:{ID:b2?function(e){e=e.replace(cI,"");return function(c7){return c7.getAttribute("id")===e}}:function(e){e=e.replace(cI,"");return function(c7){var c8=typeof c7.getAttributeNode!==c0&&c7.getAttributeNode("id");return c8&&c8.value===e}},TAG:function(e){if(e==="*"){return function(){return true}}e=e.replace(cI,"").toLowerCase();return function(c7){return c7.nodeName&&c7.nodeName.toLowerCase()===e}},CLASS:function(e){var c7=cb[cq][e];if(!c7){c7=cb(e,new RegExp("(^|"+c5+")"+e+"("+c5+"|$)"))}return function(c8){return c7.test(c8.className||(typeof c8.getAttribute!==c0&&c8.getAttribute("class"))||"")}},ATTR:function(c7,c8,e){return function(da,c9){var db=cX.attr(da,c7);if(db==null){return c8==="!="}if(!c8){return true}db+="";return c8==="="?db===e:c8==="!="?db!==e:c8==="^="?e&&db.indexOf(e)===0:c8==="*="?e&&db.indexOf(e)>-1:c8==="$="?e&&db.substr(db.length-e.length)===e:c8==="~="?(" "+db+" ").indexOf(e)>-1:c8==="|="?db===e||db.substr(0,e.length+1)===e+"-":false}},CHILD:function(c9,e,c7,c8){if(c9==="nth"){return function(db){var dc,da,dd=db.parentNode;if(c7===1&&c8===0){return true}if(dd){da=0;for(dc=dd.firstChild;dc;dc=dc.nextSibling){if(dc.nodeType===1){da++;if(db===dc){break}}}}da-=c8;return da===c7||(da%c7===0&&da/c7>=0)}}return function(da){var db=da;switch(c9){case"only":case"first":while((db=db.previousSibling)){if(db.nodeType===1){return false}}if(c9==="first"){return true}db=da;case"last":while((db=db.nextSibling)){if(db.nodeType===1){return false}}return true}}},PSEUDO:function(c9,c7){var e,c8=cr.pseudos[c9]||cr.setFilters[c9.toLowerCase()]||cX.error("unsupported pseudo: "+c9);if(c8[cq]){return c8(c7)}if(c8.length>1){e=[c9,c9,"",c7];return cr.setFilters.hasOwnProperty(c9.toLowerCase())?cx(function(de,dd){var db,dc=c8(de,c7),da=dc.length;while(da--){db=cv.call(de,dc[da]);de[db]=!(dd[db]=dc[da])}}):function(da){return c8(da,0,e)}}return c8}},pseudos:{not:cx(function(c9){var e=[],c8=[],c7=cc(c9.replace(cS,"$1"));return c7[cq]?cx(function(de,dd,da,dg){var db,df=c7(de,null,dg,[]),dc=de.length;while(dc--){if((db=df[dc])){de[dc]=!(dd[dc]=db)}}}):function(db,da,dc){e[0]=db;c7(e,null,dc,c8);return !c8.pop()}}),has:cx(function(e){return function(c7){return cX(e,c7).length>0}}),contains:cx(function(e){return function(c7){return(c7.textContent||c7.innerText||cs(c7)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===false},disabled:function(e){return e.disabled===true},checked:function(e){var c7=e.nodeName.toLowerCase();return(c7==="input"&&!!e.checked)||(c7==="option"&&!!e.selected)},selected:function(e){if(e.parentNode){e.parentNode.selectedIndex}return e.selected===true},parent:function(e){return !cr.pseudos.empty(e)},empty:function(e){var c7;e=e.firstChild;while(e){if(e.nodeName>"@"||(c7=e.nodeType)===3||c7===4){return false}e=e.nextSibling}return true},header:function(e){return cM.test(e.nodeName)},text:function(c7){var c8,e;return c7.nodeName.toLowerCase()==="input"&&(c8=c7.type)==="text"&&((e=c7.getAttribute("type"))==null||e.toLowerCase()===c8)},radio:ci("radio"),checkbox:ci("checkbox"),file:ci("file"),password:ci("password"),image:ci("image"),submit:cg("submit"),reset:cg("reset"),button:function(e){var c7=e.nodeName.toLowerCase();return c7==="input"&&e.type==="button"||c7==="button"},input:function(e){return cN.test(e.nodeName)},focus:function(c7){var e=c7.ownerDocument;return c7===e.activeElement&&(!e.hasFocus||e.hasFocus())&&!!(c7.type||c7.href)},active:function(e){return e===e.ownerDocument.activeElement},first:cj(function(c8,c7,e){return[0]}),last:cj(function(c8,c7,e){return[c7-1]}),eq:cj(function(c8,c7,e){return[e<0?e+c7:e]}),even:cj(function(c9,c8,e){for(var c7=0;c7<c8;c7+=2){c9.push(c7)}return c9}),odd:cj(function(c9,c8,e){for(var c7=1;c7<c8;c7+=2){c9.push(c7)}return c9}),lt:cj(function(c9,c8,e){for(var c7=e<0?e+c8:e;--c7>=0;){c9.push(c7)}return c9}),gt:cj(function(c9,c8,e){for(var c7=e<0?e+c8:e;++c7<c8;){c9.push(c7)}return c9})}};function cW(e,c7,c9){if(e===c7){return c9}var c8=e.nextSibling;while(c8){if(c8===c7){return -1}c8=c8.nextSibling}return 1}cZ=cl.compareDocumentPosition?function(e,c7){if(e===c7){ct=true;return 0}return(!e.compareDocumentPosition||!c7.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(c7)&4)?-1:1}:function(e,da){if(e===da){ct=true;return 0}else{if(e.sourceIndex&&da.sourceIndex){return e.sourceIndex-da.sourceIndex}}var c7,db,c8=[],dc=[],c9=e.parentNode,dd=da.parentNode,de=c9;if(c9===dd){return cW(e,da)}else{if(!c9){return -1}else{if(!dd){return 1}}}while(de){c8.unshift(de);de=de.parentNode}de=dd;while(de){dc.unshift(de);de=de.parentNode}c7=c8.length;db=dc.length;for(var df=0;df<c7&&df<db;df++){if(c8[df]!==dc[df]){return cW(c8[df],dc[df])}}return df===c7?cW(e,dc[df],-1):cW(c8[df],da,1)};[0,0].sort(cZ);b8=!ct;cX.uniqueSort=function(c8){var e,c7=1;ct=b8;c8.sort(cZ);if(ct){for(;(e=c8[c7]);c7++){if(e===c8[c7-1]){c8.splice(c7--,1)}}}return c8};cX.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};function c3(dc,da){var c9,c8,de,df,dd,c7,db,e=c2[cq][dc];if(e){return da?0:e.slice(0)}dd=dc;c7=[];db=cr.preFilter;while(dd){if(!c9||(c8=cK.exec(dd))){if(c8){dd=dd.slice(c8[0].length)}c7.push(de=[])}c9=false;if((c8=cJ.exec(dd))){de.push(c9=new c1(c8.shift()));dd=dd.slice(c9.length);c9.type=c8[0].replace(cS," ")}for(df in cr.filter){if((c8=cA[df].exec(dd))&&(!db[df]||(c8=db[df](c8,cm,true)))){de.push(c9=new c1(c8.shift()));dd=dd.slice(c9.length);c9.type=df;c9.matches=c8}}if(!c9){break}}return da?dd.length:dd?cX.error(dc):c2(dc,c7).slice(0)}function bZ(db,c8,e){var c9=c8.dir,c7=e&&c8.dir==="parentNode",da=cn++;return c8.first?function(dd,dc,de){while((dd=dd[c9])){if(c7||dd.nodeType===1){return db(dd,dc,de)}}}:function(dg,de,dh){if(!dh){var dc,df=ck+" "+da+" ",dd=df+b9;while((dg=dg[c9])){if(c7||dg.nodeType===1){if((dc=dg[cq])===dd){return dg.sizset}else{if(typeof dc==="string"&&dc.indexOf(df)===0){if(dg.sizset){return dg}}else{dg[cq]=dd;if(db(dg,de,dh)){dg.sizset=true;return dg}dg.sizset=false}}}}}else{while((dg=dg[c9])){if(c7||dg.nodeType===1){if(db(dg,de,dh)){return dg}}}}}}function cp(e){return e.length>1?function(c8,c7,da){var c9=e.length;while(c9--){if(!e[c9](c8,c7,da)){return false}}return true}:e[0]}function ce(de,db,c8,e,df){var c7,dd=[],c9=0,da=de.length,dc=db!=null;for(;c9<da;c9++){if((c7=de[c9])){if(!c8||c8(c7,e,df)){dd.push(c7);if(dc){db.push(c9)}}}}return dd}function cV(da,db,e,c7,c8,c9){if(c7&&!c7[cq]){c7=cV(c7)}if(c8&&!c8[cq]){c8=cV(c8,c9)}return cx(function(dn,dm,dc,dp){if(dn&&c8){return}var df,dd,di,dl=[],dj=[],dk=dm.length,de=dn||cB(db||"*",dc.nodeType?[dc]:dc,[],dn),dg=da&&(dn||!db)?ce(de,dl,da,dc,dp):de,dh=e?c8||(dn?da:dk||c7)?[]:dm:dg;if(e){e(dg,dh,dc,dp)}if(c7){di=ce(dh,dj);c7(di,[],dc,dp);df=di.length;while(df--){if((dd=di[df])){dh[dj[df]]=!(dg[dj[df]]=dd)}}}if(dn){df=da&&dh.length;while(df--){if((dd=dh[df])){dn[dl[df]]=!(dm[dl[df]]=dd)}}}else{dh=ce(dh===dm?dh.splice(dk,dh.length):dh);if(c8){c8(null,dm,dh,dp)}else{cH.apply(dm,dh)}}})}function cz(dg){var e,de,c9,db=dg.length,da=cr.relative[dg[0].type],c8=da||cr.relative[" "],c7=da?1:0,dd=bZ(function(dh){return dh===e},c8,true),dc=bZ(function(dh){return cv.call(e,dh)>-1},c8,true),df=[function(di,dh,dj){return(!da&&(dj||dh!==cD))||((e=dh).nodeType?dd(di,dh,dj):dc(di,dh,dj))}];for(;c7<db;c7++){if((de=cr.relative[dg[c7].type])){df=[bZ(cp(df),de)]}else{de=cr.filter[dg[c7].type].apply(null,dg[c7].matches);if(de[cq]){c9=++c7;for(;c9<db;c9++){if(cr.relative[dg[c9].type]){break}}return cV(c7>1&&cp(df),c7>1&&dg.slice(0,c7-1).join("").replace(cS,"$1"),de,c7<c9&&cz(dg.slice(c7,c9)),c9<db&&cz((dg=dg.slice(c9))),c9<db&&dg.join(""))}df.push(de)}}return cp(df)}function cy(c8,c9){var c7=c9.length>0,e=c8.length>0,da=function(dn,db,dr,dm,dg){var de,di,dk,dp=[],dj=0,dh="0",dq=dn&&[],dl=dg!=null,dc=cD,df=dn||e&&cr.find.TAG("*",dg&&db.parentNode||db),dd=(ck+=dc==null?1:Math.E);if(dl){cD=db!==cm&&db;b9=da.el}for(;(de=df[dh])!=null;dh++){if(e&&de){for(di=0;(dk=c8[di]);di++){if(dk(de,db,dr)){dm.push(de);break}}if(dl){ck=dd;b9=++da.el}}if(c7){if((de=!dk&&de)){dj--}if(dn){dq.push(de)}}}dj+=dh;if(c7&&dh!==dj){for(di=0;(dk=c9[di]);di++){dk(dq,dp,db,dr)}if(dn){if(dj>0){while(dh--){if(!(dq[dh]||dp[dh])){dp[dh]=cE.call(dm)}}}dp=ce(dp)}cH.apply(dm,dp);if(dl&&!dn&&dp.length>0&&(dj+c9.length)>1){cX.uniqueSort(dm)}}if(dl){ck=dd;cD=dc}return dq};da.el=0;return c7?cx(da):da}cc=cX.compile=function(da,c8){var c9,db=[],c7=[],e=cd[cq][da];if(!e){if(!c8){c8=c3(da)}c9=c8.length;while(c9--){e=cz(c8[c9]);if(e[cq]){db.push(e)}else{c7.push(e)}}e=cd(da,cy(c7,db))}return e};function cB(db,e,c9,da){var c7=0,c8=e.length;for(;c7<c8;c7++){cX(db,e[c7],c9,da)}return c9}function cT(dd,e,db,dc,dh){var c8,df,de,dg,c7,da=c3(dd),c9=da.length;if(!dc){if(da.length===1){df=da[0]=da[0].slice(0);if(df.length>2&&(de=df[0]).type==="ID"&&e.nodeType===9&&!dh&&cr.relative[df[1].type]){e=cr.find.ID(de.matches[0].replace(cI,""),e,dh)[0];if(!e){return db}dd=dd.slice(df.shift().length)}for(c8=cA.POS.test(dd)?-1:df.length-1;c8>=0;c8--){de=df[c8];if(cr.relative[(dg=de.type)]){break}if((c7=cr.find[dg])){if((dc=c7(de.matches[0].replace(cI,""),cR.test(df[0].type)&&e.parentNode||e,dh))){df.splice(c8,1);dd=dc.length&&df.join("");if(!dd){cH.apply(db,cY.call(dc,0));return db}break}}}}}cc(dd,da)(dc,e,dh,db,cR.test(dd));return db}if(cm.querySelectorAll){(function(){var e,c8=cT,dc=/'|\\/g,c9=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,db=[":focus"],da=[":active",":focus"],c7=cl.matchesSelector||cl.mozMatchesSelector||cl.webkitMatchesSelector||cl.oMatchesSelector||cl.msMatchesSelector;b0(function(dd){dd.innerHTML="<select><option selected=''></option></select>";if(!dd.querySelectorAll("[selected]").length){db.push("\\["+c5+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")}if(!dd.querySelectorAll(":checked").length){db.push(":checked")}});b0(function(dd){dd.innerHTML="<p test=''></p>";if(dd.querySelectorAll("[test^='']").length){db.push("[*^$]="+c5+"*(?:\"\"|'')")}dd.innerHTML="<input type='hidden'/>";if(!dd.querySelectorAll(":enabled").length){db.push(":enabled",":disabled")}});db=new RegExp(db.join("|"));cT=function(dn,dd,dl,dm,dp){if(!dm&&!dp&&(!db||!db.test(dn))){var de,df,dj=true,di=cq,dg=dd,dh=dd.nodeType===9&&dn;if(dd.nodeType===1&&dd.nodeName.toLowerCase()!=="object"){de=c3(dn);if((dj=dd.getAttribute("id"))){di=dj.replace(dc,"\\$&")}else{dd.setAttribute("id",di)}di="[id='"+di+"'] ";df=de.length;while(df--){de[df]=di+de[df].join("")}dg=cR.test(dn)&&dd.parentNode||dd;dh=de.join(",")}if(dh){try{cH.apply(dl,cY.call(dg.querySelectorAll(dh),0));return dl}catch(dk){}finally{if(!dj){dd.removeAttribute("id")}}}}return c8(dn,dd,dl,dm,dp)};if(c7){b0(function(dd){e=c7.call(dd,"div");try{c7.call(dd,"[test!='']:sizzle");da.push("!=",cG)}catch(de){}});da=new RegExp(da.join("|"));cX.matchesSelector=function(de,df){df=df.replace(c9,"='$1']");if(!cw(de)&&!da.test(df)&&(!db||!db.test(df))){try{var dg=c7.call(de,df);if(dg||e||de.document&&de.document.nodeType!==11){return dg}}catch(dd){}}return cX(df,null,null,[de]).length>0}}})()}cr.pseudos.nth=cr.pseudos.eq;function cU(){}cr.filters=cU.prototype=cr.pseudos;cr.setFilters=new cU();cX.attr=ap.attr;ap.find=cX;ap.expr=cX.selectors;ap.expr[":"]=ap.expr.pseudos;ap.unique=cX.uniqueSort;ap.text=cX.getText;ap.isXMLDoc=cX.isXML;ap.contains=cX.contains})(bT);var bC=/Until$/,bi=/^(?:parents|prev(?:Until|All))/,ao=/^.[^:#\[\.,]*$/,a9=ap.expr.match.needsContext,ag={children:true,contents:true,next:true,prev:true};ap.fn.extend({find:function(b4){var e,bZ,b0,b1,b2,b3,b5=this;if(typeof b4!=="string"){return ap(b4).filter(function(){for(e=0,bZ=b5.length;e<bZ;e++){if(ap.contains(b5[e],this)){return true}}})}b3=this.pushStack("","find",b4);for(e=0,bZ=this.length;e<bZ;e++){b0=b3.length;ap.find(b4,this[e],b3);if(e>0){for(b1=b0;b1<b3.length;b1++){for(b2=0;b2<b0;b2++){if(b3[b2]===b3[b1]){b3.splice(b1--,1);break}}}}}return b3},has:function(b0){var e,b1=ap(b0,this),bZ=b1.length;return this.filter(function(){for(e=0;e<bZ;e++){if(ap.contains(this,b1[e])){return true}}})},not:function(e){return this.pushStack(bU(this,e,false),"not",e)},filter:function(e){return this.pushStack(bU(this,e,true),"filter",e)},is:function(e){return !!e&&(typeof e==="string"?a9.test(e)?ap(e,this.context).index(this[0])>=0:ap.filter(e,this).length>0:this.filter(e).length>0)},closest:function(b4,e){var bZ,b0=0,b1=this.length,b3=[],b2=a9.test(b4)||typeof b4!=="string"?ap(b4,e||this.context):0;for(;b0<b1;b0++){bZ=this[b0];while(bZ&&bZ.ownerDocument&&bZ!==e&&bZ.nodeType!==11){if(b2?b2.index(bZ)>-1:ap.find.matchesSelector(bZ,b4)){b3.push(bZ);break}bZ=bZ.parentNode}}b3=b3.length>1?ap.unique(b3):b3;return this.pushStack(b3,"closest",b4)},index:function(e){if(!e){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1}if(typeof e==="string"){return ap.inArray(this[0],ap(e))}return ap.inArray(e.jquery?e[0]:e,this)},add:function(b0,bZ){var b1=typeof b0==="string"?ap(b0,bZ):ap.makeArray(b0&&b0.nodeType?[b0]:b0),e=ap.merge(this.get(),b1);return this.pushStack(al(b1[0])||al(e[0])?e:ap.unique(e))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}});ap.fn.andSelf=ap.fn.addBack;function al(e){return !e||!e.parentNode||e.parentNode.nodeType===11}function bM(e,bZ){do{e=e[bZ]}while(e&&e.nodeType!==1);return e}ap.each({parent:function(e){var bZ=e.parentNode;return bZ&&bZ.nodeType!==11?bZ:null},parents:function(e){return ap.dir(e,"parentNode")},parentsUntil:function(e,bZ,b0){return ap.dir(e,"parentNode",b0)},next:function(e){return bM(e,"nextSibling")},prev:function(e){return bM(e,"previousSibling")},nextAll:function(e){return ap.dir(e,"nextSibling")},prevAll:function(e){return ap.dir(e,"previousSibling")},nextUntil:function(e,bZ,b0){return ap.dir(e,"nextSibling",b0)},prevUntil:function(e,bZ,b0){return ap.dir(e,"previousSibling",b0)},siblings:function(e){return ap.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ap.sibling(e.firstChild)},contents:function(e){return ap.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ap.merge([],e.childNodes)}},function(bZ,e){ap.fn[bZ]=function(b2,b1){var b0=ap.map(this,e,b2);if(!bC.test(bZ)){b1=b2}if(b1&&typeof b1==="string"){b0=ap.filter(b1,b0)}b0=this.length>1&&!ag[bZ]?ap.unique(b0):b0;if(this.length>1&&bi.test(bZ)){b0=b0.reverse()}return this.pushStack(b0,bZ,z.call(arguments).join(","))}});ap.extend({filter:function(bZ,e,b0){if(b0){bZ=":not("+bZ+")"}return e.length===1?ap.find.matchesSelector(e[0],bZ)?[e[0]]:[]:ap.find.matches(bZ,e)},dir:function(b0,bZ,b2){var b1=[],e=b0[bZ];while(e&&e.nodeType!==9&&(b2===bR||e.nodeType!==1||!ap(e).is(b2))){if(e.nodeType===1){b1.push(e)}e=e[bZ]}return b1},sibling:function(bZ,e){var b0=[];for(;bZ;bZ=bZ.nextSibling){if(bZ.nodeType===1&&bZ!==e){b0.push(bZ)}}return b0}});function bU(e,b1,b0){b1=b1||0;if(ap.isFunction(b1)){return ap.grep(e,function(b2,b3){var b4=!!b1.call(b2,b3,b2);return b4===b0})}else{if(b1.nodeType){return ap.grep(e,function(b2,b3){return(b2===b1)===b0})}else{if(typeof b1==="string"){var bZ=ap.grep(e,function(b2){return b2.nodeType===1});if(ao.test(b1)){return ap.filter(b1,bZ,!b0)}else{b1=ap.filter(b1,bZ)}}}}return ap.grep(e,function(b2,b3){return(ap.inArray(b2,b1)>=0)===b0})}function F(e){var bZ=au.split("|"),b0=e.createDocumentFragment();if(b0.createElement){while(bZ.length){b0.createElement(bZ.pop())}}return b0}var au="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",aZ=/ jQuery\d+="(?:null|\d+)"/g,a3=/^\s+/,bI=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bw=/<([\w:]+)/,bx=/<tbody/i,aY=/<|&#?\w+;/,bc=/<(?:script|style|link)/i,ba=/<(?:script|object|embed|option|style)/i,bd=new RegExp("<(?:"+au+")[\\s/>]","i"),aF=/^(?:checkbox|radio)$/,aG=/checked\s*(?:[^=]|=\s*.checked.)/i,bt=/\/(java|ecma)script/i,aI=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,bV={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},bJ=F(Q),Z=bJ.appendChild(Q.createElement("div"));bV.optgroup=bV.option;bV.tbody=bV.tfoot=bV.colgroup=bV.caption=bV.thead;bV.th=bV.td;if(!ap.support.htmlSerialize){bV._default=[1,"X<div>","</div>"]}ap.fn.extend({text:function(e){return ap.access(this,function(bZ){return bZ===bR?ap.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Q).createTextNode(bZ))},null,e,arguments.length)},wrapAll:function(e){if(ap.isFunction(e)){return this.each(function(b0){ap(this).wrapAll(e.call(this,b0))})}if(this[0]){var bZ=ap(e,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){bZ.insertBefore(this[0])}bZ.map(function(){var b0=this;while(b0.firstChild&&b0.firstChild.nodeType===1){b0=b0.firstChild}return b0}).append(this)}return this},wrapInner:function(e){if(ap.isFunction(e)){return this.each(function(bZ){ap(this).wrapInner(e.call(this,bZ))})}return this.each(function(){var b0=ap(this),bZ=b0.contents();if(bZ.length){bZ.wrapAll(e)}else{b0.append(e)}})},wrap:function(e){var bZ=ap.isFunction(e);return this.each(function(b0){ap(this).wrapAll(bZ?e.call(this,b0):e)})},unwrap:function(){return this.parent().each(function(){if(!ap.nodeName(this,"body")){ap(this).replaceWith(this.childNodes)}}).end()},append:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.appendChild(e)}})},prepend:function(){return this.domManip(arguments,true,function(e){if(this.nodeType===1||this.nodeType===11){this.insertBefore(e,this.firstChild)}})},before:function(){if(!al(this[0])){return this.domManip(arguments,false,function(bZ){this.parentNode.insertBefore(bZ,this)})}if(arguments.length){var e=ap.clean(arguments);return this.pushStack(ap.merge(e,this),"before",this.selector)}},after:function(){if(!al(this[0])){return this.domManip(arguments,false,function(bZ){this.parentNode.insertBefore(bZ,this.nextSibling)})}if(arguments.length){var e=ap.clean(arguments);return this.pushStack(ap.merge(this,e),"after",this.selector)}},remove:function(b1,b0){var e,bZ=0;for(;(e=this[bZ])!=null;bZ++){if(!b1||ap.filter(b1,[e]).length){if(!b0&&e.nodeType===1){ap.cleanData(e.getElementsByTagName("*"));ap.cleanData([e])}if(e.parentNode){e.parentNode.removeChild(e)}}}return this},empty:function(){var e,bZ=0;for(;(e=this[bZ])!=null;bZ++){if(e.nodeType===1){ap.cleanData(e.getElementsByTagName("*"))}while(e.firstChild){e.removeChild(e.firstChild)}}return this},clone:function(e,bZ){e=e==null?false:e;bZ=bZ==null?e:bZ;return this.map(function(){return ap.clone(this,e,bZ)})},html:function(e){return ap.access(this,function(b3){var b0=this[0]||{},b1=0,b2=this.length;if(b3===bR){return b0.nodeType===1?b0.innerHTML.replace(aZ,""):bR}if(typeof b3==="string"&&!bc.test(b3)&&(ap.support.htmlSerialize||!bd.test(b3))&&(ap.support.leadingWhitespace||!a3.test(b3))&&!bV[(bw.exec(b3)||["",""])[1].toLowerCase()]){b3=b3.replace(bI,"<$1></$2>");try{for(;b1<b2;b1++){b0=this[b1]||{};if(b0.nodeType===1){ap.cleanData(b0.getElementsByTagName("*"));b0.innerHTML=b3}}b0=0}catch(bZ){}}if(b0){this.empty().append(b3)}},null,e,arguments.length)},replaceWith:function(e){if(!al(this[0])){if(ap.isFunction(e)){return this.each(function(bZ){var b1=ap(this),b0=b1.html();b1.replaceWith(e.call(this,bZ,b0))})}if(typeof e!=="string"){e=ap(e).detach()}return this.each(function(){var bZ=this.nextSibling,b0=this.parentNode;ap(this).remove();if(bZ){ap(bZ).before(e)}else{ap(b0).append(e)}})}return this.length?this.pushStack(ap(ap.isFunction(e)?e():e),"replaceWith",e):this},detach:function(e){return this.remove(e,true)},domManip:function(e,b7,bZ){e=[].concat.apply([],e);var b5,b0,b1,b3,b2=0,b8=e[0],b6=[],b4=this.length;if(!ap.support.checkClone&&b4>1&&typeof b8==="string"&&aG.test(b8)){return this.each(function(){ap(this).domManip(e,b7,bZ)})}if(ap.isFunction(b8)){return this.each(function(b9){var ca=ap(this);e[0]=b8.call(this,b9,b7?ca.html():bR);ca.domManip(e,b7,bZ)})}if(this[0]){b5=ap.buildFragment(e,this,b6);b1=b5.fragment;b0=b1.firstChild;if(b1.childNodes.length===1){b1=b0}if(b0){b7=b7&&ap.nodeName(b0,"tr");for(b3=b5.cacheable||b4-1;b2<b4;b2++){bZ.call(b7&&ap.nodeName(this[b2],"table")?W(this[b2],"tbody"):this[b2],b2===b3?b1:ap.clone(b1,true,true))}}b1=b0=null;if(b6.length){ap.each(b6,function(ca,b9){if(b9.src){if(ap.ajax){ap.ajax({url:b9.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})}else{ap.error("no ajax")}}else{ap.globalEval((b9.text||b9.textContent||b9.innerHTML||"").replace(aI,""))}if(b9.parentNode){b9.parentNode.removeChild(b9)}})}}return this}});function W(e,bZ){return e.getElementsByTagName(bZ)[0]||e.appendChild(e.ownerDocument.createElement(bZ))}function r(b4,bZ){if(bZ.nodeType!==1||!ap.hasData(b4)){return}var b5,b1,b2,b3=ap._data(b4),e=ap._data(bZ,b3),b0=b3.events;if(b0){delete e.handle;e.events={};for(b5 in b0){for(b1=0,b2=b0[b5].length;b1<b2;b1++){ap.event.add(bZ,b5,b0[b5][b1])}}}if(e.data){e.data=ap.extend({},e.data)}}function s(b0,e){var bZ;if(e.nodeType!==1){return}if(e.clearAttributes){e.clearAttributes()}if(e.mergeAttributes){e.mergeAttributes(b0)}bZ=e.nodeName.toLowerCase();if(bZ==="object"){if(e.parentNode){e.outerHTML=b0.outerHTML}if(ap.support.html5Clone&&(b0.innerHTML&&!ap.trim(e.innerHTML))){e.innerHTML=b0.innerHTML}}else{if(bZ==="input"&&aF.test(b0.type)){e.defaultChecked=e.checked=b0.checked;if(e.value!==b0.value){e.value=b0.value}}else{if(bZ==="option"){e.selected=b0.defaultSelected}else{if(bZ==="input"||bZ==="textarea"){e.defaultValue=b0.defaultValue}else{if(bZ==="script"&&e.text!==b0.text){e.text=b0.text}}}}}e.removeAttribute(ap.expando)}ap.buildFragment=function(e,b1,b4){var b3,bZ,b0,b2=e[0];b1=b1||Q;b1=!b1.nodeType&&b1[0]||b1;b1=b1.ownerDocument||b1;if(e.length===1&&typeof b2==="string"&&b2.length<512&&b1===Q&&b2.charAt(0)==="<"&&!ba.test(b2)&&(ap.support.checkClone||!aG.test(b2))&&(ap.support.html5Clone||!bd.test(b2))){bZ=true;b3=ap.fragments[b2];b0=b3!==bR}if(!b3){b3=b1.createDocumentFragment();ap.clean(e,b1,b3,b4);if(bZ){ap.fragments[b2]=b0&&b3}}return{fragment:b3,cacheable:bZ}};ap.fragments={};ap.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,bZ){ap.fn[e]=function(b6){var b0,b1=0,b5=[],b2=ap(b6),b3=b2.length,b4=this.length===1&&this[0].parentNode;if((b4==null||b4&&b4.nodeType===11&&b4.childNodes.length===1)&&b3===1){b2[bZ](this[0]);return this}else{for(;b1<b3;b1++){b0=(b1>0?this.clone(true):this).get();ap(b2[b1])[bZ](b0);b5=b5.concat(b0)}return this.pushStack(b5,e,b2.selector)}}});function ac(e){if(typeof e.getElementsByTagName!=="undefined"){return e.getElementsByTagName("*")}else{if(typeof e.querySelectorAll!=="undefined"){return e.querySelectorAll("*")}else{return[]}}}function X(e){if(aF.test(e.type)){e.defaultChecked=e.checked}}ap.extend({clone:function(b2,bZ,b0){var b4,b1,b3,e;if(ap.support.html5Clone||ap.isXMLDoc(b2)||!bd.test("<"+b2.nodeName+">")){e=b2.cloneNode(true)}else{Z.innerHTML=b2.outerHTML;Z.removeChild(e=Z.firstChild)}if((!ap.support.noCloneEvent||!ap.support.noCloneChecked)&&(b2.nodeType===1||b2.nodeType===11)&&!ap.isXMLDoc(b2)){s(b2,e);b4=ac(b2);b1=ac(e);for(b3=0;b4[b3];++b3){if(b1[b3]){s(b4[b3],b1[b3])}}}if(bZ){r(b2,e);if(b0){b4=ac(b2);b1=ac(e);for(b3=0;b4[b3];++b3){r(b4[b3],b1[b3])}}}b4=b1=null;return e},clean:function(b2,e,b3,cc){var b6,b7,b1,cd,cf,bZ,b0,b5,ce,b9,b4,b8,cb=e===Q&&bJ,ca=[];if(!e||typeof e.createDocumentFragment==="undefined"){e=Q}for(b6=0;(b1=b2[b6])!=null;b6++){if(typeof b1==="number"){b1+=""}if(!b1){continue}if(typeof b1==="string"){if(!aY.test(b1)){b1=e.createTextNode(b1)}else{cb=cb||F(e);b0=e.createElement("div");cb.appendChild(b0);b1=b1.replace(bI,"<$1></$2>");cd=(bw.exec(b1)||["",""])[1].toLowerCase();cf=bV[cd]||bV._default;bZ=cf[0];b0.innerHTML=cf[1]+b1+cf[2];while(bZ--){b0=b0.lastChild}if(!ap.support.tbody){b5=bx.test(b1);ce=cd==="table"&&!b5?b0.firstChild&&b0.firstChild.childNodes:cf[1]==="<table>"&&!b5?b0.childNodes:[];for(b7=ce.length-1;b7>=0;--b7){if(ap.nodeName(ce[b7],"tbody")&&!ce[b7].childNodes.length){ce[b7].parentNode.removeChild(ce[b7])}}}if(!ap.support.leadingWhitespace&&a3.test(b1)){b0.insertBefore(e.createTextNode(a3.exec(b1)[0]),b0.firstChild)}b1=b0.childNodes;b0.parentNode.removeChild(b0)}}if(b1.nodeType){ca.push(b1)}else{ap.merge(ca,b1)}}if(b0){b1=b0=cb=null}if(!ap.support.appendChecked){for(b6=0;(b1=ca[b6])!=null;b6++){if(ap.nodeName(b1,"input")){X(b1)}else{if(typeof b1.getElementsByTagName!=="undefined"){ap.grep(b1.getElementsByTagName("input"),X)}}}}if(b3){b4=function(cg){if(!cg.type||bt.test(cg.type)){return cc?cc.push(cg.parentNode?cg.parentNode.removeChild(cg):cg):b3.appendChild(cg)}};for(b6=0;(b1=ca[b6])!=null;b6++){if(!(ap.nodeName(b1,"script")&&b4(b1))){b3.appendChild(b1);if(typeof b1.getElementsByTagName!=="undefined"){b8=ap.grep(ap.merge([],b1.getElementsByTagName("script")),b4);ca.splice.apply(ca,[b6+1,0].concat(b8));b6+=b8.length}}}}return ca},cleanData:function(b3,e){var b0,b5,b2,b8,b4=0,b6=ap.expando,bZ=ap.cache,b1=ap.support.deleteExpando,b7=ap.event.special;for(;(b2=b3[b4])!=null;b4++){if(e||ap.acceptData(b2)){b5=b2[b6];b0=b5&&bZ[b5];if(b0){if(b0.events){for(b8 in b0.events){if(b7[b8]){ap.event.remove(b2,b8)}else{ap.removeEvent(b2,b8,b0.handle)}}}if(bZ[b5]){delete bZ[b5];if(b1){delete b2[b6]}else{if(b2.removeAttribute){b2.removeAttribute(b6)}else{b2[b6]=null}}ap.deletedIds.push(b5)}}}}}});(function(){var bZ,e;ap.uaMatch=function(b1){b1=b1.toLowerCase();var b0=/(chrome)[ \/]([\w.]+)/.exec(b1)||/(webkit)[ \/]([\w.]+)/.exec(b1)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b1)||/(msie) ([\w.]+)/.exec(b1)||b1.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b1)||[];return{browser:b0[1]||"",version:b0[2]||"0"}};bZ=ap.uaMatch(ar.userAgent);e={};if(bZ.browser){e[bZ.browser]=true;e.version=bZ.version}if(e.chrome){e.webkit=true}else{if(e.webkit){e.safari=true}}ap.browser=e;ap.sub=function(){function b1(b4,b3){return new b1.fn.init(b4,b3)}ap.extend(true,b1,this);b1.superclass=this;b1.fn=b1.prototype=this();b1.fn.constructor=b1;b1.sub=this.sub;b1.fn.init=function b0(b4,b3){if(b3&&b3 instanceof ap&&!(b3 instanceof b1)){b3=b1(b3)}return ap.fn.init.call(this,b4,b3,b2)};b1.fn.init.prototype=b1.fn;var b2=b1(Q);return b1}})();var N,ai,aj,aB=/alpha\([^)]*\)/i,bh=/opacity=([^)]*)/,bj=/^(top|right|bottom|left)$/,aM=/^(none|table(?!-c[ea]).+)/,a5=/^margin/,bf=new RegExp("^("+v+")(.*)$","i"),be=new RegExp("^("+v+")(?!px)[a-z%]+$","i"),bo=new RegExp("^([-+])=("+v+")","i"),T={},M={position:"absolute",visibility:"hidden",display:"block"},K={letterSpacing:0,fontWeight:400},J=["Top","Right","Bottom","Left"],L=["Webkit","O","Moz","ms"],U=ap.fn.toggle;function bS(b2,b0){if(b0 in b2){return b0}var e=b0.charAt(0).toUpperCase()+b0.slice(1),b1=b0,bZ=L.length;while(bZ--){b0=L[bZ]+e;if(b0 in b2){return b0}}return b1}function an(bZ,e){bZ=e||bZ;return ap.css(bZ,"display")==="none"||!ap.contains(bZ.ownerDocument,bZ)}function bL(b0,b3){var bZ,e,b4=[],b1=0,b2=b0.length;for(;b1<b2;b1++){bZ=b0[b1];if(!bZ.style){continue}b4[b1]=ap._data(bZ,"olddisplay");if(b3){if(!b4[b1]&&bZ.style.display==="none"){bZ.style.display=""}if(bZ.style.display===""&&an(bZ)){b4[b1]=ap._data(bZ,"olddisplay",I(bZ.nodeName))}}else{e=N(bZ,"display");if(!b4[b1]&&e!=="none"){ap._data(bZ,"olddisplay",e)}}}for(b1=0;b1<b2;b1++){bZ=b0[b1];if(!bZ.style){continue}if(!b3||bZ.style.display==="none"||bZ.style.display===""){bZ.style.display=b3?b4[b1]||"":"none"}}return b0}ap.fn.extend({css:function(e,bZ){return ap.access(this,function(b0,b1,b2){return b2!==bR?ap.style(b0,b1,b2):ap.css(b0,b1)},e,bZ,arguments.length>1)},show:function(){return bL(this,true)},hide:function(){return bL(this)},toggle:function(b0,bZ){var e=typeof b0==="boolean";if(ap.isFunction(b0)&&ap.isFunction(bZ)){return U.apply(this,arguments)}return this.each(function(){if(e?b0:an(this)){ap(this).show()}else{ap(this).hide()}})}});ap.extend({cssHooks:{opacity:{get:function(bZ,e){if(e){var b0=N(bZ,"opacity");return b0===""?"1":b0}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":ap.support.cssFloat?"cssFloat":"styleFloat"},style:function(b0,b3,b8,b1){if(!b0||b0.nodeType===3||b0.nodeType===8||!b0.style){return}var b5,b7,b2,b4=ap.camelCase(b3),b6=b0.style;b3=ap.cssProps[b4]||(ap.cssProps[b4]=bS(b6,b4));b2=ap.cssHooks[b3]||ap.cssHooks[b4];if(b8!==bR){b7=typeof b8;if(b7==="string"&&(b5=bo.exec(b8))){b8=(b5[1]+1)*b5[2]+parseFloat(ap.css(b0,b3));b7="number"}if(b8==null||b7==="number"&&isNaN(b8)){return}if(b7==="number"&&!ap.cssNumber[b4]){b8+="px"}if(!b2||!("set" in b2)||(b8=b2.set(b0,b8,b1))!==bR){try{b6[b3]=b8}catch(bZ){}}}else{if(b2&&"get" in b2&&(b5=b2.get(b0,false,b1))!==bR){return b5}return b6[b3]}},css:function(e,b1,b3,bZ){var b5,b2,b0,b4=ap.camelCase(b1);b1=ap.cssProps[b4]||(ap.cssProps[b4]=bS(e.style,b4));b0=ap.cssHooks[b1]||ap.cssHooks[b4];if(b0&&"get" in b0){b5=b0.get(e,true,bZ)}if(b5===bR){b5=N(e,b1)}if(b5==="normal"&&b1 in K){b5=K[b1]}if(b3||bZ!==bR){b2=parseFloat(b5);return b3||ap.isNumeric(b2)?b2||0:b5}return b5},swap:function(bZ,b2,e){var b3,b0,b1={};for(b0 in b2){b1[b0]=bZ.style[b0];bZ.style[b0]=b2[b0]}b3=e.call(bZ);for(b0 in b2){bZ.style[b0]=b1[b0]}return b3}});if(bT.getComputedStyle){N=function(bZ,b2){var b3,b5,b1,b0,e=bT.getComputedStyle(bZ,null),b4=bZ.style;if(e){b3=e[b2];if(b3===""&&!ap.contains(bZ.ownerDocument,bZ)){b3=ap.style(bZ,b2)}if(be.test(b3)&&a5.test(b2)){b5=b4.width;b1=b4.minWidth;b0=b4.maxWidth;b4.minWidth=b4.maxWidth=b4.width=b3;b3=e.width;b4.width=b5;b4.minWidth=b1;b4.maxWidth=b0}}return b3}}else{if(Q.documentElement.currentStyle){N=function(e,b0){var bZ,b2,b1=e.currentStyle&&e.currentStyle[b0],b3=e.style;if(b1==null&&b3&&b3[b0]){b1=b3[b0]}if(be.test(b1)&&!bj.test(b0)){bZ=b3.left;b2=e.runtimeStyle&&e.runtimeStyle.left;if(b2){e.runtimeStyle.left=e.currentStyle.left}b3.left=b0==="fontSize"?"1em":b1;b1=b3.pixelLeft+"px";b3.left=bZ;if(b2){e.runtimeStyle.left=b2}}return b1===""?"auto":b1}}}function bK(e,b1,b0){var bZ=bf.exec(b1);return bZ?Math.max(0,bZ[1]-(b0||0))+(bZ[2]||"px"):b1}function n(e,b2,bZ,b1){var b0=bZ===(b1?"border":"content")?4:b2==="width"?1:0,b3=0;for(;b0<4;b0+=2){if(bZ==="margin"){b3+=ap.css(e,bZ+J[b0],true)}if(b1){if(bZ==="content"){b3-=parseFloat(N(e,"padding"+J[b0]))||0}if(bZ!=="margin"){b3-=parseFloat(N(e,"border"+J[b0]+"Width"))||0}}else{b3+=parseFloat(N(e,"padding"+J[b0]))||0;if(bZ!=="padding"){b3+=parseFloat(N(e,"border"+J[b0]+"Width"))||0}}}return b3}function ae(e,b1,bZ){var b2=b1==="width"?e.offsetWidth:e.offsetHeight,b3=true,b0=ap.support.boxSizing&&ap.css(e,"boxSizing")==="border-box";if(b2<=0||b2==null){b2=N(e,b1);if(b2<0||b2==null){b2=e.style[b1]}if(be.test(b2)){return b2}b3=b0&&(ap.support.boxSizingReliable||b2===e.style[b1]);b2=parseFloat(b2)||0}return(b2+n(e,b1,bZ||(b0?"border":"content"),b3))+"px"}function I(b0){if(T[b0]){return T[b0]}var bZ=ap("<"+b0+">").appendTo(Q.body),e=bZ.css("display");bZ.remove();if(e==="none"||e===""){ai=Q.body.appendChild(ai||ap.extend(Q.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!aj||!ai.createElement){aj=(ai.contentWindow||ai.contentDocument).document;aj.write("<!doctype html><html><body>");aj.close()}bZ=aj.body.appendChild(aj.createElement(b0));e=N(bZ,"display");Q.body.removeChild(ai)}T[b0]=e;return e}ap.each(["height","width"],function(e,bZ){ap.cssHooks[bZ]={get:function(b1,b0,b2){if(b0){if(b1.offsetWidth===0&&aM.test(N(b1,"display"))){return ap.swap(b1,M,function(){return ae(b1,bZ,b2)})}else{return ae(b1,bZ,b2)}}},set:function(b0,b2,b1){return bK(b0,b2,b1?n(b0,bZ,b1,ap.support.boxSizing&&ap.css(b0,"boxSizing")==="border-box"):0)}}});if(!ap.support.opacity){ap.cssHooks.opacity={get:function(bZ,e){return bh.test((e&&bZ.currentStyle?bZ.currentStyle.filter:bZ.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":e?"1":""},set:function(bZ,b3){var b2=bZ.style,e=bZ.currentStyle,b1=ap.isNumeric(b3)?"alpha(opacity="+b3*100+")":"",b0=e&&e.filter||b2.filter||"";b2.zoom=1;if(b3>=1&&ap.trim(b0.replace(aB,""))===""&&b2.removeAttribute){b2.removeAttribute("filter");if(e&&!e.filter){return}}b2.filter=aB.test(b0)?b0.replace(aB,b1):b0+" "+b1}}}ap(function(){if(!ap.support.reliableMarginRight){ap.cssHooks.marginRight={get:function(bZ,e){return ap.swap(bZ,{display:"inline-block"},function(){if(e){return N(bZ,"marginRight")}})}}}if(!ap.support.pixelPosition&&ap.fn.position){ap.each(["top","left"],function(e,bZ){ap.cssHooks[bZ]={get:function(b1,b0){if(b0){var b2=N(b1,bZ);return be.test(b2)?ap(b1).position()[bZ]+"px":b2}}}})}});if(ap.expr&&ap.expr.filters){ap.expr.filters.hidden=function(e){return(e.offsetWidth===0&&e.offsetHeight===0)||(!ap.support.reliableHiddenOffsets&&((e.style&&e.style.display)||N(e,"display"))==="none")};ap.expr.filters.visible=function(e){return !ap.expr.filters.hidden(e)}}ap.each({margin:"",padding:"",border:"Width"},function(e,bZ){ap.cssHooks[e+bZ]={expand:function(b3){var b1,b2=typeof b3==="string"?b3.split(" "):[b3],b0={};for(b1=0;b1<4;b1++){b0[e+J[b1]+bZ]=b2[b1]||b2[b1-2]||b2[0]}return b0}};if(!a5.test(e)){ap.cssHooks[e+bZ].set=bK}});var aA=/%20/g,aE=/\[\]$/,aK=/\r?\n/g,a0=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bu=/^(?:select|textarea)/i;ap.fn.extend({serialize:function(){return ap.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?ap.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bu.test(this.nodeName)||a0.test(this.type))}).map(function(bZ,e){var b0=ap(this).val();return b0==null?null:ap.isArray(b0)?ap.map(b0,function(b2,b1){return{name:e.name,value:b2.replace(aK,"\r\n")}}):{name:e.name,value:b0.replace(aK,"\r\n")}}).get()}});ap.param=function(e,b2){var b0,b1=[],bZ=function(b3,b4){b4=ap.isFunction(b4)?b4():(b4==null?"":b4);b1[b1.length]=encodeURIComponent(b3)+"="+encodeURIComponent(b4)};if(b2===bR){b2=ap.ajaxSettings&&ap.ajaxSettings.traditional}if(ap.isArray(e)||(e.jquery&&!ap.isPlainObject(e))){ap.each(e,function(){bZ(this.name,this.value)})}else{for(b0 in e){p(b0,e[b0],b2,bZ)}}return b1.join("&").replace(aA,"+")};function p(b1,b0,b2,e){var bZ;if(ap.isArray(b0)){ap.each(b0,function(b3,b4){if(b2||aE.test(b1)){e(b1,b4)}else{p(b1+"["+(typeof b4==="object"?b3:"")+"]",b4,b2,e)}})}else{if(!b2&&ap.type(b0)==="object"){for(bZ in b0){p(b1+"["+bZ+"]",b0[bZ],b2,e)}}else{e(b1,b0)}}}var j,i,aV=/#.*$/,aW=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,a4=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bb=/^(?:GET|HEAD)$/,bk=/^\/\//,bl=/\?/,bs=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bz=/([?&])_=[^&]*/,bD=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,c=ap.fn.load,ay={},bO={},k=["*/"]+["*"];try{i=aq.href}catch(S){i=Q.createElement("a");i.href="";i=i.href}j=bD.exec(i.toLowerCase())||[];function d(e){return function(b0,b2){if(typeof b0!=="string"){b2=b0;b0="*"}var bZ,b5,b6,b1=b0.toLowerCase().split(y),b3=0,b4=b1.length;if(ap.isFunction(b2)){for(;b3<b4;b3++){bZ=b1[b3];b6=/^\+/.test(bZ);if(b6){bZ=bZ.substr(1)||"*"}b5=e[bZ]=e[bZ]||[];b5[b6?"unshift":"push"](b2)}}}}function ak(b8,b5,b6,b2,e,b1){e=e||b5.dataTypes[0];b1=b1||{};b1[e]=true;var b7,b4=b8[e],b0=0,b3=b4?b4.length:0,bZ=(b8===ay);for(;b0<b3&&(bZ||!b7);b0++){b7=b4[b0](b5,b6,b2);if(typeof b7==="string"){if(!bZ||b1[b7]){b7=bR}else{b5.dataTypes.unshift(b7);b7=ak(b8,b5,b6,b2,b7,b1)}}}if((bZ||!b7)&&!b1["*"]){b7=ak(b8,b5,b6,b2,"*",b1)}return b7}function g(b2,b1){var b0,e,bZ=ap.ajaxSettings.flatOptions||{};for(b0 in b1){if(b1[b0]!==bR){(bZ[b0]?b2:(e||(e={})))[b0]=b1[b0]}}if(e){ap.extend(true,b2,e)}}ap.fn.load=function(b5,b0,e){if(typeof b5!=="string"&&c){return c.apply(this,arguments)}if(!this.length){return this}var b2,b4,b1,b3=this,bZ=b5.indexOf(" ");if(bZ>=0){b2=b5.slice(bZ,b5.length);b5=b5.slice(0,bZ)}if(ap.isFunction(b0)){e=b0;b0=bR}else{if(b0&&typeof b0==="object"){b4="POST"}}ap.ajax({url:b5,type:b4,dataType:"html",data:b0,complete:function(b6,b7){if(e){b3.each(e,b1||[b6.responseText,b7,b6])}}}).done(function(b6){b1=arguments;b3.html(b2?ap("<div>").append(b6.replace(bs,"")).find(b2):b6)});return this};ap.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,bZ){ap.fn[bZ]=function(b0){return this.on(bZ,b0)}});ap.each(["get","post"],function(e,bZ){ap[bZ]=function(b3,b1,b0,b2){if(ap.isFunction(b1)){b2=b2||b0;b0=b1;b1=bR}return ap.ajax({type:bZ,url:b3,data:b1,success:b0,dataType:b2})}});ap.extend({getScript:function(bZ,e){return ap.get(bZ,bR,e,"script")},getJSON:function(b0,bZ,e){return ap.get(b0,bZ,e,"json")},ajaxSetup:function(bZ,e){if(e){g(bZ,ap.ajaxSettings)}else{e=bZ;bZ=ap.ajaxSettings}g(bZ,e);return bZ},ajaxSettings:{url:i,isLocal:a4.test(j[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":k},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":bT.String,"text html":true,"text json":ap.parseJSON,"text xml":ap.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:d(ay),ajaxTransport:d(bO),ajax:function(cn,b9){if(typeof cn==="object"){b9=cn;cn=bR}b9=b9||{};var b7,ce,cd,cl,ck,ca,b4,b6,cg=ap.ajaxSetup({},b9),bZ=cg.context||cg,b5=bZ!==cg&&(bZ.nodeType||bZ instanceof ap)?ap(bZ):ap.event,b1=ap.Deferred(),b0=ap.Callbacks("once memory"),ci=cg.statusCode||{},cb={},cc={},ch=0,cj="canceled",b8={readyState:0,setRequestHeader:function(co,cp){if(!ch){var e=co.toLowerCase();co=cc[e]=cc[e]||co;cb[co]=cp}return this},getAllResponseHeaders:function(){return ch===2?ce:null},getResponseHeader:function(e){var co;if(ch===2){if(!cd){cd={};while((co=aW.exec(ce))){cd[co[1].toLowerCase()]=co[2]}}co=cd[e.toLowerCase()]}return co===bR?null:co},overrideMimeType:function(e){if(!ch){cg.mimeType=e}return this},abort:function(e){e=e||cj;if(cl){cl.abort(e)}b2(0,e);return this}};function b2(cu,cr,ct,co){var cp,cw,e,cs,cq,cv=cr;if(ch===2){return}ch=2;if(ck){clearTimeout(ck)}cl=bR;ce=co||"";b8.readyState=cu>0?4:0;if(ct){cs=h(cg,b8,ct)}if(cu>=200&&cu<300||cu===304){if(cg.ifModified){cq=b8.getResponseHeader("Last-Modified");if(cq){ap.lastModified[b7]=cq}cq=b8.getResponseHeader("Etag");if(cq){ap.etag[b7]=cq}}if(cu===304){cv="notmodified";cp=true}else{cp=f(cg,cs);cv=cp.state;cw=cp.data;e=cp.error;cp=!e}}else{e=cv;if(!cv||cu){cv="error";if(cu<0){cu=0}}}b8.status=cu;b8.statusText=(cr||cv)+"";if(cp){b1.resolveWith(bZ,[cw,cv,b8])}else{b1.rejectWith(bZ,[b8,cv,e])}b8.statusCode(ci);ci=bR;if(b4){b5.trigger("ajax"+(cp?"Success":"Error"),[b8,cg,cp?cw:e])}b0.fireWith(bZ,[b8,cv]);if(b4){b5.trigger("ajaxComplete",[b8,cg]);if(!(--ap.active)){ap.event.trigger("ajaxStop")}}}b1.promise(b8);b8.success=b8.done;b8.error=b8.fail;b8.complete=b0.add;b8.statusCode=function(e){if(e){var co;if(ch<2){for(co in e){ci[co]=[ci[co],e[co]]}}else{co=e[b8.status];b8.always(co)}}return this};cg.url=((cn||cg.url)+"").replace(aV,"").replace(bk,j[1]+"//");cg.dataTypes=ap.trim(cg.dataType||"*").toLowerCase().split(y);if(cg.crossDomain==null){ca=bD.exec(cg.url.toLowerCase())||false;cg.crossDomain=ca&&(ca.join(":")+(ca[3]?"":ca[1]==="http:"?80:443))!==(j.join(":")+(j[3]?"":j[1]==="http:"?80:443))}if(cg.data&&cg.processData&&typeof cg.data!=="string"){cg.data=ap.param(cg.data,cg.traditional)}ak(ay,cg,b9,b8);if(ch===2){return b8}b4=cg.global;cg.type=cg.type.toUpperCase();cg.hasContent=!bb.test(cg.type);if(b4&&ap.active++===0){ap.event.trigger("ajaxStart")}if(!cg.hasContent){if(cg.data){cg.url+=(bl.test(cg.url)?"&":"?")+cg.data;delete cg.data}b7=cg.url;if(cg.cache===false){var cm=ap.now(),cf=cg.url.replace(bz,"$1_="+cm);cg.url=cf+((cf===cg.url)?(bl.test(cg.url)?"&":"?")+"_="+cm:"")}}if(cg.data&&cg.hasContent&&cg.contentType!==false||b9.contentType){b8.setRequestHeader("Content-Type",cg.contentType)}if(cg.ifModified){b7=b7||cg.url;if(ap.lastModified[b7]){b8.setRequestHeader("If-Modified-Since",ap.lastModified[b7])}if(ap.etag[b7]){b8.setRequestHeader("If-None-Match",ap.etag[b7])}}b8.setRequestHeader("Accept",cg.dataTypes[0]&&cg.accepts[cg.dataTypes[0]]?cg.accepts[cg.dataTypes[0]]+(cg.dataTypes[0]!=="*"?", "+k+"; q=0.01":""):cg.accepts["*"]);for(b6 in cg.headers){b8.setRequestHeader(b6,cg.headers[b6])}if(cg.beforeSend&&(cg.beforeSend.call(bZ,b8,cg)===false||ch===2)){return b8.abort()}cj="abort";for(b6 in {success:1,error:1,complete:1}){b8[b6](cg[b6])}cl=ak(bO,cg,b9,b8);if(!cl){b2(-1,"No Transport")}else{b8.readyState=1;if(b4){b5.trigger("ajaxSend",[b8,cg])}if(cg.async&&cg.timeout>0){ck=setTimeout(function(){b8.abort("timeout")},cg.timeout)}try{ch=1;cl.send(cb,b2)}catch(b3){if(ch<2){b2(-1,b3)}else{throw b3}}}return b8},active:0,lastModified:{},etag:{}});function h(b6,b3,b5){var bZ,b7,b1,b2,e=b6.contents,b0=b6.dataTypes,b4=b6.responseFields;for(b7 in b4){if(b7 in b5){b3[b4[b7]]=b5[b7]}}while(b0[0]==="*"){b0.shift();if(bZ===bR){bZ=b6.mimeType||b3.getResponseHeader("content-type")}}if(bZ){for(b7 in e){if(e[b7]&&e[b7].test(bZ)){b0.unshift(b7);break}}}if(b0[0] in b5){b1=b0[0]}else{for(b7 in b5){if(!b0[0]||b6.converters[b7+" "+b0[0]]){b1=b7;break}if(!b2){b2=b7}}b1=b1||b2}if(b1){if(b1!==b0[0]){b0.unshift(b1)}return b5[b1]}}function f(b8,b7){var bZ,b0,b2,b9,b3=b8.dataTypes.slice(),b6=b3[0],b1={},b5=0;if(b8.dataFilter){b7=b8.dataFilter(b7,b8.dataType)}if(b3[1]){for(bZ in b8.converters){b1[bZ.toLowerCase()]=b8.converters[bZ]}}for(;(b2=b3[++b5]);){if(b2!=="*"){if(b6!=="*"&&b6!==b2){bZ=b1[b6+" "+b2]||b1["* "+b2];if(!bZ){for(b0 in b1){b9=b0.split(" ");if(b9[1]===b2){bZ=b1[b6+" "+b9[0]]||b1["* "+b9[0]];if(bZ){if(bZ===true){bZ=b1[b0]}else{if(b1[b0]!==true){b2=b9[0];b3.splice(b5--,0,b2)}}break}}}}if(bZ!==true){if(bZ&&b8["throws"]){b7=bZ(b7)}else{try{b7=bZ(b7)}catch(b4){return{state:"parsererror",error:bZ?b4:"No conversion from "+b6+" to "+b2}}}}}b6=b2}}return{state:"success",data:b7}}var aw=[],bm=/\?/,a1=/(=)\?(?=&|$)|\?\?/,av=ap.now();ap.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=aw.pop()||(ap.expando+"_"+(av++));this[e]=true;return e}});ap.ajaxPrefilter("json jsonp",function(b7,b2,b1){var e,b3,b6,bZ=b7.data,b8=b7.url,b0=b7.jsonp!==false,b5=b0&&a1.test(b8),b4=b0&&!b5&&typeof bZ==="string"&&!(b7.contentType||"").indexOf("application/x-www-form-urlencoded")&&a1.test(bZ);if(b7.dataTypes[0]==="jsonp"||b5||b4){e=b7.jsonpCallback=ap.isFunction(b7.jsonpCallback)?b7.jsonpCallback():b7.jsonpCallback;b3=bT[e];if(b5){b7.url=b8.replace(a1,"$1"+e)}else{if(b4){b7.data=bZ.replace(a1,"$1"+e)}else{if(b0){b7.url+=(bm.test(b8)?"&":"?")+b7.jsonp+"="+e}}}b7.converters["script json"]=function(){if(!b6){ap.error(e+" was not called")}return b6[0]};b7.dataTypes[0]="json";bT[e]=function(){b6=arguments};b1.always(function(){bT[e]=b3;if(b7[e]){b7.jsonpCallback=b2.jsonpCallback;aw.push(e)}if(b6&&ap.isFunction(b3)){b3(b6[0])}b6=b3=bR});return"script"}});ap.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){ap.globalEval(e);return e}}});ap.ajaxPrefilter("script",function(e){if(e.cache===bR){e.cache=false}if(e.crossDomain){e.type="GET";e.global=false}});ap.ajaxTransport("script",function(bZ){if(bZ.crossDomain){var b0,e=Q.head||Q.getElementsByTagName("head")[0]||Q.documentElement;return{send:function(b1,b2){b0=Q.createElement("script");b0.async="async";if(bZ.scriptCharset){b0.charset=bZ.scriptCharset}b0.src=bZ.url;b0.onload=b0.onreadystatechange=function(b3,b4){if(b4||!b0.readyState||/loaded|complete/.test(b0.readyState)){b0.onload=b0.onreadystatechange=null;if(e&&b0.parentNode){e.removeChild(b0)}b0=bR;if(!b4){b2(200,"success")}}};e.insertBefore(b0,e.firstChild)},abort:function(){if(b0){b0.onload(0,1)}}}}});var bW,bY=bT.ActiveXObject?function(){for(var e in bW){bW[e](0,1)}}:false,bX=0;function G(){try{return new bT.XMLHttpRequest()}catch(bZ){}}function C(){try{return new bT.ActiveXObject("Microsoft.XMLHTTP")}catch(bZ){}}ap.ajaxSettings.xhr=bT.ActiveXObject?function(){return !this.isLocal&&G()||C()}:G;(function(e){ap.extend(ap.support,{ajax:!!e,cors:!!e&&("withCredentials" in e)})})(ap.ajaxSettings.xhr());if(ap.support.ajax){ap.ajaxTransport(function(bZ){if(!bZ.crossDomain||ap.support.cors){var e;return{send:function(b3,b1){var b2,b4,b5=bZ.xhr();if(bZ.username){b5.open(bZ.type,bZ.url,bZ.async,bZ.username,bZ.password)}else{b5.open(bZ.type,bZ.url,bZ.async)}if(bZ.xhrFields){for(b4 in bZ.xhrFields){b5[b4]=bZ.xhrFields[b4]}}if(bZ.mimeType&&b5.overrideMimeType){b5.overrideMimeType(bZ.mimeType)}if(!bZ.crossDomain&&!b3["X-Requested-With"]){b3["X-Requested-With"]="XMLHttpRequest"}try{for(b4 in b3){b5.setRequestHeader(b4,b3[b4])}}catch(b0){}b5.send((bZ.hasContent&&bZ.data)||null);e=function(b6,b9){var cc,cd,ca,cb,ce;try{if(e&&(b9||b5.readyState===4)){e=bR;if(b2){b5.onreadystatechange=ap.noop;if(bY){delete bW[b2]}}if(b9){if(b5.readyState!==4){b5.abort()}}else{cc=b5.status;ca=b5.getAllResponseHeaders();cb={};ce=b5.responseXML;if(ce&&ce.documentElement){cb.xml=ce}try{cb.text=b5.responseText}catch(b6){}try{cd=b5.statusText}catch(b7){cd=""}if(!cc&&bZ.isLocal&&!bZ.crossDomain){cc=cb.text?200:404}else{if(cc===1223){cc=204}}}}}catch(b8){if(!b9){b1(-1,b8)}}if(cb){b1(cc,cd,cb,ca)}};if(!bZ.async){e()}else{if(b5.readyState===4){setTimeout(e,0)}else{b2=++bX;if(bY){if(!bW){bW={};ap(bT).unload(bY)}bW[b2]=e}b5.onreadystatechange=e}}},abort:function(){if(e){e(0,1)}}}}})}var aa,bN,aU=/^(?:toggle|show|hide)$/,aT=new RegExp("^(?:([-+])=|)("+v+")([a-z%]*)$","i"),br=/queueHooks$/,m=[P],bQ={"*":[function(b1,b7){var e,b6,b5=this.createTween(b1,b7),b0=aT.exec(b7),b4=b5.cur(),b3=+b4||0,b2=1,bZ=20;if(b0){e=+b0[2];b6=b0[3]||(ap.cssNumber[b1]?"":"px");if(b6!=="px"&&b3){b3=ap.css(b5.elem,b1,true)||e||1;do{b2=b2||".5";b3=b3/b2;ap.style(b5.elem,b1,b3+b6)}while(b2!==(b2=b5.cur()/b4)&&b2!==1&&--bZ)}b5.unit=b6;b5.start=b3;b5.end=b0[1]?b3+(b0[1]+1)*e:e}return b5}]};function D(){setTimeout(function(){aa=bR},0);return(aa=ap.now())}function H(e,bZ){ap.each(bZ,function(b3,b4){var b0=(bQ[b3]||[]).concat(bQ["*"]),b1=0,b2=b0.length;for(;b1<b2;b1++){if(b0[b1].call(e,b3,b4)){return}}})}function l(b0,b4,b3){var b6,b1=0,b8=0,b2=m.length,bZ=ap.Deferred().always(function(){delete b7.elem}),b7=function(){var b9=aa||D(),cd=Math.max(0,e.startTime+e.duration-b9),cc=1-(cd/e.duration||0),ca=0,cb=e.tweens.length;for(;ca<cb;ca++){e.tweens[ca].run(cc)}bZ.notifyWith(b0,[e,cc,cd]);if(cc<1&&cb){return cd}else{bZ.resolveWith(b0,[e]);return false}},e=bZ.promise({elem:b0,props:ap.extend({},b4),opts:ap.extend(true,{specialEasing:{}},b3),originalProperties:b4,originalOptions:b3,startTime:aa||D(),duration:b3.duration,tweens:[],createTween:function(cb,ca,b9){var cc=ap.Tween(b0,e.opts,cb,ca,e.opts.specialEasing[cb]||e.opts.easing);e.tweens.push(cc);return cc},stop:function(b9){var ca=0,cb=b9?e.tweens.length:0;for(;ca<cb;ca++){e.tweens[ca].run(1)}if(b9){bZ.resolveWith(b0,[e,b9])}else{bZ.rejectWith(b0,[e,b9])}return this}}),b5=e.props;az(b5,e.opts.specialEasing);for(;b1<b2;b1++){b6=m[b1].call(e,b0,b5,e.opts);if(b6){return b6}}H(e,b5);if(ap.isFunction(e.opts.start)){e.opts.start.call(b0,e)}ap.fx.timer(ap.extend(b7,{anim:e,queue:e.opts.queue,elem:b0}));return e.progress(e.opts.progress).done(e.opts.done,e.opts.complete).fail(e.opts.fail).always(e.opts.always)}function az(b2,b3){var b0,b1,e,b4,bZ;for(b0 in b2){b1=ap.camelCase(b0);e=b3[b1];b4=b2[b0];if(ap.isArray(b4)){e=b4[1];b4=b2[b0]=b4[0]}if(b0!==b1){b2[b1]=b4;delete b2[b0]}bZ=ap.cssHooks[b1];if(bZ&&"expand" in bZ){b4=bZ.expand(b4);delete b2[b1];for(b0 in b4){if(!(b0 in b2)){b2[b0]=b4[b0];b3[b0]=e}}}else{b3[b1]=e}}}ap.Animation=ap.extend(l,{tweener:function(b2,e){if(ap.isFunction(b2)){e=b2;b2=["*"]}else{b2=b2.split(" ")}var b1,bZ=0,b0=b2.length;for(;bZ<b0;bZ++){b1=b2[bZ];bQ[b1]=bQ[b1]||[];bQ[b1].unshift(e)}},prefilter:function(e,bZ){if(bZ){m.unshift(e)}else{m.push(e)}}});function P(b0,ca,b7){var b4,b9,cd,b5,bZ,cc,b3,b6,e=this,cb=b0.style,b8={},b1=[],b2=b0.nodeType&&an(b0);if(!b7.queue){b3=ap._queueHooks(b0,"fx");if(b3.unqueued==null){b3.unqueued=0;b6=b3.empty.fire;b3.empty.fire=function(){if(!b3.unqueued){b6()}}}b3.unqueued++;e.always(function(){e.always(function(){b3.unqueued--;if(!ap.queue(b0,"fx").length){b3.empty.fire()}})})}if(b0.nodeType===1&&("height" in ca||"width" in ca)){b7.overflow=[cb.overflow,cb.overflowX,cb.overflowY];if(ap.css(b0,"display")==="inline"&&ap.css(b0,"float")==="none"){if(!ap.support.inlineBlockNeedsLayout||I(b0.nodeName)==="inline"){cb.display="inline-block"}else{cb.zoom=1}}}if(b7.overflow){cb.overflow="hidden";if(!ap.support.shrinkWrapBlocks){e.done(function(){cb.overflow=b7.overflow[0];cb.overflowX=b7.overflow[1];cb.overflowY=b7.overflow[2]})}}for(b4 in ca){cd=ca[b4];if(aU.exec(cd)){delete ca[b4];if(cd===(b2?"hide":"show")){continue}b1.push(b4)}}b5=b1.length;if(b5){bZ=ap._data(b0,"fxshow")||ap._data(b0,"fxshow",{});if(b2){ap(b0).show()}else{e.done(function(){ap(b0).hide()})}e.done(function(){var ce;ap.removeData(b0,"fxshow",true);for(ce in b8){ap.style(b0,ce,b8[ce])}});for(b4=0;b4<b5;b4++){b9=b1[b4];cc=e.createTween(b9,b2?bZ[b9]:0);b8[b9]=bZ[b9]||ap.style(b0,b9);if(!(b9 in bZ)){bZ[b9]=cc.start;if(b2){cc.end=cc.start;cc.start=b9==="width"||b9==="height"?1:0}}}}}function bP(bZ,b1,b2,b0,e){return new bP.prototype.init(bZ,b1,b2,b0,e)}ap.Tween=bP;bP.prototype={constructor:bP,init:function(bZ,b1,b2,b0,e,b3){this.elem=bZ;this.prop=b2;this.easing=e||"swing";this.options=b1;this.start=this.now=this.cur();this.end=b0;this.unit=b3||(ap.cssNumber[b2]?"":"px")},cur:function(){var e=bP.propHooks[this.prop];return e&&e.get?e.get(this):bP.propHooks._default.get(this)},run:function(b0){var e,bZ=bP.propHooks[this.prop];if(this.options.duration){this.pos=e=ap.easing[this.easing](b0,this.options.duration*b0,0,1,this.options.duration)}else{this.pos=e=b0}this.now=(this.end-this.start)*e+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(bZ&&bZ.set){bZ.set(this)}else{bP.propHooks._default.set(this)}return this}};bP.prototype.init.prototype=bP.prototype;bP.propHooks={_default:{get:function(bZ){var e;if(bZ.elem[bZ.prop]!=null&&(!bZ.elem.style||bZ.elem.style[bZ.prop]==null)){return bZ.elem[bZ.prop]}e=ap.css(bZ.elem,bZ.prop,false,"");return !e||e==="auto"?0:e},set:function(e){if(ap.fx.step[e.prop]){ap.fx.step[e.prop](e)}else{if(e.elem.style&&(e.elem.style[ap.cssProps[e.prop]]!=null||ap.cssHooks[e.prop])){ap.style(e.elem,e.prop,e.now+e.unit)}else{e.elem[e.prop]=e.now}}}}};bP.propHooks.scrollTop=bP.propHooks.scrollLeft={set:function(e){if(e.elem.nodeType&&e.elem.parentNode){e.elem[e.prop]=e.now}}};ap.each(["toggle","show","hide"],function(bZ,b0){var e=ap.fn[b0];ap.fn[b0]=function(b3,b2,b1){return b3==null||typeof b3==="boolean"||(!bZ&&ap.isFunction(b3)&&ap.isFunction(b2))?e.apply(this,arguments):this.animate(ab(b0,true),b3,b2,b1)}});ap.fn.extend({fadeTo:function(b0,b1,bZ,e){return this.filter(an).css("opacity",0).show().end().animate({opacity:b1},b0,bZ,e)},animate:function(b3,b4,b0,e){var b1=ap.isEmptyObject(b3),b2=ap.speed(b4,b0,e),bZ=function(){var b5=l(this,ap.extend({},b3),b2);if(b1){b5.stop(true)}};return b1||b2.queue===false?this.each(bZ):this.queue(b2.queue,bZ)},stop:function(b1,e,bZ){var b0=function(b2){var b3=b2.stop;delete b2.stop;b3(bZ)};if(typeof b1!=="string"){bZ=e;e=b1;b1=bR}if(e&&b1!==false){this.queue(b1||"fx",[])}return this.each(function(){var b3=true,b4=b1!=null&&b1+"queueHooks",b5=ap.timers,b2=ap._data(this);if(b4){if(b2[b4]&&b2[b4].stop){b0(b2[b4])}}else{for(b4 in b2){if(b2[b4]&&b2[b4].stop&&br.test(b4)){b0(b2[b4])}}}for(b4=b5.length;b4--;){if(b5[b4].elem===this&&(b1==null||b5[b4].queue===b1)){b5[b4].anim.stop(bZ);b3=false;b5.splice(b4,1)}}if(b3||!bZ){ap.dequeue(this,b1)}})}});function ab(b1,b0){var b2,e={height:b1},bZ=0;b0=b0?1:0;for(;bZ<4;bZ+=2-b0){b2=J[bZ];e["margin"+b2]=e["padding"+b2]=b1}if(b0){e.opacity=e.width=b1}return e}ap.each({slideDown:ab("show"),slideUp:ab("hide"),slideToggle:ab("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,bZ){ap.fn[e]=function(b2,b1,b0){return this.animate(bZ,b2,b1,b0)}});ap.speed=function(b1,e,bZ){var b0=b1&&typeof b1==="object"?ap.extend({},b1):{complete:bZ||!bZ&&e||ap.isFunction(b1)&&b1,duration:b1,easing:bZ&&e||e&&!ap.isFunction(e)&&e};b0.duration=ap.fx.off?0:typeof b0.duration==="number"?b0.duration:b0.duration in ap.fx.speeds?ap.fx.speeds[b0.duration]:ap.fx.speeds._default;if(b0.queue==null||b0.queue===true){b0.queue="fx"}b0.old=b0.complete;b0.complete=function(){if(ap.isFunction(b0.old)){b0.old.call(this)}if(b0.queue){ap.dequeue(this,b0.queue)}};return b0};ap.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}};ap.timers=[];ap.fx=bP.prototype.init;ap.fx.tick=function(){var bZ,b0=ap.timers,e=0;for(;e<b0.length;e++){bZ=b0[e];if(!bZ()&&b0[e]===bZ){b0.splice(e--,1)}}if(!b0.length){ap.fx.stop()}};ap.fx.timer=function(e){if(e()&&ap.timers.push(e)&&!bN){bN=setInterval(ap.fx.tick,ap.fx.interval)}};ap.fx.interval=13;ap.fx.stop=function(){clearInterval(bN);bN=null};ap.fx.speeds={slow:600,fast:200,_default:400};ap.fx.step={};if(ap.expr&&ap.expr.filters){ap.expr.filters.animated=function(e){return ap.grep(ap.timers,function(bZ){return e===bZ.elem}).length}}var bq=/^(?:body|html)$/i;ap.fn.offset=function(b5){if(arguments.length){return b5===bR?this:this.each(function(b9){ap.offset.setOffset(this,b5,b9)})}var b3,e,b8,b1,b0,b7,b6,bZ={top:0,left:0},b4=this[0],b2=b4&&b4.ownerDocument;if(!b2){return}if((e=b2.body)===b4){return ap.offset.bodyOffset(b4)}b3=b2.documentElement;if(!ap.contains(b3,b4)){return bZ}if(typeof b4.getBoundingClientRect!=="undefined"){bZ=b4.getBoundingClientRect()}b8=af(b2);b1=b3.clientTop||e.clientTop||0;b0=b3.clientLeft||e.clientLeft||0;b7=b8.pageYOffset||b3.scrollTop;b6=b8.pageXOffset||b3.scrollLeft;return{top:bZ.top+b7-b1,left:bZ.left+b6-b0}};ap.offset={bodyOffset:function(e){var b0=e.offsetTop,bZ=e.offsetLeft;if(ap.support.doesNotIncludeMarginInBodyOffset){b0+=parseFloat(ap.css(e,"marginTop"))||0;bZ+=parseFloat(ap.css(e,"marginLeft"))||0}return{top:b0,left:bZ}},setOffset:function(b6,b8,b7){var b9=ap.css(b6,"position");if(b9==="static"){b6.style.position="relative"}var b1=ap(b6),b3=b1.offset(),b0=ap.css(b6,"top"),bZ=ap.css(b6,"left"),e=(b9==="absolute"||b9==="fixed")&&ap.inArray("auto",[b0,bZ])>-1,ca={},b4={},b5,b2;if(e){b4=b1.position();b5=b4.top;b2=b4.left}else{b5=parseFloat(b0)||0;b2=parseFloat(bZ)||0}if(ap.isFunction(b8)){b8=b8.call(b6,b7,b3)}if(b8.top!=null){ca.top=(b8.top-b3.top)+b5}if(b8.left!=null){ca.left=(b8.left-b3.left)+b2}if("using" in b8){b8.using.call(b6,ca)}else{b1.css(ca)}}};ap.fn.extend({position:function(){if(!this[0]){return}var e=this[0],b0=this.offsetParent(),bZ=this.offset(),b1=bq.test(b0[0].nodeName)?{top:0,left:0}:b0.offset();bZ.top-=parseFloat(ap.css(e,"marginTop"))||0;bZ.left-=parseFloat(ap.css(e,"marginLeft"))||0;b1.top+=parseFloat(ap.css(b0[0],"borderTopWidth"))||0;b1.left+=parseFloat(ap.css(b0[0],"borderLeftWidth"))||0;return{top:bZ.top-b1.top,left:bZ.left-b1.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||Q.body;while(e&&(!bq.test(e.nodeName)&&ap.css(e,"position")==="static")){e=e.offsetParent}return e||Q.body})}});ap.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,bZ){var b0=/Y/.test(bZ);ap.fn[e]=function(b1){return ap.access(this,function(b2,b3,b4){var b5=af(b2);if(b4===bR){return b5?(bZ in b5)?b5[bZ]:b5.document.documentElement[b3]:b2[b3]}if(b5){b5.scrollTo(!b0?b4:ap(b5).scrollLeft(),b0?b4:ap(b5).scrollTop())}else{b2[b3]=b4}},e,b1,arguments.length,null)}});function af(e){return ap.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:false}ap.each({Height:"height",Width:"width"},function(e,bZ){ap.each({padding:"inner"+e,content:bZ,"":"outer"+e},function(b0,b1){ap.fn[b1]=function(b4,b5){var b2=arguments.length&&(b0||typeof b4!=="boolean"),b3=b0||(b4===true||b5===true?"margin":"border");return ap.access(this,function(b7,b8,b9){var b6;if(ap.isWindow(b7)){return b7.document.documentElement["client"+e]}if(b7.nodeType===9){b6=b7.documentElement;return Math.max(b7.body["scroll"+e],b6["scroll"+e],b7.body["offset"+e],b6["offset"+e],b6["client"+e])}return b9===bR?ap.css(b7,b8,b9,b3):ap.style(b7,b8,b9,b3)},bZ,b2?b4:bR,b2,null)}})});bT.jQuery=bT.$=ap;if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return ap})}})(window);
/*
 * mci.support.js  created by yangyin@mcitech.cn 2013-02-04
 * html5 support 
 */
(function(){var a=document.createElement("div");var d=["webkit","moz","o","ms"];var g={};g.transform3d=c(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);g.transform=c(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"]);g.transition=c(["transitionProperty","WebkitTransitionProperty","MozTransitionProperty","OTransitionProperty","msTransitionProperty"]);g.touch="ontouchstart" in window;g.cssAnimation=(g.transform3d||g.transform)&&g.transition;g.touchStartEvent=g.touch?"touchstart":"mousedown";g.touchMoveEvent=g.touch?"touchmove":"mousemove";g.touchEndEvent=g.touch?"touchend":"mouseup";g.mouseOut="mouseout";if(window.navigator.msPointerEnabled){g.touchStartEvent="MSPointerDown";g.touchMoveEvent="MSPointerMove";g.touchEndEvent="MSPointerUp";g.mouseOut="MSPointerOut"}function c(i){return f(i,function(j){return a.style[j]!==undefined})}function e(k,j,l){var i=saveProp[j];if(i){k[i]=l}else{if(k[j]!==undefined){saveProp[j]=j;k[j]=l}else{f(d,function(m){var n=h(m)+h(j);if(k[n]!==undefined){saveProp[j]=n;k[n]=l;return true}})}}}function b(i){if(a.style[i]!==undefined){return i}else{var j;f(d,function(k){var l=h(k)+h(i);if(a.style[l]!==undefined){j="-"+k+"-"+i;return true}});return j}}function h(i){return i.charAt(0).toUpperCase()+i.substr(1)}function f(j,k){for(var l=0,m=j.length;l<m;l++){if(k(j[l],l)){return true}}return false}g.getCSSVal=b;window.Support=g})();"use strict";var THREE=THREE||{};if(!self.Int32Array){self.Int32Array=Array,self.Float32Array=Array}(function(){for(var d=0,e=["ms","moz","webkit","o"],f=0;f<e.length&&!window.requestAnimationFrame;++f){window.requestAnimationFrame=window[e[f]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[f]+"CancelAnimationFrame"]||window[e[f]+"RequestCancelAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(a){var h=(new Date).getTime(),i=Math.max(0,16-(h-d)),j=window.setTimeout(function(){a(h+i)},i);d=h+i;return j}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(b){clearTimeout(b)}}})();THREE.Clock=function(b){this.autoStart=void 0!==b?b:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};THREE.Clock.prototype.start=function(){this.oldTime=this.startTime=Date.now();this.running=!0};THREE.Clock.prototype.stop=function(){this.getElapsedTime();this.running=!1};THREE.Clock.prototype.getElapsedTime=function(){return this.elapsedTime+=this.getDelta()};THREE.Clock.prototype.getDelta=function(){var c=0;this.autoStart&&!this.running&&this.start();if(this.running){var d=Date.now(),c=0.001*(d-this.oldTime);this.oldTime=d;this.elapsedTime+=c}return c};THREE.Color=function(b){void 0!==b&&this.setHex(b);return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,copy:function(b){this.r=b.r;this.g=b.g;this.b=b.b;return this},copyGammaToLinear:function(b){this.r=b.r*b.r;this.g=b.g*b.g;this.b=b.b*b.b;return this},copyLinearToGamma:function(b){this.r=Math.sqrt(b.r);this.g=Math.sqrt(b.g);this.b=Math.sqrt(b.b);return this},convertGammaToLinear:function(){var d=this.r,e=this.g,f=this.b;this.r=d*d;this.g=e*e;this.b=f*f;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},setRGB:function(d,e,f){this.r=d;this.g=e;this.b=f;return this},setHSV:function(g,h,i){var j,k,l;if(0===i){this.r=this.g=this.b=0}else{switch(j=Math.floor(6*g),k=6*g-j,g=i*(1-h),l=i*(1-h*k),h=i*(1-h*(1-k)),j){case 1:this.r=l;this.g=i;this.b=g;break;case 2:this.r=g;this.g=i;this.b=h;break;case 3:this.r=g;this.g=l;this.b=i;break;case 4:this.r=h;this.g=g;this.b=i;break;case 5:this.r=i;this.g=g;this.b=l;break;case 6:case 0:this.r=i,this.g=h,this.b=g}}return this},setHex:function(b){b=Math.floor(b);this.r=(b>>16&255)/255;this.g=(b>>8&255)/255;this.b=(b&255)/255;return this},getHex:function(){return Math.floor(255*this.r)<<16^Math.floor(255*this.g)<<8^Math.floor(255*this.b)},getContextStyle:function(){return"rgb("+Math.floor(255*this.r)+","+Math.floor(255*this.g)+","+Math.floor(255*this.b)+")"},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};THREE.Vector2=function(c,d){this.x=c||0;this.y=d||0};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(c,d){this.x=c;this.y=d;return this},copy:function(b){this.x=b.x;this.y=b.y;return this},clone:function(){return new THREE.Vector2(this.x,this.y)},add:function(c,d){this.x=c.x+d.x;this.y=c.y+d.y;return this},addSelf:function(b){this.x+=b.x;this.y+=b.y;return this},sub:function(c,d){this.x=c.x-d.x;this.y=c.y-d.y;return this},subSelf:function(b){this.x-=b.x;this.y-=b.y;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;return this},divideScalar:function(b){b?(this.x/=b,this.y/=b):this.set(0,0);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(c){var d=this.x-c.x,c=this.y-c.y;return d*d+c*c},setLength:function(b){return this.normalize().multiplyScalar(b)},equals:function(b){return b.x===this.x&&b.y===this.y}};THREE.Vector3=function(d,e,f){this.x=d||0;this.y=e||0;this.z=f||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(d,e,f){this.x=d;this.y=e;this.z=f;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)},add:function(c,d){this.x=c.x+d.x;this.y=c.y+d.y;this.z=c.z+d.z;return this},addSelf:function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;return this},sub:function(c,d){this.x=c.x-d.x;this.y=c.y-d.y;this.z=c.z-d.z;return this},subSelf:function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z;return this},multiply:function(c,d){this.x=c.x*d.x;this.y=c.y*d.y;this.z=c.z*d.z;return this},multiplySelf:function(b){this.x*=b.x;this.y*=b.y;this.z*=b.z;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;return this},divideSelf:function(b){this.x/=b.x;this.y/=b.y;this.z/=b.z;return this},divideScalar:function(b){b?(this.x/=b,this.y/=b,this.z/=b):this.z=this.y=this.x=0;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.lengthSq())},lengthManhattan:function(){return this.x+this.y+this.z},normalize:function(){return this.divideScalar(this.length())},setLength:function(b){return this.normalize().multiplyScalar(b)},cross:function(c,d){this.x=c.y*d.z-c.z*d.y;this.y=c.z*d.x-c.x*d.z;this.z=c.x*d.y-c.y*d.x;return this},crossSelf:function(e){var f=this.x,g=this.y,h=this.z;this.x=g*e.z-h*e.y;this.y=h*e.x-f*e.z;this.z=f*e.y-g*e.x;return this},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(b){return(new THREE.Vector3).sub(this,b).lengthSq()},setPositionFromMatrix:function(b){this.x=b.n14;this.y=b.n24;this.z=b.n34},setRotationFromMatrix:function(c){var d=Math.cos(this.y);this.y=Math.asin(c.n13);1e-05<Math.abs(d)?(this.x=Math.atan2(-c.n23/d,c.n33/d),this.z=Math.atan2(-c.n12/d,c.n11/d)):(this.x=0,this.z=Math.atan2(c.n21,c.n22))},isZero:function(){return 0.0001>this.lengthSq()}};THREE.Vector4=function(e,f,g,h){this.x=e||0;this.y=f||0;this.z=g||0;this.w=void 0!==h?h:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(e,f,g,h){this.x=e;this.y=f;this.z=g;this.w=h;return this},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=void 0!==b.w?b.w:1},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)},add:function(c,d){this.x=c.x+d.x;this.y=c.y+d.y;this.z=c.z+d.z;this.w=c.w+d.w;return this},addSelf:function(b){this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this},sub:function(c,d){this.x=c.x-d.x;this.y=c.y-d.y;this.z=c.z-d.z;this.w=c.w-d.w;return this},subSelf:function(b){this.x-=b.x;this.y-=b.y;this.z-=b.z;this.w-=b.w;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this},divideScalar:function(b){b?(this.x/=b,this.y/=b,this.z/=b,this.w/=b):(this.z=this.y=this.x=0,this.w=1);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w},lengthSq:function(){return this.dot(this)},length:function(){return Math.sqrt(this.lengthSq())},normalize:function(){return this.divideScalar(this.length())},setLength:function(b){return this.normalize().multiplyScalar(b)},lerpSelf:function(c,d){this.x+=(c.x-this.x)*d;this.y+=(c.y-this.y)*d;this.z+=(c.z-this.z)*d;this.w+=(c.w-this.w)*d;return this}};THREE.Frustum=function(){this.planes=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4]};THREE.Frustum.prototype.setFromMatrix=function(d){var e,f=this.planes;f[0].set(d.n41-d.n11,d.n42-d.n12,d.n43-d.n13,d.n44-d.n14);f[1].set(d.n41+d.n11,d.n42+d.n12,d.n43+d.n13,d.n44+d.n14);f[2].set(d.n41+d.n21,d.n42+d.n22,d.n43+d.n23,d.n44+d.n24);f[3].set(d.n41-d.n21,d.n42-d.n22,d.n43-d.n23,d.n44-d.n24);f[4].set(d.n41-d.n31,d.n42-d.n32,d.n43-d.n33,d.n44-d.n34);f[5].set(d.n41+d.n31,d.n42+d.n32,d.n43+d.n33,d.n44+d.n34);for(d=0;6>d;d++){e=f[d],e.divideScalar(Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z))}};THREE.Frustum.prototype.contains=function(f){for(var g=this.planes,h=f.matrixWorld,i=THREE.Frustum.__v1.set(h.getColumnX().length(),h.getColumnY().length(),h.getColumnZ().length()),i=-f.geometry.boundingSphere.radius*Math.max(i.x,Math.max(i.y,i.z)),j=0;6>j;j++){if(f=g[j].x*h.n14+g[j].y*h.n24+g[j].z*h.n34+g[j].w,f<=i){return !1}}return !0};THREE.Frustum.__v1=new THREE.Vector3;THREE.Ray=function(j,y){function E(d,e,f){T.sub(f,d);W=T.dot(e);X=U.add(d,R.copy(e).multiplyScalar(W));return Y=f.distanceTo(X)}function G(e,f,g,h){T.sub(h,f);U.sub(g,f);R.sub(e,f);Z=T.dot(T);aa=T.dot(U);ab=T.dot(R);z=U.dot(U);I=U.dot(R);F=1/(Z*z-aa*aa);w=(z*ab-aa*I)*F;N=(Z*I-aa*ab)*F;return 0<=w&&0<=N&&1>w+N}this.origin=j||new THREE.Vector3;this.direction=y||new THREE.Vector3;this.intersectScene=function(b){return this.intersectObjects(b.children)};this.intersectObjects=function(e){var f,g,h=[];for(f=0,g=e.length;f<g;f++){Array.prototype.push.apply(h,this.intersectObject(e[f]))}h.sort(function(c,d){return c.distance-d.distance});return h};var J=new THREE.Vector3,K=new THREE.Vector3,L=new THREE.Vector3,M=new THREE.Vector3,O=new THREE.Vector3,Q=new THREE.Vector3,P=new THREE.Vector3,S=new THREE.Vector3,V=new THREE.Vector3;this.intersectObject=function(c){for(var d,f=[],g=0,h=c.children.length;g<h;g++){Array.prototype.push.apply(f,this.intersectObject(c.children[g]))}if(c instanceof THREE.Particle){g=E(this.origin,this.direction,c.matrixWorld.getPosition());if(g>c.scale.x){return[]}d={distance:g,point:c.position,face:null,object:c};f.push(d)}else{if(c instanceof THREE.Mesh){g=E(this.origin,this.direction,c.matrixWorld.getPosition());h=THREE.Frustum.__v1.set(c.matrixWorld.getColumnX().length(),c.matrixWorld.getColumnY().length(),c.matrixWorld.getColumnZ().length());if(g>c.geometry.boundingSphere.radius*Math.max(h.x,Math.max(h.y,h.z))){return f}var i,k,e=c.geometry,l=e.vertices,n;c.matrixRotationWorld.extractRotation(c.matrixWorld);for(g=0,h=e.faces.length;g<h;g++){if(d=e.faces[g],O.copy(this.origin),Q.copy(this.direction),n=c.matrixWorld,P=n.multiplyVector3(P.copy(d.centroid)).subSelf(O),S=c.matrixRotationWorld.multiplyVector3(S.copy(d.normal)),i=Q.dot(S),!(0.0001>Math.abs(i))&&(k=S.dot(P)/i,!(0>k)&&(c.doubleSided||(c.flipSided?0<i:0>i)))){if(V.add(O,Q.multiplyScalar(k)),d instanceof THREE.Face3){J=n.multiplyVector3(J.copy(l[d.a].position)),K=n.multiplyVector3(K.copy(l[d.b].position)),L=n.multiplyVector3(L.copy(l[d.c].position)),G(V,J,K,L)&&(d={distance:O.distanceTo(V),point:V.clone(),face:d,object:c},f.push(d))}else{if(d instanceof THREE.Face4&&(J=n.multiplyVector3(J.copy(l[d.a].position)),K=n.multiplyVector3(K.copy(l[d.b].position)),L=n.multiplyVector3(L.copy(l[d.c].position)),M=n.multiplyVector3(M.copy(l[d.d].position)),G(V,J,K,M)||G(V,K,L,M))){d={distance:O.distanceTo(V),point:V.clone(),face:d,object:c},f.push(d)}}}}}}return f};var T=new THREE.Vector3,U=new THREE.Vector3,R=new THREE.Vector3,W,X,Y,Z,aa,ab,z,I,F,w,N};THREE.Rectangle=function(){function i(){n=l-j;o=m-k}var j,k,l,m,n,o,p=!0;this.getX=function(){return j};this.getY=function(){return k};this.getWidth=function(){return n};this.getHeight=function(){return o};this.getLeft=function(){return j};this.getTop=function(){return k};this.getRight=function(){return l};this.getBottom=function(){return m};this.set=function(a,b,c,d){p=!1;j=a;k=b;l=c;m=d;i()};this.addPoint=function(a,b){p?(p=!1,j=a,k=b,l=a,m=b):(j=j<a?j:a,k=k<b?k:b,l=l>a?l:a,m=m>b?m:b);i()};this.add3Points=function(a,b,c,d,h,e){p?(p=!1,j=a<c?a<h?a:h:c<h?c:h,k=b<d?b<e?b:e:d<e?d:e,l=a>c?a>h?a:h:c>h?c:h,m=b>d?b>e?b:e:d>e?d:e):(j=a<c?a<h?a<j?a:j:h<j?h:j:c<h?c<j?c:j:h<j?h:j,k=b<d?b<e?b<k?b:k:e<k?e:k:d<e?d<k?d:k:e<k?e:k,l=a>c?a>h?a>l?a:l:h>l?h:l:c>h?c>l?c:l:h>l?h:l,m=b>d?b>e?b>m?b:m:e>m?e:m:d>e?d>m?d:m:e>m?e:m);i()};this.addRectangle=function(a){p?(p=!1,j=a.getLeft(),k=a.getTop(),l=a.getRight(),m=a.getBottom()):(j=j<a.getLeft()?j:a.getLeft(),k=k<a.getTop()?k:a.getTop(),l=l>a.getRight()?l:a.getRight(),m=m>a.getBottom()?m:a.getBottom());i()};this.inflate=function(a){j-=a;k-=a;l+=a;m+=a;i()};this.minSelf=function(a){j=j>a.getLeft()?j:a.getLeft();k=k>a.getTop()?k:a.getTop();l=l<a.getRight()?l:a.getRight();m=m<a.getBottom()?m:a.getBottom();i()};this.intersects=function(b){return l<b.getLeft()||j>b.getRight()||m<b.getTop()||k>b.getBottom()?!1:!0};this.empty=function(){p=!0;m=l=k=j=0;i()};this.isEmpty=function(){return p}};THREE.Math={clamp:function(d,e,f){return d<e?e:d>f?f:d},clampBottom:function(c,d){return c<d?d:c},mapLinear:function(f,g,h,i,j){return i+(f-g)*(j-i)/(h-g)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(c,d){return c+Math.floor(Math.random()*(d-c+1))},randFloat:function(c,d){return c+Math.random()*(d-c)},randFloatSpread:function(b){return b*(0.5-Math.random())}};THREE.Matrix3=function(){this.m=[]};THREE.Matrix3.prototype={constructor:THREE.Matrix3,transpose:function(){var c,d=this.m;c=d[1];d[1]=d[3];d[3]=c;c=d[2];d[2]=d[6];d[6]=c;c=d[5];d[5]=d[7];d[7]=c;return this},transposeIntoArray:function(c){var d=this.m;c[0]=d[0];c[1]=d[3];c[2]=d[6];c[3]=d[1];c[4]=d[4];c[5]=d[7];c[6]=d[2];c[7]=d[5];c[8]=d[8];return this}};THREE.Matrix4=function(j,r,s,t,u,v,w,x,y,A,z,C,F,D,E,B){this.set(void 0!==j?j:1,r||0,s||0,t||0,u||0,void 0!==v?v:1,w||0,x||0,y||0,A||0,void 0!==z?z:1,C||0,F||0,D||0,E||0,void 0!==B?B:1);this.flat=Array(16);this.m33=new THREE.Matrix3};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(j,r,s,t,u,v,w,x,y,A,z,C,F,D,E,B){this.n11=j;this.n12=r;this.n13=s;this.n14=t;this.n21=u;this.n22=v;this.n23=w;this.n24=x;this.n31=y;this.n32=A;this.n33=z;this.n34=C;this.n41=F;this.n42=D;this.n43=E;this.n44=B;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(b){this.set(b.n11,b.n12,b.n13,b.n14,b.n21,b.n22,b.n23,b.n24,b.n31,b.n32,b.n33,b.n34,b.n41,b.n42,b.n43,b.n44);return this},lookAt:function(g,h,i){var j=THREE.Matrix4.__v1,k=THREE.Matrix4.__v2,l=THREE.Matrix4.__v3;l.sub(g,h).normalize();if(0===l.length()){l.z=1}j.cross(i,l).normalize();0===j.length()&&(l.x+=0.0001,j.cross(i,l).normalize());k.cross(l,j).normalize();this.n11=j.x;this.n12=k.x;this.n13=l.x;this.n21=j.y;this.n22=k.y;this.n23=l.y;this.n31=j.z;this.n32=k.z;this.n33=l.z;return this},multiply:function(w,z){var F=w.n11,M=w.n12,P=w.n13,R=w.n14,S=w.n21,U=w.n22,W=w.n23,aa=w.n24,Y=w.n31,ad=w.n32,ah=w.n33,af=w.n34,ag=w.n41,ac=w.n42,aj=w.n43,ak=w.n44,al=z.n11,am=z.n12,an=z.n13,ao=z.n14,E=z.n21,O=z.n22,J=z.n23,y=z.n24,V=z.n31,X=z.n32,ae=z.n33,j=z.n34,Z=z.n41,ai=z.n42,ab=z.n43,T=z.n44;this.n11=F*al+M*E+P*V+R*Z;this.n12=F*am+M*O+P*X+R*ai;this.n13=F*an+M*J+P*ae+R*ab;this.n14=F*ao+M*y+P*j+R*T;this.n21=S*al+U*E+W*V+aa*Z;this.n22=S*am+U*O+W*X+aa*ai;this.n23=S*an+U*J+W*ae+aa*ab;this.n24=S*ao+U*y+W*j+aa*T;this.n31=Y*al+ad*E+ah*V+af*Z;this.n32=Y*am+ad*O+ah*X+af*ai;this.n33=Y*an+ad*J+ah*ae+af*ab;this.n34=Y*ao+ad*y+ah*j+af*T;this.n41=ag*al+ac*E+aj*V+ak*Z;this.n42=ag*am+ac*O+aj*X+ak*ai;this.n43=ag*an+ac*J+aj*ae+ak*ab;this.n44=ag*ao+ac*y+aj*j+ak*T;return this},multiplySelf:function(b){return this.multiply(this,b)},multiplyToArray:function(d,e,f){this.multiply(d,e);f[0]=this.n11;f[1]=this.n21;f[2]=this.n31;f[3]=this.n41;f[4]=this.n12;f[5]=this.n22;f[6]=this.n32;f[7]=this.n42;f[8]=this.n13;f[9]=this.n23;f[10]=this.n33;f[11]=this.n43;f[12]=this.n14;f[13]=this.n24;f[14]=this.n34;f[15]=this.n44;return this},multiplyScalar:function(b){this.n11*=b;this.n12*=b;this.n13*=b;this.n14*=b;this.n21*=b;this.n22*=b;this.n23*=b;this.n24*=b;this.n31*=b;this.n32*=b;this.n33*=b;this.n34*=b;this.n41*=b;this.n42*=b;this.n43*=b;this.n44*=b;return this},multiplyVector3:function(f){var g=f.x,h=f.y,i=f.z,j=1/(this.n41*g+this.n42*h+this.n43*i+this.n44);f.x=(this.n11*g+this.n12*h+this.n13*i+this.n14)*j;f.y=(this.n21*g+this.n22*h+this.n23*i+this.n24)*j;f.z=(this.n31*g+this.n32*h+this.n33*i+this.n34)*j;return f},multiplyVector4:function(f){var g=f.x,h=f.y,i=f.z,j=f.w;f.x=this.n11*g+this.n12*h+this.n13*i+this.n14*j;f.y=this.n21*g+this.n22*h+this.n23*i+this.n24*j;f.z=this.n31*g+this.n32*h+this.n33*i+this.n34*j;f.w=this.n41*g+this.n42*h+this.n43*i+this.n44*j;return f},rotateAxis:function(e){var f=e.x,g=e.y,h=e.z;e.x=f*this.n11+g*this.n12+h*this.n13;e.y=f*this.n21+g*this.n22+h*this.n23;e.z=f*this.n31+g*this.n32+h*this.n33;e.normalize();return e},crossVector:function(c){var d=new THREE.Vector4;d.x=this.n11*c.x+this.n12*c.y+this.n13*c.z+this.n14*c.w;d.y=this.n21*c.x+this.n22*c.y+this.n23*c.z+this.n24*c.w;d.z=this.n31*c.x+this.n32*c.y+this.n33*c.z+this.n34*c.w;d.w=c.w?this.n41*c.x+this.n42*c.y+this.n43*c.z+this.n44*c.w:1;return d},determinant:function(){var j=this.n11,r=this.n12,s=this.n13,t=this.n14,u=this.n21,v=this.n22,w=this.n23,x=this.n24,y=this.n31,A=this.n32,z=this.n33,C=this.n34,F=this.n41,D=this.n42,E=this.n43,B=this.n44;return t*w*A*F-s*x*A*F-t*v*z*F+r*x*z*F+s*v*C*F-r*w*C*F-t*w*y*D+s*x*y*D+t*u*z*D-j*x*z*D-s*u*C*D+j*w*C*D+t*v*y*E-r*x*y*E-t*u*A*E+j*x*A*E+r*u*C*E-j*v*C*E-s*v*y*B+r*w*y*B+s*u*A*B-j*w*A*B-r*u*z*B+j*v*z*B},transpose:function(){var b;b=this.n21;this.n21=this.n12;this.n12=b;b=this.n31;this.n31=this.n13;this.n13=b;b=this.n32;this.n32=this.n23;this.n23=b;b=this.n41;this.n41=this.n14;this.n14=b;b=this.n42;this.n42=this.n24;this.n24=b;b=this.n43;this.n43=this.n34;this.n34=b;return this},clone:function(){var b=new THREE.Matrix4;b.n11=this.n11;b.n12=this.n12;b.n13=this.n13;b.n14=this.n14;b.n21=this.n21;b.n22=this.n22;b.n23=this.n23;b.n24=this.n24;b.n31=this.n31;b.n32=this.n32;b.n33=this.n33;b.n34=this.n34;b.n41=this.n41;b.n42=this.n42;b.n43=this.n43;b.n44=this.n44;return b},flatten:function(){this.flat[0]=this.n11;this.flat[1]=this.n21;this.flat[2]=this.n31;this.flat[3]=this.n41;this.flat[4]=this.n12;this.flat[5]=this.n22;this.flat[6]=this.n32;this.flat[7]=this.n42;this.flat[8]=this.n13;this.flat[9]=this.n23;this.flat[10]=this.n33;this.flat[11]=this.n43;this.flat[12]=this.n14;this.flat[13]=this.n24;this.flat[14]=this.n34;this.flat[15]=this.n44;return this.flat},flattenToArray:function(b){b[0]=this.n11;b[1]=this.n21;b[2]=this.n31;b[3]=this.n41;b[4]=this.n12;b[5]=this.n22;b[6]=this.n32;b[7]=this.n42;b[8]=this.n13;b[9]=this.n23;b[10]=this.n33;b[11]=this.n43;b[12]=this.n14;b[13]=this.n24;b[14]=this.n34;b[15]=this.n44;return b},flattenToArrayOffset:function(c,d){c[d]=this.n11;c[d+1]=this.n21;c[d+2]=this.n31;c[d+3]=this.n41;c[d+4]=this.n12;c[d+5]=this.n22;c[d+6]=this.n32;c[d+7]=this.n42;c[d+8]=this.n13;c[d+9]=this.n23;c[d+10]=this.n33;c[d+11]=this.n43;c[d+12]=this.n14;c[d+13]=this.n24;c[d+14]=this.n34;c[d+15]=this.n44;return c},setTranslation:function(d,e,f){this.set(1,0,0,d,0,1,0,e,0,0,1,f,0,0,0,1);return this},setScale:function(d,e,f){this.set(d,0,0,0,0,e,0,0,0,0,f,0,0,0,0,1);return this},setRotationX:function(c){var d=Math.cos(c),c=Math.sin(c);this.set(1,0,0,0,0,d,-c,0,0,c,d,0,0,0,0,1);return this},setRotationY:function(c){var d=Math.cos(c),c=Math.sin(c);this.set(d,0,c,0,0,1,0,0,-c,0,d,0,0,0,0,1);return this},setRotationZ:function(c){var d=Math.cos(c),c=Math.sin(c);this.set(d,-c,0,0,c,d,0,0,0,0,1,0,0,0,0,1);return this},setRotationAxis:function(j,k){var m=Math.cos(k),n=Math.sin(k),o=1-m,p=j.x,q=j.y,r=j.z,s=o*p,t=o*q;this.set(s*p+m,s*q-n*r,s*r+n*q,0,s*q+n*r,t*q+m,t*r-n*p,0,s*r-n*q,t*r+n*p,o*r*r+m,0,0,0,0,1);return this},setPosition:function(b){this.n14=b.x;this.n24=b.y;this.n34=b.z;return this},getPosition:function(){return THREE.Matrix4.__v1.set(this.n14,this.n24,this.n34)},getColumnX:function(){return THREE.Matrix4.__v1.set(this.n11,this.n21,this.n31)},getColumnY:function(){return THREE.Matrix4.__v1.set(this.n12,this.n22,this.n32)},getColumnZ:function(){return THREE.Matrix4.__v1.set(this.n13,this.n23,this.n33)},getInverse:function(j){var s=j.n11,t=j.n12,u=j.n13,v=j.n14,w=j.n21,x=j.n22,y=j.n23,z=j.n24,B=j.n31,A=j.n32,D=j.n33,G=j.n34,E=j.n41,F=j.n42,C=j.n43,H=j.n44;this.n11=y*G*F-z*D*F+z*A*C-x*G*C-y*A*H+x*D*H;this.n12=v*D*F-u*G*F-v*A*C+t*G*C+u*A*H-t*D*H;this.n13=u*z*F-v*y*F+v*x*C-t*z*C-u*x*H+t*y*H;this.n14=v*y*A-u*z*A-v*x*D+t*z*D+u*x*G-t*y*G;this.n21=z*D*E-y*G*E-z*B*C+w*G*C+y*B*H-w*D*H;this.n22=u*G*E-v*D*E+v*B*C-s*G*C-u*B*H+s*D*H;this.n23=v*y*E-u*z*E-v*w*C+s*z*C+u*w*H-s*y*H;this.n24=u*z*B-v*y*B+v*w*D-s*z*D-u*w*G+s*y*G;this.n31=x*G*E-z*A*E+z*B*F-w*G*F-x*B*H+w*A*H;this.n32=v*A*E-t*G*E-v*B*F+s*G*F+t*B*H-s*A*H;this.n33=t*z*E-v*x*E+v*w*F-s*z*F-t*w*H+s*x*H;this.n34=v*x*B-t*z*B-v*w*A+s*z*A+t*w*G-s*x*G;this.n41=y*A*E-x*D*E-y*B*F+w*D*F+x*B*C-w*A*C;this.n42=t*D*E-u*A*E+u*B*F-s*D*F-t*B*C+s*A*C;this.n43=u*x*E-t*y*E-u*w*F+s*y*F+t*w*C-s*x*C;this.n44=t*y*B-u*x*B+u*w*A-s*y*A-t*w*D+s*x*D;this.multiplyScalar(1/j.determinant());return this},setRotationFromEuler:function(j,m){var o=j.x,p=j.y,q=j.z,r=Math.cos(o),o=Math.sin(o),s=Math.cos(p),p=Math.sin(p),t=Math.cos(q),q=Math.sin(q);switch(m){case"YXZ":var u=s*t,w=s*q,v=p*t,x=p*q;this.n11=u+x*o;this.n12=v*o-w;this.n13=r*p;this.n21=r*q;this.n22=r*t;this.n23=-o;this.n31=w*o-v;this.n32=x+u*o;this.n33=r*s;break;case"ZXY":u=s*t;w=s*q;v=p*t;x=p*q;this.n11=u-x*o;this.n12=-r*q;this.n13=v+w*o;this.n21=w+v*o;this.n22=r*t;this.n23=x-u*o;this.n31=-r*p;this.n32=o;this.n33=r*s;break;case"ZYX":u=r*t;w=r*q;v=o*t;x=o*q;this.n11=s*t;this.n12=v*p-w;this.n13=u*p+x;this.n21=s*q;this.n22=x*p+u;this.n23=w*p-v;this.n31=-p;this.n32=o*s;this.n33=r*s;break;case"YZX":u=r*s;w=r*p;v=o*s;x=o*p;this.n11=s*t;this.n12=x-u*q;this.n13=v*q+w;this.n21=q;this.n22=r*t;this.n23=-o*t;this.n31=-p*t;this.n32=w*q+v;this.n33=u-x*q;break;case"XZY":u=r*s;w=r*p;v=o*s;x=o*p;this.n11=s*t;this.n12=-q;this.n13=p*t;this.n21=u*q+x;this.n22=r*t;this.n23=w*q-v;this.n31=v*q-w;this.n32=o*t;this.n33=x*q+u;break;default:u=r*t,w=r*q,v=o*t,x=o*q,this.n11=s*t,this.n12=-s*q,this.n13=p,this.n21=w+v*p,this.n22=u-x*p,this.n23=-o*s,this.n31=x-u*p,this.n32=v+w*p,this.n33=r*s}return this},setRotationFromQuaternion:function(j){var k=j.x,m=j.y,n=j.z,o=j.w,p=k+k,q=m+m,r=n+n,j=k*p,s=k*q,k=k*r,t=m*q,m=m*r,n=n*r,p=o*p,q=o*q,o=o*r;this.n11=1-(t+n);this.n12=s-o;this.n13=k+q;this.n21=s+o;this.n22=1-(j+n);this.n23=m-p;this.n31=k-q;this.n32=m+p;this.n33=1-(j+t);return this},scale:function(d){var e=d.x,f=d.y,d=d.z;this.n11*=e;this.n12*=f;this.n13*=d;this.n21*=e;this.n22*=f;this.n23*=d;this.n31*=e;this.n32*=f;this.n33*=d;this.n41*=e;this.n42*=f;this.n43*=d;return this},compose:function(f,g,h){var i=THREE.Matrix4.__m1,j=THREE.Matrix4.__m2;i.identity();i.setRotationFromQuaternion(g);j.setScale(h.x,h.y,h.z);this.multiply(i,j);this.n14=f.x;this.n24=f.y;this.n34=f.z;return this},decompose:function(g,h,i){var j=THREE.Matrix4.__v1,k=THREE.Matrix4.__v2,l=THREE.Matrix4.__v3;j.set(this.n11,this.n21,this.n31);k.set(this.n12,this.n22,this.n32);l.set(this.n13,this.n23,this.n33);g=g instanceof THREE.Vector3?g:new THREE.Vector3;h=h instanceof THREE.Quaternion?h:new THREE.Quaternion;i=i instanceof THREE.Vector3?i:new THREE.Vector3;i.x=j.length();i.y=k.length();i.z=l.length();g.x=this.n14;g.y=this.n24;g.z=this.n34;j=THREE.Matrix4.__m1;j.copy(this);j.n11/=i.x;j.n21/=i.x;j.n31/=i.x;j.n12/=i.y;j.n22/=i.y;j.n32/=i.y;j.n13/=i.z;j.n23/=i.z;j.n33/=i.z;h.setFromRotationMatrix(j);return[g,h,i]},extractPosition:function(b){this.n14=b.n14;this.n24=b.n24;this.n34=b.n34;return this},extractRotation:function(e){var f=THREE.Matrix4.__v1,g=1/f.set(e.n11,e.n21,e.n31).length(),h=1/f.set(e.n12,e.n22,e.n32).length(),f=1/f.set(e.n13,e.n23,e.n33).length();this.n11=e.n11*g;this.n21=e.n21*g;this.n31=e.n31*g;this.n12=e.n12*h;this.n22=e.n22*h;this.n32=e.n32*h;this.n13=e.n13*f;this.n23=e.n23*f;this.n33=e.n33*f;return this},rotateByAxis:function(j,w){if(1===j.x&&0===j.y&&0===j.z){return this.rotateX(w)}if(0===j.x&&1===j.y&&0===j.z){return this.rotateY(w)}if(0===j.x&&0===j.y&&1===j.z){return this.rotateZ(w)}var z=j.x,A=j.y,C=j.z,D=Math.sqrt(z*z+A*A+C*C),z=z/D,A=A/D,C=C/D,D=z*z,E=A*A,F=C*C,G=Math.cos(w),I=Math.sin(w),H=1-G,K=z*A*H,N=z*C*H,H=A*C*H,z=z*I,L=A*I,I=C*I,C=D+(1-D)*G,D=K+I,A=N-L,K=K-I,E=E+(1-E)*G,I=H+z,N=N+L,H=H-z,F=F+(1-F)*G,G=this.n11,z=this.n21,L=this.n31,M=this.n41,J=this.n12,O=this.n22,P=this.n32,Q=this.n42,R=this.n13,S=this.n23,T=this.n33,y=this.n43;this.n11=C*G+D*J+A*R;this.n21=C*z+D*O+A*S;this.n31=C*L+D*P+A*T;this.n41=C*M+D*Q+A*y;this.n12=K*G+E*J+I*R;this.n22=K*z+E*O+I*S;this.n32=K*L+E*P+I*T;this.n42=K*M+E*Q+I*y;this.n13=N*G+H*J+F*R;this.n23=N*z+H*O+F*S;this.n33=N*L+H*P+F*T;this.n43=N*M+H*Q+F*y;return this},rotateX:function(j){var k=this.n12,m=this.n22,n=this.n32,o=this.n42,p=this.n13,q=this.n23,r=this.n33,s=this.n43,t=Math.cos(j),j=Math.sin(j);this.n12=t*k+j*p;this.n22=t*m+j*q;this.n32=t*n+j*r;this.n42=t*o+j*s;this.n13=t*p-j*k;this.n23=t*q-j*m;this.n33=t*r-j*n;this.n43=t*s-j*o;return this},rotateY:function(j){var k=this.n11,m=this.n21,n=this.n31,o=this.n41,p=this.n13,q=this.n23,r=this.n33,s=this.n43,t=Math.cos(j),j=Math.sin(j);this.n11=t*k-j*p;this.n21=t*m-j*q;this.n31=t*n-j*r;this.n41=t*o-j*s;this.n13=t*p+j*k;this.n23=t*q+j*m;this.n33=t*r+j*n;this.n43=t*s+j*o;return this},rotateZ:function(j){var k=this.n11,m=this.n21,n=this.n31,o=this.n41,p=this.n12,q=this.n22,r=this.n32,s=this.n42,t=Math.cos(j),j=Math.sin(j);this.n11=t*k+j*p;this.n21=t*m+j*q;this.n31=t*n+j*r;this.n41=t*o+j*s;this.n12=t*p-j*k;this.n22=t*q-j*m;this.n32=t*r-j*n;this.n42=t*s-j*o;return this},translate:function(d){var e=d.x,f=d.y,d=d.z;this.n14=this.n11*e+this.n12*f+this.n13*d+this.n14;this.n24=this.n21*e+this.n22*f+this.n23*d+this.n24;this.n34=this.n31*e+this.n32*f+this.n33*d+this.n34;this.n44=this.n41*e+this.n42*f+this.n43*d+this.n44;return this}};THREE.Matrix4.makeInvert3x3=function(j){var m=j.m33,o=m.m,p=j.n33*j.n22-j.n32*j.n23,q=-j.n33*j.n21+j.n31*j.n23,r=j.n32*j.n21-j.n31*j.n22,s=-j.n33*j.n12+j.n32*j.n13,t=j.n33*j.n11-j.n31*j.n13,u=-j.n32*j.n11+j.n31*j.n12,w=j.n23*j.n12-j.n22*j.n13,v=-j.n23*j.n11+j.n21*j.n13,x=j.n22*j.n11-j.n21*j.n12,j=j.n11*p+j.n21*s+j.n31*w;if(0===j){return null}j=1/j;o[0]=j*p;o[1]=j*q;o[2]=j*r;o[3]=j*s;o[4]=j*t;o[5]=j*u;o[6]=j*w;o[7]=j*v;o[8]=j*x;return m};THREE.Matrix4.makeFrustum=function(h,i,j,k,l,m){var n;n=new THREE.Matrix4;n.n11=2*l/(i-h);n.n12=0;n.n13=(i+h)/(i-h);n.n14=0;n.n21=0;n.n22=2*l/(k-j);n.n23=(k+j)/(k-j);n.n24=0;n.n31=0;n.n32=0;n.n33=-(m+l)/(m-l);n.n34=-2*m*l/(m-l);n.n41=0;n.n42=0;n.n43=-1;n.n44=0;return n};THREE.Matrix4.makePerspective=function(f,g,h,i){var j,f=h*Math.tan(f*Math.PI/360);j=-f;return THREE.Matrix4.makeFrustum(j*g,f*g,j,f,h,i)};THREE.Matrix4.makeOrtho=function(j,k,m,n,o,p){var q,r,s,t;q=new THREE.Matrix4;r=k-j;s=m-n;t=p-o;q.n11=2/r;q.n12=0;q.n13=0;q.n14=-((k+j)/r);q.n21=0;q.n22=2/s;q.n23=0;q.n24=-((m+n)/s);q.n31=0;q.n32=0;q.n33=-2/t;q.n34=-((p+o)/t);q.n41=0;q.n42=0;q.n43=0;q.n44=1;return q};THREE.Matrix4.__v1=new THREE.Vector3;THREE.Matrix4.__v2=new THREE.Vector3;THREE.Matrix4.__v3=new THREE.Vector3;THREE.Matrix4.__m1=new THREE.Matrix4;THREE.Matrix4.__m2=new THREE.Matrix4;THREE.Object3D=function(){this.name="";this.id=THREE.Object3DCount++;this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder="XYZ";this.scale=new THREE.Vector3(1,1,1);this.flipSided=this.doubleSided=this.dynamic=!1;this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixRotationWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=!1;this.boundRadius=0;this.boundRadiusScale=1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this._vector=new THREE.Vector3};THREE.Object3D.prototype={constructor:THREE.Object3D,translate:function(c,d){this.matrix.rotateAxis(d);this.position.addSelf(d.multiplyScalar(c))},translateX:function(b){this.translate(b,this._vector.set(1,0,0))},translateY:function(b){this.translate(b,this._vector.set(0,1,0))},translateZ:function(b){this.translate(b,this._vector.set(0,0,1))},lookAt:function(b){this.matrix.lookAt(b,this.position,this.up);this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)},add:function(c){if(-1===this.children.indexOf(c)){void 0!==c.parent&&c.parent.remove(c);c.parent=this;this.children.push(c);for(var d=this;void 0!==d.parent;){d=d.parent}void 0!==d&&d instanceof THREE.Scene&&d.addObject(c)}},remove:function(c){var d=this.children.indexOf(c);if(-1!==d){c.parent=void 0;this.children.splice(d,1);for(d=this;void 0!==d.parent;){d=d.parent}void 0!==d&&d instanceof THREE.Scene&&d.removeObject(c)}},getChildByName:function(f,g){var h,i,j;for(h=0,i=this.children.length;h<i;h++){j=this.children[h];if(j.name===f||g&&(j=j.getChildByName(f,g),void 0!==j)){return j}}},updateMatrix:function(){this.matrix.setPosition(this.position);this.useQuaternion?this.matrix.setRotationFromQuaternion(this.quaternion):this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder);if(1!==this.scale.x||1!==this.scale.y||1!==this.scale.z){this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,Math.max(this.scale.y,this.scale.z))}this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(d){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||d){this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,d=!0}for(var e=0,f=this.children.length;e<f;e++){this.children[e].updateMatrixWorld(d)}}};THREE.Object3DCount=0;THREE.Projector=function(){function j(){var b=M[L]=M[L]||new THREE.RenderableObject;L++;return b}function y(){var b=T[Q]=T[Q]||new THREE.RenderableVertex;Q++;return b}function E(c,d){return d.z-c.z}function G(i,k){var l=0,m=1,n=i.z+i.w,o=k.z+k.w,p=-i.z+i.w,q=-k.z+k.w;if(0<=n&&0<=o&&0<=p&&0<=q){return !0}if(0>n&&0>o||0>p&&0>q){return !1}0>n?l=Math.max(l,n/(n-o)):0>o&&(m=Math.min(m,n/(n-o)));0>p?l=Math.max(l,p/(p-q)):0>q&&(m=Math.min(m,p/(p-q)));if(m<l){return !1}i.lerpSelf(k,l);k.lerpSelf(i,1-m);return !0}var K,L,M=[],O,Q,T=[],S,V,Z=[],X,Y=[],U,aa,ab=[],ac,ad,ae=[],af={objects:[],sprites:[],lights:[],elements:[]},z=new THREE.Vector3,J=new THREE.Vector4,F=new THREE.Matrix4,w=new THREE.Matrix4,P=new THREE.Frustum,R=new THREE.Vector4,W=new THREE.Vector4;this.projectVector=function(c,d){d.matrixWorldInverse.getInverse(d.matrixWorld);F.multiply(d.projectionMatrix,d.matrixWorldInverse);F.multiplyVector3(c);return c};this.unprojectVector=function(c,d){d.projectionMatrixInverse.getInverse(d.projectionMatrix);F.multiply(d.matrixWorld,d.projectionMatrixInverse);F.multiplyVector3(c);return c};this.pickingRay=function(d,e){var f;d.z=-1;f=new THREE.Vector3(d.x,d.y,1);this.unprojectVector(d,e);this.unprojectVector(f,e);f.subSelf(d).normalize();return new THREE.Ray(d,f)};this.projectGraph=function(a,c){L=0;af.objects.length=0;af.sprites.length=0;af.lights.length=0;var e=function(f){if(!1!==f.visible){(f instanceof THREE.Mesh||f instanceof THREE.Line)&&(!1===f.frustumCulled||P.contains(f))?(F.multiplyVector3(z.copy(f.position)),K=j(),K.object=f,K.z=z.z,af.objects.push(K)):f instanceof THREE.Sprite||f instanceof THREE.Particle?(F.multiplyVector3(z.copy(f.position)),K=j(),K.object=f,K.z=z.z,af.sprites.push(K)):f instanceof THREE.Light&&af.lights.push(f);for(var g=0,h=f.children.length;g<h;g++){e(f.children[g])}}};e(a);c&&af.objects.sort(E);return af};this.projectScene=function(b,k,m){var n=k.near,o=k.far,r,c,D,l,x,A,v,s,p,C,d,h,i,q,u,t;ad=aa=X=V=0;af.elements.length=0;void 0===k.parent&&(console.warn("DEPRECATED: Camera hasn't been added to a Scene. Adding it..."),b.add(k));b.updateMatrixWorld();k.matrixWorldInverse.getInverse(k.matrixWorld);F.multiply(k.projectionMatrix,k.matrixWorldInverse);P.setFromMatrix(F);af=this.projectGraph(b,!1);for(b=0,r=af.objects.length;b<r;b++){if(p=af.objects[b].object,C=p.matrixWorld,h=p.material,Q=0,p instanceof THREE.Mesh){d=p.geometry;i=p.geometry.materials;l=d.vertices;q=d.faces;u=d.faceVertexUvs;d=p.matrixRotationWorld.extractRotation(C);for(c=0,D=l.length;c<D;c++){O=y(),O.positionWorld.copy(l[c].position),C.multiplyVector3(O.positionWorld),O.positionScreen.copy(O.positionWorld),F.multiplyVector4(O.positionScreen),O.positionScreen.x/=O.positionScreen.w,O.positionScreen.y/=O.positionScreen.w,O.visible=O.positionScreen.z>n&&O.positionScreen.z<o}for(l=0,c=q.length;l<c;l++){D=q[l];if(D instanceof THREE.Face3){if(x=T[D.a],A=T[D.b],v=T[D.c],x.visible&&A.visible&&v.visible&&(p.doubleSided||p.flipSided!=0>(v.positionScreen.x-x.positionScreen.x)*(A.positionScreen.y-x.positionScreen.y)-(v.positionScreen.y-x.positionScreen.y)*(A.positionScreen.x-x.positionScreen.x))){s=Z[V]=Z[V]||new THREE.RenderableFace3,V++,S=s,S.v1.copy(x),S.v2.copy(A),S.v3.copy(v)}else{continue}}else{if(D instanceof THREE.Face4){if(x=T[D.a],A=T[D.b],v=T[D.c],s=T[D.d],x.visible&&A.visible&&v.visible&&s.visible&&(p.doubleSided||p.flipSided!=(0>(s.positionScreen.x-x.positionScreen.x)*(A.positionScreen.y-x.positionScreen.y)-(s.positionScreen.y-x.positionScreen.y)*(A.positionScreen.x-x.positionScreen.x)||0>(A.positionScreen.x-v.positionScreen.x)*(s.positionScreen.y-v.positionScreen.y)-(A.positionScreen.y-v.positionScreen.y)*(s.positionScreen.x-v.positionScreen.x)))){t=Y[X]=Y[X]||new THREE.RenderableFace4,X++,S=t,S.v1.copy(x),S.v2.copy(A),S.v3.copy(v),S.v4.copy(s)}else{continue}}}S.normalWorld.copy(D.normal);d.multiplyVector3(S.normalWorld);S.centroidWorld.copy(D.centroid);C.multiplyVector3(S.centroidWorld);S.centroidScreen.copy(S.centroidWorld);F.multiplyVector3(S.centroidScreen);v=D.vertexNormals;for(x=0,A=v.length;x<A;x++){s=S.vertexNormalsWorld[x],s.copy(v[x]),d.multiplyVector3(s)}for(x=0,A=u.length;x<A;x++){if(t=u[x][l]){for(v=0,s=t.length;v<s;v++){S.uvs[x][v]=t[v]}}}S.material=h;S.faceMaterial=null!==D.materialIndex?i[D.materialIndex]:null;S.z=S.centroidScreen.z;af.elements.push(S)}}else{if(p instanceof THREE.Line){w.multiply(F,C);l=p.geometry.vertices;x=y();x.positionScreen.copy(l[0].position);w.multiplyVector4(x.positionScreen);for(c=1,D=l.length;c<D;c++){if(x=y(),x.positionScreen.copy(l[c].position),w.multiplyVector4(x.positionScreen),A=T[Q-2],R.copy(x.positionScreen),W.copy(A.positionScreen),G(R,W)){R.multiplyScalar(1/R.w),W.multiplyScalar(1/W.w),p=ab[aa]=ab[aa]||new THREE.RenderableLine,aa++,U=p,U.v1.positionScreen.copy(R),U.v2.positionScreen.copy(W),U.z=Math.max(R.z,W.z),U.material=h,af.elements.push(U)}}}}}for(b=0,r=af.sprites.length;b<r;b++){if(p=af.sprites[b].object,C=p.matrixWorld,p instanceof THREE.Particle&&(J.set(C.n14,C.n24,C.n34,1),F.multiplyVector4(J),J.z/=J.w,0<J.z&&1>J.z)){n=ae[ad]=ae[ad]||new THREE.RenderableParticle,ad++,ac=n,ac.x=J.x/J.w,ac.y=J.y/J.w,ac.z=J.z,ac.rotation=p.rotation.z,ac.scale.x=p.scale.x*Math.abs(ac.x-(J.x+k.projectionMatrix.n11)/(J.w+k.projectionMatrix.n14)),ac.scale.y=p.scale.y*Math.abs(ac.y-(J.y+k.projectionMatrix.n22)/(J.w+k.projectionMatrix.n24)),ac.material=p.material,af.elements.push(ac)}}m&&af.elements.sort(E);return af}};THREE.Quaternion=function(e,f,g,h){this.set(e||0,f||0,g||0,void 0!==h?h:1)};THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(e,f,g,h){this.x=e;this.y=f;this.z=g;this.w=h;return this},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this},setFromEuler:function(i){var j=Math.PI/360,k=i.x*j,l=i.y*j,m=i.z*j,i=Math.cos(l),l=Math.sin(l),j=Math.cos(-m),m=Math.sin(-m),n=Math.cos(k),k=Math.sin(k),o=i*j,p=l*m;this.w=o*n-p*k;this.x=o*k+p*n;this.y=l*j*n+i*m*k;this.z=i*m*n-l*j*k;return this},setFromAxisAngle:function(e,f){var g=f/2,h=Math.sin(g);this.x=e.x*h;this.y=e.y*h;this.z=e.z*h;this.w=Math.cos(g);return this},setFromRotationMatrix:function(c){var d=Math.pow(c.determinant(),1/3);this.w=Math.sqrt(Math.max(0,d+c.n11+c.n22+c.n33))/2;this.x=Math.sqrt(Math.max(0,d+c.n11-c.n22-c.n33))/2;this.y=Math.sqrt(Math.max(0,d-c.n11+c.n22-c.n33))/2;this.z=Math.sqrt(Math.max(0,d-c.n11-c.n22+c.n33))/2;this.x=0>c.n32-c.n23?-Math.abs(this.x):Math.abs(this.x);this.y=0>c.n13-c.n31?-Math.abs(this.y):Math.abs(this.y);this.z=0>c.n21-c.n12?-Math.abs(this.z):Math.abs(this.z);this.normalize();return this},calculateW:function(){this.w=-Math.sqrt(Math.abs(1-this.x*this.x-this.y*this.y-this.z*this.z));return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var b=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===b?this.w=this.z=this.y=this.x=0:(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b);return this},multiplySelf:function(i){var j=this.x,k=this.y,l=this.z,m=this.w,n=i.x,o=i.y,p=i.z,i=i.w;this.x=j*i+m*n+k*p-l*o;this.y=k*i+m*o+l*n-j*p;this.z=l*i+m*p+j*o-k*n;this.w=m*i-j*n-k*o-l*p;return this},multiply:function(c,d){this.x=c.x*d.w+c.y*d.z-c.z*d.y+c.w*d.x;this.y=-c.x*d.z+c.y*d.w+c.z*d.x+c.w*d.y;this.z=c.x*d.y-c.y*d.x+c.z*d.w+c.w*d.z;this.w=-c.x*d.x-c.y*d.y-c.z*d.z+c.w*d.w;return this},multiplyVector3:function(j,m){m||(m=j);var o=j.x,p=j.y,q=j.z,r=this.x,s=this.y,t=this.z,u=this.w,w=u*o+s*q-t*p,v=u*p+t*o-r*q,x=u*q+r*p-s*o,o=-r*o-s*p-t*q;m.x=w*u+o*-r+v*-t-x*-s;m.y=v*u+o*-s+x*-r-w*-t;m.z=x*u+o*-t+w*-s-v*-r;return m}};THREE.Quaternion.slerp=function(g,h,i,j){var k=g.w*h.w+g.x*h.x+g.y*h.y+g.z*h.z;0>k?(i.w=-h.w,i.x=-h.x,i.y=-h.y,i.z=-h.z,k=-k):i.copy(h);if(1<=Math.abs(k)){return i.w=g.w,i.x=g.x,i.y=g.y,i.z=g.z,i}var l=Math.acos(k),k=Math.sqrt(1-k*k);if(0.001>Math.abs(k)){return i.w=0.5*(g.w+h.w),i.x=0.5*(g.x+h.x),i.y=0.5*(g.y+h.y),i.z=0.5*(g.z+h.z),i}h=Math.sin((1-j)*l)/k;j=Math.sin(j*l)/k;i.w=g.w*h+i.w*j;i.x=g.x*h+i.x*j;i.y=g.y*h+i.y*j;i.z=g.z*h+i.z*j;return i};THREE.Vertex=function(b){this.position=b||new THREE.Vector3};THREE.Face3=function(g,h,i,j,k,l){this.a=g;this.b=h;this.c=i;this.normal=j instanceof THREE.Vector3?j:new THREE.Vector3;this.vertexNormals=j instanceof Array?j:[];this.color=k instanceof THREE.Color?k:new THREE.Color;this.vertexColors=k instanceof Array?k:[];this.vertexTangents=[];this.materialIndex=l;this.centroid=new THREE.Vector3};THREE.Face4=function(h,i,j,k,l,m,n){this.a=h;this.b=i;this.c=j;this.d=k;this.normal=l instanceof THREE.Vector3?l:new THREE.Vector3;this.vertexNormals=l instanceof Array?l:[];this.color=m instanceof THREE.Color?m:new THREE.Color;this.vertexColors=m instanceof Array?m:[];this.vertexTangents=[];this.materialIndex=n;this.centroid=new THREE.Vector3};THREE.UV=function(c,d){this.u=c||0;this.v=d||0};THREE.UV.prototype={constructor:THREE.UV,set:function(c,d){this.u=c;this.v=d;return this},copy:function(b){this.u=b.u;this.v=b.v;return this},clone:function(){return new THREE.UV(this.u,this.v)}};THREE.Geometry=function(){this.id=THREE.GeometryCount++;this.vertices=[];this.colors=[];this.materials=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.dynamic=this.hasTangents=!1};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(h){var i=new THREE.Matrix4;i.extractRotation(h,new THREE.Vector3(1,1,1));for(var j=0,k=this.vertices.length;j<k;j++){h.multiplyVector3(this.vertices[j].position)}j=0;for(k=this.faces.length;j<k;j++){var l=this.faces[j];i.multiplyVector3(l.normal);for(var m=0,n=l.vertexNormals.length;m<n;m++){i.multiplyVector3(l.vertexNormals[m])}h.multiplyVector3(l.centroid)}},computeCentroids:function(){var d,e,f;for(d=0,e=this.faces.length;d<e;d++){f=this.faces[d],f.centroid.set(0,0,0),f instanceof THREE.Face3?(f.centroid.addSelf(this.vertices[f.a].position),f.centroid.addSelf(this.vertices[f.b].position),f.centroid.addSelf(this.vertices[f.c].position),f.centroid.divideScalar(3)):f instanceof THREE.Face4&&(f.centroid.addSelf(this.vertices[f.a].position),f.centroid.addSelf(this.vertices[f.b].position),f.centroid.addSelf(this.vertices[f.c].position),f.centroid.addSelf(this.vertices[f.d].position),f.centroid.divideScalar(4))}},computeFaceNormals:function(){var i,j,k,l,m,n,o=new THREE.Vector3,p=new THREE.Vector3;for(i=0,j=this.faces.length;i<j;i++){k=this.faces[i],l=this.vertices[k.a],m=this.vertices[k.b],n=this.vertices[k.c],o.sub(n.position,m.position),p.sub(l.position,m.position),o.crossSelf(p),o.isZero()||o.normalize(),k.normal.copy(o)}},computeVertexNormals:function(){var e,f,g,h;if(void 0===this.__tmpVertices){h=this.__tmpVertices=Array(this.vertices.length);for(e=0,f=this.vertices.length;e<f;e++){h[e]=new THREE.Vector3}for(e=0,f=this.faces.length;e<f;e++){if(g=this.faces[e],g instanceof THREE.Face3){g.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}else{if(g instanceof THREE.Face4){g.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]}}}}else{h=this.__tmpVertices;for(e=0,f=this.vertices.length;e<f;e++){h[e].set(0,0,0)}}for(e=0,f=this.faces.length;e<f;e++){g=this.faces[e],g instanceof THREE.Face3?(h[g.a].addSelf(g.normal),h[g.b].addSelf(g.normal),h[g.c].addSelf(g.normal)):g instanceof THREE.Face4&&(h[g.a].addSelf(g.normal),h[g.b].addSelf(g.normal),h[g.c].addSelf(g.normal),h[g.d].addSelf(g.normal))}for(e=0,f=this.vertices.length;e<f;e++){h[e].normalize()}for(e=0,f=this.faces.length;e<f;e++){g=this.faces[e],g instanceof THREE.Face3?(g.vertexNormals[0].copy(h[g.a]),g.vertexNormals[1].copy(h[g.b]),g.vertexNormals[2].copy(h[g.c])):g instanceof THREE.Face4&&(g.vertexNormals[0].copy(h[g.a]),g.vertexNormals[1].copy(h[g.b]),g.vertexNormals[2].copy(h[g.c]),g.vertexNormals[3].copy(h[g.d]))}},computeTangents:function(){function w(g,h,i,k,l,m,n){S=g.vertices[h].position;U=g.vertices[i].position;Y=g.vertices[k].position;W=R[l];ab=R[m];af=R[n];ad=U.x-S.x;ae=Y.x-S.x;aa=U.y-S.y;ah=Y.y-S.y;ai=U.z-S.z;aj=Y.z-S.z;ak=ab.u-W.u;al=af.u-W.u;am=ab.v-W.v;E=af.v-W.v;M=1/(ak*E-al*am);V.set((E*ad-am*ae)*M,(E*aa-am*ah)*M,(E*ai-am*aj)*M);ac.set((ak*ae-al*ad)*M,(ak*ah-al*aa)*M,(ak*aj-al*ai)*M);y[h].addSelf(V);y[i].addSelf(V);y[k].addSelf(V);T[h].addSelf(ac);T[i].addSelf(ac);T[k].addSelf(ac)}var z,F,J,O,P,R,S,U,Y,W,ab,af,ad,ae,aa,ah,ai,aj,ak,al,am,E,M,G,y=[],T=[],V=new THREE.Vector3,ac=new THREE.Vector3,j=new THREE.Vector3,X=new THREE.Vector3,ag=new THREE.Vector3;for(z=0,F=this.vertices.length;z<F;z++){y[z]=new THREE.Vector3,T[z]=new THREE.Vector3}for(z=0,F=this.faces.length;z<F;z++){P=this.faces[z],R=this.faceVertexUvs[0][z],P instanceof THREE.Face3?w(this,P.a,P.b,P.c,0,1,2):P instanceof THREE.Face4&&(w(this,P.a,P.b,P.c,0,1,2),w(this,P.a,P.b,P.d,0,1,3))}var Z=["a","b","c","d"];for(z=0,F=this.faces.length;z<F;z++){P=this.faces[z];for(J=0;J<P.vertexNormals.length;J++){ag.copy(P.vertexNormals[J]),O=P[Z[J]],G=y[O],j.copy(G),j.subSelf(ag.multiplyScalar(ag.dot(G))).normalize(),X.cross(P.vertexNormals[J],G),O=X.dot(T[O]),O=0>O?-1:1,P.vertexTangents[J]=new THREE.Vector4(j.x,j.y,j.z,O)}}this.hasTangents=!0},computeBoundingBox:function(){if(0<this.vertices.length){var f;f=this.vertices[0].position;this.boundingBox?(this.boundingBox.min.copy(f),this.boundingBox.max.copy(f)):this.boundingBox={min:f.clone(),max:f.clone()};for(var g=this.boundingBox.min,h=this.boundingBox.max,i=1,j=this.vertices.length;i<j;i++){f=this.vertices[i].position;if(f.x<g.x){g.x=f.x}else{if(f.x>h.x){h.x=f.x}}if(f.y<g.y){g.y=f.y}else{if(f.y>h.y){h.y=f.y}}if(f.z<g.z){g.z=f.z}else{if(f.z>h.z){h.z=f.z}}}}},computeBoundingSphere:function(){for(var e,f=0,g=0,h=this.vertices.length;g<h;g++){e=this.vertices[g].position.length(),e>f&&(f=e)}this.boundingSphere={radius:f}},mergeVertices:function(){var h={},i=[],j=[],k,l=Math.pow(10,4),m,n;for(m=0,n=this.vertices.length;m<n;m++){k=this.vertices[m].position,k=[Math.round(k.x*l),Math.round(k.y*l),Math.round(k.z*l)].join("_"),void 0===h[k]?(h[k]=m,i.push(this.vertices[m]),j[m]=i.length-1):j[m]=j[h[k]]}for(m=0,n=this.faces.length;m<n;m++){if(h=this.faces[m],h instanceof THREE.Face3){h.a=j[h.a],h.b=j[h.b],h.c=j[h.c]}else{if(h instanceof THREE.Face4){h.a=j[h.a],h.b=j[h.b],h.c=j[h.c],h.d=j[h.d]}}}this.vertices=i}};THREE.GeometryCount=0;THREE.Spline=function(j){function m(h,i,k,l,n,q,A){h=0.5*(k-h);l=0.5*(l-i);return(2*(i-k)+h+l)*A+(-3*(i-k)-2*h-l)*q+h*n+i}this.points=j;var o=[],p={x:0,y:0,z:0},r,s,t,u,v,x,w,y,z;this.initFromArray=function(c){this.points=[];for(var d=0;d<c.length;d++){this.points[d]={x:c[d][0],y:c[d][1],z:c[d][2]}}};this.getPoint=function(b){r=(this.points.length-1)*b;s=Math.floor(r);t=r-s;o[0]=0===s?s:s-1;o[1]=s;o[2]=s>this.points.length-2?s:s+1;o[3]=s>this.points.length-3?s:s+2;x=this.points[o[0]];w=this.points[o[1]];y=this.points[o[2]];z=this.points[o[3]];u=t*t;v=t*u;p.x=m(x.x,w.x,y.x,z.x,t,u,v);p.y=m(x.y,w.y,y.y,z.y,t,u,v);p.z=m(x.z,w.z,y.z,z.z,t,u,v);return p};this.getControlPointsArray=function(){var e,f,g=this.points.length,h=[];for(e=0;e<g;e++){f=this.points[e],h[e]=[f.x,f.y,f.z]}return h};this.getLength=function(k){var l,n,q,A=l=l=0,B=new THREE.Vector3,C=new THREE.Vector3,D=[],E=0;D[0]=0;k||(k=100);n=this.points.length*k;B.copy(this.points[0]);for(k=1;k<n;k++){l=k/n,q=this.getPoint(l),C.copy(q),E+=C.distanceTo(B),B.copy(q),l*=this.points.length-1,l=Math.floor(l),l!=A&&(D[l]=E,A=l)}D[D.length]=E;return{chunks:D,total:E}};this.reparametrizeByArcLength=function(k){var n,q,A,B,C,D,E=[],F=new THREE.Vector3,G=this.getLength();E.push(F.copy(this.points[0]).clone());for(n=1;n<this.points.length;n++){q=G.chunks[n]-G.chunks[n-1];D=Math.ceil(k*q/G.total);B=(n-1)/(this.points.length-1);C=n/(this.points.length-1);for(q=1;q<D-1;q++){A=B+q*(1/D)*(C-B),A=this.getPoint(A),E.push(F.copy(A).clone())}E.push(F.copy(this.points[n]).clone())}this.points=E}};THREE.Edge=function(e,f,g,h){this.vertices=[e,f];this.vertexIndices=[g,h];this.faces=[];this.faceIndices=[]};THREE.Camera=function(){if(arguments.length){return console.warn("DEPRECATED: Camera() is now PerspectiveCamera() or OrthographicCamera()."),new THREE.PerspectiveCamera(arguments[0],arguments[1],arguments[2],arguments[3])}THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=new THREE.Object3D;THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.lookAt=function(b){this.matrix.lookAt(this.position,b,this.up);this.rotationAutoUpdate&&this.rotation.setRotationFromMatrix(this.matrix)};THREE.OrthographicCamera=function(g,h,i,j,k,l){THREE.Camera.call(this);this.left=g;this.right=h;this.top=i;this.bottom=j;this.near=void 0!==k?k:0.1;this.far=void 0!==l?l:2000;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=new THREE.Camera;THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix=THREE.Matrix4.makeOrtho(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.PerspectiveCamera=function(e,f,g,h){THREE.Camera.call(this);this.fov=void 0!==e?e:50;this.aspect=void 0!==f?f:1;this.near=void 0!==g?g:0.1;this.far=void 0!==h?h:2000;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=new THREE.Camera;THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;THREE.PerspectiveCamera.prototype.setLens=function(c,d){this.fov=2*Math.atan((void 0!==d?d:43.25)/(2*c));this.fov*=180/Math.PI;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(g,h,i,j,k,l){this.fullWidth=g;this.fullHeight=h;this.x=i;this.y=j;this.width=k;this.height=l;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var e=this.fullWidth/this.fullHeight,f=Math.tan(this.fov*Math.PI/360)*this.near,g=-f,h=e*g,e=Math.abs(e*f-h),g=Math.abs(f-g);this.projectionMatrix=THREE.Matrix4.makeFrustum(h+this.x*e/this.fullWidth,h+(this.x+this.width)*e/this.fullWidth,f-(this.y+this.height)*g/this.fullHeight,f-this.y*g/this.fullHeight,this.near,this.far)}else{this.projectionMatrix=THREE.Matrix4.makePerspective(this.fov,this.aspect,this.near,this.far)}};THREE.Light=function(b){THREE.Object3D.call(this);this.color=new THREE.Color(b)};THREE.Light.prototype=new THREE.Object3D;THREE.Light.prototype.constructor=THREE.Light;THREE.Light.prototype.supr=THREE.Object3D.prototype;THREE.AmbientLight=function(b){THREE.Light.call(this,b)};THREE.AmbientLight.prototype=new THREE.Light;THREE.AmbientLight.prototype.constructor=THREE.AmbientLight;THREE.DirectionalLight=function(d,e,f){THREE.Light.call(this,d);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==e?e:1;this.distance=void 0!==f?f:0;this.onlyShadow=this.castShadow=!1;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=new THREE.Light;THREE.DirectionalLight.prototype.constructor=THREE.DirectionalLight;THREE.PointLight=function(d,e,f){THREE.Light.call(this,d);this.position=new THREE.Vector3(0,0,0);this.intensity=void 0!==e?e:1;this.distance=void 0!==f?f:0};THREE.PointLight.prototype=new THREE.Light;THREE.PointLight.prototype.constructor=THREE.PointLight;THREE.SpotLight=function(e,f,g,h){THREE.Light.call(this,e);this.position=new THREE.Vector3(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==f?f:1;this.distance=void 0!==g?g:0;this.castShadow=void 0!==h?h:!1;this.onlyShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.SpotLight.prototype=new THREE.Light;THREE.SpotLight.prototype.constructor=THREE.SpotLight;THREE.Material=function(b){b=b||{};this.name="";this.id=THREE.MaterialCount++;this.opacity=void 0!==b.opacity?b.opacity:1;this.transparent=void 0!==b.transparent?b.transparent:!1;this.blending=void 0!==b.blending?b.blending:THREE.NormalBlending;this.depthTest=void 0!==b.depthTest?b.depthTest:!0;this.depthWrite=void 0!==b.depthWrite?b.depthWrite:!0;this.polygonOffset=void 0!==b.polygonOffset?b.polygonOffset:!1;this.polygonOffsetFactor=void 0!==b.polygonOffsetFactor?b.polygonOffsetFactor:0;this.polygonOffsetUnits=void 0!==b.polygonOffsetUnits?b.polygonOffsetUnits:0;this.alphaTest=void 0!==b.alphaTest?b.alphaTest:0;this.overdraw=void 0!==b.overdraw?b.overdraw:!1};THREE.MaterialCount=0;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NormalBlending=0;THREE.AdditiveBlending=1;THREE.SubtractiveBlending=2;THREE.MultiplyBlending=3;THREE.AdditiveAlphaBlending=4;THREE.LineBasicMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.linewidth=void 0!==b.linewidth?b.linewidth:1;this.linecap=void 0!==b.linecap?b.linecap:"round";this.linejoin=void 0!==b.linejoin?b.linejoin:"round";this.vertexColors=b.vertexColors?b.vertexColors:!1;this.fog=void 0!==b.fog?b.fog:!0};THREE.LineBasicMaterial.prototype=new THREE.Material;THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;THREE.MeshBasicMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.map=void 0!==b.map?b.map:null;this.lightMap=void 0!==b.lightMap?b.lightMap:null;this.envMap=void 0!==b.envMap?b.envMap:null;this.combine=void 0!==b.combine?b.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==b.reflectivity?b.reflectivity:1;this.refractionRatio=void 0!==b.refractionRatio?b.refractionRatio:0.98;this.fog=void 0!==b.fog?b.fog:!0;this.shading=void 0!==b.shading?b.shading:THREE.SmoothShading;this.wireframe=void 0!==b.wireframe?b.wireframe:!1;this.wireframeLinewidth=void 0!==b.wireframeLinewidth?b.wireframeLinewidth:1;this.wireframeLinecap=void 0!==b.wireframeLinecap?b.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==b.wireframeLinejoin?b.wireframeLinejoin:"round";this.vertexColors=void 0!==b.vertexColors?b.vertexColors:!1;this.skinning=void 0!==b.skinning?b.skinning:!1;this.morphTargets=void 0!==b.morphTargets?b.morphTargets:!1};THREE.MeshBasicMaterial.prototype=new THREE.Material;THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;THREE.MeshLambertMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.ambient=void 0!==b.ambient?new THREE.Color(b.ambient):new THREE.Color(328965);this.wrapAround=void 0!==b.wrapAround?b.wrapAround:!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=void 0!==b.map?b.map:null;this.lightMap=void 0!==b.lightMap?b.lightMap:null;this.envMap=void 0!==b.envMap?b.envMap:null;this.combine=void 0!==b.combine?b.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==b.reflectivity?b.reflectivity:1;this.refractionRatio=void 0!==b.refractionRatio?b.refractionRatio:0.98;this.fog=void 0!==b.fog?b.fog:!0;this.shading=void 0!==b.shading?b.shading:THREE.SmoothShading;this.wireframe=void 0!==b.wireframe?b.wireframe:!1;this.wireframeLinewidth=void 0!==b.wireframeLinewidth?b.wireframeLinewidth:1;this.wireframeLinecap=void 0!==b.wireframeLinecap?b.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==b.wireframeLinejoin?b.wireframeLinejoin:"round";this.vertexColors=void 0!==b.vertexColors?b.vertexColors:!1;this.skinning=void 0!==b.skinning?b.skinning:!1;this.morphTargets=void 0!==b.morphTargets?b.morphTargets:!1};THREE.MeshLambertMaterial.prototype=new THREE.Material;THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;THREE.MeshPhongMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.ambient=void 0!==b.ambient?new THREE.Color(b.ambient):new THREE.Color(328965);this.specular=void 0!==b.specular?new THREE.Color(b.specular):new THREE.Color(1118481);this.shininess=void 0!==b.shininess?b.shininess:30;this.metal=void 0!==b.metal?b.metal:!1;this.perPixel=void 0!==b.perPixel?b.perPixel:!1;this.wrapAround=void 0!==b.wrapAround?b.wrapAround:!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=void 0!==b.map?b.map:null;this.lightMap=void 0!==b.lightMap?b.lightMap:null;this.envMap=void 0!==b.envMap?b.envMap:null;this.combine=void 0!==b.combine?b.combine:THREE.MultiplyOperation;this.reflectivity=void 0!==b.reflectivity?b.reflectivity:1;this.refractionRatio=void 0!==b.refractionRatio?b.refractionRatio:0.98;this.fog=void 0!==b.fog?b.fog:!0;this.shading=void 0!==b.shading?b.shading:THREE.SmoothShading;this.wireframe=void 0!==b.wireframe?b.wireframe:!1;this.wireframeLinewidth=void 0!==b.wireframeLinewidth?b.wireframeLinewidth:1;this.wireframeLinecap=void 0!==b.wireframeLinecap?b.wireframeLinecap:"round";this.wireframeLinejoin=void 0!==b.wireframeLinejoin?b.wireframeLinejoin:"round";this.vertexColors=void 0!==b.vertexColors?b.vertexColors:!1;this.skinning=void 0!==b.skinning?b.skinning:!1;this.morphTargets=void 0!==b.morphTargets?b.morphTargets:!1};THREE.MeshPhongMaterial.prototype=new THREE.Material;THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;THREE.MeshDepthMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.shading=void 0!==b.shading?b.shading:THREE.SmoothShading;this.wireframe=void 0!==b.wireframe?b.wireframe:!1;this.wireframeLinewidth=void 0!==b.wireframeLinewidth?b.wireframeLinewidth:1};THREE.MeshDepthMaterial.prototype=new THREE.Material;THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;THREE.MeshNormalMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.shading=b.shading?b.shading:THREE.FlatShading;this.wireframe=b.wireframe?b.wireframe:!1;this.wireframeLinewidth=b.wireframeLinewidth?b.wireframeLinewidth:1};THREE.MeshNormalMaterial.prototype=new THREE.Material;THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;THREE.MeshFaceMaterial=function(){};THREE.MeshShaderMaterial=function(b){console.warn("DEPRECATED: MeshShaderMaterial() is now ShaderMaterial().");return new THREE.ShaderMaterial(b)};THREE.ParticleBasicMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.map=void 0!==b.map?b.map:null;this.size=void 0!==b.size?b.size:1;this.sizeAttenuation=void 0!==b.sizeAttenuation?b.sizeAttenuation:!0;this.vertexColors=void 0!==b.vertexColors?b.vertexColors:!1;this.fog=void 0!==b.fog?b.fog:!0};THREE.ParticleBasicMaterial.prototype=new THREE.Material;THREE.ParticleBasicMaterial.prototype.constructor=THREE.ParticleBasicMaterial;THREE.ParticleCanvasMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.program=void 0!==b.program?b.program:function(){}};THREE.ParticleCanvasMaterial.prototype=new THREE.Material;THREE.ParticleCanvasMaterial.prototype.constructor=THREE.ParticleCanvasMaterial;THREE.ParticleDOMMaterial=function(b){THREE.Material.call(this);this.domElement=b};THREE.ShaderMaterial=function(b){THREE.Material.call(this,b);b=b||{};this.fragmentShader=void 0!==b.fragmentShader?b.fragmentShader:"void main() {}";this.vertexShader=void 0!==b.vertexShader?b.vertexShader:"void main() {}";this.uniforms=void 0!==b.uniforms?b.uniforms:{};this.attributes=b.attributes;this.shading=void 0!==b.shading?b.shading:THREE.SmoothShading;this.wireframe=void 0!==b.wireframe?b.wireframe:!1;this.wireframeLinewidth=void 0!==b.wireframeLinewidth?b.wireframeLinewidth:1;this.fog=void 0!==b.fog?b.fog:!1;this.lights=void 0!==b.lights?b.lights:!1;this.vertexColors=void 0!==b.vertexColors?b.vertexColors:!1;this.skinning=void 0!==b.skinning?b.skinning:!1;this.morphTargets=void 0!==b.morphTargets?b.morphTargets:!1};THREE.ShaderMaterial.prototype=new THREE.Material;THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;THREE.Texture=function(i,j,k,l,m,n,o,p){this.id=THREE.TextureCount++;this.image=i;this.mapping=void 0!==j?j:new THREE.UVMapping;this.wrapS=void 0!==k?k:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==l?l:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==m?m:THREE.LinearFilter;this.minFilter=void 0!==n?n:THREE.LinearMipMapLinearFilter;this.format=void 0!==o?o:THREE.RGBAFormat;this.type=void 0!==p?p:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.needsUpdate=!1;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(){var b=new THREE.Texture(this.image,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter,this.format,this.type);b.offset.copy(this.offset);b.repeat.copy(this.repeat);return b}};THREE.TextureCount=0;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.LatitudeReflectionMapping=function(){};THREE.LatitudeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.UVMapping=function(){};THREE.RepeatWrapping=0;THREE.ClampToEdgeWrapping=1;THREE.MirroredRepeatWrapping=2;THREE.NearestFilter=3;THREE.NearestMipMapNearestFilter=4;THREE.NearestMipMapLinearFilter=5;THREE.LinearFilter=6;THREE.LinearMipMapNearestFilter=7;THREE.LinearMipMapLinearFilter=8;THREE.ByteType=9;THREE.UnsignedByteType=10;THREE.ShortType=11;THREE.UnsignedShortType=12;THREE.IntType=13;THREE.UnsignedIntType=14;THREE.FloatType=15;THREE.AlphaFormat=16;THREE.RGBFormat=17;THREE.RGBAFormat=18;THREE.LuminanceFormat=19;THREE.LuminanceAlphaFormat=20;THREE.DataTexture=function(j,k,m,n,o,p,q,r,s,t){THREE.Texture.call(this,null,p,q,r,s,t,n,o);this.image={data:j,width:k,height:m}};THREE.DataTexture.prototype=new THREE.Texture;THREE.DataTexture.prototype.constructor=THREE.DataTexture;THREE.DataTexture.prototype.clone=function(){var b=new THREE.DataTexture(this.image.data,this.image.width,this.image.height,this.format,this.type,this.mapping,this.wrapS,this.wrapT,this.magFilter,this.minFilter);b.offset.copy(this.offset);b.repeat.copy(this.repeat);return b};THREE.Particle=function(b){THREE.Object3D.call(this);this.material=b};THREE.Particle.prototype=new THREE.Object3D;THREE.Particle.prototype.constructor=THREE.Particle;THREE.ParticleSystem=function(c,d){THREE.Object3D.call(this);this.geometry=c;this.material=d;this.sortParticles=!1;if(this.geometry){this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=c.boundingSphere.radius}this.frustumCulled=!1};THREE.ParticleSystem.prototype=new THREE.Object3D;THREE.ParticleSystem.prototype.constructor=THREE.ParticleSystem;THREE.Line=function(d,e,f){THREE.Object3D.call(this);this.geometry=d;this.material=e;this.type=void 0!==f?f:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=new THREE.Object3D;THREE.Line.prototype.constructor=THREE.Line;THREE.Mesh=function(d,e){THREE.Object3D.call(this);this.geometry=d;this.material=e;if(e instanceof Array){console.warn("DEPRECATED: Mesh material can no longer be an Array. Using material at index 0..."),this.material=e[0]}if(this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere(),this.boundRadius=d.boundingSphere.radius,this.geometry.morphTargets.length)){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var f=0;f<this.geometry.morphTargets.length;f++){this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[f].name]=f}}};THREE.Mesh.prototype=new THREE.Object3D;THREE.Mesh.prototype.constructor=THREE.Mesh;THREE.Mesh.prototype.supr=THREE.Object3D.prototype;THREE.Mesh.prototype.getMorphTargetIndexByName=function(b){if(void 0!==this.morphTargetDictionary[b]){return this.morphTargetDictionary[b]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+b+" does not exist. Returning 0.");return 0};THREE.Bone=function(b){THREE.Object3D.call(this);this.skin=b;this.skinMatrix=new THREE.Matrix4};THREE.Bone.prototype=new THREE.Object3D;THREE.Bone.prototype.constructor=THREE.Bone;THREE.Bone.prototype.supr=THREE.Object3D.prototype;THREE.Bone.prototype.update=function(e,f){this.matrixAutoUpdate&&(f|=this.updateMatrix());if(f||this.matrixWorldNeedsUpdate){e?this.skinMatrix.multiply(e,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,f=!0}var g,h=this.children.length;for(g=0;g<h;g++){this.children[g].update(this.skinMatrix,f)}};THREE.SkinnedMesh=function(i,j){THREE.Mesh.call(this,i,j);this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var k,l,m,n,o,p;if(void 0!==this.geometry.bones){for(k=0;k<this.geometry.bones.length;k++){m=this.geometry.bones[k],n=m.pos,o=m.rotq,p=m.scl,l=this.addBone(),l.name=m.name,l.position.set(n[0],n[1],n[2]),l.quaternion.set(o[0],o[1],o[2],o[3]),l.useQuaternion=!0,void 0!==p?l.scale.set(p[0],p[1],p[2]):l.scale.set(1,1,1)}for(k=0;k<this.bones.length;k++){m=this.geometry.bones[k],l=this.bones[k],-1===m.parent?this.add(l):this.bones[m.parent].add(l)}this.boneMatrices=new Float32Array(16*this.bones.length);this.pose()}};THREE.SkinnedMesh.prototype=new THREE.Mesh;THREE.SkinnedMesh.prototype.constructor=THREE.SkinnedMesh;THREE.SkinnedMesh.prototype.addBone=function(b){void 0===b&&(b=new THREE.Bone(this));this.bones.push(b);return b};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(e){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||e){this.parent?this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1}for(var e=0,f=this.children.length;e<f;e++){var g=this.children[e];g instanceof THREE.Bone?g.update(this.identityMatrix,!1):g.updateMatrixWorld(!0)}for(var f=this.bones.length,g=this.bones,h=this.boneMatrices,e=0;e<f;e++){g[e].skinMatrix.flattenToArrayOffset(h,16*e)}};THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var g,h=[],i=0;i<this.bones.length;i++){g=this.bones[i];var j=new THREE.Matrix4;j.getInverse(g.skinMatrix);h.push(j);g.skinMatrix.flattenToArrayOffset(this.boneMatrices,16*i)}if(void 0===this.geometry.skinVerticesA){this.geometry.skinVerticesA=[];this.geometry.skinVerticesB=[];for(g=0;g<this.geometry.skinIndices.length;g++){var i=this.geometry.vertices[g].position,k=this.geometry.skinIndices[g].x,l=this.geometry.skinIndices[g].y,j=new THREE.Vector3(i.x,i.y,i.z);this.geometry.skinVerticesA.push(h[k].multiplyVector3(j));j=new THREE.Vector3(i.x,i.y,i.z);this.geometry.skinVerticesB.push(h[l].multiplyVector3(j));1!==this.geometry.skinWeights[g].x+this.geometry.skinWeights[g].y&&(i=0.5*(1-(this.geometry.skinWeights[g].x+this.geometry.skinWeights[g].y)),this.geometry.skinWeights[g].x+=i,this.geometry.skinWeights[g].y+=i)}}};THREE.MorphAnimMesh=function(c,d){THREE.Mesh.call(this,c,d);this.duration=1000;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype=new THREE.Mesh;THREE.MorphAnimMesh.prototype.constructor=THREE.MorphAnimMesh;THREE.MorphAnimMesh.prototype.updateAnimation=function(c){var d=this.duration/(this.geometry.morphTargets.length-1);this.time+=this.direction*c;if(this.mirroredLoop){if(this.time>this.duration||0>this.time){this.direction*=-1;if(this.time>this.duration){this.time=this.duration,this.directionBackwards=!0}if(0>this.time){this.time=0,this.directionBackwards=!1}}}else{this.time%=this.duration}c=THREE.Math.clamp(Math.floor(this.time/d),0,this.geometry.morphTargets.length-1);if(c!=this.currentKeyframe){this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[c]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=c}d=this.time%d/d;this.directionBackwards&&(d=1-d);this.morphTargetInfluences[this.currentKeyframe]=d;this.morphTargetInfluences[this.lastKeyframe]=1-d};THREE.Ribbon=function(c,d){THREE.Object3D.call(this);this.geometry=c;this.material=d};THREE.Ribbon.prototype=new THREE.Object3D;THREE.Ribbon.prototype.constructor=THREE.Ribbon;THREE.LOD=function(){THREE.Object3D.call(this);this.LODs=[]};THREE.LOD.prototype=new THREE.Object3D;THREE.LOD.prototype.constructor=THREE.LOD;THREE.LOD.prototype.supr=THREE.Object3D.prototype;THREE.LOD.prototype.addLevel=function(d,e){void 0===e&&(e=0);for(var e=Math.abs(e),f=0;f<this.LODs.length&&!(e<this.LODs[f].visibleAtDistance);f++){}this.LODs.splice(f,0,{visibleAtDistance:e,object3D:d});this.add(d)};THREE.LOD.prototype.update=function(c){if(1<this.LODs.length){c.matrixWorldInverse.getInverse(c.matrixWorld);c=c.matrixWorldInverse;c=-(c.n31*this.position.x+c.n32*this.position.y+c.n33*this.position.z+c.n34);this.LODs[0].object3D.visible=!0;for(var d=1;d<this.LODs.length;d++){if(c>=this.LODs[d].visibleAtDistance){this.LODs[d-1].object3D.visible=!1,this.LODs[d].object3D.visible=!0}else{break}}for(;d<this.LODs.length;d++){this.LODs[d].object3D.visible=!1}}};THREE.Sprite=function(b){THREE.Object3D.call(this);this.color=void 0!==b.color?new THREE.Color(b.color):new THREE.Color(16777215);this.map=void 0!==b.map?b.map:new THREE.Texture;this.blending=void 0!==b.blending?b.blending:THREE.NormalBlending;this.useScreenCoordinates=void 0!==b.useScreenCoordinates?b.useScreenCoordinates:!0;this.mergeWith3D=void 0!==b.mergeWith3D?b.mergeWith3D:!this.useScreenCoordinates;this.affectedByDistance=void 0!==b.affectedByDistance?b.affectedByDistance:!this.useScreenCoordinates;this.scaleByViewport=void 0!==b.scaleByViewport?b.scaleByViewport:!this.affectedByDistance;this.alignment=b.alignment instanceof THREE.Vector2?b.alignment:THREE.SpriteAlignment.center;this.rotation3d=this.rotation;this.rotation=0;this.opacity=1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1)};THREE.Sprite.prototype=new THREE.Object3D;THREE.Sprite.prototype.constructor=THREE.Sprite;THREE.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);if(1!==this.scale.x||1!==this.scale.y){this.matrix.scale(this.scale),this.boundRadiusScale=Math.max(this.scale.x,this.scale.y)}this.matrixWorldNeedsUpdate=!0};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.matrixAutoUpdate=!1;this.objects=[];this.lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=new THREE.Object3D;THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.addObject=function(c){if(c instanceof THREE.Light){-1===this.lights.indexOf(c)&&this.lights.push(c)}else{if(!(c instanceof THREE.Camera||c instanceof THREE.Bone)&&-1===this.objects.indexOf(c)){this.objects.push(c);this.__objectsAdded.push(c);var d=this.__objectsRemoved.indexOf(c);-1!==d&&this.__objectsRemoved.splice(d,1)}}for(d=0;d<c.children.length;d++){this.addObject(c.children[d])}};THREE.Scene.prototype.removeObject=function(c){if(c instanceof THREE.Light){var d=this.lights.indexOf(c);-1!==d&&this.lights.splice(d,1)}else{c instanceof THREE.Camera||(d=this.objects.indexOf(c),-1!==d&&(this.objects.splice(d,1),this.__objectsRemoved.push(c),d=this.__objectsAdded.indexOf(c),-1!==d&&this.__objectsAdded.splice(d,1)))}for(d=0;d<c.children.length;d++){this.removeObject(c.children[d])}};THREE.Fog=function(d,e,f){this.color=new THREE.Color(d);this.near=void 0!==e?e:1;this.far=void 0!==f?f:1000};THREE.FogExp2=function(c,d){this.color=new THREE.Color(c);this.density=void 0!==d?d:0.00025};THREE.DOMRenderer=function(){var g=null,h=new THREE.Projector,i,j,k,l;this.domElement=document.createElement("div");this.setSize=function(c,d){i=c;j=d;k=i/2;l=j/2};this.render=function(a,b){var e,r,f,t,w,u,v,s;g=h.projectScene(a,b);for(e=0,r=g.length;e<r;e++){if(w=g[e],w instanceof THREE.RenderableParticle){v=w.x*k+k;s=w.y*l+l;for(f=0,t=w.material.length;f<t;f++){if(u=w.material[f],u instanceof THREE.ParticleDOMMaterial){u=u.domElement,u.style.left=v+"px",u.style.top=s+"px"}}}}}};THREE.CanvasRenderer=function(F){function Y(b){if(a1!=b){aM.globalAlpha=a1=b}}function ac(b){if(a4!=b){switch(b){case THREE.NormalBlending:aM.globalCompositeOperation="source-over";break;case THREE.AdditiveBlending:aM.globalCompositeOperation="lighter";break;case THREE.SubtractiveBlending:aM.globalCompositeOperation="darker"}a4=b}}function af(b){if(a6!=b){aM.strokeStyle=a6=b}}function ak(b){if(bb!=b){aM.fillStyle=bb=b}}var F=F||{},ao=this,ap,au,ay,aJ=new THREE.Projector,aF=void 0!==F.canvas?F.canvas:document.createElement("canvas"),aN,aT,aP,aR,aM=aF.getContext("2d"),aW=new THREE.Color(0),aZ=0,a1=1,a4=0,a6=null,bb=null,Z=null,ag=null,ad=null,J,av,az,aO,w=new THREE.RenderableVertex,aG=new THREE.RenderableVertex,aU,aK,aq,aC,a8,bd,al,a0,a2,aX,aH,ar,a7=new THREE.Color,aa=new THREE.Color,ae=new THREE.Color,ah=new THREE.Color,aw=new THREE.Color,aV=[],aL=[],be,U,aE,ai,z,a3,aA,aj,a9,bc,aY=new THREE.Rectangle,ab=new THREE.Rectangle,aD=new THREE.Rectangle,X=!1,M=new THREE.Color,aS=new THREE.Color,aQ=new THREE.Color,am=new THREE.Vector3,at,ax,aI,an,aB,a5,F=16;at=document.createElement("canvas");at.width=at.height=2;ax=at.getContext("2d");ax.fillStyle="rgba(0,0,0,1)";ax.fillRect(0,0,2,2);aI=ax.getImageData(0,0,2,2);an=aI.data;aB=document.createElement("canvas");aB.width=aB.height=F;a5=aB.getContext("2d");a5.translate(-F/2,-F/2);a5.scale(F,F);F--;this.domElement=aF;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.setSize=function(c,d){aN=c;aT=d;aP=Math.floor(aN/2);aR=Math.floor(aT/2);aF.width=aN;aF.height=aT;aY.set(-aP,-aR,aP,aR);ab.set(-aP,-aR,aP,aR);a1=1;a4=0;ad=ag=Z=bb=a6=null};this.setClearColor=function(c,d){aW.copy(c);aZ=d;ab.set(-aP,-aR,aP,aR)};this.setClearColorHex=function(c,d){aW.setHex(c);aZ=d;ab.set(-aP,-aR,aP,aR)};this.clear=function(){aM.setTransform(1,0,0,-1,aP,aR);ab.isEmpty()||(ab.minSelf(aY),ab.inflate(2),1>aZ&&aM.clearRect(Math.floor(ab.getX()),Math.floor(ab.getY()),Math.floor(ab.getWidth()),Math.floor(ab.getHeight())),0<aZ&&(ac(THREE.NormalBlending),Y(1),ak("rgba("+Math.floor(255*aW.r)+","+Math.floor(255*aW.g)+","+Math.floor(255*aW.b)+","+aZ+")"),aM.fillRect(Math.floor(ab.getX()),Math.floor(ab.getY()),Math.floor(ab.getWidth()),Math.floor(ab.getHeight()))),ab.empty())};this.render=function(b,g){function l(k){var n,q,r,s;M.setRGB(0,0,0);aS.setRGB(0,0,0);aQ.setRGB(0,0,0);for(n=0,q=k.length;n<q;n++){r=k[n],s=r.color,r instanceof THREE.AmbientLight?(M.r+=s.r,M.g+=s.g,M.b+=s.b):r instanceof THREE.DirectionalLight?(aS.r+=s.r,aS.g+=s.g,aS.b+=s.b):r instanceof THREE.PointLight&&(aQ.r+=s.r,aQ.g+=s.g,aQ.b+=s.b)}}function i(k,q,r,s){var t,u,v,n,K,x;for(t=0,u=k.length;t<u;t++){v=k[t],n=v.color,v instanceof THREE.DirectionalLight?(K=v.matrixWorld.getPosition(),x=r.dot(K),0>=x||(x*=v.intensity,s.r+=n.r*x,s.g+=n.g*x,s.b+=n.b*x)):v instanceof THREE.PointLight&&(K=v.matrixWorld.getPosition(),x=r.dot(am.sub(K,q).normalize()),0>=x||(x*=0==v.distance?1:1-Math.min(q.distanceTo(K)/v.distance,1),0!=x&&(x*=v.intensity,s.r+=n.r*x,s.g+=n.g*x,s.b+=n.b*x)))}}function m(n,r,s){Y(s.opacity);ac(s.blending);var q,v,t,u,K,x;if(s instanceof THREE.ParticleBasicMaterial){if(s.map){u=s.map.image,K=u.width>>1,x=u.height>>1,s=r.scale.x*aP,t=r.scale.y*aR,q=s*K,v=t*x,aD.set(n.x-q,n.y-v,n.x+q,n.y+v),aY.intersects(aD)&&(aM.save(),aM.translate(n.x,n.y),aM.rotate(-r.rotation),aM.scale(s,-t),aM.translate(-K,-x),aM.drawImage(u,0,0),aM.restore())}}else{s instanceof THREE.ParticleCanvasMaterial&&(q=r.scale.x*aP,v=r.scale.y*aR,aD.set(n.x-q,n.y-v,n.x+q,n.y+v),aY.intersects(aD)&&(af(s.color.getContextStyle()),ak(s.color.getContextStyle()),aM.save(),aM.translate(n.x,n.y),aM.rotate(-r.rotation),aM.scale(q,v),s.program(aM),aM.restore()))}}function o(k,n,q,r){Y(r.opacity);ac(r.blending);aM.beginPath();aM.moveTo(k.positionScreen.x,k.positionScreen.y);aM.lineTo(n.positionScreen.x,n.positionScreen.y);aM.closePath();if(r instanceof THREE.LineBasicMaterial){k=r.linewidth;if(Z!=k){aM.lineWidth=Z=k}k=r.linecap;if(ag!=k){aM.lineCap=ag=k}k=r.linejoin;if(ad!=k){aM.lineJoin=ad=k}af(r.color.getContextStyle());aM.stroke();aD.inflate(2*r.linewidth)}}function p(k,n,q,r,s,t,v,u){ao.info.render.vertices+=3;ao.info.render.faces++;Y(u.opacity);ac(u.blending);aU=k.positionScreen.x;aK=k.positionScreen.y;aq=n.positionScreen.x;aC=n.positionScreen.y;a8=q.positionScreen.x;bd=q.positionScreen.y;B(aU,aK,aq,aC,a8,bd);if(u instanceof THREE.MeshBasicMaterial){if(u.map){u.map.mapping instanceof THREE.UVMapping&&(ai=v.uvs[0],h(aU,aK,aq,aC,a8,bd,ai[r].u,ai[r].v,ai[s].u,ai[s].v,ai[t].u,ai[t].v,u.map))}else{if(u.envMap){if(u.envMap.mapping instanceof THREE.SphericalReflectionMapping){k=g.matrixWorldInverse,am.copy(v.vertexNormalsWorld[r]),z=0.5*(am.x*k.n11+am.y*k.n12+am.z*k.n13)+0.5,a3=0.5*-(am.x*k.n21+am.y*k.n22+am.z*k.n23)+0.5,am.copy(v.vertexNormalsWorld[s]),aA=0.5*(am.x*k.n11+am.y*k.n12+am.z*k.n13)+0.5,aj=0.5*-(am.x*k.n21+am.y*k.n22+am.z*k.n23)+0.5,am.copy(v.vertexNormalsWorld[t]),a9=0.5*(am.x*k.n11+am.y*k.n12+am.z*k.n13)+0.5,bc=0.5*-(am.x*k.n21+am.y*k.n22+am.z*k.n23)+0.5,h(aU,aK,aq,aC,a8,bd,z,a3,aA,aj,a9,bc,u.envMap)}}else{u.wireframe?d(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):c(u.color)}}}else{if(u instanceof THREE.MeshLambertMaterial){u.map&&!u.wireframe&&(u.map.mapping instanceof THREE.UVMapping&&(ai=v.uvs[0],h(aU,aK,aq,aC,a8,bd,ai[r].u,ai[r].v,ai[s].u,ai[s].v,ai[t].u,ai[t].v,u.map)),ac(THREE.SubtractiveBlending)),X?!u.wireframe&&u.shading==THREE.SmoothShading&&3==v.vertexNormalsWorld.length?(aa.r=ae.r=ah.r=M.r,aa.g=ae.g=ah.g=M.g,aa.b=ae.b=ah.b=M.b,i(ay,v.v1.positionWorld,v.vertexNormalsWorld[0],aa),i(ay,v.v2.positionWorld,v.vertexNormalsWorld[1],ae),i(ay,v.v3.positionWorld,v.vertexNormalsWorld[2],ah),aa.r=Math.max(0,Math.min(u.color.r*aa.r,1)),aa.g=Math.max(0,Math.min(u.color.g*aa.g,1)),aa.b=Math.max(0,Math.min(u.color.b*aa.b,1)),ae.r=Math.max(0,Math.min(u.color.r*ae.r,1)),ae.g=Math.max(0,Math.min(u.color.g*ae.g,1)),ae.b=Math.max(0,Math.min(u.color.b*ae.b,1)),ah.r=Math.max(0,Math.min(u.color.r*ah.r,1)),ah.g=Math.max(0,Math.min(u.color.g*ah.g,1)),ah.b=Math.max(0,Math.min(u.color.b*ah.b,1)),aw.r=0.5*(ae.r+ah.r),aw.g=0.5*(ae.g+ah.g),aw.b=0.5*(ae.b+ah.b),aE=C(aa,ae,ah,aw),H(aU,aK,aq,aC,a8,bd,0,0,1,0,0,1,aE)):(a7.r=M.r,a7.g=M.g,a7.b=M.b,i(ay,v.centroidWorld,v.normalWorld,a7),a7.r=Math.max(0,Math.min(u.color.r*a7.r,1)),a7.g=Math.max(0,Math.min(u.color.g*a7.g,1)),a7.b=Math.max(0,Math.min(u.color.b*a7.b,1)),u.wireframe?d(a7,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):c(a7)):u.wireframe?d(u.color,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):c(u.color)}else{if(u instanceof THREE.MeshDepthMaterial){be=g.near,U=g.far,aa.r=aa.g=aa.b=1-y(k.positionScreen.z,be,U),ae.r=ae.g=ae.b=1-y(n.positionScreen.z,be,U),ah.r=ah.g=ah.b=1-y(q.positionScreen.z,be,U),aw.r=0.5*(ae.r+ah.r),aw.g=0.5*(ae.g+ah.g),aw.b=0.5*(ae.b+ah.b),aE=C(aa,ae,ah,aw),H(aU,aK,aq,aC,a8,bd,0,0,1,0,0,1,aE)}else{if(u instanceof THREE.MeshNormalMaterial){a7.r=I(v.normalWorld.x),a7.g=I(v.normalWorld.y),a7.b=I(v.normalWorld.z),u.wireframe?d(a7,u.wireframeLinewidth,u.wireframeLinecap,u.wireframeLinejoin):c(a7)}}}}}function A(k,n,q,r,s,v,t,x,u){ao.info.render.vertices+=4;ao.info.render.faces++;Y(x.opacity);ac(x.blending);if(x.map||x.envMap){p(k,n,r,0,1,3,t,x,u),p(s,q,v,1,2,3,t,x,u)}else{if(aU=k.positionScreen.x,aK=k.positionScreen.y,aq=n.positionScreen.x,aC=n.positionScreen.y,a8=q.positionScreen.x,bd=q.positionScreen.y,al=r.positionScreen.x,a0=r.positionScreen.y,a2=s.positionScreen.x,aX=s.positionScreen.y,aH=v.positionScreen.x,ar=v.positionScreen.y,x instanceof THREE.MeshBasicMaterial){G(aU,aK,aq,aC,a8,bd,al,a0),x.wireframe?d(x.color,x.wireframeLinewidth,x.wireframeLinecap,x.wireframeLinejoin):c(x.color)}else{if(x instanceof THREE.MeshLambertMaterial){X?!x.wireframe&&x.shading==THREE.SmoothShading&&4==t.vertexNormalsWorld.length?(aa.r=ae.r=ah.r=aw.r=M.r,aa.g=ae.g=ah.g=aw.g=M.g,aa.b=ae.b=ah.b=aw.b=M.b,i(ay,t.v1.positionWorld,t.vertexNormalsWorld[0],aa),i(ay,t.v2.positionWorld,t.vertexNormalsWorld[1],ae),i(ay,t.v4.positionWorld,t.vertexNormalsWorld[3],ah),i(ay,t.v3.positionWorld,t.vertexNormalsWorld[2],aw),aa.r=Math.max(0,Math.min(x.color.r*aa.r,1)),aa.g=Math.max(0,Math.min(x.color.g*aa.g,1)),aa.b=Math.max(0,Math.min(x.color.b*aa.b,1)),ae.r=Math.max(0,Math.min(x.color.r*ae.r,1)),ae.g=Math.max(0,Math.min(x.color.g*ae.g,1)),ae.b=Math.max(0,Math.min(x.color.b*ae.b,1)),ah.r=Math.max(0,Math.min(x.color.r*ah.r,1)),ah.g=Math.max(0,Math.min(x.color.g*ah.g,1)),ah.b=Math.max(0,Math.min(x.color.b*ah.b,1)),aw.r=Math.max(0,Math.min(x.color.r*aw.r,1)),aw.g=Math.max(0,Math.min(x.color.g*aw.g,1)),aw.b=Math.max(0,Math.min(x.color.b*aw.b,1)),aE=C(aa,ae,ah,aw),B(aU,aK,aq,aC,al,a0),H(aU,aK,aq,aC,al,a0,0,0,1,0,0,1,aE),B(a2,aX,a8,bd,aH,ar),H(a2,aX,a8,bd,aH,ar,1,0,1,1,0,1,aE)):(a7.r=M.r,a7.g=M.g,a7.b=M.b,i(ay,t.centroidWorld,t.normalWorld,a7),a7.r=Math.max(0,Math.min(x.color.r*a7.r,1)),a7.g=Math.max(0,Math.min(x.color.g*a7.g,1)),a7.b=Math.max(0,Math.min(x.color.b*a7.b,1)),G(aU,aK,aq,aC,a8,bd,al,a0),x.wireframe?d(a7,x.wireframeLinewidth,x.wireframeLinecap,x.wireframeLinejoin):c(a7)):(G(aU,aK,aq,aC,a8,bd,al,a0),x.wireframe?d(x.color,x.wireframeLinewidth,x.wireframeLinecap,x.wireframeLinejoin):c(x.color))}else{if(x instanceof THREE.MeshNormalMaterial){a7.r=I(t.normalWorld.x),a7.g=I(t.normalWorld.y),a7.b=I(t.normalWorld.z),G(aU,aK,aq,aC,a8,bd,al,a0),x.wireframe?d(a7,x.wireframeLinewidth,x.wireframeLinecap,x.wireframeLinejoin):c(a7)}else{if(x instanceof THREE.MeshDepthMaterial){be=g.near,U=g.far,aa.r=aa.g=aa.b=1-y(k.positionScreen.z,be,U),ae.r=ae.g=ae.b=1-y(n.positionScreen.z,be,U),ah.r=ah.g=ah.b=1-y(r.positionScreen.z,be,U),aw.r=aw.g=aw.b=1-y(q.positionScreen.z,be,U),aE=C(aa,ae,ah,aw),B(aU,aK,aq,aC,al,a0),H(aU,aK,aq,aC,al,a0,0,0,1,0,0,1,aE),B(a2,aX,a8,bd,aH,ar),H(a2,aX,a8,bd,aH,ar,1,0,1,1,0,1,aE)}}}}}}function B(k,n,q,r,s,t){aM.beginPath();aM.moveTo(k,n);aM.lineTo(q,r);aM.lineTo(s,t);aM.lineTo(k,n);aM.closePath()}function G(k,q,r,s,t,u,v,n){aM.beginPath();aM.moveTo(k,q);aM.lineTo(r,s);aM.lineTo(t,u);aM.lineTo(v,n);aM.lineTo(k,q);aM.closePath()}function d(k,n,q,r){if(Z!=n){aM.lineWidth=Z=n}if(ag!=q){aM.lineCap=ag=q}if(ad!=r){aM.lineJoin=ad=r}af(k.getContextStyle());aM.stroke();aD.inflate(2*n)}function c(k){ak(k.getContextStyle());aM.fill()}function h(r,t,u,v,K,L,s,R,N,ba,Q,T,W){if(0!=W.image.width){if(!0==W.needsUpdate||void 0==aV[W.id]){var S=W.wrapS==THREE.RepeatWrapping,V=W.wrapT==THREE.RepeatWrapping;aV[W.id]=aM.createPattern(W.image,S&&V?"repeat":S&&!V?"repeat-x":!S&&V?"repeat-y":"no-repeat");W.needsUpdate=!1}ak(aV[W.id]);var S=W.offset.x/W.repeat.x,V=W.offset.y/W.repeat.y,bf=W.image.width*W.repeat.x,x=W.image.height*W.repeat.y,s=(s+S)*bf,R=(R+V)*x,u=u-r,v=v-t,K=K-r,L=L-t,N=(N+S)*bf-s,ba=(ba+V)*x-R,Q=(Q+S)*bf-s,T=(T+V)*x-R,S=N*T-Q*ba;if(0==S){if(void 0===aL[W.id]){t=document.createElement("canvas"),t.width=W.image.width,t.height=W.image.height,t=t.getContext("2d"),t.drawImage(W.image,0,0),aL[W.id]=t.getImageData(0,0,W.image.width,W.image.height).data}t=aL[W.id];s=4*(Math.floor(s)+Math.floor(R)*W.image.width);a7.setRGB(t[s]/255,t[s+1]/255,t[s+2]/255);c(a7)}else{S=1/S,W=(T*u-ba*K)*S,ba=(T*v-ba*L)*S,u=(N*K-Q*u)*S,v=(N*L-Q*v)*S,r=r-W*s-u*R,s=t-ba*s-v*R,aM.save(),aM.transform(W,ba,u,v,r,s),aM.fill(),aM.restore()}}}function H(n,r,s,t,u,v,x,q,N,K,T,L,S){var R,Q;R=S.width-1;Q=S.height-1;x*=R;q*=Q;s-=n;t-=r;u-=n;v-=r;N=N*R-x;K=K*Q-q;T=T*R-x;L=L*Q-q;Q=1/(N*L-T*K);R=(L*s-K*u)*Q;K=(L*t-K*v)*Q;s=(N*u-T*s)*Q;t=(N*v-T*t)*Q;n=n-R*x-s*q;r=r-K*x-t*q;aM.save();aM.transform(R,K,s,t,n,r);aM.clip();aM.drawImage(S,0,0);aM.restore()}function C(k,q,r,s){var t=~~(255*k.r),u=~~(255*k.g),k=~~(255*k.b),v=~~(255*q.r),n=~~(255*q.g),q=~~(255*q.b),L=~~(255*r.r),x=~~(255*r.g),r=~~(255*r.b),N=~~(255*s.r),K=~~(255*s.g),s=~~(255*s.b);an[0]=0>t?0:255<t?255:t;an[1]=0>u?0:255<u?255:u;an[2]=0>k?0:255<k?255:k;an[4]=0>v?0:255<v?255:v;an[5]=0>n?0:255<n?255:n;an[6]=0>q?0:255<q?255:q;an[8]=0>L?0:255<L?255:L;an[9]=0>x?0:255<x?255:x;an[10]=0>r?0:255<r?255:r;an[12]=0>N?0:255<N?255:N;an[13]=0>K?0:255<K?255:K;an[14]=0>s?0:255<s?255:s;ax.putImageData(aI,0,0);a5.drawImage(at,0,0);return aB}function y(k,n,q){k=(k-n)/(q-n);return k*k*(3-2*k)}function I(k){k=0.5*(k+1);return 0>k?0:1<k?1:k}function e(k,n){var q=n.x-k.x,r=n.y-k.y,s=q*q+r*r;0!=s&&(s=1/Math.sqrt(s),q*=s,r*=s,n.x+=q,n.y+=r,k.x-=q,k.y-=r)}var E,D,j,f;this.autoClear?this.clear():aM.setTransform(1,0,0,-1,aP,aR);ao.info.render.vertices=0;ao.info.render.faces=0;ap=aJ.projectScene(b,g,this.sortElements);au=ap.elements;ay=ap.lights;(X=0<ay.length)&&l(ay);for(E=0,D=au.length;E<D;E++){if(j=au[E],f=j.material,f=f instanceof THREE.MeshFaceMaterial?j.faceMaterial:f,!(null==f||0==f.opacity)){aD.empty();if(j instanceof THREE.RenderableParticle){J=j,J.x*=aP,J.y*=aR,m(J,j,f,b)}else{if(j instanceof THREE.RenderableLine){J=j.v1,av=j.v2,J.positionScreen.x*=aP,J.positionScreen.y*=aR,av.positionScreen.x*=aP,av.positionScreen.y*=aR,aD.addPoint(J.positionScreen.x,J.positionScreen.y),aD.addPoint(av.positionScreen.x,av.positionScreen.y),aY.intersects(aD)&&o(J,av,j,f,b)}else{if(j instanceof THREE.RenderableFace3){J=j.v1,av=j.v2,az=j.v3,J.positionScreen.x*=aP,J.positionScreen.y*=aR,av.positionScreen.x*=aP,av.positionScreen.y*=aR,az.positionScreen.x*=aP,az.positionScreen.y*=aR,f.overdraw&&(e(J.positionScreen,av.positionScreen),e(av.positionScreen,az.positionScreen),e(az.positionScreen,J.positionScreen)),aD.add3Points(J.positionScreen.x,J.positionScreen.y,av.positionScreen.x,av.positionScreen.y,az.positionScreen.x,az.positionScreen.y),aY.intersects(aD)&&p(J,av,az,0,1,2,j,f,b)}else{if(j instanceof THREE.RenderableFace4){J=j.v1,av=j.v2,az=j.v3,aO=j.v4,J.positionScreen.x*=aP,J.positionScreen.y*=aR,av.positionScreen.x*=aP,av.positionScreen.y*=aR,az.positionScreen.x*=aP,az.positionScreen.y*=aR,aO.positionScreen.x*=aP,aO.positionScreen.y*=aR,w.positionScreen.copy(av.positionScreen),aG.positionScreen.copy(aO.positionScreen),f.overdraw&&(e(J.positionScreen,av.positionScreen),e(av.positionScreen,aO.positionScreen),e(aO.positionScreen,J.positionScreen),e(az.positionScreen,w.positionScreen),e(az.positionScreen,aG.positionScreen)),aD.addPoint(J.positionScreen.x,J.positionScreen.y),aD.addPoint(av.positionScreen.x,av.positionScreen.y),aD.addPoint(az.positionScreen.x,az.positionScreen.y),aD.addPoint(aO.positionScreen.x,aO.positionScreen.y),aY.intersects(aD)&&A(J,av,az,aO,w,aG,j,f,b)}}}}ab.addRectangle(aD)}}aM.setTransform(1,0,0,1,0,0)}};THREE.SVGRenderer=function(){function w(k,m,n,o){var p,q,r,s,t,u;for(p=0,q=k.length;p<q;p++){r=k[p],s=r.color,r instanceof THREE.DirectionalLight?(t=r.matrixWorld.getPosition(),u=n.dot(t),0>=u||(u*=r.intensity,o.r+=s.r*u,o.g+=s.g*u,o.b+=s.b*u)):r instanceof THREE.PointLight&&(t=r.matrixWorld.getPosition(),u=n.dot(y.sub(t,m).normalize()),0>=u||(u*=0==r.distance?1:1-Math.min(m.distanceTo(t)/r.distance,1),0!=u&&(u*=r.intensity,o.r+=s.r*u,o.g+=s.g*u,o.b+=s.b*u)))}}function z(b){null==S[b]&&(S[b]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==ae&&S[b].setAttribute("shape-rendering","crispEdges"));return S[b]}function F(b){b=0.5*(b+1);return 0>b?0:1<b?1:b}var J=this,M,O,P,R=new THREE.Projector,T=document.createElementNS("http://www.w3.org/2000/svg","svg"),X,V,Z,ad,ab,ac,Y,af,ag=new THREE.Rectangle,ah=new THREE.Rectangle,ai=!1,aj=new THREE.Color,ak=new THREE.Color,E=new THREE.Color,L=new THREE.Color,G,y=new THREE.Vector3,S=[],U=[],aa,j,W,ae=1;this.domElement=T;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.setQuality=function(b){switch(b){case"high":ae=1;break;case"low":ae=0}};this.setSize=function(c,d){X=c;V=d;Z=X/2;ad=V/2;T.setAttribute("viewBox",-Z+" "+-ad+" "+X+" "+V);T.setAttribute("width",X);T.setAttribute("height",V);ag.set(-Z,-ad,Z,ad)};this.clear=function(){for(;0<T.childNodes.length;){T.removeChild(T.childNodes[0])}};this.render=function(f,e){var d,a,m,b;this.autoClear&&this.clear();J.info.render.vertices=0;J.info.render.faces=0;M=R.projectScene(f,e,this.sortElements);O=M.elements;P=M.lights;W=j=0;if(ai=0<P.length){ak.setRGB(0,0,0);E.setRGB(0,0,0);L.setRGB(0,0,0);for(d=0,a=P.length;d<a;d++){b=P[d],m=b.color,b instanceof THREE.AmbientLight?(ak.r+=m.r,ak.g+=m.g,ak.b+=m.b):b instanceof THREE.DirectionalLight?(E.r+=m.r,E.g+=m.g,E.b+=m.b):b instanceof THREE.PointLight&&(L.r+=m.r,L.g+=m.g,L.b+=m.b)}}for(d=0,a=O.length;d<a;d++){if(m=O[d],b=m.material,b=b instanceof THREE.MeshFaceMaterial?m.faceMaterial:b,!(null==b||0==b.opacity)){if(ah.empty(),m instanceof THREE.RenderableParticle){ab=m,ab.x*=Z,ab.y*=-ad}else{if(m instanceof THREE.RenderableLine){if(ab=m.v1,ac=m.v2,ab.positionScreen.x*=Z,ab.positionScreen.y*=-ad,ac.positionScreen.x*=Z,ac.positionScreen.y*=-ad,ah.addPoint(ab.positionScreen.x,ab.positionScreen.y),ah.addPoint(ac.positionScreen.x,ac.positionScreen.y),ag.intersects(ah)){m=ab;var h=ac,i=W++;null==U[i]&&(U[i]=document.createElementNS("http://www.w3.org/2000/svg","line"),0==ae&&U[i].setAttribute("shape-rendering","crispEdges"));aa=U[i];aa.setAttribute("x1",m.positionScreen.x);aa.setAttribute("y1",m.positionScreen.y);aa.setAttribute("x2",h.positionScreen.x);aa.setAttribute("y2",h.positionScreen.y);b instanceof THREE.LineBasicMaterial&&(aa.setAttribute("style","fill: none; stroke: "+b.color.getContextStyle()+"; stroke-width: "+b.linewidth+"; stroke-opacity: "+b.opacity+"; stroke-linecap: "+b.linecap+"; stroke-linejoin: "+b.linejoin),T.appendChild(aa))}}else{if(m instanceof THREE.RenderableFace3){if(ab=m.v1,ac=m.v2,Y=m.v3,ab.positionScreen.x*=Z,ab.positionScreen.y*=-ad,ac.positionScreen.x*=Z,ac.positionScreen.y*=-ad,Y.positionScreen.x*=Z,Y.positionScreen.y*=-ad,ah.addPoint(ab.positionScreen.x,ab.positionScreen.y),ah.addPoint(ac.positionScreen.x,ac.positionScreen.y),ah.addPoint(Y.positionScreen.x,Y.positionScreen.y),ag.intersects(ah)){var h=ab,i=ac,g=Y;J.info.render.vertices+=3;J.info.render.faces++;aa=z(j++);aa.setAttribute("d","M "+h.positionScreen.x+" "+h.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+g.positionScreen.x+","+g.positionScreen.y+"z");b instanceof THREE.MeshBasicMaterial?aj.copy(b.color):b instanceof THREE.MeshLambertMaterial?ai?(aj.r=ak.r,aj.g=ak.g,aj.b=ak.b,w(P,m.centroidWorld,m.normalWorld,aj),aj.r=Math.max(0,Math.min(b.color.r*aj.r,1)),aj.g=Math.max(0,Math.min(b.color.g*aj.g,1)),aj.b=Math.max(0,Math.min(b.color.b*aj.b,1))):aj.copy(b.color):b instanceof THREE.MeshDepthMaterial?(G=1-b.__2near/(b.__farPlusNear-m.z*b.__farMinusNear),aj.setRGB(G,G,G)):b instanceof THREE.MeshNormalMaterial&&aj.setRGB(F(m.normalWorld.x),F(m.normalWorld.y),F(m.normalWorld.z));b.wireframe?aa.setAttribute("style","fill: none; stroke: "+aj.getContextStyle()+"; stroke-width: "+b.wireframeLinewidth+"; stroke-opacity: "+b.opacity+"; stroke-linecap: "+b.wireframeLinecap+"; stroke-linejoin: "+b.wireframeLinejoin):aa.setAttribute("style","fill: "+aj.getContextStyle()+"; fill-opacity: "+b.opacity);T.appendChild(aa)}}else{if(m instanceof THREE.RenderableFace4&&(ab=m.v1,ac=m.v2,Y=m.v3,af=m.v4,ab.positionScreen.x*=Z,ab.positionScreen.y*=-ad,ac.positionScreen.x*=Z,ac.positionScreen.y*=-ad,Y.positionScreen.x*=Z,Y.positionScreen.y*=-ad,af.positionScreen.x*=Z,af.positionScreen.y*=-ad,ah.addPoint(ab.positionScreen.x,ab.positionScreen.y),ah.addPoint(ac.positionScreen.x,ac.positionScreen.y),ah.addPoint(Y.positionScreen.x,Y.positionScreen.y),ah.addPoint(af.positionScreen.x,af.positionScreen.y),ag.intersects(ah))){var h=ab,i=ac,g=Y,c=af;J.info.render.vertices+=4;J.info.render.faces++;aa=z(j++);aa.setAttribute("d","M "+h.positionScreen.x+" "+h.positionScreen.y+" L "+i.positionScreen.x+" "+i.positionScreen.y+" L "+g.positionScreen.x+","+g.positionScreen.y+" L "+c.positionScreen.x+","+c.positionScreen.y+"z");b instanceof THREE.MeshBasicMaterial?aj.copy(b.color):b instanceof THREE.MeshLambertMaterial?ai?(aj.r=ak.r,aj.g=ak.g,aj.b=ak.b,w(P,m.centroidWorld,m.normalWorld,aj),aj.r=Math.max(0,Math.min(b.color.r*aj.r,1)),aj.g=Math.max(0,Math.min(b.color.g*aj.g,1)),aj.b=Math.max(0,Math.min(b.color.b*aj.b,1))):aj.copy(b.color):b instanceof THREE.MeshDepthMaterial?(G=1-b.__2near/(b.__farPlusNear-m.z*b.__farMinusNear),aj.setRGB(G,G,G)):b instanceof THREE.MeshNormalMaterial&&aj.setRGB(F(m.normalWorld.x),F(m.normalWorld.y),F(m.normalWorld.z));b.wireframe?aa.setAttribute("style","fill: none; stroke: "+aj.getContextStyle()+"; stroke-width: "+b.wireframeLinewidth+"; stroke-opacity: "+b.opacity+"; stroke-linecap: "+b.wireframeLinecap+"; stroke-linejoin: "+b.wireframeLinejoin):aa.setAttribute("style","fill: "+aj.getContextStyle()+"; fill-opacity: "+b.opacity);T.appendChild(aa)}}}}}}}};THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, reflectivity );\n} else {\ngl_FragColor.xyz = gl_FragColor.xyz * cubeColor.xyz;\n}\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = mat3( objectMatrix[ 0 ].xyz, objectMatrix[ 1 ].xyz, objectMatrix[ 2 ].xyz ) * normal;\nif ( useRefract ) {\nvReflect = refract( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ), refractionRatio );\n} else {\nvReflect = reflect( normalize( mPosition.xyz - cameraPosition ), normalize( nWorld.xyz ) );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, gl_PointCoord );\n#endif",map_pars_vertex:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#ifdef USE_MAP\nvarying vec2 vUv;\nuniform sampler2D map;\n#endif",map_vertex:"#ifdef USE_MAP\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( map, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( map, vUv );\n#endif\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",lights_lambert_vertex:"vLightWeighting = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( transformedNormal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( transformedNormal, dirVector ) + 0.5, 0.0 );\nvec3 directionalLightWeighting = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat directionalLightWeighting = max( dot( transformedNormal, dirVector ), 0.0 );\n#endif\nvLightWeighting += directionalLightColor[ i ] * directionalLightWeighting;\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#ifdef WRAP_AROUND\nfloat pointLightWeightingFull = max( dot( transformedNormal, lVector ), 0.0 );\nfloat pointLightWeightingHalf = max( 0.5 * dot( transformedNormal, lVector ) + 0.5, 0.0 );\nvec3 pointLightWeighting = mix( vec3 ( pointLightWeightingFull ), vec3( pointLightWeightingHalf ), wrapRGB );\n#else\nfloat pointLightWeighting = max( dot( transformedNormal, lVector ), 0.0 );\n#endif\nvLightWeighting += pointLightColor[ i ] * pointLightWeighting * lDistance;\n}\n#endif\nvLightWeighting = vLightWeighting * diffuse + ambient * ambientLightColor;",lights_phong_pars_vertex:"#if MAX_POINT_LIGHTS > 0\n#ifndef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif",lights_phong_vertex:"#if MAX_POINT_LIGHTS > 0\n#ifndef PHONG_PER_PIXEL\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif",lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, lVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, lVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, lVector ), 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dot( normal, dirVector ), 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n#endif",skinning_vertex:"#ifdef USE_SKINNING\ngl_Position  = ( boneGlobalMatrices[ int( skinIndex.x ) ] * skinVertexA ) * skinWeight.x;\ngl_Position += ( boneGlobalMatrices[ int( skinIndex.y ) ] * skinVertexB ) * skinWeight.y;\ngl_Position  = projectionMatrix * viewMatrix * objectMatrix * gl_Position;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\nuniform float morphTargetInfluences[ 8 ];\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0, 0.0, 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\nmorphed += position;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( morphed, 1.0 );\n#endif",default_vertex:"#ifndef USE_MORPHTARGETS\n#ifndef USE_SKINNING\ngl_Position = projectionMatrix * mvPosition;\n#endif\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\nvec3 shadowColor = vec3( 1.0 );\nfloat fDepth;\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nif ( shadowCoord.z <= 1.0 ) {\nshadowCoord.z += shadowBias[ i ];\nbvec4 shadowTest = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nif ( all( shadowTest ) ) {\n#ifdef SHADOWMAP_SOFT\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n}\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n#ifdef USE_MORPHTARGETS\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( morphed, 1.0 );\n#else\nvShadowCoord[ i ] = shadowMatrix[ i ] * objectMatrix * vec4( position, 1.0 );\n#endif\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};THREE.UniformsUtils={merge:function(f){var g,h,i,j={};for(g=0;g<f.length;g++){for(h in i=this.clone(f[g]),i){j[h]=i[h]}}return j},clone:function(f){var g,h,i,j={};for(g in f){for(h in j[g]={},f[g]){i=f[g][h],j[g][h]=i instanceof THREE.Color||i instanceof THREE.Vector2||i instanceof THREE.Vector3||i instanceof THREE.Vector4||i instanceof THREE.Matrix4||i instanceof THREE.Texture?i.clone():i instanceof Array?i.slice():i}}return j}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:0,texture:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:2,texture:null},envMap:{type:"t",value:1,texture:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},fog:{fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:0,texture:null},fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:6,texture:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};THREE.ShaderLib={depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2000},opacity:{type:"f",value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:"varying vec3 vNormal;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvNormal = normalize( normalMatrix * normal );\ngl_Position = projectionMatrix * mvPosition;\n}",fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(328965)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vLightWeighting;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"vec3 transformedNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightWeighting;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,"gl_FragColor.xyz = gl_FragColor.xyz * vLightWeighting;",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(328965)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["varying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.color_vertex,"#ifndef USE_ENVMAP\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\n#endif\nvViewPosition = -mvPosition.xyz;\nvec3 transformedNormal = normalMatrix * normal;\nvNormal = transformedNormal;",THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};THREE.WebGLRenderer=function(F){function P(h,i){var j=h.vertices.length,k=i.material;if(k.attributes){if(void 0===h.__webglCustomAttributesList){h.__webglCustomAttributesList=[]}for(var l in k.attributes){var m=k.attributes[l];if(!m.__webglInitialized||m.createUniqueBuffers){m.__webglInitialized=!0;var n=1;"v2"===m.type?n=2:"v3"===m.type?n=3:"v4"===m.type?n=4:"c"===m.type&&(n=3);m.size=n;m.array=new Float32Array(j*n);m.buffer=au.createBuffer();m.buffer.belongsToAttribute=l;m.needsUpdate=!0}h.__webglCustomAttributesList.push(m)}}}function Z(c,d){if(c.material&&!(c.material instanceof THREE.MeshFaceMaterial)){return c.material}if(0<=d.materialIndex){return c.geometry.materials[d.materialIndex]}}function ac(b){return b instanceof THREE.MeshBasicMaterial&&!b.envMap||b instanceof THREE.MeshDepthMaterial?!1:b&&void 0!==b.shading&&b.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function ah(b){return b.map||b.lightMap||b instanceof THREE.ShaderMaterial?!0:!1}function aj(j,r,s){var t,u,v,x,y=j.vertices;x=y.length;var A=j.colors,C=A.length,B=j.__vertexArray,E=j.__colorArray,D=j.__sortArray,I=j.__dirtyVertices,G=j.__dirtyColors,H=j.__webglCustomAttributesList;if(s.sortParticles){aX.multiplySelf(s.matrixWorld);for(t=0;t<x;t++){u=y[t].position,aZ.copy(u),aX.multiplyVector3(aZ),D[t]=[aZ.z,t]}D.sort(function(c,d){return d[0]-c[0]});for(t=0;t<x;t++){u=y[D[t][1]].position,v=3*t,B[v]=u.x,B[v+1]=u.y,B[v+2]=u.z}for(t=0;t<C;t++){v=3*t,u=A[D[t][1]],E[v]=u.r,E[v+1]=u.g,E[v+2]=u.b}if(H){for(A=0,C=H.length;A<C;A++){if(y=H[A],void 0===y.boundTo||"vertices"===y.boundTo){if(v=0,u=y.value.length,1===y.size){for(t=0;t<u;t++){x=D[t][1],y.array[t]=y.value[x]}}else{if(2===y.size){for(t=0;t<u;t++){x=D[t][1],x=y.value[x],y.array[v]=x.x,y.array[v+1]=x.y,v+=2}}else{if(3===y.size){if("c"===y.type){for(t=0;t<u;t++){x=D[t][1],x=y.value[x],y.array[v]=x.r,y.array[v+1]=x.g,y.array[v+2]=x.b,v+=3}}else{for(t=0;t<u;t++){x=D[t][1],x=y.value[x],y.array[v]=x.x,y.array[v+1]=x.y,y.array[v+2]=x.z,v+=3}}}else{if(4===y.size){for(t=0;t<u;t++){x=D[t][1],x=y.value[x],y.array[v]=x.x,y.array[v+1]=x.y,y.array[v+2]=x.z,y.array[v+3]=x.w,v+=4}}}}}}}}}else{if(I){for(t=0;t<x;t++){u=y[t].position,v=3*t,B[v]=u.x,B[v+1]=u.y,B[v+2]=u.z}}if(G){for(t=0;t<C;t++){u=A[t],v=3*t,E[v]=u.r,E[v+1]=u.g,E[v+2]=u.b}}if(H){for(A=0,C=H.length;A<C;A++){if(y=H[A],y.needsUpdate&&(void 0===y.boundTo||"vertices"===y.boundTo)){if(u=y.value.length,v=0,1===y.size){for(t=0;t<u;t++){y.array[t]=y.value[t]}}else{if(2===y.size){for(t=0;t<u;t++){x=y.value[t],y.array[v]=x.x,y.array[v+1]=x.y,v+=2}}else{if(3===y.size){if("c"===y.type){for(t=0;t<u;t++){x=y.value[t],y.array[v]=x.r,y.array[v+1]=x.g,y.array[v+2]=x.b,v+=3}}else{for(t=0;t<u;t++){x=y.value[t],y.array[v]=x.x,y.array[v+1]=x.y,y.array[v+2]=x.z,v+=3}}}else{if(4===y.size){for(t=0;t<u;t++){x=y.value[t],y.array[v]=x.x,y.array[v+1]=x.y,y.array[v+2]=x.z,y.array[v+3]=x.w,v+=4}}}}}}}}}if(I||s.sortParticles){au.bindBuffer(au.ARRAY_BUFFER,j.__webglVertexBuffer),au.bufferData(au.ARRAY_BUFFER,B,r)}if(G||s.sortParticles){au.bindBuffer(au.ARRAY_BUFFER,j.__webglColorBuffer),au.bufferData(au.ARRAY_BUFFER,E,r)}if(H){for(A=0,C=H.length;A<C;A++){if(y=H[A],y.needsUpdate||s.sortParticles){au.bindBuffer(au.ARRAY_BUFFER,y.buffer),au.bufferData(au.ARRAY_BUFFER,y.array,r)}}}}function ak(c,d){return d.z-c.z}function an(f,g,h){if(f.length){for(var i=0,j=f.length;i<j;i++){aM=a0=null,aP=aR=ae=ab=X=-1,f[i].render(g,h,aS,at),aM=a0=null,aP=aR=ae=ab=X=-1}}}function aq(m,o,p,q,r,s,t,u){var x,v,A,y;o?(v=m.length-1,y=o=-1):(v=0,o=m.length,y=1);for(var B=v;B!==o;B+=y){if(x=m[B],x.render){v=x.object;A=x.buffer;if(u){x=u}else{x=x[p];if(!x){continue}t&&al.setBlending(x.blending);al.setDepthTest(x.depthTest);al.setDepthWrite(x.depthWrite);aO(x.polygonOffset,x.polygonOffsetFactor,x.polygonOffsetUnits)}al.setObjectFaces(v);A instanceof THREE.BufferGeometry?al.renderBufferDirect(q,r,s,x,A,v):al.renderBuffer(q,r,s,x,A,v)}}}function aA(k,m,n,o,p,q,r){for(var s,u,t=0,v=k.length;t<v;t++){if(s=k[t],u=s.object,u.visible){if(r){s=r}else{s=s[m];if(!s){continue}q&&al.setBlending(s.blending);al.setDepthTest(s.depthTest);al.setDepthWrite(s.depthWrite);aO(s.polygonOffset,s.polygonOffsetFactor,s.polygonOffsetUnits)}al.renderImmediateObject(n,o,p,s,u)}}}function ax(d,e,f){d.push({buffer:e,object:f,opaque:null,transparent:null})}function aE(c){for(var d in c.attributes){if(c.attributes[d].needsUpdate){return !0}}return !1}function aI(c){for(var d in c.attributes){c.attributes[d].needsUpdate=!1}}function aG(d,e){for(var f=d.length-1;0<=f;f--){d[f].object===e&&d.splice(f,1)}}function aH(d,e){for(var f=d.length-1;0<=f;f--){d[f]===e&&d.splice(f,1)}}function aD(j,y,B,G,H){G.program||al.initMaterial(G,y,B,H);if(G.morphTargets&&!H.__webglMorphTargetInfluences){H.__webglMorphTargetInfluences=new Float32Array(al.maxMorphTargets);for(var K=0,L=al.maxMorphTargets;K<L;K++){H.__webglMorphTargetInfluences[K]=0}}var N=!1,K=G.program,L=K.uniforms,Q=G.uniforms;K!==a0&&(au.useProgram(K),a0=K,N=!0);if(G.id!==aP){aP=G.id,N=!0}if(N||j!==aM){au.uniformMatrix4fv(L.projectionMatrix,!1,j._projectionMatrixArray),j!==aM&&(aM=j)}if(N){if(B&&G.fog){if(Q.fogColor.value=B.color,B instanceof THREE.Fog){Q.fogNear.value=B.near,Q.fogFar.value=B.far}else{if(B instanceof THREE.FogExp2){Q.fogDensity.value=B.density}}}if(G instanceof THREE.MeshPhongMaterial||G instanceof THREE.MeshLambertMaterial||G.lights){var S,R=0,W=0,V=0,a4,a2,a3,a5=Y,a6=a5.directional.colors,a7=a5.directional.positions,I=a5.point.colors,a9=a5.point.positions,ba=a5.point.distances,a8=0,u=0,D=a3=0;for(B=0,N=y.length;B<N;B++){if(S=y[B],!S.onlyShadow){if(a4=S.color,a2=S.intensity,a3=S.distance,S instanceof THREE.AmbientLight){al.gammaInput?(R+=a4.r*a4.r,W+=a4.g*a4.g,V+=a4.b*a4.b):(R+=a4.r,W+=a4.g,V+=a4.b)}else{if(S instanceof THREE.DirectionalLight){a3=3*a8,al.gammaInput?(a6[a3]=a4.r*a4.r*a2*a2,a6[a3+1]=a4.g*a4.g*a2*a2,a6[a3+2]=a4.b*a4.b*a2*a2):(a6[a3]=a4.r*a2,a6[a3+1]=a4.g*a2,a6[a3+2]=a4.b*a2),aN.copy(S.matrixWorld.getPosition()),aN.subSelf(S.target.matrixWorld.getPosition()),aN.normalize(),a7[a3]=aN.x,a7[a3+1]=aN.y,a7[a3+2]=aN.z,a8+=1}else{if(S instanceof THREE.PointLight||S instanceof THREE.SpotLight){D=3*u,al.gammaInput?(I[D]=a4.r*a4.r*a2*a2,I[D+1]=a4.g*a4.g*a2*a2,I[D+2]=a4.b*a4.b*a2*a2):(I[D]=a4.r*a2,I[D+1]=a4.g*a2,I[D+2]=a4.b*a2),S=S.matrixWorld.getPosition(),a9[D]=S.x,a9[D+1]=S.y,a9[D+2]=S.z,ba[u]=a3,u+=1}}}}}for(B=3*a8,N=a6.length;B<N;B++){a6[B]=0}for(B=3*u,N=I.length;B<N;B++){I[B]=0}a5.point.length=u;a5.directional.length=a8;a5.ambient[0]=R;a5.ambient[1]=W;a5.ambient[2]=V;B=Y;Q.ambientLightColor.value=B.ambient;Q.directionalLightColor.value=B.directional.colors;Q.directionalLightDirection.value=B.directional.positions;Q.pointLightColor.value=B.point.colors;Q.pointLightPosition.value=B.point.positions;Q.pointLightDistance.value=B.point.distances}if(G instanceof THREE.MeshBasicMaterial||G instanceof THREE.MeshLambertMaterial||G instanceof THREE.MeshPhongMaterial){Q.opacity.value=G.opacity,al.gammaInput?Q.diffuse.value.copyGammaToLinear(G.color):Q.diffuse.value=G.color,(Q.map.texture=G.map)&&Q.offsetRepeat.value.set(G.map.offset.x,G.map.offset.y,G.map.repeat.x,G.map.repeat.y),Q.lightMap.texture=G.lightMap,Q.envMap.texture=G.envMap,Q.flipEnvMap.value=G.envMap instanceof THREE.WebGLRenderTargetCube?1:-1,Q.reflectivity.value=G.reflectivity,Q.refractionRatio.value=G.refractionRatio,Q.combine.value=G.combine,Q.useRefract.value=G.envMap&&G.envMap.mapping instanceof THREE.CubeRefractionMapping}if(G instanceof THREE.LineBasicMaterial){Q.diffuse.value=G.color,Q.opacity.value=G.opacity}else{if(G instanceof THREE.ParticleBasicMaterial){Q.psColor.value=G.color,Q.opacity.value=G.opacity,Q.size.value=G.size,Q.scale.value=ad.height/2,Q.map.texture=G.map}else{if(G instanceof THREE.MeshPhongMaterial){Q.shininess.value=G.shininess,al.gammaInput?(Q.ambient.value.copyGammaToLinear(G.ambient),Q.specular.value.copyGammaToLinear(G.specular)):(Q.ambient.value=G.ambient,Q.specular.value=G.specular),G.wrapAround&&Q.wrapRGB.value.copy(G.wrapRGB)}else{if(G instanceof THREE.MeshLambertMaterial){al.gammaInput?Q.ambient.value.copyGammaToLinear(G.ambient):Q.ambient.value=G.ambient,G.wrapAround&&Q.wrapRGB.value.copy(G.wrapRGB)}else{if(G instanceof THREE.MeshDepthMaterial){Q.mNear.value=j.near,Q.mFar.value=j.far,Q.opacity.value=G.opacity}else{if(G instanceof THREE.MeshNormalMaterial){Q.opacity.value=G.opacity}}}}}}if(H.receiveShadow&&!G._shadowPass&&Q.shadowMatrix){N=B=0;for(R=y.length;N<R;N++){if(W=y[N],W.castShadow&&(W instanceof THREE.SpotLight||W instanceof THREE.DirectionalLight)){Q.shadowMap.texture[B]=W.shadowMap,Q.shadowMapSize.value[B]=W.shadowMapSize,Q.shadowMatrix.value[B]=W.shadowMatrix,Q.shadowDarkness.value[B]=W.shadowDarkness,Q.shadowBias.value[B]=W.shadowBias,B++}}}y=G.uniformsList;for(Q=0,B=y.length;Q<B;Q++){if(W=K.uniforms[y[Q][1]]){if(N=y[Q][0],V=N.type,R=N.value,"i"===V){au.uniform1i(W,R)}else{if("f"===V){au.uniform1f(W,R)}else{if("v2"===V){au.uniform2f(W,R.x,R.y)}else{if("v3"===V){au.uniform3f(W,R.x,R.y,R.z)}else{if("v4"===V){au.uniform4f(W,R.x,R.y,R.z,R.w)}else{if("c"===V){au.uniform3f(W,R.r,R.g,R.b)}else{if("fv1"===V){au.uniform1fv(W,R)}else{if("fv"===V){au.uniform3fv(W,R)}else{if("v2v"===V){if(!N._array){N._array=new Float32Array(2*R.length)}for(V=0,a5=R.length;V<a5;V++){a6=2*V,N._array[a6]=R[V].x,N._array[a6+1]=R[V].y}au.uniform2fv(W,N._array)}else{if("v3v"===V){if(!N._array){N._array=new Float32Array(3*R.length)}for(V=0,a5=R.length;V<a5;V++){a6=3*V,N._array[a6]=R[V].x,N._array[a6+1]=R[V].y,N._array[a6+2]=R[V].z}au.uniform3fv(W,N._array)}else{if("v4v"==V){if(!N._array){N._array=new Float32Array(4*R.length)}for(V=0,a5=R.length;V<a5;V++){a6=4*V,N._array[a6]=R[V].x,N._array[a6+1]=R[V].y,N._array[a6+2]=R[V].z,N._array[a6+3]=R[V].w}au.uniform4fv(W,N._array)}else{if("m4"===V){if(!N._array){N._array=new Float32Array(16)}R.flattenToArray(N._array);au.uniformMatrix4fv(W,!1,N._array)}else{if("m4v"===V){if(!N._array){N._array=new Float32Array(16*R.length)}for(V=0,a5=R.length;V<a5;V++){R[V].flattenToArrayOffset(N._array,16*V)}au.uniformMatrix4fv(W,!1,N._array)}else{if("t"===V){if(au.uniform1i(W,R),W=N.texture){if(W.image instanceof Array&&6===W.image.length){if(N=W,6===N.image.length){if(N.needsUpdate){if(!N.image.__webglTextureCube){N.image.__webglTextureCube=au.createTexture()}au.activeTexture(au.TEXTURE0+R);au.bindTexture(au.TEXTURE_CUBE_MAP,N.image.__webglTextureCube);R=[];for(W=0;6>W;W++){V=R;a5=W;if(al.autoScaleCubemaps){if(a6=N.image[W],I=O,!(a6.width<=I&&a6.height<=I)){a9=Math.max(a6.width,a6.height),a7=Math.floor(a6.width*I/a9),I=Math.floor(a6.height*I/a9),a9=document.createElement("canvas"),a9.width=a7,a9.height=I,a9.getContext("2d").drawImage(a6,0,0,a6.width,a6.height,0,0,a7,I),a6=a9}}else{a6=N.image[W]}V[a5]=a6}W=R[0];V=0===(W.width&W.width-1)&&0===(W.height&W.height-1);a5=U(N.format);a6=U(N.type);aT(au.TEXTURE_CUBE_MAP,N,V);for(W=0;6>W;W++){au.texImage2D(au.TEXTURE_CUBE_MAP_POSITIVE_X+W,0,a5,a5,a6,R[W])}N.generateMipmaps&&V&&au.generateMipmap(au.TEXTURE_CUBE_MAP);N.needsUpdate=!1;if(N.onUpdated){N.onUpdated()}}else{au.activeTexture(au.TEXTURE0+R),au.bindTexture(au.TEXTURE_CUBE_MAP,N.image.__webglTextureCube)}}}else{W instanceof THREE.WebGLRenderTargetCube?(N=W,au.activeTexture(au.TEXTURE0+R),au.bindTexture(au.TEXTURE_CUBE_MAP,N.__webglTexture)):al.setTexture(W,R)}}}else{if("tv"===V){if(!N._array){N._array=[];for(V=0,a5=N.texture.length;V<a5;V++){N._array[V]=R+V}}au.uniform1iv(W,N._array);for(V=0,a5=N.texture.length;V<a5;V++){(W=N.texture[V])&&al.setTexture(W,N._array[V])}}}}}}}}}}}}}}}}}}(G instanceof THREE.ShaderMaterial||G instanceof THREE.MeshPhongMaterial||G.envMap)&&null!==L.cameraPosition&&au.uniform3f(L.cameraPosition,j.position.x,j.position.y,j.position.z);(G instanceof THREE.MeshPhongMaterial||G instanceof THREE.MeshLambertMaterial||G instanceof THREE.ShaderMaterial||G.skinning)&&null!==L.viewMatrix&&au.uniformMatrix4fv(L.viewMatrix,!1,j._viewMatrixArray);G.skinning&&(au.uniformMatrix4fv(L.cameraInverseMatrix,!1,j._viewMatrixArray),au.uniformMatrix4fv(L.boneGlobalMatrices,!1,H.boneMatrices))}au.uniformMatrix4fv(L.modelViewMatrix,!1,H._modelViewMatrixArray);L.normalMatrix&&au.uniformMatrix3fv(L.normalMatrix,!1,H._normalMatrixArray);(G instanceof THREE.ShaderMaterial||G.envMap||G.skinning||H.receiveShadow)&&null!==L.objectMatrix&&au.uniformMatrix4fv(L.objectMatrix,!1,H._objectMatrixArray);return K}function aL(d,e){d._modelViewMatrix.multiplyToArray(e.matrixWorldInverse,d.matrixWorld,d._modelViewMatrixArray);var f=THREE.Matrix4.makeInvert3x3(d._modelViewMatrix);f&&f.transposeIntoArray(d._normalMatrixArray)}function aO(d,e,f){ap!==d&&(d?au.enable(au.POLYGON_OFFSET_FILL):au.disable(au.POLYGON_OFFSET_FILL),ap=d);if(d&&(aK!==e||aC!==f)){au.polygonOffset(e,f),aK=e,aC=f}}function aQ(d,e){var f;"fragment"===d?f=au.createShader(au.FRAGMENT_SHADER):"vertex"===d&&(f=au.createShader(au.VERTEX_SHADER));au.shaderSource(f,e);au.compileShader(f);return !au.getShaderParameter(f,au.COMPILE_STATUS)?(console.error(au.getShaderInfoLog(f)),console.error(e),null):f}function aT(d,e,f){f?(au.texParameteri(d,au.TEXTURE_WRAP_S,U(e.wrapS)),au.texParameteri(d,au.TEXTURE_WRAP_T,U(e.wrapT)),au.texParameteri(d,au.TEXTURE_MAG_FILTER,U(e.magFilter)),au.texParameteri(d,au.TEXTURE_MIN_FILTER,U(e.minFilter))):(au.texParameteri(d,au.TEXTURE_WRAP_S,au.CLAMP_TO_EDGE),au.texParameteri(d,au.TEXTURE_WRAP_T,au.CLAMP_TO_EDGE),au.texParameteri(d,au.TEXTURE_MAG_FILTER,aY(e.magFilter)),au.texParameteri(d,au.TEXTURE_MIN_FILTER,aY(e.minFilter)))}function aU(c,d){au.bindRenderbuffer(au.RENDERBUFFER,c);d.depthBuffer&&!d.stencilBuffer?(au.renderbufferStorage(au.RENDERBUFFER,au.DEPTH_COMPONENT16,d.width,d.height),au.framebufferRenderbuffer(au.FRAMEBUFFER,au.DEPTH_ATTACHMENT,au.RENDERBUFFER,c)):d.depthBuffer&&d.stencilBuffer?(au.renderbufferStorage(au.RENDERBUFFER,au.DEPTH_STENCIL,d.width,d.height),au.framebufferRenderbuffer(au.FRAMEBUFFER,au.DEPTH_STENCIL_ATTACHMENT,au.RENDERBUFFER,c)):au.renderbufferStorage(au.RENDERBUFFER,au.RGBA4,d.width,d.height)}function aY(b){switch(b){case THREE.NearestFilter:case THREE.NearestMipMapNearestFilter:case THREE.NearestMipMapLinearFilter:return au.NEAREST;default:return au.LINEAR}}function U(b){switch(b){case THREE.RepeatWrapping:return au.REPEAT;case THREE.ClampToEdgeWrapping:return au.CLAMP_TO_EDGE;case THREE.MirroredRepeatWrapping:return au.MIRRORED_REPEAT;case THREE.NearestFilter:return au.NEAREST;case THREE.NearestMipMapNearestFilter:return au.NEAREST_MIPMAP_NEAREST;case THREE.NearestMipMapLinearFilter:return au.NEAREST_MIPMAP_LINEAR;case THREE.LinearFilter:return au.LINEAR;case THREE.LinearMipMapNearestFilter:return au.LINEAR_MIPMAP_NEAREST;case THREE.LinearMipMapLinearFilter:return au.LINEAR_MIPMAP_LINEAR;case THREE.ByteType:return au.BYTE;case THREE.UnsignedByteType:return au.UNSIGNED_BYTE;case THREE.ShortType:return au.SHORT;case THREE.UnsignedShortType:return au.UNSIGNED_SHORT;case THREE.IntType:return au.INT;case THREE.UnsignedShortType:return au.UNSIGNED_INT;case THREE.FloatType:return au.FLOAT;case THREE.AlphaFormat:return au.ALPHA;case THREE.RGBFormat:return au.RGB;case THREE.RGBAFormat:return au.RGBA;case THREE.LuminanceFormat:return au.LUMINANCE;case THREE.LuminanceAlphaFormat:return au.LUMINANCE_ALPHA}return 0}var F=F||{},ad=void 0!==F.canvas?F.canvas:document.createElement("canvas"),aa=void 0!==F.precision?F.precision:"mediump",J=void 0!==F.alpha?F.alpha:!0,ao=void 0!==F.premultipliedAlpha?F.premultipliedAlpha:!0,ar=void 0!==F.antialias?F.antialias:!1,aF=void 0!==F.stencil?F.stencil:!0,w=void 0!==F.preserveDrawingBuffer?F.preserveDrawingBuffer:!1,ay=void 0!==F.clearColor?new THREE.Color(F.clearColor):new THREE.Color(0),aJ=void 0!==F.clearAlpha?F.clearAlpha:0,aB=void 0!==F.maxLights?F.maxLights:4;this.domElement=ad;this.context=null;this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapCullFrontFaces=this.shadowMapSoft=this.shadowMapAutoUpdate=!0;this.maxMorphTargets=8;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var al=this,au,aW=[],a0=null,ai=null,aP=-1,aR=null,aM=null,az=0,am=null,aV=null,X=null,ab=null,ae=null,ap=null,aK=null,aC=null,a1=null,M=0,aw=0,af=0,z=0,aS=0,at=0,ag=new THREE.Frustum,aX=new THREE.Matrix4,aZ=new THREE.Vector4,aN=new THREE.Vector3,Y={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]}};au=function(){var c;try{if(!(c=ad.getContext("experimental-webgl",{alpha:J,premultipliedAlpha:ao,antialias:ar,stencil:aF,preserveDrawingBuffer:w}))){throw"Error creating WebGL context."}console.log(navigator.userAgent+" | "+c.getParameter(c.VERSION)+" | "+c.getParameter(c.VENDOR)+" | "+c.getParameter(c.RENDERER)+" | "+c.getParameter(c.SHADING_LANGUAGE_VERSION))}catch(d){console.error(d)}return c}();au.clearColor(0,0,0,1);au.clearDepth(1);au.clearStencil(0);au.enable(au.DEPTH_TEST);au.depthFunc(au.LEQUAL);au.frontFace(au.CCW);au.cullFace(au.BACK);au.enable(au.CULL_FACE);au.enable(au.BLEND);au.blendEquation(au.FUNC_ADD);au.blendFunc(au.SRC_ALPHA,au.ONE_MINUS_SRC_ALPHA);au.clearColor(ay.r,ay.g,ay.b,aJ);this.context=au;var av=au.getParameter(au.MAX_VERTEX_TEXTURE_IMAGE_UNITS);au.getParameter(au.MAX_TEXTURE_SIZE);var O=au.getParameter(au.MAX_CUBE_MAP_TEXTURE_SIZE);this.getContext=function(){return au};this.supportsVertexTextures=function(){return 0<av};this.setSize=function(c,d){ad.width=c;ad.height=d;this.setViewport(0,0,ad.width,ad.height)};this.setViewport=function(e,f,g,h){M=e;aw=f;af=g;z=h;au.viewport(M,aw,af,z)};this.setScissor=function(e,f,g,h){au.scissor(e,f,g,h)};this.enableScissorTest=function(b){b?au.enable(au.SCISSOR_TEST):au.disable(au.SCISSOR_TEST)};this.setClearColorHex=function(c,d){ay.setHex(c);aJ=d;au.clearColor(ay.r,ay.g,ay.b,aJ)};this.setClearColor=function(c,d){ay.copy(c);aJ=d;au.clearColor(ay.r,ay.g,ay.b,aJ)};this.getClearColor=function(){return ay};this.getClearAlpha=function(){return aJ};this.clear=function(e,f,g){var h=0;if(void 0===e||e){h|=au.COLOR_BUFFER_BIT}if(void 0===f||f){h|=au.DEPTH_BUFFER_BIT}if(void 0===g||g){h|=au.STENCIL_BUFFER_BIT}au.clear(h)};this.clearTarget=function(e,f,g,h){this.setRenderTarget(e);this.clear(f,g,h)};this.addPostPlugin=function(b){b.init(this);this.renderPluginsPost.push(b)};this.addPrePlugin=function(b){b.init(this);this.renderPluginsPre.push(b)};this.deallocateObject=function(f){if(f.__webglInit){if(f.__webglInit=!1,delete f._modelViewMatrix,delete f._normalMatrixArray,delete f._modelViewMatrixArray,delete f._objectMatrixArray,f instanceof THREE.Mesh){for(var g in f.geometry.geometryGroups){var h=f.geometry.geometryGroups[g];au.deleteBuffer(h.__webglVertexBuffer);au.deleteBuffer(h.__webglNormalBuffer);au.deleteBuffer(h.__webglTangentBuffer);au.deleteBuffer(h.__webglColorBuffer);au.deleteBuffer(h.__webglUVBuffer);au.deleteBuffer(h.__webglUV2Buffer);au.deleteBuffer(h.__webglSkinVertexABuffer);au.deleteBuffer(h.__webglSkinVertexBBuffer);au.deleteBuffer(h.__webglSkinIndicesBuffer);au.deleteBuffer(h.__webglSkinWeightsBuffer);au.deleteBuffer(h.__webglFaceBuffer);au.deleteBuffer(h.__webglLineBuffer);if(h.numMorphTargets){for(var i=0,j=h.numMorphTargets;i<j;i++){au.deleteBuffer(h.__webglMorphTargetsBuffers[i])}}if(h.__webglCustomAttributesList){for(i in i=void 0,h.__webglCustomAttributesList){au.deleteBuffer(h.__webglCustomAttributesList[i].buffer)}}al.info.memory.geometries--}}else{if(f instanceof THREE.Ribbon){f=f.geometry,au.deleteBuffer(f.__webglVertexBuffer),au.deleteBuffer(f.__webglColorBuffer),al.info.memory.geometries--}else{if(f instanceof THREE.Line){f=f.geometry,au.deleteBuffer(f.__webglVertexBuffer),au.deleteBuffer(f.__webglColorBuffer),al.info.memory.geometries--}else{if(f instanceof THREE.ParticleSystem){f=f.geometry,au.deleteBuffer(f.__webglVertexBuffer),au.deleteBuffer(f.__webglColorBuffer),al.info.memory.geometries--}}}}}};this.deallocateTexture=function(b){if(b.__webglInit){b.__webglInit=!1,au.deleteTexture(b.__webglTexture),al.info.memory.textures--}};this.updateShadowMap=function(c,d){a0=null;aP=aR=ae=ab=X=-1;this.shadowMapPlugin.update(c,d)};this.renderBufferImmediate=function(j,o,p){if(!j.__webglVertexBuffer){j.__webglVertexBuffer=au.createBuffer()}if(!j.__webglNormalBuffer){j.__webglNormalBuffer=au.createBuffer()}j.hasPos&&(au.bindBuffer(au.ARRAY_BUFFER,j.__webglVertexBuffer),au.bufferData(au.ARRAY_BUFFER,j.positionArray,au.DYNAMIC_DRAW),au.enableVertexAttribArray(o.attributes.position),au.vertexAttribPointer(o.attributes.position,3,au.FLOAT,!1,0,0));if(j.hasNormal){au.bindBuffer(au.ARRAY_BUFFER,j.__webglNormalBuffer);if(p===THREE.FlatShading){var r,s,t,u,v,x,A,y,C,B,D=3*j.count;for(B=0;B<D;B+=9){p=j.normalArray,r=p[B],s=p[B+1],t=p[B+2],u=p[B+3],x=p[B+4],y=p[B+5],v=p[B+6],A=p[B+7],C=p[B+8],r=(r+u+v)/3,s=(s+x+A)/3,t=(t+y+C)/3,p[B]=r,p[B+1]=s,p[B+2]=t,p[B+3]=r,p[B+4]=s,p[B+5]=t,p[B+6]=r,p[B+7]=s,p[B+8]=t}}au.bufferData(au.ARRAY_BUFFER,j.normalArray,au.DYNAMIC_DRAW);au.enableVertexAttribArray(o.attributes.normal);au.vertexAttribPointer(o.attributes.normal,3,au.FLOAT,!1,0,0)}au.drawArrays(au.TRIANGLES,0,j.count);j.count=0};this.renderBufferDirect=function(g,h,i,j,k,l){if(0!==j.opacity&&(i=aD(g,h,i,j,l),g=i.attributes,h=!1,j=16777215*k.id+2*i.id+(j.wireframe?1:0),j!==aR&&(aR=j,h=!0),l instanceof THREE.Mesh)){l=k.offsets;j=0;for(i=l.length;j<i;++j){h&&(au.bindBuffer(au.ARRAY_BUFFER,k.vertexPositionBuffer),au.vertexAttribPointer(g.position,k.vertexPositionBuffer.itemSize,au.FLOAT,!1,0,12*l[j].index),0<=g.normal&&k.vertexNormalBuffer&&(au.bindBuffer(au.ARRAY_BUFFER,k.vertexNormalBuffer),au.vertexAttribPointer(g.normal,k.vertexNormalBuffer.itemSize,au.FLOAT,!1,0,12*l[j].index)),0<=g.uv&&k.vertexUvBuffer&&(k.vertexUvBuffer?(au.bindBuffer(au.ARRAY_BUFFER,k.vertexUvBuffer),au.vertexAttribPointer(g.uv,k.vertexUvBuffer.itemSize,au.FLOAT,!1,0,8*l[j].index),au.enableVertexAttribArray(g.uv)):au.disableVertexAttribArray(g.uv)),0<=g.color&&k.vertexColorBuffer&&(au.bindBuffer(au.ARRAY_BUFFER,k.vertexColorBuffer),au.vertexAttribPointer(g.color,k.vertexColorBuffer.itemSize,au.FLOAT,!1,0,16*l[j].index)),au.bindBuffer(au.ELEMENT_ARRAY_BUFFER,k.vertexIndexBuffer)),au.drawElements(au.TRIANGLES,l[j].count,au.UNSIGNED_SHORT,2*l[j].start),al.info.render.calls++,al.info.render.vertices+=l[j].count,al.info.render.faces+=l[j].count/3}}};this.renderBuffer=function(j,m,o,p,r,s){if(0!==p.opacity){var t,u,o=aD(j,m,o,p,s),m=o.attributes,j=!1,o=16777215*r.id+2*o.id+(p.wireframe?1:0);o!==aR&&(aR=o,j=!0);if(!p.morphTargets&&0<=m.position){j&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglVertexBuffer),au.vertexAttribPointer(m.position,3,au.FLOAT,!1,0,0))}else{if(s.morphTargetBase){o=p.program.attributes;-1!==s.morphTargetBase?(au.bindBuffer(au.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[s.morphTargetBase]),au.vertexAttribPointer(o.position,3,au.FLOAT,!1,0,0)):0<=o.position&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglVertexBuffer),au.vertexAttribPointer(o.position,3,au.FLOAT,!1,0,0));if(s.morphTargetForcedOrder.length){t=0;var v=s.morphTargetForcedOrder;for(u=s.morphTargetInfluences;t<p.numSupportedMorphTargets&&t<v.length;){au.bindBuffer(au.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[v[t]]),au.vertexAttribPointer(o["morphTarget"+t],3,au.FLOAT,!1,0,0),s.__webglMorphTargetInfluences[t]=u[v[t]],t++}}else{var v=[],y=-1,x=0;u=s.morphTargetInfluences;var A,B=u.length;t=0;for(-1!==s.morphTargetBase&&(v[s.morphTargetBase]=!0);t<p.numSupportedMorphTargets;){for(A=0;A<B;A++){!v[A]&&u[A]>y&&(x=A,y=u[x])}au.bindBuffer(au.ARRAY_BUFFER,r.__webglMorphTargetsBuffers[x]);au.vertexAttribPointer(o["morphTarget"+t],3,au.FLOAT,!1,0,0);s.__webglMorphTargetInfluences[t]=y;v[x]=1;y=-1;t++}}null!==p.program.uniforms.morphTargetInfluences&&au.uniform1fv(p.program.uniforms.morphTargetInfluences,s.__webglMorphTargetInfluences)}}if(j){if(r.__webglCustomAttributesList){for(t=0,u=r.__webglCustomAttributesList.length;t<u;t++){o=r.__webglCustomAttributesList[t],0<=m[o.buffer.belongsToAttribute]&&(au.bindBuffer(au.ARRAY_BUFFER,o.buffer),au.vertexAttribPointer(m[o.buffer.belongsToAttribute],o.size,au.FLOAT,!1,0,0))}}0<=m.color&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglColorBuffer),au.vertexAttribPointer(m.color,3,au.FLOAT,!1,0,0));0<=m.normal&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglNormalBuffer),au.vertexAttribPointer(m.normal,3,au.FLOAT,!1,0,0));0<=m.tangent&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglTangentBuffer),au.vertexAttribPointer(m.tangent,4,au.FLOAT,!1,0,0));0<=m.uv&&(r.__webglUVBuffer?(au.bindBuffer(au.ARRAY_BUFFER,r.__webglUVBuffer),au.vertexAttribPointer(m.uv,2,au.FLOAT,!1,0,0),au.enableVertexAttribArray(m.uv)):au.disableVertexAttribArray(m.uv));0<=m.uv2&&(r.__webglUV2Buffer?(au.bindBuffer(au.ARRAY_BUFFER,r.__webglUV2Buffer),au.vertexAttribPointer(m.uv2,2,au.FLOAT,!1,0,0),au.enableVertexAttribArray(m.uv2)):au.disableVertexAttribArray(m.uv2));p.skinning&&0<=m.skinVertexA&&0<=m.skinVertexB&&0<=m.skinIndex&&0<=m.skinWeight&&(au.bindBuffer(au.ARRAY_BUFFER,r.__webglSkinVertexABuffer),au.vertexAttribPointer(m.skinVertexA,4,au.FLOAT,!1,0,0),au.bindBuffer(au.ARRAY_BUFFER,r.__webglSkinVertexBBuffer),au.vertexAttribPointer(m.skinVertexB,4,au.FLOAT,!1,0,0),au.bindBuffer(au.ARRAY_BUFFER,r.__webglSkinIndicesBuffer),au.vertexAttribPointer(m.skinIndex,4,au.FLOAT,!1,0,0),au.bindBuffer(au.ARRAY_BUFFER,r.__webglSkinWeightsBuffer),au.vertexAttribPointer(m.skinWeight,4,au.FLOAT,!1,0,0))}s instanceof THREE.Mesh?(p.wireframe?(p=p.wireframeLinewidth,p!==a1&&(au.lineWidth(p),a1=p),j&&au.bindBuffer(au.ELEMENT_ARRAY_BUFFER,r.__webglLineBuffer),au.drawElements(au.LINES,r.__webglLineCount,au.UNSIGNED_SHORT,0)):(j&&au.bindBuffer(au.ELEMENT_ARRAY_BUFFER,r.__webglFaceBuffer),au.drawElements(au.TRIANGLES,r.__webglFaceCount,au.UNSIGNED_SHORT,0)),al.info.render.calls++,al.info.render.vertices+=r.__webglFaceCount,al.info.render.faces+=r.__webglFaceCount/3):s instanceof THREE.Line?(s=s.type===THREE.LineStrip?au.LINE_STRIP:au.LINES,p=p.linewidth,p!==a1&&(au.lineWidth(p),a1=p),au.drawArrays(s,0,r.__webglLineCount),al.info.render.calls++):s instanceof THREE.ParticleSystem?(au.drawArrays(au.POINTS,0,r.__webglParticleCount),al.info.render.calls++,al.info.render.points+=r.__webglParticleCount):s instanceof THREE.Ribbon&&(au.drawArrays(au.TRIANGLE_STRIP,0,r.__webglVertexCount),al.info.render.calls++)}};this.render=function(g,h,i,j){var l,s,u,v,x=g.lights,B=g.fog;aP=-1;this.autoUpdateObjects&&this.initWebGLObjects(g);void 0===h.parent&&(console.warn("DEPRECATED: Camera hasn't been added to a Scene. Adding it..."),g.add(h));this.autoUpdateScene&&g.updateMatrixWorld();an(this.renderPluginsPre,g,h);al.info.render.calls=0;al.info.render.vertices=0;al.info.render.faces=0;al.info.render.points=0;h.matrixWorldInverse.getInverse(h.matrixWorld);if(!h._viewMatrixArray){h._viewMatrixArray=new Float32Array(16)}h.matrixWorldInverse.flattenToArray(h._viewMatrixArray);if(!h._projectionMatrixArray){h._projectionMatrixArray=new Float32Array(16)}h.projectionMatrix.flattenToArray(h._projectionMatrixArray);aX.multiply(h.projectionMatrix,h.matrixWorldInverse);ag.setFromMatrix(aX);this.setRenderTarget(i);(this.autoClear||j)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);v=g.__webglObjects;for(j=0,l=v.length;j<l;j++){if(s=v[j],u=s.object,s.render=!1,u.visible&&(!(u instanceof THREE.Mesh||u instanceof THREE.ParticleSystem)||!u.frustumCulled||ag.contains(u))){u.matrixWorld.flattenToArray(u._objectMatrixArray);aL(u,h);var y=s,A=y.object,C=y.buffer,r=void 0,r=r=void 0,r=A.material;if(r instanceof THREE.MeshFaceMaterial){if(r=C.materialIndex,0<=r){r=A.geometry.materials[r],r.transparent?(y.transparent=r,y.opaque=null):(y.opaque=r,y.transparent=null)}}else{if(r){r.transparent?(y.transparent=r,y.opaque=null):(y.opaque=r,y.transparent=null)}}s.render=!0;if(this.sortObjects){u.renderDepth?s.z=u.renderDepth:(aZ.copy(u.position),aX.multiplyVector3(aZ),s.z=aZ.z)}}}this.sortObjects&&v.sort(ak);v=g.__webglObjectsImmediate;for(j=0,l=v.length;j<l;j++){if(s=v[j],u=s.object,u.visible){u.matrixAutoUpdate&&u.matrixWorld.flattenToArray(u._objectMatrixArray),aL(u,h),u=s.object.material,u.transparent?(s.transparent=u,s.opaque=null):(s.opaque=u,s.transparent=null)}}g.overrideMaterial?(this.setBlending(g.overrideMaterial.blending),this.setDepthTest(g.overrideMaterial.depthTest),this.setDepthWrite(g.overrideMaterial.depthWrite),aO(g.overrideMaterial.polygonOffset,g.overrideMaterial.polygonOffsetFactor,g.overrideMaterial.polygonOffsetUnits),aq(g.__webglObjects,!1,"",h,x,B,!0,g.overrideMaterial),aA(g.__webglObjectsImmediate,"",h,x,B,!1,g.overrideMaterial)):(this.setBlending(THREE.NormalBlending),aq(g.__webglObjects,!0,"opaque",h,x,B,!1),aA(g.__webglObjectsImmediate,"opaque",h,x,B,!1),aq(g.__webglObjects,!1,"transparent",h,x,B,!0),aA(g.__webglObjectsImmediate,"transparent",h,x,B,!0));an(this.renderPluginsPost,g,h);i&&i.generateMipmaps&&i.minFilter!==THREE.NearestFilter&&i.minFilter!==THREE.LinearFilter&&(i instanceof THREE.WebGLRenderTargetCube?(au.bindTexture(au.TEXTURE_CUBE_MAP,i.__webglTexture),au.generateMipmap(au.TEXTURE_CUBE_MAP),au.bindTexture(au.TEXTURE_CUBE_MAP,null)):(au.bindTexture(au.TEXTURE_2D,i.__webglTexture),au.generateMipmap(au.TEXTURE_2D),au.bindTexture(au.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)};this.renderImmediateObject=function(g,h,i,j,k){var l=aD(g,h,i,j,k);aR=-1;al.setObjectFaces(k);k.immediateRenderCallback?k.immediateRenderCallback(l,au,ag):k.render(function(b){al.renderBufferImmediate(b,l,j.shading)})};this.initWebGLObjects=function(f){if(!f.__webglObjects){f.__webglObjects=[],f.__webglObjectsImmediate=[],f.__webglSprites=[],f.__webglFlares=[]}for(;f.__objectsAdded.length;){var bG=f.__objectsAdded[0],bM=f,bU=void 0,cj=void 0,cr=void 0;if(!bG.__webglInit){if(bG.__webglInit=!0,bG._modelViewMatrix=new THREE.Matrix4,bG._normalMatrixArray=new Float32Array(9),bG._modelViewMatrixArray=new Float32Array(16),bG._objectMatrixArray=new Float32Array(16),bG.matrixWorld.flattenToArray(bG._objectMatrixArray),bG instanceof THREE.Mesh){if(cj=bG.geometry,cj instanceof THREE.Geometry){if(void 0===cj.geometryGroups){var c3=cj,dg=void 0,bt=void 0,dq=void 0,dG=void 0,dh=void 0,d2=void 0,dy=void 0,dU={},dr=c3.morphTargets.length;c3.geometryGroups={};for(dg=0,bt=c3.faces.length;dg<bt;dg++){dq=c3.faces[dg],dG=dq.materialIndex,d2=void 0!==dG?dG:-1,void 0===dU[d2]&&(dU[d2]={hash:d2,counter:0}),dy=dU[d2].hash+"_"+dU[d2].counter,void 0===c3.geometryGroups[dy]&&(c3.geometryGroups[dy]={faces3:[],faces4:[],materialIndex:dG,vertices:0,numMorphTargets:dr}),dh=dq instanceof THREE.Face3?3:4,65535<c3.geometryGroups[dy].vertices+dh&&(dU[d2].counter+=1,dy=dU[d2].hash+"_"+dU[d2].counter,void 0===c3.geometryGroups[dy]&&(c3.geometryGroups[dy]={faces3:[],faces4:[],materialIndex:dG,vertices:0,numMorphTargets:dr})),dq instanceof THREE.Face3?c3.geometryGroups[dy].faces3.push(dg):c3.geometryGroups[dy].faces4.push(dg),c3.geometryGroups[dy].vertices+=dh}c3.geometryGroupsList=[];var a9=void 0;for(a9 in c3.geometryGroups){c3.geometryGroups[a9].id=az++,c3.geometryGroupsList.push(c3.geometryGroups[a9])}}for(bU in cj.geometryGroups){if(cr=cj.geometryGroups[bU],!cr.__webglVertexBuffer){var j=cr;j.__webglVertexBuffer=au.createBuffer();j.__webglNormalBuffer=au.createBuffer();j.__webglTangentBuffer=au.createBuffer();j.__webglColorBuffer=au.createBuffer();j.__webglUVBuffer=au.createBuffer();j.__webglUV2Buffer=au.createBuffer();j.__webglSkinVertexABuffer=au.createBuffer();j.__webglSkinVertexBBuffer=au.createBuffer();j.__webglSkinIndicesBuffer=au.createBuffer();j.__webglSkinWeightsBuffer=au.createBuffer();j.__webglFaceBuffer=au.createBuffer();j.__webglLineBuffer=au.createBuffer();if(j.numMorphTargets){var G=void 0,bl=void 0;j.__webglMorphTargetsBuffers=[];for(G=0,bl=j.numMorphTargets;G<bl;G++){j.__webglMorphTargetsBuffers.push(au.createBuffer())}}al.info.memory.geometries++;var c4=cr,bN=bG,ck=bN.geometry,dH=c4.faces3,b9=c4.faces4,bV=3*dH.length+4*b9.length,cA=1*dH.length+2*b9.length,bH=3*dH.length+4*b9.length,a2=Z(bN,c4),be=ah(a2),cV=ac(a2),bm=a2.vertexColors?a2.vertexColors:!1;c4.__vertexArray=new Float32Array(3*bV);if(cV){c4.__normalArray=new Float32Array(3*bV)}if(ck.hasTangents){c4.__tangentArray=new Float32Array(4*bV)}if(bm){c4.__colorArray=new Float32Array(3*bV)}if(be){if(0<ck.faceUvs.length||0<ck.faceVertexUvs.length){c4.__uvArray=new Float32Array(2*bV)}if(1<ck.faceUvs.length||1<ck.faceVertexUvs.length){c4.__uv2Array=new Float32Array(2*bV)}}if(bN.geometry.skinWeights.length&&bN.geometry.skinIndices.length){c4.__skinVertexAArray=new Float32Array(4*bV),c4.__skinVertexBArray=new Float32Array(4*bV),c4.__skinIndexArray=new Float32Array(4*bV),c4.__skinWeightArray=new Float32Array(4*bV)}c4.__faceArray=new Uint16Array(3*cA);c4.__lineArray=new Uint16Array(2*bH);if(c4.numMorphTargets){c4.__morphTargetsArrays=[];for(var bO=0,dO=c4.numMorphTargets;bO<dO;bO++){c4.__morphTargetsArrays.push(new Float32Array(3*bV))}}c4.__webglFaceCount=3*cA;c4.__webglLineCount=2*bH;if(a2.attributes){if(void 0===c4.__webglCustomAttributesList){c4.__webglCustomAttributesList=[]}var b=void 0;for(b in a2.attributes){var cX=a2.attributes[b],cl={},ee;for(ee in cX){cl[ee]=cX[ee]}if(!cl.__webglInitialized||cl.createUniqueBuffers){cl.__webglInitialized=!0;var b3=1;"v2"===cl.type?b3=2:"v3"===cl.type?b3=3:"v4"===cl.type?b3=4:"c"===cl.type&&(b3=3);cl.size=b3;cl.array=new Float32Array(bV*b3);cl.buffer=au.createBuffer();cl.buffer.belongsToAttribute=b;cX.needsUpdate=!0;cl.__original=cX}c4.__webglCustomAttributesList.push(cl)}}c4.__inittedArrays=!0;cj.__dirtyVertices=!0;cj.__dirtyMorphTargets=!0;cj.__dirtyElements=!0;cj.__dirtyUvs=!0;cj.__dirtyNormals=!0;cj.__dirtyTangents=!0;cj.__dirtyColors=!0}}}}else{if(bG instanceof THREE.Ribbon){if(cj=bG.geometry,!cj.__webglVertexBuffer){var c5=cj;c5.__webglVertexBuffer=au.createBuffer();c5.__webglColorBuffer=au.createBuffer();al.info.memory.geometries++;var k=cj,bn=k.vertices.length;k.__vertexArray=new Float32Array(3*bn);k.__colorArray=new Float32Array(3*bn);k.__webglVertexCount=bn;cj.__dirtyVertices=!0;cj.__dirtyColors=!0}}else{if(bG instanceof THREE.Line){if(cj=bG.geometry,!cj.__webglVertexBuffer){var a3=cj;a3.__webglVertexBuffer=au.createBuffer();a3.__webglColorBuffer=au.createBuffer();al.info.memory.geometries++;var b4=cj,dQ=bG,c=b4.vertices.length;b4.__vertexArray=new Float32Array(3*c);b4.__colorArray=new Float32Array(3*c);b4.__webglLineCount=c;P(b4,dQ);cj.__dirtyVertices=!0;cj.__dirtyColors=!0}}else{if(bG instanceof THREE.ParticleSystem&&(cj=bG.geometry,!cj.__webglVertexBuffer)){var dX=cj;dX.__webglVertexBuffer=au.createBuffer();dX.__webglColorBuffer=au.createBuffer();al.info.geometries++;var dt=cj,bo=bG,bY=dt.vertices.length;dt.__vertexArray=new Float32Array(3*bY);dt.__colorArray=new Float32Array(3*bY);dt.__sortArray=[];dt.__webglParticleCount=bY;P(dt,bo);cj.__dirtyVertices=!0;cj.__dirtyColors=!0}}}}}if(!bG.__webglActive){if(bG instanceof THREE.Mesh){if(cj=bG.geometry,cj instanceof THREE.BufferGeometry){ax(bM.__webglObjects,cj,bG)}else{for(bU in cj.geometryGroups){cr=cj.geometryGroups[bU],ax(bM.__webglObjects,cr,bG)}}}else{bG instanceof THREE.Ribbon||bG instanceof THREE.Line||bG instanceof THREE.ParticleSystem?(cj=bG.geometry,ax(bM.__webglObjects,cj,bG)):void 0!==THREE.MarchingCubes&&bG instanceof THREE.MarchingCubes||bG.immediateRenderCallback?bM.__webglObjectsImmediate.push({object:bG,opaque:null,transparent:null}):bG instanceof THREE.Sprite?bM.__webglSprites.push(bG):bG instanceof THREE.LensFlare&&bM.__webglFlares.push(bG)}bG.__webglActive=!0}f.__objectsAdded.splice(0,1)}for(;f.__objectsRemoved.length;){var bC=f.__objectsRemoved[0],n=f;bC instanceof THREE.Mesh||bC instanceof THREE.ParticleSystem||bC instanceof THREE.Ribbon||bC instanceof THREE.Line?aG(n.__webglObjects,bC):bC instanceof THREE.Sprite?aH(n.__webglSprites,bC):bC instanceof THREE.LensFlare?aH(n.__webglFlares,bC):(bC instanceof THREE.MarchingCubes||bC.immediateRenderCallback)&&aG(n.__webglObjectsImmediate,bC);bC.__webglActive=!1;f.__objectsRemoved.splice(0,1)}for(var cy=0,bT=f.__webglObjects.length;cy<bT;cy++){var cn=f.__webglObjects[cy].object,bW=cn.geometry,b6=void 0,d=void 0,dB=void 0;if(cn instanceof THREE.Mesh){if(bW instanceof THREE.BufferGeometry){bW.__dirtyVertices=!1,bW.__dirtyElements=!1,bW.__dirtyUvs=!1,bW.__dirtyNormals=!1,bW.__dirtyColors=!1}else{for(var cF=0,b1=bW.geometryGroupsList.length;cF<b1;cF++){if(b6=bW.geometryGroupsList[cF],dB=Z(cn,b6),d=dB.attributes&&aE(dB),bW.__dirtyVertices||bW.__dirtyMorphTargets||bW.__dirtyElements||bW.__dirtyUvs||bW.__dirtyNormals||bW.__dirtyColors||bW.__dirtyTangents||d){var bu=b6,b8=cn,a4=au.DYNAMIC_DRAW,ci=!bW.dynamic,d0=dB;if(bu.__inittedArrays){var dT=ac(d0),cM=d0.vertexColors?d0.vertexColors:!1,d1=ah(d0),d8=dT===THREE.SmoothShading,bz=void 0,dz=void 0,cf=void 0,cs=void 0,o=void 0,bR=void 0,cv=void 0,d7=void 0,a5=void 0,a6=void 0,bi=void 0,dV=void 0,d3=void 0,eb=void 0,cO=void 0,cC=void 0,cJ=void 0,cQ=void 0,ch=void 0,cY=void 0,c7=void 0,dk=void 0,cp=void 0,du=void 0,dC=void 0,dK=void 0,cx=void 0,dR=void 0,dY=void 0,d6=void 0,cE=void 0,bZ=void 0,b5=void 0,cg=void 0,eh=void 0,co=void 0,cw=void 0,cD=void 0,p=void 0,ct=void 0,ei=void 0,cK=void 0,bq=void 0,bw=void 0,bg=void 0,e=void 0,ce=void 0,bf=0,bX=0,bh=0,bp=0,bJ=0,cP=0,cW=0,c6=0,bB=0,b2=0,bI=0,d9=0,d5=void 0,cm=bu.__vertexArray,cL=bu.__uvArray,cS=bu.__uv2Array,bQ=bu.__normalArray,ds=bu.__tangentArray,cu=bu.__colorArray,dA=bu.__skinVertexAArray,dI=bu.__skinVertexBArray,dP=bu.__skinIndexArray,dW=bu.__skinWeightArray,cT=bu.__morphTargetsArrays,c1=bu.__webglCustomAttributesList,dN=void 0,eg=bu.__faceArray,ef=bu.__lineArray,dj=b8.geometry,cq=dj.__dirtyElements,q=dj.__dirtyUvs,cz=dj.__dirtyNormals,cG=dj.__dirtyTangents,cN=dj.__dirtyColors,cU=dj.__dirtyMorphTargets,dD=dj.vertices,cB=bu.faces3,cH=bu.faces4,bP=dj.faces,de=dj.faceVertexUvs[0],dn=dj.faceVertexUvs[1],dL=dj.skinVerticesA,dS=dj.skinVerticesB,dZ=dj.skinIndices,cR=dj.skinWeights,cZ=dj.morphTargets;if(dj.__dirtyVertices){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dV=dD[cs.a].position,d3=dD[cs.b].position,eb=dD[cs.c].position,cm[bX]=dV.x,cm[bX+1]=dV.y,cm[bX+2]=dV.z,cm[bX+3]=d3.x,cm[bX+4]=d3.y,cm[bX+5]=d3.z,cm[bX+6]=eb.x,cm[bX+7]=eb.y,cm[bX+8]=eb.z,bX+=9}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dV=dD[cs.a].position,d3=dD[cs.b].position,eb=dD[cs.c].position,cO=dD[cs.d].position,cm[bX]=dV.x,cm[bX+1]=dV.y,cm[bX+2]=dV.z,cm[bX+3]=d3.x,cm[bX+4]=d3.y,cm[bX+5]=d3.z,cm[bX+6]=eb.x,cm[bX+7]=eb.y,cm[bX+8]=eb.z,cm[bX+9]=cO.x,cm[bX+10]=cO.y,cm[bX+11]=cO.z,bX+=12}au.bindBuffer(au.ARRAY_BUFFER,bu.__webglVertexBuffer);au.bufferData(au.ARRAY_BUFFER,cm,a4)}if(cU){for(bg=0,e=cZ.length;bg<e;bg++){bI=0;for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dV=cZ[bg].vertices[cs.a].position,d3=cZ[bg].vertices[cs.b].position,eb=cZ[bg].vertices[cs.c].position,ce=cT[bg],ce[bI]=dV.x,ce[bI+1]=dV.y,ce[bI+2]=dV.z,ce[bI+3]=d3.x,ce[bI+4]=d3.y,ce[bI+5]=d3.z,ce[bI+6]=eb.x,ce[bI+7]=eb.y,ce[bI+8]=eb.z,bI+=9}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dV=cZ[bg].vertices[cs.a].position,d3=cZ[bg].vertices[cs.b].position,eb=cZ[bg].vertices[cs.c].position,cO=cZ[bg].vertices[cs.d].position,ce=cT[bg],ce[bI]=dV.x,ce[bI+1]=dV.y,ce[bI+2]=dV.z,ce[bI+3]=d3.x,ce[bI+4]=d3.y,ce[bI+5]=d3.z,ce[bI+6]=eb.x,ce[bI+7]=eb.y,ce[bI+8]=eb.z,ce[bI+9]=cO.x,ce[bI+10]=cO.y,ce[bI+11]=cO.z,bI+=12}au.bindBuffer(au.ARRAY_BUFFER,bu.__webglMorphTargetsBuffers[bg]);au.bufferData(au.ARRAY_BUFFER,cT[bg],a4)}}if(cR.length){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],du=cR[cs.a],dC=cR[cs.b],dK=cR[cs.c],dW[b2]=du.x,dW[b2+1]=du.y,dW[b2+2]=du.z,dW[b2+3]=du.w,dW[b2+4]=dC.x,dW[b2+5]=dC.y,dW[b2+6]=dC.z,dW[b2+7]=dC.w,dW[b2+8]=dK.x,dW[b2+9]=dK.y,dW[b2+10]=dK.z,dW[b2+11]=dK.w,dR=dZ[cs.a],dY=dZ[cs.b],d6=dZ[cs.c],dP[b2]=dR.x,dP[b2+1]=dR.y,dP[b2+2]=dR.z,dP[b2+3]=dR.w,dP[b2+4]=dY.x,dP[b2+5]=dY.y,dP[b2+6]=dY.z,dP[b2+7]=dY.w,dP[b2+8]=d6.x,dP[b2+9]=d6.y,dP[b2+10]=d6.z,dP[b2+11]=d6.w,bZ=dL[cs.a],b5=dL[cs.b],cg=dL[cs.c],dA[b2]=bZ.x,dA[b2+1]=bZ.y,dA[b2+2]=bZ.z,dA[b2+3]=1,dA[b2+4]=b5.x,dA[b2+5]=b5.y,dA[b2+6]=b5.z,dA[b2+7]=1,dA[b2+8]=cg.x,dA[b2+9]=cg.y,dA[b2+10]=cg.z,dA[b2+11]=1,co=dS[cs.a],cw=dS[cs.b],cD=dS[cs.c],dI[b2]=co.x,dI[b2+1]=co.y,dI[b2+2]=co.z,dI[b2+3]=1,dI[b2+4]=cw.x,dI[b2+5]=cw.y,dI[b2+6]=cw.z,dI[b2+7]=1,dI[b2+8]=cD.x,dI[b2+9]=cD.y,dI[b2+10]=cD.z,dI[b2+11]=1,b2+=12}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],du=cR[cs.a],dC=cR[cs.b],dK=cR[cs.c],cx=cR[cs.d],dW[b2]=du.x,dW[b2+1]=du.y,dW[b2+2]=du.z,dW[b2+3]=du.w,dW[b2+4]=dC.x,dW[b2+5]=dC.y,dW[b2+6]=dC.z,dW[b2+7]=dC.w,dW[b2+8]=dK.x,dW[b2+9]=dK.y,dW[b2+10]=dK.z,dW[b2+11]=dK.w,dW[b2+12]=cx.x,dW[b2+13]=cx.y,dW[b2+14]=cx.z,dW[b2+15]=cx.w,dR=dZ[cs.a],dY=dZ[cs.b],d6=dZ[cs.c],cE=dZ[cs.d],dP[b2]=dR.x,dP[b2+1]=dR.y,dP[b2+2]=dR.z,dP[b2+3]=dR.w,dP[b2+4]=dY.x,dP[b2+5]=dY.y,dP[b2+6]=dY.z,dP[b2+7]=dY.w,dP[b2+8]=d6.x,dP[b2+9]=d6.y,dP[b2+10]=d6.z,dP[b2+11]=d6.w,dP[b2+12]=cE.x,dP[b2+13]=cE.y,dP[b2+14]=cE.z,dP[b2+15]=cE.w,bZ=dL[cs.a],b5=dL[cs.b],cg=dL[cs.c],eh=dL[cs.d],dA[b2]=bZ.x,dA[b2+1]=bZ.y,dA[b2+2]=bZ.z,dA[b2+3]=1,dA[b2+4]=b5.x,dA[b2+5]=b5.y,dA[b2+6]=b5.z,dA[b2+7]=1,dA[b2+8]=cg.x,dA[b2+9]=cg.y,dA[b2+10]=cg.z,dA[b2+11]=1,dA[b2+12]=eh.x,dA[b2+13]=eh.y,dA[b2+14]=eh.z,dA[b2+15]=1,co=dS[cs.a],cw=dS[cs.b],cD=dS[cs.c],p=dS[cs.d],dI[b2]=co.x,dI[b2+1]=co.y,dI[b2+2]=co.z,dI[b2+3]=1,dI[b2+4]=cw.x,dI[b2+5]=cw.y,dI[b2+6]=cw.z,dI[b2+7]=1,dI[b2+8]=cD.x,dI[b2+9]=cD.y,dI[b2+10]=cD.z,dI[b2+11]=1,dI[b2+12]=p.x,dI[b2+13]=p.y,dI[b2+14]=p.z,dI[b2+15]=1,b2+=16}0<b2&&(au.bindBuffer(au.ARRAY_BUFFER,bu.__webglSkinVertexABuffer),au.bufferData(au.ARRAY_BUFFER,dA,a4),au.bindBuffer(au.ARRAY_BUFFER,bu.__webglSkinVertexBBuffer),au.bufferData(au.ARRAY_BUFFER,dI,a4),au.bindBuffer(au.ARRAY_BUFFER,bu.__webglSkinIndicesBuffer),au.bufferData(au.ARRAY_BUFFER,dP,a4),au.bindBuffer(au.ARRAY_BUFFER,bu.__webglSkinWeightsBuffer),au.bufferData(au.ARRAY_BUFFER,dW,a4))}if(cN&&cM){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],cv=cs.vertexColors,d7=cs.color,3===cv.length&&cM===THREE.VertexColors?(cY=cv[0],c7=cv[1],dk=cv[2]):dk=c7=cY=d7,cu[bB]=cY.r,cu[bB+1]=cY.g,cu[bB+2]=cY.b,cu[bB+3]=c7.r,cu[bB+4]=c7.g,cu[bB+5]=c7.b,cu[bB+6]=dk.r,cu[bB+7]=dk.g,cu[bB+8]=dk.b,bB+=9}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],cv=cs.vertexColors,d7=cs.color,4===cv.length&&cM===THREE.VertexColors?(cY=cv[0],c7=cv[1],dk=cv[2],cp=cv[3]):cp=dk=c7=cY=d7,cu[bB]=cY.r,cu[bB+1]=cY.g,cu[bB+2]=cY.b,cu[bB+3]=c7.r,cu[bB+4]=c7.g,cu[bB+5]=c7.b,cu[bB+6]=dk.r,cu[bB+7]=dk.g,cu[bB+8]=dk.b,cu[bB+9]=cp.r,cu[bB+10]=cp.g,cu[bB+11]=cp.b,bB+=12}0<bB&&(au.bindBuffer(au.ARRAY_BUFFER,bu.__webglColorBuffer),au.bufferData(au.ARRAY_BUFFER,cu,a4))}if(cG&&dj.hasTangents){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],a5=cs.vertexTangents,cC=a5[0],cJ=a5[1],cQ=a5[2],ds[cW]=cC.x,ds[cW+1]=cC.y,ds[cW+2]=cC.z,ds[cW+3]=cC.w,ds[cW+4]=cJ.x,ds[cW+5]=cJ.y,ds[cW+6]=cJ.z,ds[cW+7]=cJ.w,ds[cW+8]=cQ.x,ds[cW+9]=cQ.y,ds[cW+10]=cQ.z,ds[cW+11]=cQ.w,cW+=12}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],a5=cs.vertexTangents,cC=a5[0],cJ=a5[1],cQ=a5[2],ch=a5[3],ds[cW]=cC.x,ds[cW+1]=cC.y,ds[cW+2]=cC.z,ds[cW+3]=cC.w,ds[cW+4]=cJ.x,ds[cW+5]=cJ.y,ds[cW+6]=cJ.z,ds[cW+7]=cJ.w,ds[cW+8]=cQ.x,ds[cW+9]=cQ.y,ds[cW+10]=cQ.z,ds[cW+11]=cQ.w,ds[cW+12]=ch.x,ds[cW+13]=ch.y,ds[cW+14]=ch.z,ds[cW+15]=ch.w,cW+=16}au.bindBuffer(au.ARRAY_BUFFER,bu.__webglTangentBuffer);au.bufferData(au.ARRAY_BUFFER,ds,a4)}if(cz&&dT){for(bz=0,dz=cB.length;bz<dz;bz++){if(cs=bP[cB[bz]],o=cs.vertexNormals,bR=cs.normal,3===o.length&&d8){for(ct=0;3>ct;ct++){cK=o[ct],bQ[cP]=cK.x,bQ[cP+1]=cK.y,bQ[cP+2]=cK.z,cP+=3}}else{for(ct=0;3>ct;ct++){bQ[cP]=bR.x,bQ[cP+1]=bR.y,bQ[cP+2]=bR.z,cP+=3}}}for(bz=0,dz=cH.length;bz<dz;bz++){if(cs=bP[cH[bz]],o=cs.vertexNormals,bR=cs.normal,4===o.length&&d8){for(ct=0;4>ct;ct++){cK=o[ct],bQ[cP]=cK.x,bQ[cP+1]=cK.y,bQ[cP+2]=cK.z,cP+=3}}else{for(ct=0;4>ct;ct++){bQ[cP]=bR.x,bQ[cP+1]=bR.y,bQ[cP+2]=bR.z,cP+=3}}}au.bindBuffer(au.ARRAY_BUFFER,bu.__webglNormalBuffer);au.bufferData(au.ARRAY_BUFFER,bQ,a4)}if(q&&de&&d1){for(bz=0,dz=cB.length;bz<dz;bz++){if(cf=cB[bz],cs=bP[cf],a6=de[cf],void 0!==a6){for(ct=0;3>ct;ct++){bq=a6[ct],cL[bh]=bq.u,cL[bh+1]=bq.v,bh+=2}}}for(bz=0,dz=cH.length;bz<dz;bz++){if(cf=cH[bz],cs=bP[cf],a6=de[cf],void 0!==a6){for(ct=0;4>ct;ct++){bq=a6[ct],cL[bh]=bq.u,cL[bh+1]=bq.v,bh+=2}}}0<bh&&(au.bindBuffer(au.ARRAY_BUFFER,bu.__webglUVBuffer),au.bufferData(au.ARRAY_BUFFER,cL,a4))}if(q&&dn&&d1){for(bz=0,dz=cB.length;bz<dz;bz++){if(cf=cB[bz],cs=bP[cf],bi=dn[cf],void 0!==bi){for(ct=0;3>ct;ct++){bw=bi[ct],cS[bp]=bw.u,cS[bp+1]=bw.v,bp+=2}}}for(bz=0,dz=cH.length;bz<dz;bz++){if(cf=cH[bz],cs=bP[cf],bi=dn[cf],void 0!==bi){for(ct=0;4>ct;ct++){bw=bi[ct],cS[bp]=bw.u,cS[bp+1]=bw.v,bp+=2}}}0<bp&&(au.bindBuffer(au.ARRAY_BUFFER,bu.__webglUV2Buffer),au.bufferData(au.ARRAY_BUFFER,cS,a4))}if(cq){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],eg[bJ]=bf,eg[bJ+1]=bf+1,eg[bJ+2]=bf+2,bJ+=3,ef[c6]=bf,ef[c6+1]=bf+1,ef[c6+2]=bf,ef[c6+3]=bf+2,ef[c6+4]=bf+1,ef[c6+5]=bf+2,c6+=6,bf+=3}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],eg[bJ]=bf,eg[bJ+1]=bf+1,eg[bJ+2]=bf+3,eg[bJ+3]=bf+1,eg[bJ+4]=bf+2,eg[bJ+5]=bf+3,bJ+=6,ef[c6]=bf,ef[c6+1]=bf+1,ef[c6+2]=bf,ef[c6+3]=bf+3,ef[c6+4]=bf+1,ef[c6+5]=bf+2,ef[c6+6]=bf+2,ef[c6+7]=bf+3,c6+=8,bf+=4}au.bindBuffer(au.ELEMENT_ARRAY_BUFFER,bu.__webglFaceBuffer);au.bufferData(au.ELEMENT_ARRAY_BUFFER,eg,a4);au.bindBuffer(au.ELEMENT_ARRAY_BUFFER,bu.__webglLineBuffer);au.bufferData(au.ELEMENT_ARRAY_BUFFER,ef,a4)}if(c1){for(ct=0,ei=c1.length;ct<ei;ct++){if(dN=c1[ct],dN.__original.needsUpdate){d9=0;if(1===dN.size){if(void 0===dN.boundTo||"vertices"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dN.array[d9]=dN.value[cs.a],dN.array[d9+1]=dN.value[cs.b],dN.array[d9+2]=dN.value[cs.c],d9+=3}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dN.array[d9]=dN.value[cs.a],dN.array[d9+1]=dN.value[cs.b],dN.array[d9+2]=dN.value[cs.c],dN.array[d9+3]=dN.value[cs.d],d9+=4}}else{if("faces"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){d5=dN.value[cB[bz]],dN.array[d9]=d5,dN.array[d9+1]=d5,dN.array[d9+2]=d5,d9+=3}for(bz=0,dz=cH.length;bz<dz;bz++){d5=dN.value[cH[bz]],dN.array[d9]=d5,dN.array[d9+1]=d5,dN.array[d9+2]=d5,dN.array[d9+3]=d5,d9+=4}}}}else{if(2===dN.size){if(void 0===dN.boundTo||"vertices"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=d3.x,dN.array[d9+3]=d3.y,dN.array[d9+4]=eb.x,dN.array[d9+5]=eb.y,d9+=6}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],cO=dN.value[cs.d],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=d3.x,dN.array[d9+3]=d3.y,dN.array[d9+4]=eb.x,dN.array[d9+5]=eb.y,dN.array[d9+6]=cO.x,dN.array[d9+7]=cO.y,d9+=8}}else{if("faces"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){eb=d3=dV=d5=dN.value[cB[bz]],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=d3.x,dN.array[d9+3]=d3.y,dN.array[d9+4]=eb.x,dN.array[d9+5]=eb.y,d9+=6}for(bz=0,dz=cH.length;bz<dz;bz++){cO=eb=d3=dV=d5=dN.value[cH[bz]],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=d3.x,dN.array[d9+3]=d3.y,dN.array[d9+4]=eb.x,dN.array[d9+5]=eb.y,dN.array[d9+6]=cO.x,dN.array[d9+7]=cO.y,d9+=8}}}}else{if(3===dN.size){var bA;bA="c"===dN.type?["r","g","b"]:["x","y","z"];if(void 0===dN.boundTo||"vertices"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],dN.array[d9]=dV[bA[0]],dN.array[d9+1]=dV[bA[1]],dN.array[d9+2]=dV[bA[2]],dN.array[d9+3]=d3[bA[0]],dN.array[d9+4]=d3[bA[1]],dN.array[d9+5]=d3[bA[2]],dN.array[d9+6]=eb[bA[0]],dN.array[d9+7]=eb[bA[1]],dN.array[d9+8]=eb[bA[2]],d9+=9}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],cO=dN.value[cs.d],dN.array[d9]=dV[bA[0]],dN.array[d9+1]=dV[bA[1]],dN.array[d9+2]=dV[bA[2]],dN.array[d9+3]=d3[bA[0]],dN.array[d9+4]=d3[bA[1]],dN.array[d9+5]=d3[bA[2]],dN.array[d9+6]=eb[bA[0]],dN.array[d9+7]=eb[bA[1]],dN.array[d9+8]=eb[bA[2]],dN.array[d9+9]=cO[bA[0]],dN.array[d9+10]=cO[bA[1]],dN.array[d9+11]=cO[bA[2]],d9+=12}}else{if("faces"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){eb=d3=dV=d5=dN.value[cB[bz]],dN.array[d9]=dV[bA[0]],dN.array[d9+1]=dV[bA[1]],dN.array[d9+2]=dV[bA[2]],dN.array[d9+3]=d3[bA[0]],dN.array[d9+4]=d3[bA[1]],dN.array[d9+5]=d3[bA[2]],dN.array[d9+6]=eb[bA[0]],dN.array[d9+7]=eb[bA[1]],dN.array[d9+8]=eb[bA[2]],d9+=9}for(bz=0,dz=cH.length;bz<dz;bz++){cO=eb=d3=dV=d5=dN.value[cH[bz]],dN.array[d9]=dV[bA[0]],dN.array[d9+1]=dV[bA[1]],dN.array[d9+2]=dV[bA[2]],dN.array[d9+3]=d3[bA[0]],dN.array[d9+4]=d3[bA[1]],dN.array[d9+5]=d3[bA[2]],dN.array[d9+6]=eb[bA[0]],dN.array[d9+7]=eb[bA[1]],dN.array[d9+8]=eb[bA[2]],dN.array[d9+9]=cO[bA[0]],dN.array[d9+10]=cO[bA[1]],dN.array[d9+11]=cO[bA[2]],d9+=12}}}}else{if(4===dN.size){if(void 0===dN.boundTo||"vertices"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){cs=bP[cB[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=dV.z,dN.array[d9+3]=dV.w,dN.array[d9+4]=d3.x,dN.array[d9+5]=d3.y,dN.array[d9+6]=d3.z,dN.array[d9+7]=d3.w,dN.array[d9+8]=eb.x,dN.array[d9+9]=eb.y,dN.array[d9+10]=eb.z,dN.array[d9+11]=eb.w,d9+=12}for(bz=0,dz=cH.length;bz<dz;bz++){cs=bP[cH[bz]],dV=dN.value[cs.a],d3=dN.value[cs.b],eb=dN.value[cs.c],cO=dN.value[cs.d],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=dV.z,dN.array[d9+3]=dV.w,dN.array[d9+4]=d3.x,dN.array[d9+5]=d3.y,dN.array[d9+6]=d3.z,dN.array[d9+7]=d3.w,dN.array[d9+8]=eb.x,dN.array[d9+9]=eb.y,dN.array[d9+10]=eb.z,dN.array[d9+11]=eb.w,dN.array[d9+12]=cO.x,dN.array[d9+13]=cO.y,dN.array[d9+14]=cO.z,dN.array[d9+15]=cO.w,d9+=16}}else{if("faces"===dN.boundTo){for(bz=0,dz=cB.length;bz<dz;bz++){eb=d3=dV=d5=dN.value[cB[bz]],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=dV.z,dN.array[d9+3]=dV.w,dN.array[d9+4]=d3.x,dN.array[d9+5]=d3.y,dN.array[d9+6]=d3.z,dN.array[d9+7]=d3.w,dN.array[d9+8]=eb.x,dN.array[d9+9]=eb.y,dN.array[d9+10]=eb.z,dN.array[d9+11]=eb.w,d9+=12}for(bz=0,dz=cH.length;bz<dz;bz++){cO=eb=d3=dV=d5=dN.value[cH[bz]],dN.array[d9]=dV.x,dN.array[d9+1]=dV.y,dN.array[d9+2]=dV.z,dN.array[d9+3]=dV.w,dN.array[d9+4]=d3.x,dN.array[d9+5]=d3.y,dN.array[d9+6]=d3.z,dN.array[d9+7]=d3.w,dN.array[d9+8]=eb.x,dN.array[d9+9]=eb.y,dN.array[d9+10]=eb.z,dN.array[d9+11]=eb.w,dN.array[d9+12]=cO.x,dN.array[d9+13]=cO.y,dN.array[d9+14]=cO.z,dN.array[d9+15]=cO.w,d9+=16}}}}}}}au.bindBuffer(au.ARRAY_BUFFER,dN.buffer);au.bufferData(au.ARRAY_BUFFER,dN.array,a4)}}}ci&&(delete bu.__inittedArrays,delete bu.__colorArray,delete bu.__normalArray,delete bu.__tangentArray,delete bu.__uvArray,delete bu.__uv2Array,delete bu.__faceArray,delete bu.__vertexArray,delete bu.__lineArray,delete bu.__skinVertexAArray,delete bu.__skinVertexBArray,delete bu.__skinIndexArray,delete bu.__skinWeightArray)}}}bW.__dirtyVertices=!1;bW.__dirtyMorphTargets=!1;bW.__dirtyElements=!1;bW.__dirtyUvs=!1;bW.__dirtyNormals=!1;bW.__dirtyColors=!1;bW.__dirtyTangents=!1;dB.attributes&&aI(dB)}}else{if(cn instanceof THREE.Ribbon){if(bW.__dirtyVertices||bW.__dirtyColors){var c8=bW,a8=au.DYNAMIC_DRAW,c0=void 0,c9=void 0,a7=void 0,dl=void 0,bj=void 0,bk=c8.vertices,bs=c8.colors,c2=bk.length,df=bs.length,br=c8.__vertexArray,bx=c8.__colorArray,dp=c8.__dirtyColors;if(c8.__dirtyVertices){for(c0=0;c0<c2;c0++){a7=bk[c0].position,dl=3*c0,br[dl]=a7.x,br[dl+1]=a7.y,br[dl+2]=a7.z}au.bindBuffer(au.ARRAY_BUFFER,c8.__webglVertexBuffer);au.bufferData(au.ARRAY_BUFFER,br,a8)}if(dp){for(c9=0;c9<df;c9++){bj=bs[c9],dl=3*c9,bx[dl]=bj.r,bx[dl+1]=bj.g,bx[dl+2]=bj.b}au.bindBuffer(au.ARRAY_BUFFER,c8.__webglColorBuffer);au.bufferData(au.ARRAY_BUFFER,bx,a8)}}bW.__dirtyVertices=!1;bW.__dirtyColors=!1}else{if(cn instanceof THREE.Line){dB=Z(cn,b6);d=dB.attributes&&aE(dB);if(bW.__dirtyVertices||bW.__dirtyColors||d){var bv=bW,dw=au.DYNAMIC_DRAW,dm=void 0,dv=void 0,bE=void 0,d4=void 0,bK=void 0,by=bv.vertices,bF=bv.colors,dx=by.length,dF=bF.length,bS=bv.__vertexArray,b0=bv.__colorArray,dM=bv.__dirtyColors,dE=bv.__webglCustomAttributesList,b7=void 0,bL=void 0,cI=void 0,bD=void 0,dJ=void 0,di=void 0;if(bv.__dirtyVertices){for(dm=0;dm<dx;dm++){bE=by[dm].position,d4=3*dm,bS[d4]=bE.x,bS[d4+1]=bE.y,bS[d4+2]=bE.z}au.bindBuffer(au.ARRAY_BUFFER,bv.__webglVertexBuffer);au.bufferData(au.ARRAY_BUFFER,bS,dw)}if(dM){for(dv=0;dv<dF;dv++){bK=bF[dv],d4=3*dv,b0[d4]=bK.r,b0[d4+1]=bK.g,b0[d4+2]=bK.b}au.bindBuffer(au.ARRAY_BUFFER,bv.__webglColorBuffer);au.bufferData(au.ARRAY_BUFFER,b0,dw)}if(dE){for(b7=0,bL=dE.length;b7<bL;b7++){if(di=dE[b7],di.needsUpdate&&(void 0===di.boundTo||"vertices"===di.boundTo)){d4=0;bD=di.value.length;if(1===di.size){for(cI=0;cI<bD;cI++){di.array[cI]=di.value[cI]}}else{if(2===di.size){for(cI=0;cI<bD;cI++){dJ=di.value[cI],di.array[d4]=dJ.x,di.array[d4+1]=dJ.y,d4+=2}}else{if(3===di.size){if("c"===di.type){for(cI=0;cI<bD;cI++){dJ=di.value[cI],di.array[d4]=dJ.r,di.array[d4+1]=dJ.g,di.array[d4+2]=dJ.b,d4+=3}}else{for(cI=0;cI<bD;cI++){dJ=di.value[cI],di.array[d4]=dJ.x,di.array[d4+1]=dJ.y,di.array[d4+2]=dJ.z,d4+=3}}}else{if(4===di.size){for(cI=0;cI<bD;cI++){dJ=di.value[cI],di.array[d4]=dJ.x,di.array[d4+1]=dJ.y,di.array[d4+2]=dJ.z,di.array[d4+3]=dJ.w,d4+=4}}}}}au.bindBuffer(au.ARRAY_BUFFER,di.buffer);au.bufferData(au.ARRAY_BUFFER,di.array,dw)}}}}bW.__dirtyVertices=!1;bW.__dirtyColors=!1;dB.attributes&&aI(dB)}else{if(cn instanceof THREE.ParticleSystem){dB=Z(cn,b6),d=dB.attributes&&aE(dB),(bW.__dirtyVertices||bW.__dirtyColors||cn.sortParticles||d)&&aj(bW,au.DYNAMIC_DRAW,cn),bW.__dirtyVertices=!1,bW.__dirtyColors=!1,dB.attributes&&aI(dB)}}}}}};this.initMaterial=function(j,s,t,u){var v,x,y,A,B;j instanceof THREE.MeshDepthMaterial?B="depth":j instanceof THREE.MeshNormalMaterial?B="normal":j instanceof THREE.MeshBasicMaterial?B="basic":j instanceof THREE.MeshLambertMaterial?B="lambert":j instanceof THREE.MeshPhongMaterial?B="phong":j instanceof THREE.LineBasicMaterial?B="basic":j instanceof THREE.ParticleBasicMaterial&&(B="particle_basic");if(B){var D=THREE.ShaderLib[B];j.uniforms=THREE.UniformsUtils.clone(D.uniforms);j.vertexShader=D.vertexShader;j.fragmentShader=D.fragmentShader}var C,E;x=D=0;for(C=0,E=s.length;C<E;C++){v=s[C],v.onlyShadow||(v instanceof THREE.DirectionalLight&&x++,v instanceof THREE.PointLight&&D++,v instanceof THREE.SpotLight&&D++)}D+x<=aB?C=x:(C=Math.ceil(aB*x/(D+x)),D=aB-C);v=C;x=D;var G=0;for(D=0,C=s.length;D<C;D++){E=s[D],E.castShadow&&(E instanceof THREE.SpotLight||E instanceof THREE.DirectionalLight)&&G++}var K=50;if(void 0!==u&&u instanceof THREE.SkinnedMesh){K=u.bones.length}var H;j:{C=j.fragmentShader;E=j.vertexShader;var D=j.uniforms,s=j.attributes,t={map:!!j.map,envMap:!!j.envMap,lightMap:!!j.lightMap,vertexColors:j.vertexColors,fog:t,useFog:j.fog,sizeAttenuation:j.sizeAttenuation,skinning:j.skinning,morphTargets:j.morphTargets,maxMorphTargets:this.maxMorphTargets,maxDirLights:v,maxPointLights:x,maxBones:K,shadowMapEnabled:this.shadowMapEnabled&&u.receiveShadow,shadowMapSoft:this.shadowMapSoft,maxShadows:G,alphaTest:j.alphaTest,metal:j.metal,perPixel:j.perPixel,wrapAround:j.wrapAround},I,u=[];B?u.push(B):(u.push(C),u.push(E));for(I in t){u.push(I),u.push(t[I])}B=u.join();for(I=0,u=aW.length;I<u;I++){if(aW[I].code===B){H=aW[I].program;break j}}I=au.createProgram();u=[0<av?"#define VERTEX_TEXTURES":"",al.gammaInput?"#define GAMMA_INPUT":"",al.gammaOutput?"#define GAMMA_OUTPUT":"",al.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+t.maxDirLights,"#define MAX_POINT_LIGHTS "+t.maxPointLights,"#define MAX_SHADOWS "+t.maxShadows,"#define MAX_BONES "+t.maxBones,t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.lightMap?"#define USE_LIGHTMAP":"",t.vertexColors?"#define USE_COLOR":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.perPixel?"#define PHONG_PER_PIXEL":"",t.wrapAround?"#define WRAP_AROUND":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapSoft?"#define SHADOWMAP_SOFT":"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 objectMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform mat4 cameraInverseMatrix;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinVertexA;\nattribute vec4 skinVertexB;\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");v=["precision "+aa+" float;","#define MAX_DIR_LIGHTS "+t.maxDirLights,"#define MAX_POINT_LIGHTS "+t.maxPointLights,"#define MAX_SHADOWS "+t.maxShadows,t.alphaTest?"#define ALPHATEST "+t.alphaTest:"",al.gammaInput?"#define GAMMA_INPUT":"",al.gammaOutput?"#define GAMMA_OUTPUT":"",al.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fog instanceof THREE.FogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.lightMap?"#define USE_LIGHTMAP":"",t.vertexColors?"#define USE_COLOR":"",t.metal?"#define METAL":"",t.perPixel?"#define PHONG_PER_PIXEL":"",t.wrapAround?"#define WRAP_AROUND":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapSoft?"#define SHADOWMAP_SOFT":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");au.attachShader(I,aQ("fragment",v+C));au.attachShader(I,aQ("vertex",u+E));au.linkProgram(I);au.getProgramParameter(I,au.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+au.getProgramParameter(I,au.VALIDATE_STATUS)+", gl error ["+au.getError()+"]");I.uniforms={};I.attributes={};var L,u="viewMatrix,modelViewMatrix,projectionMatrix,normalMatrix,objectMatrix,cameraPosition,cameraInverseMatrix,boneGlobalMatrices,morphTargetInfluences".split(",");for(L in D){u.push(L)}L=u;for(u=0,D=L.length;u<D;u++){C=L[u],I.uniforms[C]=au.getUniformLocation(I,C)}u="position,normal,uv,uv2,tangent,color,skinVertexA,skinVertexB,skinIndex,skinWeight".split(",");for(L=0;L<t.maxMorphTargets;L++){u.push("morphTarget"+L)}for(H in s){u.push(H)}H=u;for(L=0,s=H.length;L<s;L++){t=H[L],I.attributes[t]=au.getAttribLocation(I,t)}I.id=aW.length;aW.push({program:I,code:B});al.info.memory.programs=aW.length;H=I}j.program=H;H=j.program.attributes;0<=H.position&&au.enableVertexAttribArray(H.position);0<=H.color&&au.enableVertexAttribArray(H.color);0<=H.normal&&au.enableVertexAttribArray(H.normal);0<=H.tangent&&au.enableVertexAttribArray(H.tangent);j.skinning&&0<=H.skinVertexA&&0<=H.skinVertexB&&0<=H.skinIndex&&0<=H.skinWeight&&(au.enableVertexAttribArray(H.skinVertexA),au.enableVertexAttribArray(H.skinVertexB),au.enableVertexAttribArray(H.skinIndex),au.enableVertexAttribArray(H.skinWeight));if(j.attributes){for(A in j.attributes){void 0!==H[A]&&0<=H[A]&&au.enableVertexAttribArray(H[A])}}if(j.morphTargets){for(A=j.numSupportedMorphTargets=0;A<this.maxMorphTargets;A++){L="morphTarget"+A,0<=H[L]&&(au.enableVertexAttribArray(H[L]),j.numSupportedMorphTargets++)}}j.uniformsList=[];for(y in j.uniforms){j.uniformsList.push([j.uniforms[y],y])}};this.setFaceCulling=function(c,d){c?(!d||"ccw"===d?au.frontFace(au.CCW):au.frontFace(au.CW),"back"===c?au.cullFace(au.BACK):"front"===c?au.cullFace(au.FRONT):au.cullFace(au.FRONT_AND_BACK),au.enable(au.CULL_FACE)):au.disable(au.CULL_FACE)};this.setObjectFaces=function(b){if(am!==b.doubleSided){b.doubleSided?au.disable(au.CULL_FACE):au.enable(au.CULL_FACE),am=b.doubleSided}if(aV!==b.flipSided){b.flipSided?au.frontFace(au.CW):au.frontFace(au.CCW),aV=b.flipSided}};this.setDepthTest=function(b){ab!==b&&(b?au.enable(au.DEPTH_TEST):au.disable(au.DEPTH_TEST),ab=b)};this.setDepthWrite=function(b){ae!==b&&(au.depthMask(b),ae=b)};this.setBlending=function(b){if(b!==X){switch(b){case THREE.AdditiveBlending:au.blendEquation(au.FUNC_ADD);au.blendFunc(au.SRC_ALPHA,au.ONE);break;case THREE.SubtractiveBlending:au.blendEquation(au.FUNC_ADD);au.blendFunc(au.ZERO,au.ONE_MINUS_SRC_COLOR);break;case THREE.MultiplyBlending:au.blendEquation(au.FUNC_ADD);au.blendFunc(au.ZERO,au.SRC_COLOR);break;default:au.blendEquationSeparate(au.FUNC_ADD,au.FUNC_ADD),au.blendFuncSeparate(au.SRC_ALPHA,au.ONE_MINUS_SRC_ALPHA,au.ONE,au.ONE_MINUS_SRC_ALPHA)}X=b}};this.setTexture=function(g,h){if(g.needsUpdate){if(!g.__webglInit){g.__webglInit=!0,g.__webglTexture=au.createTexture(),al.info.memory.textures++}au.activeTexture(au.TEXTURE0+h);au.bindTexture(au.TEXTURE_2D,g.__webglTexture);var i=g.image,j=0===(i.width&i.width-1)&&0===(i.height&i.height-1),k=U(g.format),l=U(g.type);aT(au.TEXTURE_2D,g,j);g instanceof THREE.DataTexture?au.texImage2D(au.TEXTURE_2D,0,k,i.width,i.height,0,k,l,i.data):au.texImage2D(au.TEXTURE_2D,0,k,k,l,g.image);g.generateMipmaps&&j&&au.generateMipmap(au.TEXTURE_2D);g.needsUpdate=!1;if(g.onUpdated){g.onUpdated()}}else{au.activeTexture(au.TEXTURE0+h),au.bindTexture(au.TEXTURE_2D,g.__webglTexture)}};this.setRenderTarget=function(h){var i=h instanceof THREE.WebGLRenderTargetCube;if(h&&!h.__webglFramebuffer){if(void 0===h.depthBuffer){h.depthBuffer=!0}if(void 0===h.stencilBuffer){h.stencilBuffer=!0}h.__webglTexture=au.createTexture();var j=0===(h.width&h.width-1)&&0===(h.height&h.height-1),k=U(h.format),l=U(h.type);if(i){h.__webglFramebuffer=[];h.__webglRenderbuffer=[];au.bindTexture(au.TEXTURE_CUBE_MAP,h.__webglTexture);aT(au.TEXTURE_CUBE_MAP,h,j);for(j=0;6>j;j++){h.__webglFramebuffer[j]=au.createFramebuffer();h.__webglRenderbuffer[j]=au.createRenderbuffer();au.texImage2D(au.TEXTURE_CUBE_MAP_POSITIVE_X+j,0,k,h.width,h.height,0,k,l,null);var m=h,n=au.TEXTURE_CUBE_MAP_POSITIVE_X+j;au.bindFramebuffer(au.FRAMEBUFFER,h.__webglFramebuffer[j]);au.framebufferTexture2D(au.FRAMEBUFFER,au.COLOR_ATTACHMENT0,n,m.__webglTexture,0);aU(h.__webglRenderbuffer[j],h)}}else{h.__webglFramebuffer=au.createFramebuffer(),h.__webglRenderbuffer=au.createRenderbuffer(),au.bindTexture(au.TEXTURE_2D,h.__webglTexture),aT(au.TEXTURE_2D,h,j),au.texImage2D(au.TEXTURE_2D,0,k,h.width,h.height,0,k,l,null),k=au.TEXTURE_2D,au.bindFramebuffer(au.FRAMEBUFFER,h.__webglFramebuffer),au.framebufferTexture2D(au.FRAMEBUFFER,au.COLOR_ATTACHMENT0,k,h.__webglTexture,0),aU(h.__webglRenderbuffer,h)}i?au.bindTexture(au.TEXTURE_CUBE_MAP,null):au.bindTexture(au.TEXTURE_2D,null);au.bindRenderbuffer(au.RENDERBUFFER,null);au.bindFramebuffer(au.FRAMEBUFFER,null)}h?(i=i?h.__webglFramebuffer[h.activeCubeFace]:h.__webglFramebuffer,k=h.width,h=h.height,j=l=0):(i=null,k=af,h=z,l=M,j=aw);i!==ai&&(au.bindFramebuffer(au.FRAMEBUFFER,i),au.viewport(l,j,k,h),ai=i);aS=k;at=h};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};THREE.WebGLRenderTarget=function(d,e,f){this.width=d;this.height=e;f=f||{};this.wrapS=void 0!==f.wrapS?f.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==f.wrapT?f.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==f.magFilter?f.magFilter:THREE.LinearFilter;this.minFilter=void 0!==f.minFilter?f.minFilter:THREE.LinearMipMapLinearFilter;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==f.format?f.format:THREE.RGBAFormat;this.type=void 0!==f.type?f.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==f.depthBuffer?f.depthBuffer:!0;this.stencilBuffer=void 0!==f.stencilBuffer?f.stencilBuffer:!0;this.generateMipmaps=!0};THREE.WebGLRenderTarget.prototype.clone=function(){var b=new THREE.WebGLRenderTarget(this.width,this.height);b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.format=this.format;b.type=this.type;b.depthBuffer=this.depthBuffer;b.stencilBuffer=this.stencilBuffer;return b};THREE.WebGLRenderTargetCube=function(d,e,f){THREE.WebGLRenderTarget.call(this,d,e,f);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=new THREE.WebGLRenderTarget;THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(b){this.positionWorld.copy(b.positionWorld);this.positionScreen.copy(b.positionScreen)};THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterial=this.material=null;this.uvs=[[]];this.z=null};THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidWorld=new THREE.Vector3;this.centroidScreen=new THREE.Vector3;this.normalWorld=new THREE.Vector3;this.vertexNormalsWorld=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.faceMaterial=this.material=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.material=null};THREE.ColorUtils={adjustHSV:function(f,g,h,i){var j=THREE.ColorUtils.__hsv;THREE.ColorUtils.rgbToHsv(f,j);j.h=THREE.Math.clamp(j.h+g,0,1);j.s=THREE.Math.clamp(j.s+h,0,1);j.v=THREE.Math.clamp(j.v+i,0,1);f.setHSV(j.h,j.s,j.v)},rgbToHsv:function(i,j){var k=i.r,l=i.g,m=i.b,n=Math.max(Math.max(k,l),m),o=Math.min(Math.min(k,l),m);if(o===n){o=k=0}else{var p=n-o,o=p/n,k=(k===n?(l-m)/p:l===n?2+(m-k)/p:4+(k-l)/p)/6;0>k&&(k+=1);1<k&&(k-=1)}void 0===j&&(j={h:0,s:0,v:0});j.h=k;j.s=o;j.v=n;return j}};THREE.ColorUtils.__hsv={h:0,s:0,v:0};THREE.GeometryUtils={merge:function(j,v){for(var w,x,y=j.vertices.length,z=v instanceof THREE.Mesh?v.geometry:v,A=j.vertices,B=z.vertices,C=j.faces,E=z.faces,D=j.faceVertexUvs[0],G=z.faceVertexUvs[0],J={},H=0;H<j.materials.length;H++){J[j.materials[H].id]=H}if(v instanceof THREE.Mesh){v.matrixAutoUpdate&&v.updateMatrix(),w=v.matrix,x=new THREE.Matrix4,x.extractRotation(w,v.scale)}for(var H=0,I=B.length;H<I;H++){var F=new THREE.Vertex(B[H].position.clone());w&&w.multiplyVector3(F.position);A.push(F)}for(H=0,I=E.length;H<I;H++){var A=E[H],K,L,M=A.vertexNormals,N=A.vertexColors;A instanceof THREE.Face3?K=new THREE.Face3(A.a+y,A.b+y,A.c+y):A instanceof THREE.Face4&&(K=new THREE.Face4(A.a+y,A.b+y,A.c+y,A.d+y));K.normal.copy(A.normal);x&&x.multiplyVector3(K.normal);B=0;for(F=M.length;B<F;B++){L=M[B].clone(),x&&x.multiplyVector3(L),K.vertexNormals.push(L)}K.color.copy(A.color);B=0;for(F=N.length;B<F;B++){L=N[B],K.vertexColors.push(L.clone())}if(void 0!==A.materialIndex){B=z.materials[A.materialIndex];F=B.id;N=J[F];if(void 0===N){N=j.materials.length,J[F]=N,j.materials.push(B)}K.materialIndex=N}K.centroid.copy(A.centroid);w&&w.multiplyVector3(K.centroid);C.push(K)}for(H=0,I=G.length;H<I;H++){w=G[H];x=[];B=0;for(F=w.length;B<F;B++){x.push(new THREE.UV(w[B].u,w[B].v))}D.push(x)}},clone:function(j){var m=new THREE.Geometry,o,p=j.vertices,q=j.faces,r=j.faceVertexUvs[0];if(j.materials){m.materials=j.materials.slice()}for(j=0,o=p.length;j<o;j++){var s=new THREE.Vertex(p[j].position.clone());m.vertices.push(s)}for(j=0,o=q.length;j<o;j++){var t=q[j],u,w,v=t.vertexNormals,x=t.vertexColors;t instanceof THREE.Face3?u=new THREE.Face3(t.a,t.b,t.c):t instanceof THREE.Face4&&(u=new THREE.Face4(t.a,t.b,t.c,t.d));u.normal.copy(t.normal);p=0;for(s=v.length;p<s;p++){w=v[p],u.vertexNormals.push(w.clone())}u.color.copy(t.color);p=0;for(s=x.length;p<s;p++){w=x[p],u.vertexColors.push(w.clone())}u.materialIndex=t.materialIndex;u.centroid.copy(t.centroid);m.faces.push(u)}for(j=0,o=r.length;j<o;j++){q=r[j];u=[];p=0;for(s=q.length;p<s;p++){u.push(new THREE.UV(q[p].u,q[p].v))}m.faceVertexUvs[0].push(u)}return m},randomPointInTriangle:function(i,j,k){var l,m,n,o=new THREE.Vector3,p=THREE.GeometryUtils.__v1;l=THREE.GeometryUtils.random();m=THREE.GeometryUtils.random();1<l+m&&(l=1-l,m=1-m);n=1-l-m;o.copy(i);o.multiplyScalar(l);p.copy(j);p.multiplyScalar(m);o.addSelf(p);p.copy(k);p.multiplyScalar(n);o.addSelf(p);return o},randomPointInFace:function(h,i,j){var k,l,m;if(h instanceof THREE.Face3){return k=i.vertices[h.a].position,l=i.vertices[h.b].position,m=i.vertices[h.c].position,THREE.GeometryUtils.randomPointInTriangle(k,l,m)}if(h instanceof THREE.Face4){k=i.vertices[h.a].position;l=i.vertices[h.b].position;m=i.vertices[h.c].position;var i=i.vertices[h.d].position,n;j?h._area1&&h._area2?(j=h._area1,n=h._area2):(j=THREE.GeometryUtils.triangleArea(k,l,i),n=THREE.GeometryUtils.triangleArea(l,m,i),h._area1=j,h._area2=n):(j=THREE.GeometryUtils.triangleArea(k,l,i),n=THREE.GeometryUtils.triangleArea(l,m,i));return THREE.GeometryUtils.random()*(j+n)<j?THREE.GeometryUtils.randomPointInTriangle(k,l,i):THREE.GeometryUtils.randomPointInTriangle(l,m,i)}},randomPointsInGeometry:function(j,m){function p(c){function d(a,b){if(b<a){return a}var f=a+Math.floor((b-a)/2);return y[f]>c?d(a,f-1):y[f]<c?d(f+1,b):f}return d(0,y.length-1)}var r,s,t=j.faces,u=j.vertices,v=t.length,w=0,y=[],x,z,B,A;for(s=0;s<v;s++){r=t[s];if(r instanceof THREE.Face3){x=u[r.a].position,z=u[r.b].position,B=u[r.c].position,r._area=THREE.GeometryUtils.triangleArea(x,z,B)}else{if(r instanceof THREE.Face4){x=u[r.a].position,z=u[r.b].position,B=u[r.c].position,A=u[r.d].position,r._area1=THREE.GeometryUtils.triangleArea(x,z,A),r._area2=THREE.GeometryUtils.triangleArea(z,B,A),r._area=r._area1+r._area2}}w+=r._area;y[s]=w}r=[];for(s=0;s<m;s++){u=THREE.GeometryUtils.random()*w,u=p(u),r[s]=THREE.GeometryUtils.randomPointInFace(t[u],j,!0)}return r},triangleArea:function(f,g,h){var i,j=THREE.GeometryUtils.__v1;j.sub(f,g);i=j.length();j.sub(f,h);f=j.length();j.sub(g,h);h=j.length();g=0.5*(i+f+h);return Math.sqrt(g*(g-i)*(g-f)*(g-h))},center:function(d){d.computeBoundingBox();var e=d.boundingBox,f=new THREE.Vector3;f.add(e.min,e.max);f.multiplyScalar(-0.5);d.applyMatrix((new THREE.Matrix4).setTranslation(f.x,f.y,f.z));d.computeBoundingBox();return f},normalizeUVs:function(g){for(var g=g.faceVertexUvs[0],h=0,i=g.length;h<i;h++){for(var j=g[h],k=0,l=j.length;k<l;k++){1!==j[k].u&&(j[k].u-=Math.floor(j[k].u)),1!==j[k].v&&(j[k].v-=Math.floor(j[k].v))}}}};THREE.GeometryUtils.random=THREE.Math.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;THREE.ImageUtils={crossOrigin:"",loadTexture:function(f,g,h){var i=new Image,j=new THREE.Texture(i,g);i.onload=function(){j.needsUpdate=!0;h&&h(this)};i.crossOrigin=this.crossOrigin;i.src=f;return j},loadTextureCube:function(g,h,i){var j,k=[],l=new THREE.Texture(k,h);k.loadCount=0;for(h=0,j=g.length;h<j;++h){k[h]=new Image,k[h].onload=function(){k.loadCount+=1;if(6===k.loadCount){l.needsUpdate=!0}i&&i(this)},k[h].crossOrigin="",k[h].src=g[h]}return l},getNormalMap:function(j,u){var v=function(c){var d=Math.sqrt(c[0]*c[0]+c[1]*c[1]+c[2]*c[2]);return[c[0]/d,c[1]/d,c[2]/d]},u=u|1,w=j.width,x=j.height,y=document.createElement("canvas");y.width=w;y.height=x;var z=y.getContext("2d");z.drawImage(j,0,0);for(var A=z.getImageData(0,0,w,x).data,B=z.createImageData(w,x),D=B.data,C=0;C<w;C++){for(var F=1;F<x;F++){var I=0>F-1?x-1:F-1,G=(F+1)%x,H=0>C-1?w-1:C-1,E=(C+1)%w,J=[],K=[0,0,A[4*(F*w+C)]/255*u];J.push([-1,0,A[4*(F*w+H)]/255*u]);J.push([-1,-1,A[4*(I*w+H)]/255*u]);J.push([0,-1,A[4*(I*w+C)]/255*u]);J.push([1,-1,A[4*(I*w+E)]/255*u]);J.push([1,0,A[4*(F*w+E)]/255*u]);J.push([1,1,A[4*(G*w+E)]/255*u]);J.push([0,1,A[4*(G*w+C)]/255*u]);J.push([-1,1,A[4*(G*w+H)]/255*u]);I=[];H=J.length;for(G=0;G<H;G++){var E=J[G],L=J[(G+1)%H],E=[E[0]-K[0],E[1]-K[1],E[2]-K[2]],L=[L[0]-K[0],L[1]-K[1],L[2]-K[2]];I.push(v([E[1]*L[2]-E[2]*L[1],E[2]*L[0]-E[0]*L[2],E[0]*L[1]-E[1]*L[0]]))}J=[0,0,0];for(G=0;G<I.length;G++){J[0]+=I[G][0],J[1]+=I[G][1],J[2]+=I[G][2]}J[0]/=I.length;J[1]/=I.length;J[2]/=I.length;K=4*(F*w+C);D[K]=255*((J[0]+1)/2)|0;D[K+1]=255*(J[1]+0.5)|0;D[K+2]=255*J[2]|0;D[K+3]=255}}z.putImageData(B,0,0);return y}};THREE.SceneUtils={showHierarchy:function(c,d){THREE.SceneUtils.traverseHierarchy(c,function(b){b.visible=d})},traverseHierarchy:function(f,g){var h,i,j=f.children.length;for(i=0;i<j;i++){h=f.children[i],g(h),THREE.SceneUtils.traverseHierarchy(h,g)}},createMultiMaterialObject:function(g,h){var i,j=h.length,k=new THREE.Object3D;for(i=0;i<j;i++){var l=new THREE.Mesh(g,h[i]);k.add(l)}return k},cloneObject:function(e){var f;e instanceof THREE.MorphAnimMesh?(f=new THREE.MorphAnimMesh(e.geometry,e.material),f.duration=e.duration,f.mirroredLoop=e.mirroredLoop,f.time=e.time,f.lastKeyframe=e.lastKeyframe,f.currentKeyframe=e.currentKeyframe,f.direction=e.direction,f.directionBackwards=e.directionBackwards):e instanceof THREE.SkinnedMesh?f=new THREE.SkinnedMesh(e.geometry,e.material):e instanceof THREE.Mesh?f=new THREE.Mesh(e.geometry,e.material):e instanceof THREE.Line?f=new THREE.Line(e.geometry,e.material,e.type):e instanceof THREE.Ribbon?f=new THREE.Ribbon(e.geometry,e.material):e instanceof THREE.ParticleSystem?(f=new THREE.ParticleSystem(e.geometry,e.material),f.sortParticles=e.sortParticles):e instanceof THREE.Particle?f=new THREE.Particle(e.material):e instanceof THREE.Sprite?(f=new THREE.Sprite({}),f.color.copy(e.color),f.map=e.map,f.blending=e.blending,f.useScreenCoordinates=e.useScreenCoordinates,f.mergeWith3D=e.mergeWith3D,f.affectedByDistance=e.affectedByDistance,f.scaleByViewport=e.scaleByViewport,f.alignment=e.alignment,f.rotation3d.copy(e.rotation3d),f.rotation=e.rotation,f.opacity=e.opacity,f.uvOffset.copy(e.uvOffset),f.uvScale.copy(e.uvScale)):e instanceof THREE.LOD?f=new THREE.LOD:e instanceof THREE.MarchingCubes?(f=new THREE.MarchingCubes(e.resolution,e.material),f.field.set(e.field),f.isolation=e.isolation):e instanceof THREE.Object3D&&(f=new THREE.Object3D);f.name=e.name;f.parent=e.parent;f.up.copy(e.up);f.position.copy(e.position);f.rotation instanceof THREE.Vector3&&f.rotation.copy(e.rotation);f.eulerOrder=e.eulerOrder;f.scale.copy(e.scale);f.dynamic=e.dynamic;f.doubleSided=e.doubleSided;f.flipSided=e.flipSided;f.renderDepth=e.renderDepth;f.rotationAutoUpdate=e.rotationAutoUpdate;f.matrix.copy(e.matrix);f.matrixWorld.copy(e.matrixWorld);f.matrixRotationWorld.copy(e.matrixRotationWorld);f.matrixAutoUpdate=e.matrixAutoUpdate;f.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate;f.quaternion.copy(e.quaternion);f.useQuaternion=e.useQuaternion;f.boundRadius=e.boundRadius;f.boundRadiusScale=e.boundRadiusScale;f.visible=e.visible;f.castShadow=e.castShadow;f.receiveShadow=e.receiveShadow;f.frustumCulled=e.frustumCulled;for(var g=0;g<e.children.length;g++){var h=THREE.SceneUtils.cloneObject(e.children[g]);f.children[g]=h;h.parent=f}if(e instanceof THREE.LOD){for(g=0;g<e.LODs.length;g++){f.LODs[g]={visibleAtDistance:e.LODs[g].visibleAtDistance,object3D:f.children[g]}}}return f}};if(THREE.WebGLRenderer){THREE.ShaderUtils={lib:{fresnel:{uniforms:{mRefractionRatio:{type:"f",value:1.02},mFresnelBias:{type:"f",value:0.1},mFresnelPower:{type:"f",value:2},mFresnelScale:{type:"f",value:1},tCube:{type:"t",value:1,texture:null}},fragmentShader:"uniform samplerCube tCube;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\nvec4 refractedColor = vec4( 1.0, 1.0, 1.0, 1.0 );\nrefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;\nrefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;\nrefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;\nrefractedColor.a = 1.0;\ngl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );\n}",vertexShader:"uniform float mRefractionRatio;\nuniform float mFresnelBias;\nuniform float mFresnelScale;\nuniform float mFresnelPower;\nvarying vec3 vReflect;\nvarying vec3 vRefract[3];\nvarying float vReflectionFactor;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvec3 nWorld = normalize ( mat3( objectMatrix[0].xyz, objectMatrix[1].xyz, objectMatrix[2].xyz ) * normal );\nvec3 I = mPosition.xyz - cameraPosition;\nvReflect = reflect( I, nWorld );\nvRefract[0] = refract( normalize( I ), nWorld, mRefractionRatio );\nvRefract[1] = refract( normalize( I ), nWorld, mRefractionRatio * 0.99 );\nvRefract[2] = refract( normalize( I ), nWorld, mRefractionRatio * 0.98 );\nvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), nWorld ), mFresnelPower );\ngl_Position = projectionMatrix * mvPosition;\n}"},normal:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},tDiffuse:{type:"t",value:0,texture:null},tCube:{type:"t",value:1,texture:null},tNormal:{type:"t",value:2,texture:null},tSpecular:{type:"t",value:3,texture:null},tAO:{type:"t",value:4,texture:null},tDisplacement:{type:"t",value:5,texture:null},uNormalScale:{type:"f",value:1},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(15658734)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(328965)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform float uNormalScale;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec3 pointVector = normalize( vPointLight[ i ].xyz );\nfloat pointDistance = vPointLight[ i ].w;\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor) + totalSpecular;\nif ( enableReflection ) {\nvec3 wPos = cameraPosition - vViewPosition;\nvec3 vReflect = reflect( normalize( wPos ), normal );\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\nvarying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\nvViewPosition = -mvPosition.xyz;\nvNormal = normalMatrix * normal;\nvTangent = normalMatrix * tangent.xyz;\nvBinormal = cross( vNormal, vTangent ) * tangent.w;\nvUv = uv * uRepeat + uOffset;\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#ifdef VERTEX_TEXTURES\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\nvec4 displacedPosition = vec4( normalize( vNormal.xyz ) * df, 0.0 ) + mvPosition;\ngl_Position = projectionMatrix * displacedPosition;\n#else\ngl_Position = projectionMatrix * mvPosition;\n#endif",THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:1,texture:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vViewPosition;\nvoid main() {\nvec4 mPosition = objectMatrix * vec4( position, 1.0 );\nvViewPosition = cameraPosition - mPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 wPos = cameraPosition - vViewPosition;\ngl_FragColor = textureCube( tCube, vec3( tFlip * wPos.x, wPos.yz ) );\n}"}}}}THREE.BufferGeometry=function(){this.id=THREE.GeometryCount++;this.vertexColorArray=this.vertexUvArray=this.vertexNormalArray=this.vertexPositionArray=this.vertexIndexArray=this.vertexColorBuffer=this.vertexUvBuffer=this.vertexNormalBuffer=this.vertexPositionBuffer=this.vertexIndexBuffer=null;this.dynamic=!1;this.boundingSphere=this.boundingBox=null;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,computeBoundingBox:function(){},computeBoundingSphere:function(){}};THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(b){return this.getPoint(this.getUtoTmapping(b))};THREE.Curve.prototype.getPoints=function(d){d||(d=5);var e,f=[];for(e=0;e<=d;e++){f.push(this.getPoint(e/d))}return f};THREE.Curve.prototype.getSpacedPoints=function(d){d||(d=5);var e,f=[];for(e=0;e<=d;e++){f.push(this.getPointAt(e/d))}return f};THREE.Curve.prototype.getLength=function(){var b=this.getLengths();return b[b.length-1]};THREE.Curve.prototype.getLengths=function(g){g||(g=200);if(this.cacheArcLengths&&this.cacheArcLengths.length==g+1){return this.cacheArcLengths}var h=[],i,j=this.getPoint(0),k,l=0;h.push(0);for(k=1;k<=g;k++){i=this.getPoint(k/g),l+=i.distanceTo(j),h.push(l),j=i}return this.cacheArcLengths=h};THREE.Curve.prototype.getUtoTmapping=function(j,k){var l=this.getLengths(),m=0,n=l.length,o;o=k?k:j*l[n-1];for(var p=0,q=n-1,r;p<=q;){if(m=Math.floor(p+(q-p)/2),r=l[m]-o,0>r){p=m+1}else{if(0<r){q=m-1}else{q=m;break}}}m=q;if(l[m]==o){return m/(n-1)}p=l[m];return l=(m+(o-p)/(l[m+1]-p))/(n-1)};THREE.Curve.prototype.getNormalVector=function(b){b=this.getTangent(b);return new THREE.Vector2(-b.y,b.x)};THREE.Curve.prototype.getTangent=function(c){var d=c-0.0001,c=c+0.0001;0>d&&(d=0);1<c&&(c=1);d=this.getPoint(d);c=this.getPoint(c);return d.clone().subSelf(c).normalize()};THREE.Curve.prototype.getTangentAt=function(b){return this.getTangent(this.getUtoTmapping(b))};THREE.LineCurve=function(c,d){c instanceof THREE.Vector2?(this.v1=c,this.v2=d):THREE.LineCurve.oldConstructor.apply(this,arguments)};THREE.LineCurve.oldConstructor=function(e,f,g,h){this.constructor(new THREE.Vector2(e,f),new THREE.Vector2(g,h))};THREE.LineCurve.prototype=new THREE.Curve;THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(c){var d=new THREE.Vector2;d.sub(this.v2,this.v1);d.multiplyScalar(c).addSelf(this.v1);return d};THREE.LineCurve.prototype.getPointAt=function(b){return this.getPoint(b)};THREE.LineCurve.prototype.getTangent=function(){var b=new THREE.Vector2;b.sub(this.v2,this.v1);b.normalize();return b};THREE.QuadraticBezierCurve=function(e,f,g){if(!(f instanceof THREE.Vector2)){var h=Array.prototype.slice.call(arguments),e=new THREE.Vector2(h[0],h[1]),f=new THREE.Vector2(h[2],h[3]),g=new THREE.Vector2(h[4],h[5])}this.v0=e;this.v1=f;this.v2=g};THREE.QuadraticBezierCurve.prototype=new THREE.Curve;THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;THREE.QuadraticBezierCurve.prototype.getPoint=function(c){var d;d=THREE.Shape.Utils.b2(c,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(c,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(d,c)};THREE.QuadraticBezierCurve.prototype.getTangent=function(c){var d;d=THREE.Curve.Utils.tangentQuadraticBezier(c,this.v0.x,this.v1.x,this.v2.x);c=THREE.Curve.Utils.tangentQuadraticBezier(c,this.v0.y,this.v1.y,this.v2.y);d=new THREE.Vector2(d,c);d.normalize();return d};THREE.CubicBezierCurve=function(f,g,h,i){if(!(g instanceof THREE.Vector2)){var j=Array.prototype.slice.call(arguments),f=new THREE.Vector2(j[0],j[1]),g=new THREE.Vector2(j[2],j[3]),h=new THREE.Vector2(j[4],j[5]),i=new THREE.Vector2(j[6],j[7])}this.v0=f;this.v1=g;this.v2=h;this.v3=i};THREE.CubicBezierCurve.prototype=new THREE.Curve;THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(c){var d;d=THREE.Shape.Utils.b3(c,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(c,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(d,c)};THREE.CubicBezierCurve.prototype.getTangent=function(c){var d;d=THREE.Curve.Utils.tangentCubicBezier(c,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Curve.Utils.tangentCubicBezier(c,this.v0.y,this.v1.y,this.v2.y,this.v3.y);d=new THREE.Vector2(d,c);d.normalize();return d};THREE.SplineCurve=function(b){this.points=void 0==b?[]:b};THREE.SplineCurve.prototype=new THREE.Curve;THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;THREE.SplineCurve.prototype.getPoint=function(f){var g=new THREE.Vector2,h=[],i=this.points,j;j=(i.length-1)*f;f=Math.floor(j);j-=f;h[0]=0==f?f:f-1;h[1]=f;h[2]=f>i.length-2?f:f+1;h[3]=f>i.length-3?f:f+2;g.x=THREE.Curve.Utils.interpolate(i[h[0]].x,i[h[1]].x,i[h[2]].x,i[h[3]].x,j);g.y=THREE.Curve.Utils.interpolate(i[h[0]].y,i[h[1]].y,i[h[2]].y,i[h[3]].y,j);return g};THREE.ArcCurve=function(g,h,i,j,k,l){this.aX=g;this.aY=h;this.aRadius=i;this.aStartAngle=j;this.aEndAngle=k;this.aClockwise=l};THREE.ArcCurve.prototype=new THREE.Curve;THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;THREE.ArcCurve.prototype.getPoint=function(c){var d=this.aEndAngle-this.aStartAngle;this.aClockwise||(c=1-c);d=this.aStartAngle+c*d;c=this.aX+this.aRadius*Math.cos(d);d=this.aY+this.aRadius*Math.sin(d);return new THREE.Vector2(c,d)};THREE.Curve.Utils={tangentQuadraticBezier:function(e,f,g,h){return 2*(1-e)*(g-f)+2*e*(h-g)},tangentCubicBezier:function(f,g,h,i,j){return -3*g*(1-f)*(1-f)+3*h*(1-f)*(1-f)-6*f*h*(1-f)+6*f*i*(1-f)-3*f*f*i+3*f*f*j},tangentSpline:function(b){return 6*b*b-6*b+(3*b*b-4*b+1)+(-6*b*b+6*b)+(3*b*b-2*b)},interpolate:function(g,h,i,j,k){var g=0.5*(i-g),j=0.5*(j-h),l=k*k;return(2*h-2*i+g+j)*k*l+(-3*h+3*i-2*g-j)*l+g*k+h}};THREE.Curve.create=function(c,d){c.prototype=new THREE.Curve;c.prototype.constructor=c;c.prototype.getPoint=d;return c};THREE.LineCurve3=THREE.Curve.create(function(c,d){this.v1=c;this.v2=d},function(c){var d=new THREE.Vector3;d.sub(this.v2,this.v1);d.multiplyScalar(c);d.addSelf(this.v1);return d});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(d,e,f){this.v0=d;this.v1=e;this.v2=f},function(d){var e,f;e=THREE.Shape.Utils.b2(d,this.v0.x,this.v1.x,this.v2.x);f=THREE.Shape.Utils.b2(d,this.v0.y,this.v1.y,this.v2.y);d=THREE.Shape.Utils.b2(d,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(e,f,d)});THREE.CubicBezierCurve3=THREE.Curve.create(function(e,f,g,h){this.v0=e;this.v1=f;this.v2=g;this.v3=h},function(d){var e,f;e=THREE.Shape.Utils.b3(d,this.v0.x,this.v1.x,this.v2.x,this.v3.x);f=THREE.Shape.Utils.b3(d,this.v0.y,this.v1.y,this.v2.y,this.v3.y);d=THREE.Shape.Utils.b3(d,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(e,f,d)});THREE.SplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(f){var g=new THREE.Vector3,h=[],i=this.points,j;j=(i.length-1)*f;f=Math.floor(j);j-=f;h[0]=0==f?f:f-1;h[1]=f;h[2]=f>i.length-2?f:f+1;h[3]=f>i.length-3?f:f+2;g.x=THREE.Curve.Utils.interpolate(i[h[0]].x,i[h[1]].x,i[h[2]].x,i[h[3]].x,j);g.y=THREE.Curve.Utils.interpolate(i[h[0]].y,i[h[1]].y,i[h[2]].y,i[h[3]].y,j);g.z=THREE.Curve.Utils.interpolate(i[h[0]].z,i[h[1]].z,i[h[2]].z,i[h[3]].z,j);return g});THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=new THREE.Curve;THREE.CurvePath.prototype.constructor=THREE.CurvePath;THREE.CurvePath.prototype.add=function(b){this.curves.push(b)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var c=this.curves[0].getPoint(0),d=this.curves[this.curves.length-1].getPoint(1);c.equals(d)||this.curves.push(new THREE.LineCurve(d,c))};THREE.CurvePath.prototype.getPoint=function(d){for(var e=d*this.getLength(),f=this.getCurveLengths(),d=0;d<f.length;){if(f[d]>=e){return e=f[d]-e,d=this.curves[d],e=1-e/d.getLength(),d.getPointAt(e)}d++}return null};THREE.CurvePath.prototype.getLength=function(){var b=this.getCurveLengths();return b[b.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var e=[],f=0,g,h=this.curves.length;for(g=0;g<h;g++){f+=this.curves[g].getLength(),e.push(f)}return this.cacheLengths=e};THREE.CurvePath.prototype.getBoundingBox=function(){var j=this.getPoints(),k,l,m,n;k=l=Number.NEGATIVE_INFINITY;m=n=Number.POSITIVE_INFINITY;var o,p,q,r;r=new THREE.Vector2;for(p=0,q=j.length;p<q;p++){o=j[p];if(o.x>k){k=o.x}else{if(o.x<m){m=o.x}}if(o.y>l){l=o.y}else{if(o.y<l){n=o.y}}r.addSelf(o.x,o.y)}return{minX:m,minY:n,maxX:k,maxY:l,centroid:r.divideScalar(q)}};THREE.CurvePath.prototype.createPointsGeometry=function(b){return this.createGeometry(this.getPoints(b,!0))};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(b){return this.createGeometry(this.getSpacedPoints(b,!0))};THREE.CurvePath.prototype.createGeometry=function(d){for(var e=new THREE.Geometry,f=0;f<d.length;f++){e.vertices.push(new THREE.Vertex(new THREE.Vector3(d[f].x,d[f].y,0)))}return e};THREE.CurvePath.prototype.addWrapPath=function(b){this.bends.push(b)};THREE.CurvePath.prototype.getTransformedPoints=function(f,g){var h=this.getPoints(f),i,j;if(!g){g=this.bends}for(i=0,j=g.length;i<j;i++){h=this.getWrapPoints(h,g[i])}return h};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(f,g){var h=this.getSpacedPoints(f),i,j;if(!g){g=this.bends}for(i=0,j=g.length;i<j;i++){h=this.getWrapPoints(h,g[i])}return h};THREE.CurvePath.prototype.getWrapPoints=function(j,k){var l=this.getBoundingBox(),m,n,o,p,q,r;for(m=0,n=j.length;m<n;m++){o=j[m],p=o.x,q=o.y,r=p/l.maxX,r=k.getUtoTmapping(r,p),p=k.getPoint(r),q=k.getNormalVector(r).multiplyScalar(q),o.x=p.x+q.x,o.y=p.y+q.y}return j};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=new THREE.Object3D;THREE.Gyroscope.prototype.constructor=THREE.Gyroscope;THREE.Gyroscope.prototype.updateMatrixWorld=function(d){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||d){this.parent?(this.matrixWorld.multiply(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.compose(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,d=!0}for(var e=0,f=this.children.length;e<f;e++){this.children[e].updateMatrixWorld(d)}};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;THREE.Path=function(b){THREE.CurvePath.call(this);this.actions=[];b&&this.fromPoints(b)};THREE.Path.prototype=new THREE.CurvePath;THREE.Path.prototype.constructor=THREE.Path;THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc"};THREE.Path.prototype.fromPoints=function(d){this.moveTo(d[0].x,d[0].y);for(var e=1,f=d.length;e<f;e++){this.lineTo(d[e].x,d[e].y)}};THREE.Path.prototype.moveTo=function(d,e){var f=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:f})};THREE.Path.prototype.lineTo=function(e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args;this.curves.push(new THREE.LineCurve(new THREE.Vector2(h[h.length-2],h[h.length-1]),new THREE.Vector2(e,f)));this.actions.push({action:THREE.PathActions.LINE_TO,args:g})};THREE.Path.prototype.quadraticCurveTo=function(g,h,i,j){var k=Array.prototype.slice.call(arguments),l=this.actions[this.actions.length-1].args;this.curves.push(new THREE.QuadraticBezierCurve(new THREE.Vector2(l[l.length-2],l[l.length-1]),new THREE.Vector2(g,h),new THREE.Vector2(i,j)));this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:k})};THREE.Path.prototype.bezierCurveTo=function(i,j,k,l,m,n){var o=Array.prototype.slice.call(arguments),p=this.actions[this.actions.length-1].args;this.curves.push(new THREE.CubicBezierCurve(new THREE.Vector2(p[p.length-2],p[p.length-1]),new THREE.Vector2(i,j),new THREE.Vector2(k,l),new THREE.Vector2(m,n)));this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:o})};THREE.Path.prototype.splineThru=function(d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,f=[new THREE.Vector2(f[f.length-2],f[f.length-1])];Array.prototype.push.apply(f,d);this.curves.push(new THREE.SplineCurve(f));this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:e})};THREE.Path.prototype.arc=function(h,i,j,k,l,m){var n=Array.prototype.slice.call(arguments);this.curves.push(new THREE.ArcCurve(h,i,j,k,l,m));this.actions.push({action:THREE.PathActions.ARC,args:n})};THREE.Path.prototype.getSpacedPoints=function(d){d||(d=40);for(var e=[],f=0;f<d;f++){e.push(this.getPoint(f/d))}return e};THREE.Path.prototype.getPoints=function(j,s){var j=j||12,t=[],u,v,w,x,y,z,B,A,D,G,E,F,C;for(u=0,v=this.actions.length;u<v;u++){switch(w=this.actions[u],x=w.action,w=w.args,x){case THREE.PathActions.LINE_TO:t.push(new THREE.Vector2(w[0],w[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:y=w[2];z=w[3];D=w[0];G=w[1];0<t.length?(x=t[t.length-1],E=x.x,F=x.y):(x=this.actions[u-1].args,E=x[x.length-2],F=x[x.length-1]);for(x=1;x<=j;x++){C=x/j,w=THREE.Shape.Utils.b2(C,E,D,y),C=THREE.Shape.Utils.b2(C,F,G,z),t.push(new THREE.Vector2(w,C))}break;case THREE.PathActions.BEZIER_CURVE_TO:y=w[4];z=w[5];D=w[0];G=w[1];B=w[2];A=w[3];0<t.length?(x=t[t.length-1],E=x.x,F=x.y):(x=this.actions[u-1].args,E=x[x.length-2],F=x[x.length-1]);for(x=1;x<=j;x++){C=x/j,w=THREE.Shape.Utils.b3(C,E,D,B,y),C=THREE.Shape.Utils.b3(C,F,G,A,z),t.push(new THREE.Vector2(w,C))}break;case THREE.PathActions.CSPLINE_THRU:x=this.actions[u-1].args;x=[new THREE.Vector2(x[x.length-2],x[x.length-1])];C=j*w[0].length;x=x.concat(w[0]);w=new THREE.SplineCurve(x);for(x=1;x<=C;x++){t.push(w.getPointAt(x/C))}break;case THREE.PathActions.ARC:x=this.actions[u-1].args;y=w[0];z=w[1];B=w[2];D=w[3];C=w[4];G=!!w[5];A=x[x.length-2];E=x[x.length-1];0==x.length&&(A=E=0);F=C-D;var H=2*j;for(x=1;x<=H;x++){C=x/H,G||(C=1-C),C=D+C*F,w=A+y+B*Math.cos(C),C=E+z+B*Math.sin(C),t.push(new THREE.Vector2(w,C))}}}s&&t.push(t[0]);return t};THREE.Path.prototype.transform=function(c,d){this.getBoundingBox();return this.getWrapPoints(this.getPoints(d),c)};THREE.Path.prototype.nltransform=function(j,m,o,p,q,r){var s=this.getPoints(),t,u,w,v,x;for(t=0,u=s.length;t<u;t++){w=s[t],v=w.x,x=w.y,w.x=j*v+m*x+o,w.y=p*x+q*v+r}return s};THREE.Path.prototype.debug=function(f){var g=this.getBoundingBox();f||(f=document.createElement("canvas"),f.setAttribute("width",g.maxX+100),f.setAttribute("height",g.maxY+100),document.body.appendChild(f));g=f.getContext("2d");g.fillStyle="white";g.fillRect(0,0,f.width,f.height);g.strokeStyle="black";g.beginPath();var h,i,j;for(f=0,h=this.actions.length;f<h;f++){i=this.actions[f],j=i.args,i=i.action,i!=THREE.PathActions.CSPLINE_THRU&&g[i].apply(g,j)}g.stroke();g.closePath();g.strokeStyle="red";i=this.getPoints();for(f=0,h=i.length;f<h;f++){j=i[f],g.beginPath(),g.arc(j.x,j.y,1.5,0,2*Math.PI,!1),g.stroke(),g.closePath()}};THREE.Path.prototype.toShapes=function(){var h,i,j,k,l=[],m=new THREE.Path;for(h=0,i=this.actions.length;h<i;h++){j=this.actions[h],k=j.args,j=j.action,j==THREE.PathActions.MOVE_TO&&0!=m.actions.length&&(l.push(m),m=new THREE.Path),m[j].apply(m,k)}0!=m.actions.length&&l.push(m);if(0==l.length){return[]}var n;k=[];h=!THREE.Shape.Utils.isClockWise(l[0].getPoints());if(1==l.length){return m=l[0],n=new THREE.Shape,n.actions=m.actions,n.curves=m.curves,k.push(n),k}if(h){n=new THREE.Shape;for(h=0,i=l.length;h<i;h++){m=l[h],THREE.Shape.Utils.isClockWise(m.getPoints())?(n.actions=m.actions,n.curves=m.curves,k.push(n),n=new THREE.Shape):n.holes.push(m)}}else{for(h=0,i=l.length;h<i;h++){m=l[h],THREE.Shape.Utils.isClockWise(m.getPoints())?(n&&k.push(n),n=new THREE.Shape,n.actions=m.actions,n.curves=m.curves):n.holes.push(m)}k.push(n)}return k};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=new THREE.Path;THREE.Shape.prototype.constructor=THREE.Path;THREE.Shape.prototype.extrude=function(b){return new THREE.ExtrudeGeometry(this,b)};THREE.Shape.prototype.getPointsHoles=function(e){var f,g=this.holes.length,h=[];for(f=0;f<g;f++){h[f]=this.holes[f].getTransformedPoints(e,this.bends)}return h};THREE.Shape.prototype.getSpacedPointsHoles=function(e){var f,g=this.holes.length,h=[];for(f=0;f<g;f++){h[f]=this.holes[f].getTransformedSpacedPoints(e,this.bends)}return h};THREE.Shape.prototype.extractAllPoints=function(b){return{shape:this.getTransformedPoints(b),holes:this.getPointsHoles(b)}};THREE.Shape.prototype.extractAllSpacedPoints=function(b){return{shape:this.getTransformedSpacedPoints(b),holes:this.getSpacedPointsHoles(b)}};THREE.Shape.Utils={removeHoles:function(j,s){var t=j.concat(),u=t.concat(),v,w,x,y,z,B,A,D,G,E,F=[];for(z=0;z<s.length;z++){B=s[z];Array.prototype.push.apply(u,B);w=Number.POSITIVE_INFINITY;for(v=0;v<B.length;v++){G=B[v];E=[];for(D=0;D<t.length;D++){A=t[D],A=G.distanceToSquared(A),E.push(A),A<w&&(w=A,x=v,y=D)}}v=0<=y-1?y-1:t.length-1;w=0<=x-1?x-1:B.length-1;var C=[B[x],t[y],t[v]];D=THREE.FontUtils.Triangulate.area(C);var H=[B[x],B[w],t[y]];G=THREE.FontUtils.Triangulate.area(H);E=y;A=x;y+=1;x+=-1;0>y&&(y+=t.length);y%=t.length;0>x&&(x+=B.length);x%=B.length;v=0<=y-1?y-1:t.length-1;w=0<=x-1?x-1:B.length-1;C=[B[x],t[y],t[v]];C=THREE.FontUtils.Triangulate.area(C);H=[B[x],B[w],t[y]];H=THREE.FontUtils.Triangulate.area(H);D+G>C+H&&(y=E,x=A,0>y&&(y+=t.length),y%=t.length,0>x&&(x+=B.length),x%=B.length,v=0<=y-1?y-1:t.length-1,w=0<=x-1?x-1:B.length-1);D=t.slice(0,y);G=t.slice(y);E=B.slice(x);A=B.slice(0,x);w=[B[x],B[w],t[y]];F.push([B[x],t[y],t[v]]);F.push(w);t=D.concat(E).concat(A).concat(G)}return{shape:t,isolatedPts:F,allpoints:u}},triangulateShape:function(j,k){var m=THREE.Shape.Utils.removeHoles(j,k),n=m.allpoints,o=m.isolatedPts,m=THREE.FontUtils.Triangulate(m.shape,!1),p,q,r,s,t={};for(p=0,q=n.length;p<q;p++){s=n[p].x+":"+n[p].y,void 0!==t[s]&&console.log("Duplicate point",s),t[s]=p}for(p=0,q=m.length;p<q;p++){r=m[p];for(n=0;3>n;n++){s=r[n].x+":"+r[n].y,s=t[s],void 0!==s&&(r[n]=s)}}for(p=0,q=o.length;p<q;p++){r=o[p];for(n=0;3>n;n++){s=r[n].x+":"+r[n].y,s=t[s],void 0!==s&&(r[n]=s)}}return m.concat(o)},isClockWise:function(b){return 0>THREE.FontUtils.Triangulate.area(b)},b2p0:function(d,e){var f=1-d;return f*f*e},b2p1:function(c,d){return 2*(1-c)*c*d},b2p2:function(c,d){return c*c*d},b2:function(e,f,g,h){return this.b2p0(e,f)+this.b2p1(e,g)+this.b2p2(e,h)},b3p0:function(d,e){var f=1-d;return f*f*f*e},b3p1:function(d,e){var f=1-d;return 3*f*f*d*e},b3p2:function(c,d){return 3*(1-c)*c*c*d},b3p3:function(c,d){return c*c*c*d},b3:function(f,g,h,i,j){return this.b3p0(f,g)+this.b3p1(f,h)+this.b3p2(f,i)+this.b3p3(f,j)}};THREE.TextPath=function(c,d){THREE.Path.call(this);this.parameters=d||{};this.set(c)};THREE.TextPath.prototype.set=function(g,h){h=h||this.parameters;this.text=g;var i=void 0!==h.curveSegments?h.curveSegments:4,j=void 0!==h.font?h.font:"helvetiker",k=void 0!==h.weight?h.weight:"normal",l=void 0!==h.style?h.style:"normal";THREE.FontUtils.size=void 0!==h.size?h.size:100;THREE.FontUtils.divisions=i;THREE.FontUtils.face=j;THREE.FontUtils.weight=k;THREE.FontUtils.style=l};THREE.TextPath.prototype.toShapes=function(){for(var e=THREE.FontUtils.drawText(this.text).paths,f=[],g=0,h=e.length;g<h;g++){Array.prototype.push.apply(f,e[g].toShapes())}return f};THREE.AnimationHandler=function(){var e=[],f={},g={update:function(a){for(var d=0;d<e.length;d++){e[d].update(a)}},addToUpdate:function(a){-1===e.indexOf(a)&&e.push(a)},removeFromUpdate:function(a){a=e.indexOf(a);-1!==a&&e.splice(a,1)},add:function(b){void 0!==f[b.name]&&console.log("THREE.AnimationHandler.add: Warning! "+b.name+" already exists in library. Overwriting.");f[b.name]=b;if(!0!==b.initialized){for(var j=0;j<b.hierarchy.length;j++){for(var m=0;m<b.hierarchy[j].keys.length;m++){if(0>b.hierarchy[j].keys[m].time){b.hierarchy[j].keys[m].time=0}if(void 0!==b.hierarchy[j].keys[m].rot&&!(b.hierarchy[j].keys[m].rot instanceof THREE.Quaternion)){var n=b.hierarchy[j].keys[m].rot;b.hierarchy[j].keys[m].rot=new THREE.Quaternion(n[0],n[1],n[2],n[3])}}if(b.hierarchy[j].keys.length&&void 0!==b.hierarchy[j].keys[0].morphTargets){n={};for(m=0;m<b.hierarchy[j].keys.length;m++){for(var o=0;o<b.hierarchy[j].keys[m].morphTargets.length;o++){var q=b.hierarchy[j].keys[m].morphTargets[o];n[q]=-1}}b.hierarchy[j].usedMorphTargets=n;for(m=0;m<b.hierarchy[j].keys.length;m++){var p={};for(q in n){for(o=0;o<b.hierarchy[j].keys[m].morphTargets.length;o++){if(b.hierarchy[j].keys[m].morphTargets[o]===q){p[q]=b.hierarchy[j].keys[m].morphTargetsInfluences[o];break}}o===b.hierarchy[j].keys[m].morphTargets.length&&(p[q]=0)}b.hierarchy[j].keys[m].morphTargetsInfluences=p}}for(m=1;m<b.hierarchy[j].keys.length;m++){b.hierarchy[j].keys[m].time===b.hierarchy[j].keys[m-1].time&&(b.hierarchy[j].keys.splice(m,1),m--)}for(m=0;m<b.hierarchy[j].keys.length;m++){b.hierarchy[j].keys[m].index=m}}m=parseInt(b.length*b.fps,10);b.JIT={};b.JIT.hierarchy=[];for(j=0;j<b.hierarchy.length;j++){b.JIT.hierarchy.push(Array(m))}b.initialized=!0}},get:function(b){if("string"===typeof b){if(f[b]){return f[b]}console.log("THREE.AnimationHandler.get: Couldn't find animation "+b);return null}},parse:function(d){var i=[];if(d instanceof THREE.SkinnedMesh){for(var j=0;j<d.bones.length;j++){i.push(d.bones[j])}}else{h(d,i)}return i}},h=function(d,i){i.push(d);for(var j=0;j<d.children.length;j++){h(d.children[j],i)}};g.LINEAR=0;g.CATMULLROM=1;g.CATMULLROM_FORWARD=2;return g}();THREE.Animation=function(e,f,g,h){this.root=e;this.data=THREE.AnimationHandler.get(f);this.hierarchy=THREE.AnimationHandler.parse(e);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==g?g:THREE.AnimationHandler.LINEAR;this.JITCompile=void 0!==h?h:!0;this.points=[];this.target=new THREE.Vector3};THREE.Animation.prototype.play=function(g,h){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==g?g:!0;this.currentTime=void 0!==h?h:0;var i,j=this.hierarchy.length,k;for(i=0;i<j;i++){k=this.hierarchy[i];if(this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD){k.useQuaternion=!0}k.matrixAutoUpdate=!0;if(void 0===k.animationCache){k.animationCache={},k.animationCache.prevKey={pos:0,rot:0,scl:0},k.animationCache.nextKey={pos:0,rot:0,scl:0},k.animationCache.originalMatrix=k instanceof THREE.Bone?k.skinMatrix:k.matrix}var l=k.animationCache.prevKey;k=k.animationCache.nextKey;l.pos=this.data.hierarchy[i].keys[0];l.rot=this.data.hierarchy[i].keys[0];l.scl=this.data.hierarchy[i].keys[0];k.pos=this.getNextKeyWith("pos",i,1);k.rot=this.getNextKeyWith("rot",i,1);k.scl=this.getNextKeyWith("scl",i,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var b=0;b<this.hierarchy.length;b++){if(void 0!==this.hierarchy[b].animationCache){this.hierarchy[b] instanceof THREE.Bone?this.hierarchy[b].skinMatrix=this.hierarchy[b].animationCache.originalMatrix:this.hierarchy[b].matrix=this.hierarchy[b].animationCache.originalMatrix,delete this.hierarchy[b].animationCache}}};THREE.Animation.prototype.update=function(j){if(this.isPlaying){var r=["pos","rot","scl"],s,t,u,v,w,x,y,A,z=this.data.JIT.hierarchy,C,F;F=this.currentTime+=j*this.timeScale;C=this.currentTime%=this.data.length;A=parseInt(Math.min(C*this.data.fps,this.data.length*this.data.fps),10);for(var D=0,E=this.hierarchy.length;D<E;D++){if(j=this.hierarchy[D],y=j.animationCache,this.JITCompile&&void 0!==z[D][A]){j instanceof THREE.Bone?(j.skinMatrix=z[D][A],j.matrixAutoUpdate=!1,j.matrixWorldNeedsUpdate=!1):(j.matrix=z[D][A],j.matrixAutoUpdate=!1,j.matrixWorldNeedsUpdate=!0)}else{if(this.JITCompile){j instanceof THREE.Bone?j.skinMatrix=j.animationCache.originalMatrix:j.matrix=j.animationCache.originalMatrix}for(var B=0;3>B;B++){s=r[B];w=y.prevKey[s];x=y.nextKey[s];if(x.time<=F){if(C<F){if(this.loop){w=this.data.hierarchy[D].keys[0];for(x=this.getNextKeyWith(s,D,1);x.time<C;){w=x,x=this.getNextKeyWith(s,D,x.index+1)}}else{this.stop();return}}else{do{w=x,x=this.getNextKeyWith(s,D,x.index+1)}while(x.time<C)}y.prevKey[s]=w;y.nextKey[s]=x}j.matrixAutoUpdate=!0;j.matrixWorldNeedsUpdate=!0;t=(C-w.time)/(x.time-w.time);u=w[s];v=x[s];if(0>t||1<t){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+t+" on bone "+D),t=0>t?0:1}if("pos"===s){if(s=j.position,this.interpolationType===THREE.AnimationHandler.LINEAR){s.x=u[0]+(v[0]-u[0])*t,s.y=u[1]+(v[1]-u[1])*t,s.z=u[2]+(v[2]-u[2])*t}else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){if(this.points[0]=this.getPrevKeyWith("pos",D,w.index-1).pos,this.points[1]=u,this.points[2]=v,this.points[3]=this.getNextKeyWith("pos",D,x.index+1).pos,t=0.33*t+0.33,u=this.interpolateCatmullRom(this.points,t),s.x=u[0],s.y=u[1],s.z=u[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){t=this.interpolateCatmullRom(this.points,1.01*t),this.target.set(t[0],t[1],t[2]),this.target.subSelf(s),this.target.y=0,this.target.normalize(),t=Math.atan2(this.target.x,this.target.z),j.rotation.set(0,t,0)}}}}else{if("rot"===s){THREE.Quaternion.slerp(u,v,j.quaternion,t)}else{if("scl"===s){s=j.scale,s.x=u[0]+(v[0]-u[0])*t,s.y=u[1]+(v[1]-u[1])*t,s.z=u[2]+(v[2]-u[2])*t}}}}}}if(this.JITCompile&&void 0===z[0][A]){this.hierarchy[0].updateMatrixWorld(!0);for(D=0;D<this.hierarchy.length;D++){z[D][A]=this.hierarchy[D] instanceof THREE.Bone?this.hierarchy[D].skinMatrix.clone():this.hierarchy[D].matrix.clone()}}}};THREE.Animation.prototype.interpolateCatmullRom=function(j,k){var m=[],n=[],o,p,q,r,s,t;o=(j.length-1)*k;p=Math.floor(o);o-=p;m[0]=0===p?p:p-1;m[1]=p;m[2]=p>j.length-2?p:p+1;m[3]=p>j.length-3?p:p+2;p=j[m[0]];r=j[m[1]];s=j[m[2]];t=j[m[3]];m=o*o;q=o*m;n[0]=this.interpolate(p[0],r[0],s[0],t[0],o,m,q);n[1]=this.interpolate(p[1],r[1],s[1],t[1],o,m,q);n[2]=this.interpolate(p[2],r[2],s[2],t[2],o,m,q);return n};THREE.Animation.prototype.interpolate=function(h,i,j,k,l,m,n){h=0.5*(j-h);k=0.5*(k-i);return(2*(i-j)+h+k)*n+(-3*(i-j)-2*h-k)*m+h*l+i};THREE.Animation.prototype.getNextKeyWith=function(e,f,g){for(var h=this.data.hierarchy[f].keys,g=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?g<h.length-1?g:h.length-1:g%h.length;g<h.length;g++){if(void 0!==h[g][e]){return h[g]}}return this.data.hierarchy[f].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(e,f,g){for(var h=this.data.hierarchy[f].keys,g=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<g?g:0:0<=g?g:g+h.length;0<=g;g--){if(void 0!==h[g][e]){return h[g]}}return this.data.hierarchy[f].keys[h.length-1]};THREE.KeyFrameAnimation=function(h,i,j){this.root=h;this.data=THREE.AnimationHandler.get(i);this.hierarchy=THREE.AnimationHandler.parse(h);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==j?j:!0;h=0;for(i=this.hierarchy.length;h<i;h++){var j=this.data.hierarchy[h].sids,k=this.hierarchy[h];if(this.data.hierarchy[h].keys.length&&j){for(var l=0;l<j.length;l++){var m=j[l],n=this.getNextKeyWith(m,h,0);n&&n.apply(m)}k.matrixAutoUpdate=!1;this.data.hierarchy[h].node.updateMatrix();k.matrixWorldNeedsUpdate=!0}}};THREE.KeyFrameAnimation.prototype.play=function(g,h){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==g?g:!0;this.currentTime=void 0!==h?h:0;this.startTimeMs=h;this.startTime=10000000;this.endTime=-this.startTime;var i,j=this.hierarchy.length,k,l;for(i=0;i<j;i++){k=this.hierarchy[i];l=this.data.hierarchy[i];k.useQuaternion=!0;if(void 0===l.animationCache){l.animationCache={},l.animationCache.prevKey=null,l.animationCache.nextKey=null,l.animationCache.originalMatrix=k instanceof THREE.Bone?k.skinMatrix:k.matrix}k=this.data.hierarchy[i].keys;if(k.length){l.animationCache.prevKey=k[0],l.animationCache.nextKey=k[1],this.startTime=Math.min(k[0].time,this.startTime),this.endTime=Math.max(k[k.length-1].time,this.endTime)}}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var d=0;d<this.hierarchy.length;d++){var e=this.hierarchy[d];if(void 0!==e.animationCache){var f=e.animationCache.originalMatrix;e instanceof THREE.Bone?(f.copy(e.skinMatrix),e.skinMatrix=f):(f.copy(e.matrix),e.matrix=f);delete e.animationCache}}};THREE.KeyFrameAnimation.prototype.update=function(j){if(this.isPlaying){var m,o,p,r,s=this.data.JIT.hierarchy,t,u,v;u=this.currentTime+=j*this.timeScale;t=this.currentTime%=this.data.length;if(t<this.startTimeMs){t=this.currentTime=this.startTimeMs+t}r=parseInt(Math.min(t*this.data.fps,this.data.length*this.data.fps),10);if((v=t<u)&&!this.loop){for(var j=0,x=this.hierarchy.length;j<x;j++){var w=this.data.hierarchy[j].keys,s=this.data.hierarchy[j].sids;p=w.length-1;r=this.hierarchy[j];if(w.length){for(w=0;w<s.length;w++){t=s[w],(u=this.getPrevKeyWith(t,j,p))&&u.apply(t)}this.data.hierarchy[j].node.updateMatrix();r.matrixWorldNeedsUpdate=!0}}this.stop()}else{if(!(t<this.startTime)){j=0;for(x=this.hierarchy.length;j<x;j++){p=this.hierarchy[j];m=this.data.hierarchy[j];var w=m.keys,y=m.animationCache;if(this.JITCompile&&void 0!==s[j][r]){p instanceof THREE.Bone?(p.skinMatrix=s[j][r],p.matrixWorldNeedsUpdate=!1):(p.matrix=s[j][r],p.matrixWorldNeedsUpdate=!0)}else{if(w.length){if(this.JITCompile&&y){p instanceof THREE.Bone?p.skinMatrix=y.originalMatrix:p.matrix=y.originalMatrix}m=y.prevKey;o=y.nextKey;if(m&&o){if(o.time<=u){if(v&&this.loop){m=w[0];for(o=w[1];o.time<t;){m=o,o=w[m.index+1]}}else{if(!v){for(var z=w.length-1;o.time<t&&o.index!==z;){m=o,o=w[m.index+1]}}}y.prevKey=m;y.nextKey=o}m.interpolate(o,t)}this.data.hierarchy[j].node.updateMatrix();p.matrixWorldNeedsUpdate=!0}}}if(this.JITCompile&&void 0===s[0][r]){this.hierarchy[0].updateMatrixWorld(!0);for(j=0;j<this.hierarchy.length;j++){s[j][r]=this.hierarchy[j] instanceof THREE.Bone?this.hierarchy[j].skinMatrix.clone():this.hierarchy[j].matrix.clone()}}}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(d,e,f){e=this.data.hierarchy[e].keys;for(f%=e.length;f<e.length;f++){if(e[f].hasTarget(d)){return e[f]}}return e[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(d,e,f){e=this.data.hierarchy[e].keys;for(f=0<=f?f:f+e.length;0<=f;f--){if(e[f].hasTarget(d)){return e[f]}}return e[e.length-1]};THREE.CubeCamera=function(e,f,g,h){this.heightOffset=g;this.position=new THREE.Vector3(0,g,0);this.cameraPX=new THREE.PerspectiveCamera(90,1,e,f);this.cameraNX=new THREE.PerspectiveCamera(90,1,e,f);this.cameraPY=new THREE.PerspectiveCamera(90,1,e,f);this.cameraNY=new THREE.PerspectiveCamera(90,1,e,f);this.cameraPZ=new THREE.PerspectiveCamera(90,1,e,f);this.cameraNZ=new THREE.PerspectiveCamera(90,1,e,f);this.cameraPX.position=this.position;this.cameraNX.position=this.position;this.cameraPY.position=this.position;this.cameraNY.position=this.position;this.cameraPZ.position=this.position;this.cameraNZ.position=this.position;this.cameraPX.up.set(0,-1,0);this.cameraNX.up.set(0,-1,0);this.cameraPY.up.set(0,0,1);this.cameraNY.up.set(0,0,-1);this.cameraPZ.up.set(0,-1,0);this.cameraNZ.up.set(0,-1,0);this.targetPX=new THREE.Vector3(0,0,0);this.targetNX=new THREE.Vector3(0,0,0);this.targetPY=new THREE.Vector3(0,0,0);this.targetNY=new THREE.Vector3(0,0,0);this.targetPZ=new THREE.Vector3(0,0,0);this.targetNZ=new THREE.Vector3(0,0,0);this.renderTarget=new THREE.WebGLRenderTargetCube(h,h,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updatePosition=function(b){this.position.copy(b);this.position.y+=this.heightOffset;this.targetPX.copy(this.position);this.targetNX.copy(this.position);this.targetPY.copy(this.position);this.targetNY.copy(this.position);this.targetPZ.copy(this.position);this.targetNZ.copy(this.position);this.targetPX.x+=1;this.targetNX.x-=1;this.targetPY.y+=1;this.targetNY.y-=1;this.targetPZ.z+=1;this.targetNZ.z-=1;this.cameraPX.lookAt(this.targetPX);this.cameraNX.lookAt(this.targetNX);this.cameraPY.lookAt(this.targetPY);this.cameraNY.lookAt(this.targetNY);this.cameraPZ.lookAt(this.targetPZ);this.cameraNZ.lookAt(this.targetNZ)};this.updateCubeMap=function(d,i){var j=this.renderTarget;j.activeCubeFace=0;d.render(i,this.cameraPX,j);j.activeCubeFace=1;d.render(i,this.cameraNX,j);j.activeCubeFace=2;d.render(i,this.cameraPY,j);j.activeCubeFace=3;d.render(i,this.cameraNY,j);j.activeCubeFace=4;d.render(i,this.cameraPZ,j);j.activeCubeFace=5;d.render(i,this.cameraNZ,j)}};THREE.FirstPersonCamera=function(){console.warn("DEPRECATED: FirstPersonCamera() is FirstPersonControls().")};THREE.PathCamera=function(){console.warn("DEPRECATED: PathCamera() is PathControls().")};THREE.FlyCamera=function(){console.warn("DEPRECATED: FlyCamera() is FlyControls().")};THREE.RollCamera=function(){console.warn("DEPRECATED: RollCamera() is RollControls().")};THREE.TrackballCamera=function(){console.warn("DEPRECATED: TrackballCamera() is TrackballControls().")};THREE.CombinedCamera=function(h,i,j,k,l,m,n){THREE.Camera.call(this);this.fov=j;this.left=-h/2;this.right=h/2;this.top=i/2;this.bottom=-i/2;this.cameraO=new THREE.OrthographicCamera(h/-2,h/2,i/2,i/-2,m,n);this.cameraP=new THREE.PerspectiveCamera(j,h/i,k,l);this.zoom=1;this.toPerspective()};THREE.CombinedCamera.prototype=new THREE.Camera;THREE.CombinedCamera.prototype.constructor=THREE.CoolCamera;THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPersepectiveMode=!0;this.inOrthographicMode=!1};THREE.CombinedCamera.prototype.toOrthographic=function(){var c=this.cameraP.aspect,d=(this.cameraP.near+this.cameraP.far)/2,d=Math.tan(this.fov/2)*d,c=2*d*c/2,d=d/this.zoom,c=c/this.zoom;this.cameraO.left=-c;this.cameraO.right=c;this.cameraO.top=d;this.cameraO.bottom=-d;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPersepectiveMode=!1;this.inOrthographicMode=!0};THREE.CombinedCamera.prototype.setFov=function(b){this.fov=b;this.inPersepectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.setLens=function(d,e){e||(e=43.25);var f=2*Math.atan(e/(2*d)),f=180/Math.PI*f;this.setFov(f);return f};THREE.CombinedCamera.prototype.setZoom=function(b){this.zoom=b;this.inPersepectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.FirstPersonControls=function(d,e){function f(c,g){return function(){g.apply(c,arguments)}}this.object=d;this.target=new THREE.Vector3(0,0,0);this.domElement=void 0!==e?e:document;this.movementSpeed=1;this.lookSpeed=0.005;this.noFly=!1;this.lookVertical=!0;this.autoForward=!1;this.activeLook=!0;this.heightSpeed=!1;this.heightCoef=1;this.heightMin=0;this.constrainVertical=!1;this.verticalMin=0;this.verticalMax=Math.PI;this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=this.autoSpeedFactor=0;this.mouseDragOn=this.freeze=this.moveRight=this.moveLeft=this.moveBackward=this.moveForward=!1;this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2,this.domElement.setAttribute("tabindex",-1));this.onMouseDown=function(b){this.domElement!==document&&this.domElement.focus();b.preventDefault();b.stopPropagation();if(this.activeLook){switch(b.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}}this.mouseDragOn=!0};this.onMouseUp=function(b){b.preventDefault();b.stopPropagation();if(this.activeLook){switch(b.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}}this.mouseDragOn=!1};this.onMouseMove=function(b){this.domElement===document?(this.mouseX=b.pageX-this.viewHalfX,this.mouseY=b.pageY-this.viewHalfY):(this.mouseX=b.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=b.pageY-this.domElement.offsetTop-this.viewHalfY)};this.onKeyDown=function(b){switch(b.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}};this.onKeyUp=function(b){switch(b.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}};this.update=function(g){var h=0;if(!this.freeze){this.heightSpeed?(h=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax)-this.heightMin,this.autoSpeedFactor=g*h*this.heightCoef):this.autoSpeedFactor=0;h=g*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(h+this.autoSpeedFactor));this.moveBackward&&this.object.translateZ(h);this.moveLeft&&this.object.translateX(-h);this.moveRight&&this.object.translateX(h);this.moveUp&&this.object.translateY(h);this.moveDown&&this.object.translateY(-h);g*=this.lookSpeed;this.activeLook||(g=0);this.lon+=this.mouseX*g;this.lookVertical&&(this.lat-=this.mouseY*g);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;var h=this.target,i=this.object.position;h.x=i.x+100*Math.sin(this.phi)*Math.cos(this.theta);h.y=i.y+100*Math.cos(this.phi);h.z=i.z+100*Math.sin(this.phi)*Math.sin(this.theta);h=1;this.constrainVertical&&(h=Math.PI/(this.verticalMax-this.verticalMin));this.lon+=this.mouseX*g;this.lookVertical&&(this.lat-=this.mouseY*g*h);this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*Math.PI/180;this.theta=this.lon*Math.PI/180;if(this.constrainVertical){this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax)}h=this.target;i=this.object.position;h.x=i.x+100*Math.sin(this.phi)*Math.cos(this.theta);h.y=i.y+100*Math.cos(this.phi);h.z=i.z+100*Math.sin(this.phi)*Math.sin(this.theta);this.object.lookAt(h)}};this.domElement.addEventListener("contextmenu",function(b){b.preventDefault()},!1);this.domElement.addEventListener("mousemove",f(this,this.onMouseMove),!1);this.domElement.addEventListener("mousedown",f(this,this.onMouseDown),!1);this.domElement.addEventListener("mouseup",f(this,this.onMouseUp),!1);this.domElement.addEventListener("keydown",f(this,this.onKeyDown),!1);this.domElement.addEventListener("keyup",f(this,this.onKeyUp),!1)};THREE.PathControls=function(i,j){function k(b){return 1>(b*=2)?0.5*b*b:-0.5*(--b*(b-2)-1)}function l(c,d){return function(){d.apply(c,arguments)}}function m(q,t,u,v){var w={name:u,fps:0.6,length:v,hierarchy:[]},x,y=t.getControlPointsArray(),z=t.getLength(),A=y.length,B=0;x=A-1;t={parent:-1,keys:[]};t.keys[0]={time:0,pos:y[0],rot:[0,0,0,1],scl:[1,1,1]};t.keys[x]={time:v,pos:y[x],rot:[0,0,0,1],scl:[1,1,1]};for(x=1;x<A-1;x++){B=v*z.chunks[x]/z.total,t.keys[x]={time:B,pos:y[x]}}w.hierarchy[0]=t;THREE.AnimationHandler.add(w);return new THREE.Animation(q,u,THREE.AnimationHandler.CATMULLROM_FORWARD,!1)}function n(f,g){var h,q,r=new THREE.Geometry;for(h=0;h<f.points.length*g;h++){q=h/(f.points.length*g),q=f.getPoint(q),r.vertices[h]=new THREE.Vertex(new THREE.Vector3(q.x,q.y,q.z))}return r}this.object=i;this.domElement=void 0!==j?j:document;this.id="PathControls"+THREE.PathControlsIdCounter++;this.duration=10000;this.waypoints=[];this.useConstantSpeed=!0;this.resamplingCoef=50;this.debugPath=new THREE.Object3D;this.debugDummy=new THREE.Object3D;this.animationParent=new THREE.Object3D;this.lookSpeed=0.005;this.lookHorizontal=this.lookVertical=!0;this.verticalAngleMap={srcRange:[0,2*Math.PI],dstRange:[0,2*Math.PI]};this.horizontalAngleMap={srcRange:[0,2*Math.PI],dstRange:[0,2*Math.PI]};this.target=new THREE.Object3D;this.theta=this.phi=this.lon=this.lat=this.mouseY=this.mouseX=0;this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2,this.domElement.setAttribute("tabindex",-1));var o=2*Math.PI,p=Math.PI/180;this.update=function(c){var e;this.lookHorizontal&&(this.lon+=this.mouseX*this.lookSpeed*c);this.lookVertical&&(this.lat-=this.mouseY*this.lookSpeed*c);this.lon=Math.max(0,Math.min(360,this.lon));this.lat=Math.max(-85,Math.min(85,this.lat));this.phi=(90-this.lat)*p;this.theta=this.lon*p;c=this.phi%o;this.phi=0<=c?c:c+o;e=this.verticalAngleMap.srcRange;c=this.verticalAngleMap.dstRange;e=THREE.Math.mapLinear(this.phi,e[0],e[1],c[0],c[1]);var f=c[1]-c[0];this.phi=k((e-c[0])/f)*f+c[0];e=this.horizontalAngleMap.srcRange;c=this.horizontalAngleMap.dstRange;e=THREE.Math.mapLinear(this.theta,e[0],e[1],c[0],c[1]);f=c[1]-c[0];this.theta=k((e-c[0])/f)*f+c[0];c=this.target.position;c.x=100*Math.sin(this.phi)*Math.cos(this.theta);c.y=100*Math.cos(this.phi);c.z=100*Math.sin(this.phi)*Math.sin(this.theta);this.object.lookAt(this.target.position)};this.onMouseMove=function(b){this.domElement===document?(this.mouseX=b.pageX-this.viewHalfX,this.mouseY=b.pageY-this.viewHalfY):(this.mouseX=b.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=b.pageY-this.domElement.offsetTop-this.viewHalfY)};this.init=function(){this.spline=new THREE.Spline;this.spline.initFromArray(this.waypoints);this.useConstantSpeed&&this.spline.reparametrizeByArcLength(this.resamplingCoef);if(this.createDebugDummy){var d=new THREE.MeshLambertMaterial({color:30719}),e=new THREE.MeshLambertMaterial({color:65280}),f=new THREE.CubeGeometry(10,10,20),q=new THREE.CubeGeometry(2,2,10);this.animationParent=new THREE.Mesh(f,d);d=new THREE.Mesh(q,e);d.position.set(0,10,0);this.animation=m(this.animationParent,this.spline,this.id,this.duration);this.animationParent.add(this.object);this.animationParent.add(this.target);this.animationParent.add(d)}else{this.animation=m(this.animationParent,this.spline,this.id,this.duration),this.animationParent.add(this.target),this.animationParent.add(this.object)}if(this.createDebugPath){var d=this.debugPath,e=this.spline,q=n(e,10),f=n(e,10),r=new THREE.LineBasicMaterial({color:16711680,linewidth:3}),q=new THREE.Line(q,r),f=new THREE.ParticleSystem(f,new THREE.ParticleBasicMaterial({color:16755200,size:3}));q.scale.set(1,1,1);d.add(q);f.scale.set(1,1,1);d.add(f);for(var q=new THREE.SphereGeometry(1,16,8),r=new THREE.MeshBasicMaterial({color:65280}),s=0;s<e.points.length;s++){f=new THREE.Mesh(q,r),f.position.copy(e.points[s]),d.add(f)}}this.domElement.addEventListener("mousemove",l(this,this.onMouseMove),!1)}};THREE.PathControlsIdCounter=0;THREE.FlyControls=function(d,e){function f(c,g){return function(){g.apply(c,arguments)}}this.object=d;this.domElement=void 0!==e?e:document;e&&this.domElement.setAttribute("tabindex",-1);this.movementSpeed=1;this.rollSpeed=0.005;this.autoForward=this.dragToLook=!1;this.object.useQuaternion=!0;this.tmpQuaternion=new THREE.Quaternion;this.mouseStatus=0;this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0};this.moveVector=new THREE.Vector3(0,0,0);this.rotationVector=new THREE.Vector3(0,0,0);this.handleEvent=function(b){if("function"==typeof this[b.type]){this[b.type](b)}};this.keydown=function(b){if(!b.altKey){switch(b.keyCode){case 16:this.movementSpeedMultiplier=0.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector();this.updateRotationVector()}};this.keyup=function(b){switch(b.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector();this.updateRotationVector()};this.mousedown=function(b){this.domElement!==document&&this.domElement.focus();b.preventDefault();b.stopPropagation();if(this.dragToLook){this.mouseStatus++}else{switch(b.button){case 0:this.object.moveForward=!0;break;case 2:this.object.moveBackward=!0}}};this.mousemove=function(h){if(!this.dragToLook||0<this.mouseStatus){var i=this.getContainerDimensions(),j=i.size[0]/2,k=i.size[1]/2;this.moveState.yawLeft=-(h.pageX-i.offset[0]-j)/j;this.moveState.pitchDown=(h.pageY-i.offset[1]-k)/k;this.updateRotationVector()}};this.mouseup=function(b){b.preventDefault();b.stopPropagation();if(this.dragToLook){this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0}else{switch(b.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}}this.updateRotationVector()};this.update=function(c){var g=c*this.movementSpeed,c=c*this.rollSpeed;this.object.translateX(this.moveVector.x*g);this.object.translateY(this.moveVector.y*g);this.object.translateZ(this.moveVector.z*g);this.tmpQuaternion.set(this.rotationVector.x*c,this.rotationVector.y*c,this.rotationVector.z*c,1).normalize();this.object.quaternion.multiplySelf(this.tmpQuaternion);this.object.matrix.setPosition(this.object.position);this.object.matrix.setRotationFromQuaternion(this.object.quaternion);this.object.matrixWorldNeedsUpdate=!0};this.updateMovementVector=function(){var b=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right;this.moveVector.y=-this.moveState.down+this.moveState.up;this.moveVector.z=-b+this.moveState.back};this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp;this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft;this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft};this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}};this.domElement.addEventListener("mousemove",f(this,this.mousemove),!1);this.domElement.addEventListener("mousedown",f(this,this.mousedown),!1);this.domElement.addEventListener("mouseup",f(this,this.mouseup),!1);this.domElement.addEventListener("keydown",f(this,this.keydown),!1);this.domElement.addEventListener("keyup",f(this,this.keyup),!1);this.updateMovementVector();this.updateRotationVector()};THREE.RollControls=function(j,m){this.object=j;this.domElement=void 0!==m?m:document;this.mouseLook=!0;this.autoForward=!1;this.rollSpeed=this.movementSpeed=this.lookSpeed=1;this.constrainVertical=[-0.9,0.9];this.object.matrixAutoUpdate=!1;this.forward=new THREE.Vector3(0,0,1);this.roll=0;var r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Matrix4,v=!1,w=1,x=0,z=0,y=0,A=0,D=0,B=window.innerWidth/2,C=window.innerHeight/2;this.update=function(c){if(this.mouseLook){var d=c*this.lookSpeed;this.rotateHorizontally(d*A);this.rotateVertically(d*D)}d=c*this.movementSpeed;this.object.translateZ(-d*(0<x||this.autoForward&&!(0>x)?1:x));this.object.translateX(d*z);this.object.translateY(d*y);v&&(this.roll+=this.rollSpeed*c*w);if(this.forward.y>this.constrainVertical[1]){this.forward.y=this.constrainVertical[1],this.forward.normalize()}else{if(this.forward.y<this.constrainVertical[0]){this.forward.y=this.constrainVertical[0],this.forward.normalize()}}t.copy(this.forward);s.set(0,1,0);r.cross(s,t).normalize();s.cross(t,r).normalize();this.object.matrix.n11=r.x;this.object.matrix.n12=s.x;this.object.matrix.n13=t.x;this.object.matrix.n21=r.y;this.object.matrix.n22=s.y;this.object.matrix.n23=t.y;this.object.matrix.n31=r.z;this.object.matrix.n32=s.z;this.object.matrix.n33=t.z;u.identity();u.n11=Math.cos(this.roll);u.n12=-Math.sin(this.roll);u.n21=Math.sin(this.roll);u.n22=Math.cos(this.roll);this.object.matrix.multiplySelf(u);this.object.matrixWorldNeedsUpdate=!0;this.object.matrix.n14=this.object.position.x;this.object.matrix.n24=this.object.position.y;this.object.matrix.n34=this.object.position.z};this.translateX=function(b){this.object.position.x+=this.object.matrix.n11*b;this.object.position.y+=this.object.matrix.n21*b;this.object.position.z+=this.object.matrix.n31*b};this.translateY=function(b){this.object.position.x+=this.object.matrix.n12*b;this.object.position.y+=this.object.matrix.n22*b;this.object.position.z+=this.object.matrix.n32*b};this.translateZ=function(b){this.object.position.x-=this.object.matrix.n13*b;this.object.position.y-=this.object.matrix.n23*b;this.object.position.z-=this.object.matrix.n33*b};this.rotateHorizontally=function(b){r.set(this.object.matrix.n11,this.object.matrix.n21,this.object.matrix.n31);r.multiplyScalar(b);this.forward.subSelf(r);this.forward.normalize()};this.rotateVertically=function(b){s.set(this.object.matrix.n12,this.object.matrix.n22,this.object.matrix.n32);s.multiplyScalar(b);this.forward.addSelf(s);this.forward.normalize()};this.domElement.addEventListener("contextmenu",function(b){b.preventDefault()},!1);this.domElement.addEventListener("mousemove",function(b){A=(b.clientX-B)/window.innerWidth;D=(b.clientY-C)/window.innerHeight},!1);this.domElement.addEventListener("mousedown",function(b){b.preventDefault();b.stopPropagation();switch(b.button){case 0:x=1;break;case 2:x=-1}},!1);this.domElement.addEventListener("mouseup",function(b){b.preventDefault();b.stopPropagation();switch(b.button){case 0:x=0;break;case 2:x=0}},!1);this.domElement.addEventListener("keydown",function(b){switch(b.keyCode){case 38:case 87:x=1;break;case 37:case 65:z=-1;break;case 40:case 83:x=-1;break;case 39:case 68:z=1;break;case 81:v=!0;w=1;break;case 69:v=!0;w=-1;break;case 82:y=1;break;case 70:y=-1}},!1);this.domElement.addEventListener("keyup",function(b){switch(b.keyCode){case 38:case 87:x=0;break;case 37:case 65:z=0;break;case 40:case 83:x=0;break;case 39:case 68:z=0;break;case 81:v=!1;break;case 69:v=!1;break;case 82:y=0;break;case 70:y=0}},!1)};THREE.TrackballControls=function(j,m){var o=this;this.object=j;this.domElement=void 0!==m?m:document;this.enabled=!0;this.screen={width:window.innerWidth,height:window.innerHeight,offsetLeft:0,offsetTop:0};this.radius=(this.screen.width+this.screen.height)/4;this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=0.3;this.staticMoving=this.noPan=this.noZoom=this.noRotate=!1;this.dynamicDampingFactor=0.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.target=new THREE.Vector3(0,0,0);var p=!1,q=-1,r=new THREE.Vector3,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector2,w=new THREE.Vector2,v=new THREE.Vector2,x=new THREE.Vector2;this.handleEvent=function(b){if("function"==typeof this[b.type]){this[b.type](b)}};this.getMouseOnScreen=function(c,d){return new THREE.Vector2(0.5*((c-o.screen.offsetLeft)/o.radius),0.5*((d-o.screen.offsetTop)/o.radius))};this.getMouseProjectionOnBall=function(c,f){var g=new THREE.Vector3((c-0.5*o.screen.width-o.screen.offsetLeft)/o.radius,(0.5*o.screen.height+o.screen.offsetTop-f)/o.radius,0),h=g.length();1<h?g.normalize():g.z=Math.sqrt(1-h*h);r.copy(o.object.position).subSelf(o.target);h=o.object.up.clone().setLength(g.y);h.addSelf(o.object.up.clone().crossSelf(r).setLength(g.x));h.addSelf(r.setLength(g.z));return h};this.rotateCamera=function(){var c=Math.acos(s.dot(t)/s.length()/t.length());if(c){var e=(new THREE.Vector3).cross(s,t).normalize(),f=new THREE.Quaternion,c=c*o.rotateSpeed;f.setFromAxisAngle(e,-c);f.multiplyVector3(r);f.multiplyVector3(o.object.up);f.multiplyVector3(t);o.staticMoving?s=t:(f.setFromAxisAngle(e,c*(o.dynamicDampingFactor-1)),f.multiplyVector3(s))}};this.zoomCamera=function(){var b=1+(w.y-u.y)*o.zoomSpeed;1!==b&&0<b&&(r.multiplyScalar(b),o.staticMoving?u=w:u.y+=(w.y-u.y)*this.dynamicDampingFactor)};this.panCamera=function(){var c=x.clone().subSelf(v);if(c.lengthSq()){c.multiplyScalar(r.length()*o.panSpeed);var d=r.clone().crossSelf(o.object.up).setLength(c.x);d.addSelf(o.object.up.clone().setLength(c.y));o.object.position.addSelf(d);o.target.addSelf(d);o.staticMoving?v=x:v.addSelf(c.sub(x,v).multiplyScalar(o.dynamicDampingFactor))}};this.checkDistances=function(){if(!o.noZoom||!o.noPan){o.object.position.lengthSq()>o.maxDistance*o.maxDistance&&o.object.position.setLength(o.maxDistance),r.lengthSq()<o.minDistance*o.minDistance&&o.object.position.add(o.target,r.setLength(o.minDistance))}};this.update=function(){r.copy(o.object.position).subSelf(this.target);o.noRotate||o.rotateCamera();o.noZoom||o.zoomCamera();o.noPan||o.panCamera();o.object.position.add(o.target,r);o.checkDistances();o.object.lookAt(o.target)};this.domElement.addEventListener("contextmenu",function(b){b.preventDefault()},!1);this.domElement.addEventListener("mousemove",function(b){o.enabled&&(p&&(s=t=o.getMouseProjectionOnBall(b.clientX,b.clientY),u=w=o.getMouseOnScreen(b.clientX,b.clientY),v=x=o.getMouseOnScreen(b.clientX,b.clientY),p=!1),-1!==q&&(0===q&&!o.noRotate?t=o.getMouseProjectionOnBall(b.clientX,b.clientY):1===q&&!o.noZoom?w=o.getMouseOnScreen(b.clientX,b.clientY):2===q&&!o.noPan&&(x=o.getMouseOnScreen(b.clientX,b.clientY))))},!1);this.domElement.addEventListener("mousedown",function(b){if(o.enabled&&(b.preventDefault(),b.stopPropagation(),-1===q)){q=b.button,0===q&&!o.noRotate?s=t=o.getMouseProjectionOnBall(b.clientX,b.clientY):1===q&&!o.noZoom?u=w=o.getMouseOnScreen(b.clientX,b.clientY):this.noPan||(v=x=o.getMouseOnScreen(b.clientX,b.clientY))}},!1);this.domElement.addEventListener("mouseup",function(b){o.enabled&&(b.preventDefault(),b.stopPropagation(),q=-1)},!1);window.addEventListener("keydown",function(b){o.enabled&&-1===q&&(b.keyCode===o.keys[0]&&!o.noRotate?q=0:b.keyCode===o.keys[1]&&!o.noZoom?q=1:b.keyCode===o.keys[2]&&!o.noPan&&(q=2),-1!==q&&(p=!0))},!1);window.addEventListener("keyup",function(){o.enabled&&-1!==q&&(q=-1)},!1)};THREE.CubeGeometry=function(j,v,w,x,y,z,A,B){function C(d,e,f,O,P,Q,T,V){var U,W=x||1,X=y||1,Y=P/2,Z=Q/2,aa=E.vertices.length;if("x"===d&&"y"===e||"y"===d&&"x"===e){U="z"}else{if("x"===d&&"z"===e||"z"===d&&"x"===e){U="y",X=z||1}else{if("z"===d&&"y"===e||"y"===d&&"z"===e){U="x",W=z||1}}}var R=W+1,ac=X+1,ae=P/W,l=Q/X,ab=new THREE.Vector3;ab[U]=0<T?1:-1;for(P=0;P<ac;P++){for(Q=0;Q<R;Q++){var ad=new THREE.Vector3;ad[d]=(Q*ae-Y)*f;ad[e]=(P*l-Z)*O;ad[U]=T;E.vertices.push(new THREE.Vertex(ad))}}for(P=0;P<X;P++){for(Q=0;Q<W;Q++){d=new THREE.Face4(Q+R*P+aa,Q+R*(P+1)+aa,Q+1+R*(P+1)+aa,Q+1+R*P+aa),d.normal.copy(ab),d.vertexNormals.push(ab.clone(),ab.clone(),ab.clone(),ab.clone()),d.materialIndex=V,E.faces.push(d),E.faceVertexUvs[0].push([new THREE.UV(Q/W,P/X),new THREE.UV(Q/W,(P+1)/X),new THREE.UV((Q+1)/W,(P+1)/X),new THREE.UV((Q+1)/W,P/X)])}}}THREE.Geometry.call(this);var E=this,D=j/2,G=v/2,J=w/2,H,I,F,K,L,M;if(void 0!==A){if(A instanceof Array){this.materials=A}else{this.materials=[];for(H=0;6>H;H++){this.materials.push(A)}}H=0;K=1;I=2;L=3;F=4;M=5}else{this.materials=[]}this.sides={px:!0,nx:!0,py:!0,ny:!0,pz:!0,nz:!0};if(void 0!=B){for(var N in B){void 0!==this.sides[N]&&(this.sides[N]=B[N])}}this.sides.px&&C("z","y",-1,-1,w,v,D,H);this.sides.nx&&C("z","y",1,-1,w,v,-D,K);this.sides.py&&C("x","z",1,1,j,w,G,I);this.sides.ny&&C("x","z",1,-1,j,w,-G,L);this.sides.pz&&C("x","y",1,-1,j,v,J,F);this.sides.nz&&C("x","y",-1,-1,j,v,-J,M);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=new THREE.Geometry;THREE.CubeGeometry.prototype.constructor=THREE.CubeGeometry;THREE.CylinderGeometry=function(j,w,y,z,A,B){THREE.Geometry.call(this);var j=void 0!==j?j:20,w=void 0!==w?w:20,y=void 0!==y?y:100,C=y/2,z=z||8,A=A||1,D,E,G=[],F=[];for(E=0;E<=A;E++){var I=[],L=[],J=E/A,K=J*(w-j)+j;for(D=0;D<=z;D++){var H=D/z,M=K*Math.sin(2*H*Math.PI),N=-J*y+C,O=K*Math.cos(2*H*Math.PI);this.vertices.push(new THREE.Vertex(new THREE.Vector3(M,N,O)));I.push(this.vertices.length-1);L.push(new THREE.UV(H,J))}G.push(I);F.push(L)}for(E=0;E<A;E++){for(D=0;D<z;D++){var y=G[E][D],I=G[E+1][D],L=G[E+1][D+1],J=G[E][D+1],K=this.vertices[y].position.clone().setY(0).normalize(),H=this.vertices[I].position.clone().setY(0).normalize(),M=this.vertices[L].position.clone().setY(0).normalize(),N=this.vertices[J].position.clone().setY(0).normalize(),O=F[E][D].clone(),P=F[E+1][D].clone(),Q=F[E+1][D+1].clone(),R=F[E][D+1].clone();this.faces.push(new THREE.Face4(y,I,L,J,[K,H,M,N]));this.faceVertexUvs[0].push([O,P,Q,R])}}if(!B&&0<j){this.vertices.push(new THREE.Vertex(new THREE.Vector3(0,C,0)));for(D=0;D<z;D++){y=G[0][D],I=G[0][D+1],L=this.vertices.length-1,K=new THREE.Vector3(0,1,0),H=new THREE.Vector3(0,1,0),M=new THREE.Vector3(0,1,0),O=F[0][D].clone(),P=F[0][D+1].clone(),Q=new THREE.UV(P.u,0),this.faces.push(new THREE.Face3(y,I,L,[K,H,M])),this.faceVertexUvs[0].push([O,P,Q])}}if(!B&&0<w){this.vertices.push(new THREE.Vertex(new THREE.Vector3(0,-C,0)));for(D=0;D<z;D++){y=G[E][D+1],I=G[E][D],L=this.vertices.length-1,K=new THREE.Vector3(0,-1,0),H=new THREE.Vector3(0,-1,0),M=new THREE.Vector3(0,-1,0),O=F[E][D+1].clone(),P=F[E][D].clone(),Q=new THREE.UV(P.u,1),this.faces.push(new THREE.Face3(y,I,L,[K,H,M])),this.faceVertexUvs[0].push([O,P,Q])}}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=new THREE.Geometry;THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;THREE.ExtrudeGeometry=function(f,g){if("undefined"!==typeof f){THREE.Geometry.call(this);var f=f instanceof Array?f:[f],h,i,j=f.length;this.shapebb=f[j-1].getBoundingBox();for(i=0;i<j;i++){h=f[i],this.addShape(h,g)}this.computeCentroids();this.computeFaceNormals()}};THREE.ExtrudeGeometry.prototype=new THREE.Geometry;THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;THREE.ExtrudeGeometry.prototype.addShape=function(z,J){function O(d,e,f){e||console.log("die");return e.clone().multiplyScalar(f).addSelf(d)}function U(i,k,l){var m=THREE.ExtrudeGeometry.__v1,n=THREE.ExtrudeGeometry.__v2,o=THREE.ExtrudeGeometry.__v3,p=THREE.ExtrudeGeometry.__v4,q=THREE.ExtrudeGeometry.__v5,r=THREE.ExtrudeGeometry.__v6;m.set(i.x-k.x,i.y-k.y);n.set(i.x-l.x,i.y-l.y);m=m.normalize();n=n.normalize();o.set(-m.y,m.x);p.set(n.y,-n.x);q.copy(i).addSelf(o);r.copy(i).addSelf(p);if(q.equals(r)){return p.clone()}q.copy(k).addSelf(o);r.copy(l).addSelf(p);o=m.dot(p);p=r.subSelf(q).dot(p);0===o&&(console.log("Either infinite or no solutions!"),0===p?console.log("Its finite solutions."):console.log("Too bad, no solutions."));p/=o;return 0>p?(k=Math.atan2(k.y-i.y,k.x-i.x),i=Math.atan2(l.y-i.y,l.x-i.x),k>i&&(i+=2*Math.PI),l=(k+i)/2,i=-Math.cos(l),l=-Math.sin(l),new THREE.Vector2(i,l)):m.multiplyScalar(p).addSelf(q).subSelf(i).clone()}function X(h){for(ag=h.length;0<=--ag;){aE=ag;Y=ag-1;0>Y&&(Y=h.length-1);for(var i=0,j=ap+2*ah,i=0;i<j;i++){var k=at*i,m=at*(i+1),o=aj+aE+k,p=aj+aE+m,q=o,k=aj+Y+k,m=aj+Y+m,r=p,q=q+ad,k=k+ad,m=m+ad,r=r+ad;F.faces.push(new THREE.Face4(q,k,m,r,null,null,aB));void 0!==aB&&(q=i/j,k=(i+1)/j,m=ac+2*ae,o=(F.vertices[o].position.z+ae)/m,p=(F.vertices[p].position.z+ae)/m,F.faceVertexUvs[0].push([new THREE.UV(o,q),new THREE.UV(p,q),new THREE.UV(p,k),new THREE.UV(o,k)]))}}}function Z(d,e,f){F.vertices.push(new THREE.Vertex(new THREE.Vector3(d,e,f)))}function aa(i,k,l){i+=ad;k+=ad;l+=ad;F.faces.push(new THREE.Face3(i,k,l,null,null,aA));if(void 0!==aA){var m=aD.minX,n=aD.minY,o=aD.maxY,p=aD.maxX,q=F.vertices[k].position.x-m,k=F.vertices[k].position.y-n,r=F.vertices[l].position.x-m,l=F.vertices[l].position.y-n;F.faceVertexUvs[0].push([new THREE.UV((F.vertices[i].position.x-m)/p,(F.vertices[i].position.y-n)/o),new THREE.UV(q/p,k/o),new THREE.UV(r/p,l/o)])}}var ac=void 0!==J.amount?J.amount:100,ae=void 0!==J.bevelThickness?J.bevelThickness:6,ak=void 0!==J.bevelSize?J.bevelSize:ae-2,ah=void 0!==J.bevelSegments?J.bevelSegments:3,an=void 0!==J.bevelEnabled?J.bevelEnabled:!0,ar=void 0!==J.curveSegments?J.curveSegments:12,ap=void 0!==J.steps?J.steps:1,aq=J.bendPath,am=J.extrudePath,au,aw=!1,ay=void 0!==J.useSpacedPoints?J.useSpacedPoints:!1,aA=J.material,aB=J.extrudeMaterial,aD=this.shapebb;if(am){au=am.getPoints(ar),ap=au.length,aw=!0,an=!1}an||(ak=ae=ah=0);var M,V,P,F=this,ad=this.vertices.length;aq&&z.addWrapPath(aq);ar=ay?z.extractAllSpacedPoints(ar):z.extractAllPoints(ar);aq=ar.shape;ar=ar.holes;if(am=!THREE.Shape.Utils.isClockWise(aq)){aq=aq.reverse();for(V=0,P=ar.length;V<P;V++){M=ar[V],THREE.Shape.Utils.isClockWise(M)&&(ar[V]=M.reverse())}am=!1}am=THREE.Shape.Utils.triangulateShape(aq,ar);ay=aq;for(V=0,P=ar.length;V<P;V++){M=ar[V],aq=aq.concat(M)}for(var af,ao,w,ai,at=aq.length,al=am.length,ab=[],ag=0,aC=ay.length,aE=aC-1,Y=ag+1;ag<aC;ag++,aE++,Y++){aE===aC&&(aE=0),Y===aC&&(Y=0),ab[ag]=U(ay[ag],ay[aE],ay[Y])}var ax=[],az,av=ab.concat();for(V=0,P=ar.length;V<P;V++){M=ar[V];az=[];for(ag=0,aC=M.length,aE=aC-1,Y=ag+1;ag<aC;ag++,aE++,Y++){aE===aC&&(aE=0),Y===aC&&(Y=0),az[ag]=U(M[ag],M[aE],M[Y])}ax.push(az);av=av.concat(az)}for(af=0;af<ah;af++){ao=af/ah;w=ae*(1-ao);ao=ak*Math.sin(ao*Math.PI/2);for(ag=0,aC=ay.length;ag<aC;ag++){ai=O(ay[ag],ab[ag],ao),Z(ai.x,ai.y,-w)}for(V=0,P=ar.length;V<P;V++){M=ar[V];az=ax[V];for(ag=0,aC=M.length;ag<aC;ag++){ai=O(M[ag],az[ag],ao),Z(ai.x,ai.y,-w)}}}ao=ak;for(ag=0;ag<at;ag++){ai=an?O(aq[ag],av[ag],ao):aq[ag],aw?Z(ai.x,ai.y+au[0].y,au[0].x):Z(ai.x,ai.y,0)}for(af=1;af<=ap;af++){for(ag=0;ag<at;ag++){ai=an?O(aq[ag],av[ag],ao):aq[ag],aw?Z(ai.x,ai.y+au[af-1].y,au[af-1].x):Z(ai.x,ai.y,ac/ap*af)}}for(af=ah-1;0<=af;af--){ao=af/ah;w=ae*(1-ao);ao=ak*Math.sin(ao*Math.PI/2);for(ag=0,aC=ay.length;ag<aC;ag++){ai=O(ay[ag],ab[ag],ao),Z(ai.x,ai.y,ac+w)}for(V=0,P=ar.length;V<P;V++){M=ar[V];az=ax[V];for(ag=0,aC=M.length;ag<aC;ag++){ai=O(M[ag],az[ag],ao),aw?Z(ai.x,ai.y+au[ap-1].y,au[ap-1].x+w):Z(ai.x,ai.y,ac+w)}}}if(an){an=0*at;for(ag=0;ag<al;ag++){ak=am[ag],aa(ak[2]+an,ak[1]+an,ak[0]+an)}an=at*(ap+2*ah);for(ag=0;ag<al;ag++){ak=am[ag],aa(ak[0]+an,ak[1]+an,ak[2]+an)}}else{for(ag=0;ag<al;ag++){ak=am[ag],aa(ak[2],ak[1],ak[0])}for(ag=0;ag<al;ag++){ak=am[ag],aa(ak[0]+at*ap,ak[1]+at*ap,ak[2]+at*ap)}}var aj=0;X(ay);aj+=ay.length;for(V=0,P=ar.length;V<P;V++){M=ar[V],X(M),aj+=M.length}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.IcosahedronGeometry=function(j){function m(e,f,g){var h=Math.sqrt(e*e+f*f+g*g);return q.vertices.push(new THREE.Vertex(new THREE.Vector3(e/h,f/h,g/h)))-1}function o(e,i,k,l){var n=q.vertices[e].position,y=q.vertices[i].position,z=q.vertices[k].position,e=new THREE.Face3(e,i,k);e.vertexNormals.push(n.clone().normalize(),y.clone().normalize(),z.clone().normalize());l.faces.push(e);l.faceVertexUvs[0].push([new THREE.UV(1-0.5*((Math.atan2(n.z,n.x)+Math.PI)%Math.PI/Math.PI),0.5-n.y/2),new THREE.UV(1-0.5*((Math.atan2(y.z,y.x)+Math.PI)%Math.PI/Math.PI),0.5-y.y/2),new THREE.UV(1-0.5*((Math.atan2(z.z,z.x)+Math.PI)%Math.PI/Math.PI),0.5-z.y/2)])}function p(b,e){var g=q.vertices[b].position,h=q.vertices[e].position;return m((g.x+h.x)/2,(g.y+h.y)/2,(g.z+h.z)/2)}var q=this,r=new THREE.Geometry;this.subdivisions=j||0;THREE.Geometry.call(this);j=(1+Math.sqrt(5))/2;m(-1,j,0);m(1,j,0);m(-1,-j,0);m(1,-j,0);m(0,-1,j);m(0,1,j);m(0,-1,-j);m(0,1,-j);m(j,0,-1);m(j,0,1);m(-j,0,-1);m(-j,0,1);o(0,11,5,r);o(0,5,1,r);o(0,1,7,r);o(0,7,10,r);o(0,10,11,r);o(1,5,9,r);o(5,11,4,r);o(11,10,2,r);o(10,7,6,r);o(7,1,8,r);o(3,9,4,r);o(3,4,2,r);o(3,2,6,r);o(3,6,8,r);o(3,8,9,r);o(4,9,5,r);o(2,4,11,r);o(6,2,10,r);o(8,6,7,r);o(9,8,1,r);for(var s=0;s<this.subdivisions;s++){for(var j=new THREE.Geometry,s=0,t=r.faces.length;s<t;s++){var u=r.faces[s],w=p(u.a,u.b),v=p(u.b,u.c),x=p(u.c,u.a);o(u.a,w,x,j);o(u.b,v,w,j);o(u.c,x,v,j);o(w,v,x,j)}r.faces=j.faces;r.faceVertexUvs[0]=j.faceVertexUvs[0]}q.faces=r.faces;q.faceVertexUvs[0]=r.faceVertexUvs[0];this.mergeVertices();this.computeCentroids();this.computeFaceNormals()};THREE.IcosahedronGeometry.prototype=new THREE.Geometry;THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.LatheGeometry=function(j,k,l){THREE.Geometry.call(this);this.steps=k||12;this.angle=l||2*Math.PI;for(var k=this.angle/this.steps,l=[],m=[],n=[],o=[],p=(new THREE.Matrix4).setRotationZ(k),q=0;q<j.length;q++){this.vertices.push(new THREE.Vertex(j[q])),l[q]=j[q].clone(),m[q]=this.vertices.length-1}for(var r=0;r<=this.angle+0.001;r+=k){for(q=0;q<l.length;q++){r<this.angle?(l[q]=p.multiplyVector3(l[q].clone()),this.vertices.push(new THREE.Vertex(l[q])),n[q]=this.vertices.length-1):n=o}0==r&&(o=m);for(q=0;q<m.length-1;q++){this.faces.push(new THREE.Face4(n[q],n[q+1],m[q+1],m[q])),this.faceVertexUvs[0].push([new THREE.UV(1-r/this.angle,q/j.length),new THREE.UV(1-r/this.angle,(q+1)/j.length),new THREE.UV(1-(r-k)/this.angle,(q+1)/j.length),new THREE.UV(1-(r-k)/this.angle,q/j.length)])}m=n;n=[]}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=new THREE.Geometry;THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;THREE.OctahedronGeometry=function(j,k){function l(a){var e=a.clone().normalize(),e=new THREE.Vertex(e.clone().multiplyScalar(j));e.index=p.vertices.push(e)-1;var f=Math.atan2(a.z,-a.x)/2/Math.PI+0.5,a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+0.5;e.uv=new THREE.UV(f,a);return e}function m(d,e,f,g){1>g?(g=new THREE.Face3(d.index,e.index,f.index,[d.position,e.position,f.position]),g.centroid.addSelf(d.position).addSelf(e.position).addSelf(f.position).divideScalar(3),g.normal=g.centroid.clone().normalize(),p.faces.push(g),g=Math.atan2(g.centroid.z,-g.centroid.x),p.faceVertexUvs[0].push([o(d.uv,d.position,g),o(e.uv,e.position,g),o(f.uv,f.position,g)])):(g-=1,m(d,n(d,e),n(d,f),g),m(n(d,e),e,n(e,f),g),m(n(d,f),n(e,f),f,g),m(n(d,e),n(e,f),n(d,f),g))}function n(c,e){q[c.index]||(q[c.index]=[]);q[e.index]||(q[e.index]=[]);var f=q[c.index][e.index];void 0===f&&(q[c.index][e.index]=q[e.index][c.index]=f=l((new THREE.Vector3).add(c.position,e.position).divideScalar(2)));return f}function o(d,e,f){0>f&&1===d.u&&(d=new THREE.UV(d.u-1,d.v));0===e.x&&0===e.z&&(d=new THREE.UV(f/2/Math.PI+0.5,d.v));return d}THREE.Geometry.call(this);var k=k||0,p=this;l(new THREE.Vector3(1,0,0));l(new THREE.Vector3(-1,0,0));l(new THREE.Vector3(0,1,0));l(new THREE.Vector3(0,-1,0));l(new THREE.Vector3(0,0,1));l(new THREE.Vector3(0,0,-1));var q=[],r=this.vertices;m(r[0],r[2],r[4],k);m(r[0],r[4],r[3],k);m(r[0],r[3],r[5],k);m(r[0],r[5],r[2],k);m(r[1],r[2],r[5],k);m(r[1],r[5],r[3],k);m(r[1],r[3],r[4],k);m(r[1],r[4],r[2],k);this.boundingSphere={radius:j}};THREE.OctahedronGeometry.prototype=new THREE.Geometry;THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;THREE.PlaneGeometry=function(j,m,n,o){THREE.Geometry.call(this);for(var p=j/2,q=m/2,n=n||1,o=o||1,r=n+1,s=o+1,t=j/n,v=m/o,u=new THREE.Vector3(0,0,1),j=0;j<s;j++){for(m=0;m<r;m++){this.vertices.push(new THREE.Vertex(new THREE.Vector3(m*t-p,-(j*v-q),0)))}}for(j=0;j<o;j++){for(m=0;m<n;m++){p=new THREE.Face4(m+r*j,m+r*(j+1),m+1+r*(j+1),m+1+r*j),p.normal.copy(u),p.vertexNormals.push(u.clone(),u.clone(),u.clone(),u.clone()),this.faces.push(p),this.faceVertexUvs[0].push([new THREE.UV(m/n,j/o),new THREE.UV(m/n,(j+1)/o),new THREE.UV((m+1)/n,(j+1)/o),new THREE.UV((m+1)/n,j/o)])}}this.computeCentroids()};THREE.PlaneGeometry.prototype=new THREE.Geometry;THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;THREE.SphereGeometry=function(j,u,v,w,x,y,z){THREE.Geometry.call(this);var j=j||50,w=void 0!==w?w:0,x=void 0!==x?x:2*Math.PI,y=void 0!==y?y:0,z=void 0!==z?z:Math.PI,u=Math.max(3,Math.floor(u)||8),v=Math.max(2,Math.floor(v)||6),A,B,D=[],C=[];for(B=0;B<=v;B++){var F=[],I=[];for(A=0;A<=u;A++){var G=A/u,H=B/v,E=-j*Math.cos(w+G*x)*Math.sin(y+H*z),J=j*Math.cos(y+H*z),K=j*Math.sin(w+G*x)*Math.sin(y+H*z);this.vertices.push(new THREE.Vertex(new THREE.Vector3(E,J,K)));F.push(this.vertices.length-1);I.push(new THREE.UV(G,H))}D.push(F);C.push(I)}for(B=0;B<v;B++){for(A=0;A<u;A++){var w=D[B][A+1],x=D[B][A],y=D[B+1][A],z=D[B+1][A+1],F=this.vertices[w].position.clone().normalize(),I=this.vertices[x].position.clone().normalize(),G=this.vertices[y].position.clone().normalize(),H=this.vertices[z].position.clone().normalize(),E=C[B][A+1].clone(),J=C[B][A].clone(),K=C[B+1][A].clone(),L=C[B+1][A+1].clone();Math.abs(this.vertices[w].position.y)==j?(this.faces.push(new THREE.Face3(w,y,z,[F,G,H])),this.faceVertexUvs[0].push([E,K,L])):Math.abs(this.vertices[y].position.y)==j?(this.faces.push(new THREE.Face3(w,x,y,[F,I,G])),this.faceVertexUvs[0].push([E,J,K])):(this.faces.push(new THREE.Face4(w,x,y,z,[F,I,G,H])),this.faceVertexUvs[0].push([E,J,K,L]))}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere={radius:j}};THREE.SphereGeometry.prototype=new THREE.Geometry;THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;THREE.TextGeometry=function(e,f){var g=(new THREE.TextPath(e,f)).toShapes();f.amount=void 0!==f.height?f.height:50;if(void 0===f.bevelThickness){f.bevelThickness=10}if(void 0===f.bevelSize){f.bevelSize=8}if(void 0===f.bevelEnabled){f.bevelEnabled=!1}if(f.bend){var h=g[g.length-1].getBoundingBox().maxX;f.bendPath=new THREE.QuadraticBezierCurve(new THREE.Vector2(0,0),new THREE.Vector2(h/2,120),new THREE.Vector2(h,0))}THREE.ExtrudeGeometry.call(this,g,f)};THREE.TextGeometry.prototype=new THREE.ExtrudeGeometry;THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(c){var d=c.familyName.toLowerCase();this.faces[d]=this.faces[d]||{};this.faces[d][c.cssFontWeight]=this.faces[d][c.cssFontWeight]||{};this.faces[d][c.cssFontWeight][c.cssFontStyle]=c;return this.faces[d][c.cssFontWeight][c.cssFontStyle]=c},drawText:function(i){for(var j=this.getFace(),k=this.size/j.resolution,l=0,m=(""+i).split(""),n=m.length,o=[],i=0;i<n;i++){var p=new THREE.Path,p=this.extractGlyphPoints(m[i],j,k,l,p),l=l+p.offset;o.push(p.path)}return{paths:o,offset:l/2}},extractGlyphPoints:function(j,v,w,x,y){var z=[],A,B,C,E,D,G,J,H,I,F,K,L=v.glyphs[j]||v.glyphs["?"];if(L){if(L.o){v=L._cachedOutline||(L._cachedOutline=L.o.split(" "));E=v.length;for(j=0;j<E;){switch(C=v[j++],C){case"m":C=v[j++]*w+x;D=v[j++]*w;z.push(new THREE.Vector2(C,D));y.moveTo(C,D);break;case"l":C=v[j++]*w+x;D=v[j++]*w;z.push(new THREE.Vector2(C,D));y.lineTo(C,D);break;case"q":C=v[j++]*w+x;D=v[j++]*w;H=v[j++]*w+x;I=v[j++]*w;y.quadraticCurveTo(H,I,C,D);if(A=z[z.length-1]){G=A.x;J=A.y;for(A=1,B=this.divisions;A<=B;A++){var M=A/B,N=THREE.Shape.Utils.b2(M,G,H,C),M=THREE.Shape.Utils.b2(M,J,I,D);z.push(new THREE.Vector2(N,M))}}break;case"b":if(C=v[j++]*w+x,D=v[j++]*w,H=v[j++]*w+x,I=v[j++]*-w,F=v[j++]*w+x,K=v[j++]*-w,y.bezierCurveTo(C,D,H,I,F,K),A=z[z.length-1]){G=A.x;J=A.y;for(A=1,B=this.divisions;A<=B;A++){M=A/B,N=THREE.Shape.Utils.b3(M,G,H,F,C),M=THREE.Shape.Utils.b3(M,J,I,K,D),z.push(new THREE.Vector2(N,M))}}}}}return{offset:L.ha*w,points:z,path:y}}}};(function(c){var d=function(h){for(var i=h.length,j=0,k=i-1,l=0;l<i;k=l++){j+=h[k].x*h[l].y-h[l].x*h[k].y}return 0.5*j};c.Triangulate=function(w,M){var P=w.length;if(3>P){return null}var T=[],U=[],X=[],Z,ae,ac;if(0<d(w)){for(ae=0;ae<P;ae++){U[ae]=ae}}else{for(ae=0;ae<P;ae++){U[ae]=P-1-ae}}var ah=2*P;for(ae=P-1;2<P;){if(0>=ah--){console.log("Warning, unable to triangulate polygon!");break}Z=ae;P<=Z&&(Z=0);ae=Z+1;P<=ae&&(ae=0);ac=ae+1;P<=ac&&(ac=0);var al;w:{al=w;var aj=Z,ak=ae,ag=ac,an=P,ao=U,aq=void 0,ar=void 0,at=void 0,av=void 0,F=void 0,O=void 0,J=void 0,z=void 0,Y=void 0,ar=al[ao[aj]].x,at=al[ao[aj]].y,av=al[ao[ak]].x,F=al[ao[ak]].y,O=al[ao[ag]].x,J=al[ao[ag]].y;if(1e-10>(av-ar)*(J-at)-(F-at)*(O-ar)){al=!1}else{for(aq=0;aq<an;aq++){if(!(aq==aj||aq==ak||aq==ag)){var z=al[ao[aq]].x,Y=al[ao[aq]].y,aa=void 0,ai=void 0,b=void 0,ad=void 0,am=void 0,af=void 0,V=void 0,ab=void 0,au=void 0,aw=void 0,R=void 0,ap=void 0,aa=b=am=void 0,aa=O-av,ai=J-F,b=ar-O,ad=at-J,am=av-ar,af=F-at,V=z-ar,ab=Y-at,au=z-av,aw=Y-F,R=z-O,ap=Y-J,aa=aa*aw-ai*au,am=am*ab-af*V,b=b*ap-ad*R;if(0<=aa&&0<=b&&0<=am){al=!1;break w}}}al=!0}}if(al){T.push([w[U[Z]],w[U[ae]],w[U[ac]]]);X.push([U[Z],U[ae],U[ac]]);for(Z=ae,ac=ae+1;ac<P;Z++,ac++){U[Z]=U[ac]}P--;ah=2*P}}return M?X:T};c.Triangulate.area=d;return c})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.TorusGeometry=function(j,k,l,m,n){THREE.Geometry.call(this);this.radius=j||100;this.tube=k||40;this.segmentsR=l||8;this.segmentsT=m||6;this.arc=n||2*Math.PI;n=new THREE.Vector3;j=[];k=[];for(l=0;l<=this.segmentsR;l++){for(m=0;m<=this.segmentsT;m++){var o=m/this.segmentsT*this.arc,p=2*l/this.segmentsR*Math.PI;n.x=this.radius*Math.cos(o);n.y=this.radius*Math.sin(o);var q=new THREE.Vector3;q.x=(this.radius+this.tube*Math.cos(p))*Math.cos(o);q.y=(this.radius+this.tube*Math.cos(p))*Math.sin(o);q.z=this.tube*Math.sin(p);this.vertices.push(new THREE.Vertex(q));j.push(new THREE.UV(m/this.segmentsT,1-l/this.segmentsR));k.push(q.clone().subSelf(n).normalize())}}for(l=1;l<=this.segmentsR;l++){for(m=1;m<=this.segmentsT;m++){var n=(this.segmentsT+1)*l+m-1,o=(this.segmentsT+1)*(l-1)+m-1,p=(this.segmentsT+1)*(l-1)+m,q=(this.segmentsT+1)*l+m,r=new THREE.Face4(n,o,p,q,[k[n],k[o],k[p],k[q]]);r.normal.addSelf(k[n]);r.normal.addSelf(k[o]);r.normal.addSelf(k[p]);r.normal.addSelf(k[q]);r.normal.normalize();this.faces.push(r);this.faceVertexUvs[0].push([j[n].clone(),j[o].clone(),j[p].clone(),j[q].clone()])}}this.computeCentroids()};THREE.TorusGeometry.prototype=new THREE.Geometry;THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;THREE.TorusKnotGeometry=function(j,m,n,o,p,q,r){function s(h,i,k,l,w,x){var y=Math.cos(h);Math.cos(i);i=Math.sin(h);h*=k/l;k=Math.cos(h);y*=0.5*w*(2+k);i=0.5*w*(2+k)*i;w=0.5*x*w*Math.sin(h);return new THREE.Vector3(y,i,w)}THREE.Geometry.call(this);this.radius=j||200;this.tube=m||40;this.segmentsR=n||64;this.segmentsT=o||8;this.p=p||2;this.q=q||3;this.heightScale=r||1;this.grid=Array(this.segmentsR);n=new THREE.Vector3;o=new THREE.Vector3;p=new THREE.Vector3;for(j=0;j<this.segmentsR;++j){this.grid[j]=Array(this.segmentsT);for(m=0;m<this.segmentsT;++m){var t=2*(j/this.segmentsR)*this.p*Math.PI,r=2*(m/this.segmentsT)*Math.PI,q=s(t,r,this.q,this.p,this.radius,this.heightScale),t=s(t+0.01,r,this.q,this.p,this.radius,this.heightScale);n.sub(t,q);o.add(t,q);p.cross(n,o);o.cross(p,n);p.normalize();o.normalize();t=-this.tube*Math.cos(r);r=this.tube*Math.sin(r);q.x+=t*o.x+r*p.x;q.y+=t*o.y+r*p.y;q.z+=t*o.z+r*p.z;this.grid[j][m]=this.vertices.push(new THREE.Vertex(new THREE.Vector3(q.x,q.y,q.z)))-1}}for(j=0;j<this.segmentsR;++j){for(m=0;m<this.segmentsT;++m){var p=(j+1)%this.segmentsR,q=(m+1)%this.segmentsT,n=this.grid[j][m],o=this.grid[p][m],p=this.grid[p][q],q=this.grid[j][q],r=new THREE.UV(j/this.segmentsR,m/this.segmentsT),t=new THREE.UV((j+1)/this.segmentsR,m/this.segmentsT),v=new THREE.UV((j+1)/this.segmentsR,(m+1)/this.segmentsT),u=new THREE.UV(j/this.segmentsR,(m+1)/this.segmentsT);this.faces.push(new THREE.Face4(n,o,p,q));this.faceVertexUvs[0].push([r,t,v,u])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=new THREE.Geometry;THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;THREE.AxisHelper=function(){THREE.Object3D.call(this);var d=new THREE.Geometry;d.vertices.push(new THREE.Vertex);d.vertices.push(new THREE.Vertex(new THREE.Vector3(0,100,0)));var e=new THREE.CylinderGeometry(0,5,25,5,1),f;f=new THREE.Line(d,new THREE.LineBasicMaterial({color:16711680}));f.rotation.z=-Math.PI/2;this.add(f);f=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:16711680}));f.position.x=100;f.rotation.z=-Math.PI/2;this.add(f);f=new THREE.Line(d,new THREE.LineBasicMaterial({color:65280}));this.add(f);f=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:65280}));f.position.y=100;this.add(f);f=new THREE.Line(d,new THREE.LineBasicMaterial({color:255}));f.rotation.x=Math.PI/2;this.add(f);f=new THREE.Mesh(e,new THREE.MeshBasicMaterial({color:255}));f.position.z=100;f.rotation.x=Math.PI/2;this.add(f)};THREE.AxisHelper.prototype=new THREE.Object3D;THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;THREE.CameraHelper=function(e){function f(c,i,j){g(c,j);g(i,j)}function g(c,d){h.lineGeometry.vertices.push(new THREE.Vertex(new THREE.Vector3));h.lineGeometry.colors.push(new THREE.Color(d));void 0===h.pointMap[c]&&(h.pointMap[c]=[]);h.pointMap[c].push(h.lineGeometry.vertices.length-1)}THREE.Object3D.call(this);var h=this;this.lineGeometry=new THREE.Geometry;this.lineMaterial=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});this.pointMap={};f("n1","n2",16755200);f("n2","n4",16755200);f("n4","n3",16755200);f("n3","n1",16755200);f("f1","f2",16755200);f("f2","f4",16755200);f("f4","f3",16755200);f("f3","f1",16755200);f("n1","f1",16755200);f("n2","f2",16755200);f("n3","f3",16755200);f("n4","f4",16755200);f("p","n1",16711680);f("p","n2",16711680);f("p","n3",16711680);f("p","n4",16711680);f("u1","u2",43775);f("u2","u3",43775);f("u3","u1",43775);f("c","t",16777215);f("p","c",3355443);f("cn1","cn2",3355443);f("cn3","cn4",3355443);f("cf1","cf2",3355443);f("cf3","cf4",3355443);this.update(e);this.lines=new THREE.Line(this.lineGeometry,this.lineMaterial,THREE.LinePieces);this.add(this.lines)};THREE.CameraHelper.prototype=new THREE.Object3D;THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;THREE.CameraHelper.prototype.update=function(d){function e(c,h,i,j){THREE.CameraHelper.__v.set(h,i,j);THREE.CameraHelper.__projector.unprojectVector(THREE.CameraHelper.__v,THREE.CameraHelper.__c);c=f.pointMap[c];if(void 0!==c){h=0;for(i=c.length;h<i;h++){f.lineGeometry.vertices[c[h]].position.copy(THREE.CameraHelper.__v)}}}var f=this;THREE.CameraHelper.__c.projectionMatrix.copy(d.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",0.7,1.1,-1);e("u2",-0.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);this.lineGeometry.__dirtyVertices=!0};THREE.CameraHelper.__projector=new THREE.Projector;THREE.CameraHelper.__v=new THREE.Vector3;THREE.CameraHelper.__c=new THREE.Camera;THREE.SubdivisionModifier=function(b){this.subdivisions=void 0===b?1:b;this.useOldVertexColors=!1;this.supportUVs=!0};THREE.SubdivisionModifier.prototype.constructor=THREE.SubdivisionModifier;THREE.SubdivisionModifier.prototype.modify=function(c){for(var d=this.subdivisions;0<d--;){this.smooth(c)}};THREE.SubdivisionModifier.prototype.smooth=function(w){function z(e,f,g,q,r,s){var u=new THREE.Face4(e,f,g,q,null,r.color,r.material);if(P.useOldVertexColors){u.vertexColors=[];for(var t,v,x,A=0;4>A;A++){x=s[A];t=new THREE.Color;t.setRGB(0,0,0);for(var B=0;B<x.length;B++){v=r.vertexColors[x[B]-1],t.r+=v.r,t.g+=v.g,t.b+=v.b}t.r/=x.length;t.g/=x.length;t.b/=x.length;u.vertexColors[A]=t}}M.push(u);(!P.supportUVs||0!=ad.length)&&O.push([ad[e],ad[f],ad[g],ad[q]])}function F(c,d){return Math.min(c,d)+"_"+Math.max(c,d)}var J=[],M=[],O=[],P=this,R=w.vertices,J=w.faces,T=R.concat(),X=[],V={},Z={},ad=[],ab,ac,Y,af,ag,ah=w.faceVertexUvs[0];for(ab=0,ac=ah.length;ab<ac;ab++){for(Y=0,af=ah[ab].length;Y<af;Y++){ag=J[ab]["abcd".charAt(Y)],ad[ag]||(ad[ag]=ah[ab][Y])}}var ai;for(ab=0,ac=J.length;ab<ac;ab++){if(ag=J[ab],X.push(ag.centroid),T.push(new THREE.Vertex(ag.centroid)),P.supportUVs&&0!=ad.length){ai=new THREE.UV;if(ag instanceof THREE.Face3){ai.u=ad[ag.a].u+ad[ag.b].u+ad[ag.c].u,ai.v=ad[ag.a].v+ad[ag.b].v+ad[ag.c].v,ai.u/=3,ai.v/=3}else{if(ag instanceof THREE.Face4){ai.u=ad[ag.a].u+ad[ag.b].u+ad[ag.c].u+ad[ag.d].u,ai.v=ad[ag.a].v+ad[ag.b].v+ad[ag.c].v+ad[ag.d].v,ai.u/=4,ai.v/=4}}ad.push(ai)}}ac=function(c){function i(b,e,f){void 0===b[e]&&(b[e]=[]);b[e].push(f)}var k,l,m,n,o={};for(k=0,l=c.faces.length;k<l;k++){m=c.faces[k],m instanceof THREE.Face3?(n=F(m.a,m.b),i(o,n,k),n=F(m.b,m.c),i(o,n,k),n=F(m.c,m.a),i(o,n,k)):m instanceof THREE.Face4&&(n=F(m.a,m.b),i(o,n,k),n=F(m.b,m.c),i(o,n,k),n=F(m.c,m.d),i(o,n,k),n=F(m.d,m.a),i(o,n,k))}return o}(w);var aj=0,ah=R.length,ak,E,L={},G={},y=function(c,d){void 0===L[c]&&(L[c]=[]);L[c].push(d)},S=function(c,d){void 0===G[c]&&(G[c]={});G[c][d]=null};for(ab in ac){ai=ac[ab];ak=ab.split("_");E=ak[0];ak=ak[1];y(E,[E,ak]);y(ak,[E,ak]);for(Y=0,af=ai.length;Y<af;Y++){ag=ai[Y],S(E,ag,ab),S(ak,ag,ab)}2>ai.length&&(Z[ab]=!0)}for(ab in ac){if(ai=ac[ab],ag=ai[0],ai=ai[1],ak=ab.split("_"),E=ak[0],ak=ak[1],af=new THREE.Vector3,Z[ab]?(af.addSelf(R[E].position),af.addSelf(R[ak].position),af.multiplyScalar(0.5)):(af.addSelf(X[ag]),af.addSelf(X[ai]),af.addSelf(R[E].position),af.addSelf(R[ak].position),af.multiplyScalar(0.25)),V[ab]=ah+J.length+aj,T.push(new THREE.Vertex(af)),aj++,P.supportUVs&&0!=ad.length){ai=new THREE.UV,ai.u=ad[E].u+ad[ak].u,ai.v=ad[E].v+ad[ak].v,ai.u/=2,ai.v/=2,ad.push(ai)}}var U,aa;ak=["123","12","2","23"];af=["123","23","3","31"];var y=["123","31","1","12"],S=["1234","12","2","23"],j=["1234","23","3","34"],W=["1234","34","4","41"],ae=["1234","41","1","12"];for(ab=0,ac=X.length;ab<ac;ab++){ag=J[ab],ai=ah+ab,ag instanceof THREE.Face3?(aj=F(ag.a,ag.b),E=F(ag.b,ag.c),U=F(ag.c,ag.a),z(ai,V[aj],ag.b,V[E],ag,ak),z(ai,V[E],ag.c,V[U],ag,af),z(ai,V[U],ag.a,V[aj],ag,y)):ag instanceof THREE.Face4?(aj=F(ag.a,ag.b),E=F(ag.b,ag.c),U=F(ag.c,ag.d),aa=F(ag.d,ag.a),z(ai,V[aj],ag.b,V[E],ag,S),z(ai,V[E],ag.c,V[U],ag,j),z(ai,V[U],ag.d,V[aa],ag,W),z(ai,V[aa],ag.a,V[aj],ag,ae)):console.log("face should be a face!",ag)}J=T;T=new THREE.Vector3;V=new THREE.Vector3;for(ab=0,ac=R.length;ab<ac;ab++){if(void 0!==L[ab]){T.set(0,0,0);V.set(0,0,0);ag=new THREE.Vector3(0,0,0);ai=0;for(Y in G[ab]){T.addSelf(X[Y]),ai++}aj=0;ah=L[ab].length;for(Y=0;Y<ah;Y++){Z[F(L[ab][Y][0],L[ab][Y][1])]&&aj++}if(2!=aj){T.divideScalar(ai);for(Y=0;Y<ah;Y++){ai=L[ab][Y],ai=R[ai[0]].position.clone().addSelf(R[ai[1]].position).divideScalar(2),V.addSelf(ai)}V.divideScalar(ah);ag.addSelf(R[ab].position);ag.multiplyScalar(ah-3);ag.addSelf(T);ag.addSelf(V.multiplyScalar(2));ag.divideScalar(ah);J[ab].position=ag}}}w.vertices=J;w.faces=M;w.faceVertexUvs[0]=O;delete w.__tmpVertices;w.computeCentroids();w.computeFaceNormals();w.computeVertexNormals()};THREE.Loader=function(b){this.statusDomElement=(this.showStatus=b)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"",addStatusElement:function(){var b=document.createElement("div");b.style.position="absolute";b.style.right="0px";b.style.top="0px";b.style.fontSize="0.8em";b.style.textAlign="left";b.style.background="rgba(0,0,0,0.25)";b.style.color="#fff";b.style.width="120px";b.style.padding="0.5em 0.5em 0.5em 0.5em";b.style.zIndex=1000;b.innerHTML="Loading ...";return b},updateProgress:function(c){var d="Loaded ",d=c.total?d+((100*c.loaded/c.total).toFixed(0)+"%"):d+((c.loaded/1000).toFixed(2)+" KB");this.statusDomElement.innerHTML=d},extractUrlbase:function(b){b=b.split("/");b.pop();return 1>b.length?"":b.join("/")+"/"},initMaterials:function(e,f,g){e.materials=[];for(var h=0;h<f.length;++h){e.materials[h]=THREE.Loader.prototype.createMaterial(f[h],g)}},hasNormals:function(e){var f,g,h=e.materials.length;for(g=0;g<h;g++){if(f=e.materials[g],f instanceof THREE.ShaderMaterial){return !0}}return !1},createMaterial:function(j,m){function n(b){b=Math.log(b)/Math.LN2;return Math.floor(b)==b}function o(b){b=Math.log(b)/Math.LN2;return Math.pow(2,Math.round(b))}function p(c,d){var f=new Image;f.onload=function(){if(!n(this.width)||!n(this.height)){var a=o(this.width),g=o(this.height);c.image.width=a;c.image.height=g;c.image.getContext("2d").drawImage(this,0,0,a,g)}else{c.image=this}c.needsUpdate=!0};f.crossOrigin=s.crossOrigin;f.src=d}function q(b,e,k,l,w,x){var y=document.createElement("canvas");b[e]=new THREE.Texture(y);b[e].sourceFile=k;if(l){b[e].repeat.set(l[0],l[1]);if(1!=l[0]){b[e].wrapS=THREE.RepeatWrapping}if(1!=l[1]){b[e].wrapT=THREE.RepeatWrapping}}w&&b[e].offset.set(w[0],w[1]);if(x){l={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(void 0!==l[x[0]]){b[e].wrapS=l[x[0]]}if(void 0!==l[x[1]]){b[e].wrapT=l[x[1]]}}p(b[e],m+"/"+k)}function r(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]}var s=this,t="MeshLambertMaterial",v={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,wireframe:j.wireframe};j.shading&&("Phong"==j.shading?t="MeshPhongMaterial":"Basic"==j.shading&&(t="MeshBasicMaterial"));if(j.blending){if("Additive"==j.blending){v.blending=THREE.AdditiveBlending}else{if("Subtractive"==j.blending){v.blending=THREE.SubtractiveBlending}else{if("Multiply"==j.blending){v.blending=THREE.MultiplyBlending}}}}if(void 0!==j.transparent||1>j.opacity){v.transparent=j.transparent}if(void 0!==j.depthTest){v.depthTest=j.depthTest}if(void 0!==j.vertexColors){if("face"==j.vertexColors){v.vertexColors=THREE.FaceColors}else{if(j.vertexColors){v.vertexColors=THREE.VertexColors}}}if(j.colorDiffuse){v.color=r(j.colorDiffuse)}else{if(j.DbgColor){v.color=j.DbgColor}}if(j.colorSpecular){v.specular=r(j.colorSpecular)}if(j.colorAmbient){v.ambient=r(j.colorAmbient)}if(j.transparency){v.opacity=j.transparency}if(j.specularCoef){v.shininess=j.specularCoef}j.mapDiffuse&&m&&q(v,"map",j.mapDiffuse,j.mapDiffuseRepeat,j.mapDiffuseOffset,j.mapDiffuseWrap);j.mapLight&&m&&q(v,"lightMap",j.mapLight,j.mapLightRepeat,j.mapLightOffset,j.mapLightWrap);j.mapNormal&&m&&q(v,"normalMap",j.mapNormal,j.mapNormalRepeat,j.mapNormalOffset,j.mapNormalWrap);j.mapSpecular&&m&&q(v,"specularMap",j.mapSpecular,j.mapSpecularRepeat,j.mapSpecularOffset,j.mapSpecularWrap);if(j.mapNormal){var t=THREE.ShaderUtils.lib.normal,u=THREE.UniformsUtils.clone(t.uniforms);u.tNormal.texture=v.normalMap;if(j.mapNormalFactor){u.uNormalScale.value=j.mapNormalFactor}if(v.map){u.tDiffuse.texture=v.map,u.enableDiffuse.value=!0}if(v.specularMap){u.tSpecular.texture=v.specularMap,u.enableSpecular.value=!0}if(v.lightMap){u.tAO.texture=v.lightMap,u.enableAO.value=!0}u.uDiffuseColor.value.setHex(v.color);u.uSpecularColor.value.setHex(v.specular);u.uAmbientColor.value.setHex(v.ambient);u.uShininess.value=v.shininess;if(void 0!==v.opacity){u.uOpacity.value=v.opacity}v=new THREE.ShaderMaterial({fragmentShader:t.fragmentShader,vertexShader:t.vertexShader,uniforms:u,lights:!0,fog:!0})}else{v=new THREE[t](v)}if(void 0!==j.DbgName){v.name=j.DbgName}return v}};THREE.BinaryLoader=function(b){THREE.Loader.call(this,b)};THREE.BinaryLoader.prototype=new THREE.Loader;THREE.BinaryLoader.prototype.constructor=THREE.BinaryLoader;THREE.BinaryLoader.prototype.supr=THREE.Loader.prototype;THREE.BinaryLoader.prototype.load=function(f,g,h,i){if(f instanceof Object){console.warn("DEPRECATED: BinaryLoader( parameters ) is now BinaryLoader( url, callback, texturePath, binaryPath )."),i=f,f=i.model,g=i.callback,h=i.texture_path,i=i.bin_path}var h=h?h:this.extractUrlbase(f),i=i?i:this.extractUrlbase(f),j=this.showProgress?THREE.Loader.prototype.updateProgress:null;this.onLoadStart();this.loadAjaxJSON(this,f,g,h,i,j)};THREE.BinaryLoader.prototype.loadAjaxJSON=function(h,i,j,k,l,m){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState){if(200==n.status||0==n.status){try{var a=JSON.parse(n.responseText);void 0===a.metadata||void 0===a.metadata.formatVersion||3!==a.metadata.formatVersion?console.error("Deprecated file format."):h.loadAjaxBuffers(a,j,l,k,m)}catch(b){console.error(b),console.warn("DEPRECATED: ["+i+"] seems to be using old model format")}}else{console.error("Couldn't load ["+i+"] ["+n.status+"]")}}};n.open("GET",i,!0);n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined");n.setRequestHeader("Content-Type","text/plain");n.send(null)};THREE.BinaryLoader.prototype.loadAjaxBuffers=function(i,j,k,l,m){var n=new XMLHttpRequest,o=k+"/"+i.buffers,p=0;n.onreadystatechange=function(){4==n.readyState?200==n.status||0==n.status?THREE.BinaryLoader.prototype.createBinModel(n.response,j,l,i.materials):console.error("Couldn't load ["+o+"] ["+n.status+"]"):3==n.readyState?m&&(0==p&&(p=n.getResponseHeader("Content-Length")),m({total:p,loaded:n.responseText.length})):2==n.readyState&&(p=n.getResponseHeader("Content-Length"))};n.open("GET",o,!0);n.responseType="arraybuffer";n.send(null)};THREE.BinaryLoader.prototype.createBinModel=function(f,g,h,i){var j=function(w){var E,M,R,X,U,aa,ae,ac,ad,Z,ag,ah,ai,aj,ak,am;function z(b){return b%4?4-b%4:0}function J(c,e){return(new Uint8Array(c,e,1))[0]}function F(c,e){return(new Uint32Array(c,e,1))[0]}function d(o,p){var q,r,s,t,u,v,y,x,A=new Uint32Array(f,p,3*o);for(q=0;q<o;q++){r=A[3*q];s=A[3*q+1];t=A[3*q+2];u=T[2*r];r=T[2*r+1];v=T[2*s];y=T[2*s+1];s=T[2*t];x=T[2*t+1];t=af.faceVertexUvs[0];var B=[];B.push(new THREE.UV(u,r));B.push(new THREE.UV(v,y));B.push(new THREE.UV(s,x));t.push(B)}}function P(q,r){var s,t,u,v,x,y,B,A,C,D,G=new Uint32Array(f,r,4*q);for(s=0;s<q;s++){t=G[4*s];u=G[4*s+1];v=G[4*s+2];x=G[4*s+3];y=T[2*t];t=T[2*t+1];B=T[2*u];C=T[2*u+1];A=T[2*v];D=T[2*v+1];v=T[2*x];u=T[2*x+1];x=af.faceVertexUvs[0];var H=[];H.push(new THREE.UV(y,t));H.push(new THREE.UV(B,C));H.push(new THREE.UV(A,D));H.push(new THREE.UV(v,u));x.push(H)}}function S(k,l,m){for(var n,o,p,q,l=new Uint32Array(f,l,3*k),r=new Uint16Array(f,m,k),m=0;m<k;m++){n=l[3*m],o=l[3*m+1],p=l[3*m+2],q=r[m],af.faces.push(new THREE.Face3(n,o,p,null,null,q))}}function ab(k,l,m){for(var n,o,p,q,s,l=new Uint32Array(f,l,4*k),r=new Uint16Array(f,m,k),m=0;m<k;m++){n=l[4*m],o=l[4*m+1],p=l[4*m+2],q=l[4*m+3],s=r[m],af.faces.push(new THREE.Face4(n,o,p,q,null,null,s))}}function a(r,s,t,u){for(var v,x,y,B,A,D,C,s=new Uint32Array(f,s,3*r),t=new Uint32Array(f,t,3*r),G=new Uint16Array(f,u,r),u=0;u<r;u++){v=s[3*u];x=s[3*u+1];y=s[3*u+2];A=t[3*u];D=t[3*u+1];C=t[3*u+2];B=G[u];var H=O[3*D],I=O[3*D+1];D=O[3*D+2];var K=O[3*C],L=O[3*C+1];C=O[3*C+2];af.faces.push(new THREE.Face3(v,x,y,[new THREE.Vector3(O[3*A],O[3*A+1],O[3*A+2]),new THREE.Vector3(H,I,D),new THREE.Vector3(K,L,C)],null,B))}}function V(v,x,y,A){for(var B,C,D,H,G,K,I,L,N,x=new Uint32Array(f,x,4*v),y=new Uint32Array(f,y,4*v),Q=new Uint16Array(f,A,v),A=0;A<v;A++){B=x[4*A];C=x[4*A+1];D=x[4*A+2];H=x[4*A+3];K=y[4*A];I=y[4*A+1];L=y[4*A+2];N=y[4*A+3];G=Q[A];var W=O[3*I],ao=O[3*I+1];I=O[3*I+2];var ap=O[3*L],aq=O[3*L+1];L=O[3*L+2];var ar=O[3*N],at=O[3*N+1];N=O[3*N+2];af.faces.push(new THREE.Face4(B,C,D,H,[new THREE.Vector3(O[3*K],O[3*K+1],O[3*K+2]),new THREE.Vector3(W,ao,I),new THREE.Vector3(ap,aq,L),new THREE.Vector3(ar,at,N)],null,G))}}var af=this,Y=0,O=[],T=[],al,an;THREE.Geometry.call(this);THREE.Loader.prototype.initMaterials(af,i,w);E=function(k,l,m){for(var k=new Uint8Array(k,l,m),n="",o=0;o<m;o++){n+=String.fromCharCode(k[l+o])}return n}(f,Y,12);M=J(f,Y+12);J(f,Y+13);J(f,Y+14);J(f,Y+15);R=J(f,Y+16);X=J(f,Y+17);U=J(f,Y+18);aa=J(f,Y+19);ae=F(f,Y+20);ac=F(f,Y+20+4);ad=F(f,Y+20+8);w=F(f,Y+20+12);Z=F(f,Y+20+16);ag=F(f,Y+20+20);ah=F(f,Y+20+24);ai=F(f,Y+20+28);aj=F(f,Y+20+32);ak=F(f,Y+20+36);am=F(f,Y+20+40);"Three.js 003"!==E&&console.warn("DEPRECATED: binary model seems to be using old format");Y+=M;E=3*R+aa;an=4*R+aa;M=w*E;al=Z*(E+3*X);R=ag*(E+3*U);aa=ah*(E+3*X+3*U);E=ai*an;X=aj*(an+4*X);U=ak*(an+4*U);Y+=function(k){var k=new Float32Array(f,k,3*ae),l,m,n,o;for(l=0;l<ae;l++){m=k[3*l],n=k[3*l+1],o=k[3*l+2],af.vertices.push(new THREE.Vertex(new THREE.Vector3(m,n,o)))}return 3*ae*Float32Array.BYTES_PER_ELEMENT}(Y);Y+=function(k){if(ac){var k=new Int8Array(f,k,3*ac),l,m,n,o;for(l=0;l<ac;l++){m=k[3*l],n=k[3*l+1],o=k[3*l+2],O.push(m/127,n/127,o/127)}}return 3*ac*Int8Array.BYTES_PER_ELEMENT}(Y);Y+=z(3*ac);Y+=function(k){if(ad){var k=new Float32Array(f,k,2*ad),l,m,n;for(l=0;l<ad;l++){m=k[2*l],n=k[2*l+1],T.push(m,n)}}return 2*ad*Float32Array.BYTES_PER_ELEMENT}(Y);M=Y+M+z(2*w);al=M+al+z(2*Z);R=al+R+z(2*ag);aa=R+aa+z(2*ah);E=aa+E+z(2*ai);X=E+X+z(2*aj);U=X+U+z(2*ak);(function(c){if(ag){var e=c+3*ag*Uint32Array.BYTES_PER_ELEMENT;S(ag,c,e+3*ag*Uint32Array.BYTES_PER_ELEMENT);d(ag,e)}})(al);(function(e){if(ah){var k=e+3*ah*Uint32Array.BYTES_PER_ELEMENT,l=k+3*ah*Uint32Array.BYTES_PER_ELEMENT;a(ah,e,k,l+3*ah*Uint32Array.BYTES_PER_ELEMENT);d(ah,l)}})(R);(function(c){if(ak){var e=c+4*ak*Uint32Array.BYTES_PER_ELEMENT;ab(ak,c,e+4*ak*Uint32Array.BYTES_PER_ELEMENT);P(ak,e)}})(X);(function(e){if(am){var k=e+4*am*Uint32Array.BYTES_PER_ELEMENT,l=k+4*am*Uint32Array.BYTES_PER_ELEMENT;V(am,e,k,l+4*am*Uint32Array.BYTES_PER_ELEMENT);P(am,l)}})(U);w&&S(w,Y,Y+3*w*Uint32Array.BYTES_PER_ELEMENT);(function(c){if(Z){var e=c+3*Z*Uint32Array.BYTES_PER_ELEMENT;a(Z,c,e,e+3*Z*Uint32Array.BYTES_PER_ELEMENT)}})(M);ai&&ab(ai,aa,aa+4*ai*Uint32Array.BYTES_PER_ELEMENT);(function(c){if(aj){var e=c+4*aj*Uint32Array.BYTES_PER_ELEMENT;V(aj,c,e,e+4*aj*Uint32Array.BYTES_PER_ELEMENT)}})(E);this.computeCentroids();this.computeFaceNormals();THREE.Loader.prototype.hasNormals(this)&&this.computeTangents()};j.prototype=new THREE.Geometry;j.prototype.constructor=j;g(new j(h))};THREE.ColladaLoader=function(){function F(b,c,f){aV=b;c=c||ae;void 0!==f&&(b=f.split("/"),b.pop(),at=1>b.length?"":b.join("/")+"/");if((b=aV.evaluate("//dae:asset",aV,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())&&b.childNodes){for(f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];switch(g.nodeName){case"unit":(g=g.getAttribute("meter"))&&parseFloat(g);break;case"up_axis":Y=g.textContent.charAt(0)}}}if(!aN.convertUpAxis||Y===aN.upAxis){av=null}else{switch(Y){case"X":av="Y"===aN.upAxis?"XtoY":"XtoZ";break;case"Y":av="X"===aN.upAxis?"YtoX":"YtoZ";break;case"Z":av="X"===aN.upAxis?"ZtoX":"ZtoY"}}aK=P("//dae:library_images/dae:image",ak,"image");aw=P("//dae:library_materials/dae:material",aa,"material");af=P("//dae:library_effects/dae:effect",w,"effect");M=P("//dae:library_geometries/dae:geometry",aL,"geometry");a1=P("//dae:library_controllers/dae:controller",an,"controller");aC=P("//dae:library_animations/dae:animation",aJ,"animation");aS=P(".//dae:library_visual_scenes/dae:visual_scene",ax,"visual_scene");ag=[];aX=[];(b=aV.evaluate(".//dae:scene/dae:instance_visual_scene",aV,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())?(b=b.getAttribute("url").replace(/^#/,""),ab=aS[b]):ab=null;X=new THREE.Object3D;for(b=0;b<ab.nodes.length;b++){X.add(aj(ab.nodes[b]))}z=[];Z(X);b={scene:X,morphs:ag,skins:aX,animations:z,dae:{images:aK,materials:aw,effects:af,geometries:M,controllers:a1,animations:aC,visualScenes:aS,scene:ab}};c&&c(b);return b}function P(g,h,i){for(var g=aV.evaluate(g,aV,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),j={},k=g.iterateNext(),l=0;k;){k=(new h).parse(k);if(!k.id||0==k.id.length){k.id=i+l++}j[k.id]=k;k=g.iterateNext()}return j}function Z(c){var h=ab.getChildById(c.name,!0),i=null;if(h&&h.keys){i={fps:60,hierarchy:[{node:h,keys:h.keys,sids:h.sids}],node:c,name:"animation_"+c.name,length:0};z.push(i);for(var j=0,k=h.keys.length;j<k;j++){i.length=Math.max(i.length,h.keys[j].time)}}else{i={hierarchy:[{keys:[],sids:[]}]}}j=0;for(k=c.children.length;j<k;j++){for(var h=0,l=Z(c.children[j]).hierarchy.length;h<l;h++){i.hierarchy.push({keys:[],sids:[]})}}return i}function ac(d,g,h,i){d.world=d.world||new THREE.Matrix4;d.world.copy(d.matrix);if(d.channels&&d.channels.length){var j=d.channels[0].sampler.output[h];j instanceof THREE.Matrix4&&d.world.copy(j)}i&&d.world.multiply(i,d.world);g.push(d);for(i=0;i<d.nodes.length;i++){ac(d.nodes[i],g,h,d.world)}}function ah(d,r,s){var t,u=a1[r.url];if(!u||!u.skin){console.log("ColladaLoader: Could not find skin controller.")}else{if(!r.skeleton||!r.skeleton.length){console.log("ColladaLoader: Could not find the skeleton for the skin. ")}else{var s=1000000,v=-s,x=0;for(t in aC){for(var A=aC[t],y=0;y<A.sampler.length;y++){var C=A.sampler[y];C.create();s=Math.min(s,C.startTime);v=Math.max(v,C.endTime);x=Math.max(x,C.input.length)}}t=x;for(var r=ab.getChildById(r.skeleton[0],!0)||ab.getChildBySid(r.skeleton[0],!0),B,D,v=new THREE.Vector3,E,y=0;y<d.vertices.length;y++){u.skin.bindShapeMatrix.multiplyVector3(d.vertices[y].position)}for(s=0;s<t;s++){x=[];A=[];for(y=0;y<d.vertices.length;y++){A.push(new THREE.Vertex(new THREE.Vector3))}ac(r,x,s);y=x;C=u.skin;for(D=0;D<y.length;D++){if(B=y[D],E=-1,"JOINT"==B.type){for(var G=0;G<C.joints.length;G++){if(B.sid==C.joints[G]){E=G;break}}if(0<=E){G=C.invBindMatrices[E];B.invBindMatrix=G;B.skinningMatrix=new THREE.Matrix4;B.skinningMatrix.multiply(B.world,G);B.weights=[];for(G=0;G<C.weights.length;G++){for(var H=0;H<C.weights[G].length;H++){var I=C.weights[G][H];I.joint==E&&B.weights.push(I)}}}else{throw"ColladaLoader: Could not find joint '"+B.sid+"'."}}}for(y=0;y<x.length;y++){if("JOINT"==x[y].type){for(C=0;C<x[y].weights.length;C++){B=x[y].weights[C],D=B.index,B=B.weight,E=d.vertices[D],D=A[D],v.x=E.position.x,v.y=E.position.y,v.z=E.position.z,x[y].skinningMatrix.multiplyVector3(v),D.position.x+=v.x*B,D.position.y+=v.y*B,D.position.z+=v.z*B}}}d.morphTargets.push({name:"target_"+s,vertices:A})}}}}function aj(e){var f=new THREE.Object3D,m,o,r,s;for(r=0;r<e.controllers.length;r++){var u=a1[e.controllers[r].url];switch(u.type){case"skin":if(M[u.skin.source]){var t=new aD;t.url=u.skin.source;t.instance_material=e.controllers[r].instance_material;e.geometries.push(t);m=e.controllers[r]}else{if(a1[u.skin.source]&&(o=u=a1[u.skin.source],u.morph&&M[u.morph.source])){t=new aD,t.url=u.morph.source,t.instance_material=e.controllers[r].instance_material,e.geometries.push(t)}}break;case"morph":if(M[u.morph.source]){t=new aD,t.url=u.morph.source,t.instance_material=e.controllers[r].instance_material,e.geometries.push(t),o=e.controllers[r]}console.log("ColladaLoader: Morph-controller partially supported.")}}for(r=0;r<e.geometries.length;r++){var u=e.geometries[r],t=u.instance_material,u=M[u.url],x={},v=[],y=0,A;if(u&&u.mesh&&u.mesh.primitives){if(0==f.name.length){f.name=u.id}if(t){for(s=0;s<t.length;s++){A=t[s];var B=af[aw[A.target].instance_effect.url].shader;B.material.opacity=!B.material.opacity?1:B.material.opacity;x[A.symbol]=y;v.push(B.material);A=B.material;y++}}t=A||new THREE.MeshLambertMaterial({color:14540253,shading:THREE.FlatShading});u=u.mesh.geometry3js;if(1<y){t=new THREE.MeshFaceMaterial;u.materials=v;for(s=0;s<u.faces.length;s++){v=u.faces[s],v.materialIndex=x[v.daeMaterial]}}if(void 0!==m){ah(u,m),t.morphTargets=!0,t=new THREE.SkinnedMesh(u,t),t.skeleton=m.skeleton,t.skinController=a1[m.url],t.skinInstanceController=m,t.name="skin_"+aX.length,aX.push(t)}else{if(void 0!==o){s=u;x=o instanceof aG?a1[o.url]:o;if(!x||!x.morph){console.log("could not find morph controller!")}else{x=x.morph;for(v=0;v<x.targets.length;v++){if(y=M[x.targets[v]],y.mesh&&y.mesh.primitives&&y.mesh.primitives.length){y=y.mesh.primitives[0].geometry,y.vertices.length===s.vertices.length&&s.morphTargets.push({name:"target_1",vertices:y.vertices})}}s.morphTargets.push({name:"target_Z",vertices:s.vertices})}t.morphTargets=!0;t=new THREE.Mesh(u,t);t.name="morph_"+ag.length;ag.push(t)}else{t=new THREE.Mesh(u,t)}}1<e.geometries.length?f.add(t):f=t}}f.name=e.id||"";f.matrix=e.matrix;m=e.matrix.decompose();f.position=m[0];f.quaternion=m[1];f.useQuaternion=!0;f.scale=m[2];aN.centerGeometry&&f.geometry&&(m=THREE.GeometryUtils.center(f.geometry),f.quaternion.multiplyVector3(m.multiplySelf(f.scale)),f.position.subSelf(m));for(r=0;r<e.nodes.length;r++){f.add(aj(e.nodes[r],e))}return f}function ak(){this.init_from=this.id=""}function an(){this.type=this.name=this.id="";this.morph=this.skin=null}function aq(){this.weights=this.targets=this.source=this.method=null}function aA(){this.source="";this.bindShapeMatrix=null;this.invBindMatrices=[];this.joints=[];this.weights=[]}function ax(){this.name=this.id="";this.nodes=[];this.scene=new THREE.Object3D}function aE(){this.sid=this.name=this.id="";this.nodes=[];this.controllers=[];this.transforms=[];this.geometries=[];this.channels=[];this.matrix=new THREE.Matrix4}function aI(){this.type=this.sid="";this.data=[];this.obj=null}function aG(){this.url="";this.skeleton=[];this.instance_material=[]}function aH(){this.target=this.symbol=""}function aD(){this.url="";this.instance_material=[]}function aL(){this.id="";this.mesh=null}function aO(b){this.geometry=b.id;this.primitives=[];this.geometry3js=this.vertices=null}function aQ(){}function aT(){this.material="";this.count=0;this.inputs=[];this.vcount=null;this.p=[];this.geometry=new THREE.Geometry}function aU(){this.source="";this.stride=this.count=0;this.params=[]}function aY(){this.input={}}function U(){this.semantic="";this.offset=0;this.source="";this.set=0}function ad(b){this.id=b;this.type=null}function aa(){this.name=this.id="";this.instance_effect=null}function J(){this.color=new THREE.Color(0);this.color.setRGB(Math.random(),Math.random(),Math.random());this.color.a=1;this.texOpts=this.texcoord=this.texture=null}function ao(c,d){this.type=c;this.effect=d;this.material=null}function ar(b){this.effect=b;this.format=this.init_from=null}function aF(b){this.effect=b;this.mipfilter=this.magfilter=this.minfilter=this.wrap_t=this.wrap_s=this.source=null}function w(){this.name=this.id="";this.sampler=this.surface=this.shader=null}function ay(){this.url=""}function aJ(){this.name=this.id="";this.source={};this.sampler=[];this.channel=[]}function aB(b){this.animation=b;this.target=this.source="";this.member=this.arrIndices=this.arrSyntax=this.dotSyntax=this.sid=this.fullSid=null}function al(b){this.id="";this.animation=b;this.inputs=[];this.endTime=this.startTime=this.interpolation=this.strideOut=this.output=this.input=null;this.duration=0}function au(b){this.targets=[];this.time=b}function aW(b){return"dae"==b?"http://www.collada.org/2005/11/COLLADASchema":null}function a0(d){for(var d=aP(d),e=[],f=0;f<d.length;f++){e.push(parseFloat(d[f]))}return e}function ai(d){for(var d=aP(d),e=[],f=0;f<d.length;f++){e.push(parseInt(d[f],10))}return e}function aP(b){return b.replace(/^\s+/,"").replace(/\s+$/,"").split(/\s+/)}function aR(d,e,f){return d.hasAttribute(e)?parseInt(d.getAttribute(e),10):f}function aM(d,e){if(aN.convertUpAxis&&Y!==aN.upAxis){switch(av){case"XtoY":var f=d[0];d[0]=e*d[1];d[1]=f;break;case"XtoZ":f=d[2];d[2]=d[1];d[1]=d[0];d[0]=f;break;case"YtoX":f=d[0];d[0]=d[1];d[1]=e*f;break;case"YtoZ":f=d[1];d[1]=e*d[2];d[2]=f;break;case"ZtoX":f=d[0];d[0]=d[1];d[1]=d[2];d[2]=f;break;case"ZtoY":f=d[1],d[1]=d[2],d[2]=e*f}}}function az(d,e){var f=[d[e],d[e+1],d[e+2]];aM(f,-1);return new THREE.Vector3(f[0],f[1],f[2])}function am(c){if(aN.convertUpAxis){var d=[c[0],c[4],c[8]];aM(d,-1);c[0]=d[0];c[4]=d[1];c[8]=d[2];d=[c[1],c[5],c[9]];aM(d,-1);c[1]=d[0];c[5]=d[1];c[9]=d[2];d=[c[2],c[6],c[10]];aM(d,-1);c[2]=d[0];c[6]=d[1];c[10]=d[2];d=[c[0],c[1],c[2]];aM(d,-1);c[0]=d[0];c[1]=d[1];c[2]=d[2];d=[c[4],c[5],c[6]];aM(d,-1);c[4]=d[0];c[5]=d[1];c[6]=d[2];d=[c[8],c[9],c[10]];aM(d,-1);c[8]=d[0];c[9]=d[1];c[10]=d[2];d=[c[3],c[7],c[11]];aM(d,-1);c[3]=d[0];c[7]=d[1];c[11]=d[2]}return new THREE.Matrix4(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8],c[9],c[10],c[11],c[12],c[13],c[14],c[15])}var aV=null,X=null,ab,ae=null,ap={},aK={},aC={},a1={},M={},aw={},af={},z,aS,at,ag,aX,aZ=THREE.SmoothShading,aN={centerGeometry:!1,convertUpAxis:!1,subdivideFaces:!0,upAxis:"Y"},Y="Y",av=null,O=Math.PI/180;ak.prototype.parse=function(d){this.id=d.getAttribute("id");for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if("init_from"==f.nodeName){this.init_from=f.textContent}}return this};an.prototype.parse=function(d){this.id=d.getAttribute("id");this.name=d.getAttribute("name");this.type="none";for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];switch(f.nodeName){case"skin":this.skin=(new aA).parse(f);this.type=f.nodeName;break;case"morph":this.morph=(new aq).parse(f),this.type=f.nodeName}}return this};aq.prototype.parse=function(f){var g={},h=[],i;this.method=f.getAttribute("method");this.source=f.getAttribute("source").replace(/^#/,"");for(i=0;i<f.childNodes.length;i++){var j=f.childNodes[i];if(1==j.nodeType){switch(j.nodeName){case"source":j=(new ad).parse(j);g[j.id]=j;break;case"targets":h=this.parseInputs(j);break;default:console.log(j.nodeName)}}}for(i=0;i<h.length;i++){switch(f=h[i],j=g[f.source],f.semantic){case"MORPH_TARGET":this.targets=j.read();break;case"MORPH_WEIGHT":this.weights=j.read()}}return this};aq.prototype.parseInputs=function(e){for(var f=[],g=0;g<e.childNodes.length;g++){var h=e.childNodes[g];if(1==h.nodeType){switch(h.nodeName){case"input":f.push((new U).parse(h))}}}return f};aA.prototype.parse=function(g){var h={},i,j;this.source=g.getAttribute("source").replace(/^#/,"");this.invBindMatrices=[];this.joints=[];this.weights=[];for(var k=0;k<g.childNodes.length;k++){var l=g.childNodes[k];if(1==l.nodeType){switch(l.nodeName){case"bind_shape_matrix":l=a0(l.textContent);this.bindShapeMatrix=am(l);break;case"source":l=(new ad).parse(l);h[l.id]=l;break;case"joints":i=l;break;case"vertex_weights":j=l;break;default:console.log(l.nodeName)}}}this.parseJoints(i,h);this.parseWeights(j,h);return this};aA.prototype.parseJoints=function(f,g){for(var h=0;h<f.childNodes.length;h++){var i=f.childNodes[h];if(1==i.nodeType){switch(i.nodeName){case"input":var i=(new U).parse(i),j=g[i.source];if("JOINT"==i.semantic){this.joints=j.read()}else{if("INV_BIND_MATRIX"==i.semantic){this.invBindMatrices=j.read()}}}}}};aA.prototype.parseWeights=function(o,p){for(var q,r,s=[],t=0;t<o.childNodes.length;t++){var u=o.childNodes[t];if(1==u.nodeType){switch(u.nodeName){case"input":s.push((new U).parse(u));break;case"v":q=ai(u.textContent);break;case"vcount":r=ai(u.textContent)}}}for(t=u=0;t<r.length;t++){for(var v=r[t],y=[],x=0;x<v;x++){for(var B={},A=0;A<s.length;A++){var C=s[A],D=q[u+C.offset];switch(C.semantic){case"JOINT":B.joint=D;break;case"WEIGHT":B.weight=p[C.source].data[D]}}y.push(B);u+=s.length}for(x=0;x<y.length;x++){y[x].index=t}this.weights.push(y)}};ax.prototype.getChildById=function(e,f){for(var g=0;g<this.nodes.length;g++){var h=this.nodes[g].getChildById(e,f);if(h){return h}}return null};ax.prototype.getChildBySid=function(e,f){for(var g=0;g<this.nodes.length;g++){var h=this.nodes[g].getChildBySid(e,f);if(h){return h}}return null};ax.prototype.parse=function(d){this.id=d.getAttribute("id");this.name=d.getAttribute("name");this.nodes=[];for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"node":this.nodes.push((new aE).parse(f))}}}return this};aE.prototype.getChannelForTransform=function(i){for(var j=0;j<this.channels.length;j++){var k=this.channels[j],l=k.target.split("/");l.shift();var m=l.shift(),n=0<=m.indexOf("."),o=0<=m.indexOf("("),p;if(n){l=m.split("."),m=l.shift(),l.shift()}else{if(o){p=m.split("(");m=p.shift();for(l=0;l<p.length;l++){p[l]=parseInt(p[l].replace(/\)/,""))}}}if(m==i){return k.info={sid:m,dotSyntax:n,arrSyntax:o,arrIndices:p},k}}return null};aE.prototype.getChildById=function(e,f){if(this.id==e){return this}if(f){for(var g=0;g<this.nodes.length;g++){var h=this.nodes[g].getChildById(e,f);if(h){return h}}}return null};aE.prototype.getChildBySid=function(e,f){if(this.sid==e){return this}if(f){for(var g=0;g<this.nodes.length;g++){var h=this.nodes[g].getChildBySid(e,f);if(h){return h}}}return null};aE.prototype.getTransformBySid=function(c){for(var d=0;d<this.transforms.length;d++){if(this.transforms[d].sid==c){return this.transforms[d]}}return null};aE.prototype.parse=function(j){var m;this.id=j.getAttribute("id");this.sid=j.getAttribute("sid");this.name=j.getAttribute("name");this.type=j.getAttribute("type");this.type="JOINT"==this.type?this.type:"NODE";this.nodes=[];this.transforms=[];this.geometries=[];this.controllers=[];this.matrix=new THREE.Matrix4;for(var n=0;n<j.childNodes.length;n++){if(m=j.childNodes[n],1==m.nodeType){switch(m.nodeName){case"node":this.nodes.push((new aE).parse(m));break;case"instance_camera":break;case"instance_controller":this.controllers.push((new aG).parse(m));break;case"instance_geometry":this.geometries.push((new aD).parse(m));break;case"instance_light":break;case"instance_node":m=m.getAttribute("url").replace(/^#/,"");(m=aV.evaluate(".//dae:library_nodes//dae:node[@id='"+m+"']",aV,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null).iterateNext())&&this.nodes.push((new aE).parse(m));break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new aI).parse(m));break;case"extra":break;default:console.log(m.nodeName)}}}j=[];n=1000000;m=-1000000;for(var o in aC){for(var q=aC[o],x=0;x<q.channel.length;x++){var y=q.channel[x],A=q.sampler[x];o=y.target.split("/")[0];if(o==this.id){A.create(),y.sampler=A,n=Math.min(n,A.startTime),m=Math.max(m,A.endTime),j.push(y)}}}if(j.length){this.startTime=n,this.endTime=m}if((this.channels=j)&&this.channels.length){o=[];j=[];n=0;for(q=this.channels.length;n<q;n++){m=this.channels[n];x=m.fullSid;y=m.member;if(aN.convertUpAxis){switch(y){case"X":switch(av){case"XtoY":case"XtoZ":case"YtoX":y="Y";break;case"ZtoX":y="Z"}break;case"Y":switch(av){case"XtoY":case"YtoX":case"ZtoX":y="X";break;case"XtoZ":case"YtoZ":case"ZtoY":y="Z"}break;case"Z":switch(av){case"XtoZ":y="X";break;case"YtoZ":case"ZtoX":case"ZtoY":y="Y"}}}var A=m.sampler,B=A.input,D=this.getTransformBySid(m.sid);if(D){-1===j.indexOf(x)&&j.push(x);m=0;for(var C=B.length;m<C;m++){var E=B[m],G=A.getData(D.type,m),H;H=null;for(var I=0,K=o.length;I<K&&null==H;I++){var L=o[I];if(L.time===E){H=L}else{if(L.time>E){break}}}if(!H){H=new au(E);I=-1;K=0;for(L=o.length;K<L&&-1==I;K++){o[K].time>=E&&(I=K)}E=I;o.splice(-1==E?o.length:E,0,H)}H.addTarget(x,D,y,G)}}else{console.log('Could not find transform "'+m.sid+'" in node '+this.id)}}for(n=0;n<j.length;n++){q=j[n];for(m=0;m<o.length;m++){if(H=o[m],!H.hasTarget(q)){A=o;x=H;D=m;y=q;B=void 0;j:{B=D?D-1:0;for(B=0<=B?B:B+A.length;0<=B;B--){if(C=A[B],C.hasTarget(y)){B=C;break j}}B=null}C=void 0;j:{for(D+=1;D<A.length;D++){if(C=A[D],C.hasTarget(y)){break j}}C=null}if(B&&C){A=(x.time-B.time)/(C.time-B.time);B=B.getTarget(y);D=C.getTarget(y).data;C=B.data;G=void 0;if(C.length){G=[];for(E=0;E<C.length;++E){G[E]=C[E]+(D[E]-C[E])*A}}else{G=C+(D-C)*A}x.addTarget(y,B.transform,B.member,G)}}}}this.keys=o;this.sids=j}this.updateMatrix();return this};aE.prototype.updateMatrix=function(){this.matrix.identity();for(var b=0;b<this.transforms.length;b++){this.transforms[b].apply(this.matrix)}};aI.prototype.parse=function(b){this.sid=b.getAttribute("sid");this.type=b.nodeName;this.data=a0(b.textContent);this.convert();return this};aI.prototype.convert=function(){switch(this.type){case"matrix":this.obj=am(this.data);break;case"rotate":this.angle=this.data[3]*O;case"translate":aM(this.data,-1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":aM(this.data,1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type)}};aI.prototype.apply=function(b){switch(this.type){case"matrix":b.multiplySelf(this.obj);break;case"translate":b.translate(this.obj);break;case"rotate":b.rotateByAxis(this.obj,this.angle);break;case"scale":b.scale(this.obj)}};aI.prototype.update=function(c,d){switch(this.type){case"matrix":console.log("Currently not handling matrix transform updates");break;case"translate":case"scale":switch(d){case"X":this.obj.x=c;break;case"Y":this.obj.y=c;break;case"Z":this.obj.z=c;break;default:this.obj.x=c[0],this.obj.y=c[1],this.obj.z=c[2]}break;case"rotate":switch(d){case"X":this.obj.x=c;break;case"Y":this.obj.y=c;break;case"Z":this.obj.z=c;break;case"ANGLE":this.angle=c*O;break;default:this.obj.x=c[0],this.obj.y=c[1],this.obj.z=c[2],this.angle=c[3]*O}}};aG.prototype.parse=function(e){this.url=e.getAttribute("url").replace(/^#/,"");this.skeleton=[];this.instance_material=[];for(var f=0;f<e.childNodes.length;f++){var g=e.childNodes[f];if(1==g.nodeType){switch(g.nodeName){case"skeleton":this.skeleton.push(g.textContent.replace(/^#/,""));break;case"bind_material":if(g=aV.evaluate(".//dae:instance_material",g,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)){for(var h=g.iterateNext();h;){this.instance_material.push((new aH).parse(h)),h=g.iterateNext()}}}}}return this};aH.prototype.parse=function(b){this.symbol=b.getAttribute("symbol");this.target=b.getAttribute("target").replace(/^#/,"");return this};aD.prototype.parse=function(d){this.url=d.getAttribute("url").replace(/^#/,"");this.instance_material=[];for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType&&"bind_material"==f.nodeName){if(d=aV.evaluate(".//dae:instance_material",f,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null)){for(e=d.iterateNext();e;){this.instance_material.push((new aH).parse(e)),e=d.iterateNext()}}break}}return this};aL.prototype.parse=function(d){this.id=d.getAttribute("id");for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];switch(f.nodeName){case"mesh":this.mesh=(new aO(this)).parse(f)}}return this};aO.prototype.parse=function(e){this.primitives=[];var f;for(f=0;f<e.childNodes.length;f++){var g=e.childNodes[f];switch(g.nodeName){case"source":var h=g.getAttribute("id");void 0==ap[h]&&(ap[h]=(new ad(h)).parse(g));break;case"vertices":this.vertices=(new aY).parse(g);break;case"triangles":this.primitives.push((new aT).parse(g));break;case"polygons":console.warn("polygon holes not yet supported!");case"polylist":this.primitives.push((new aQ).parse(g))}}this.geometry3js=new THREE.Geometry;e=ap[this.vertices.input.POSITION.source].data;for(f=0;f<e.length;f+=3){this.geometry3js.vertices.push(new THREE.Vertex(az(e,f)))}for(f=0;f<this.primitives.length;f++){e=this.primitives[f],e.setVertices(this.vertices),this.handlePrimitive(e,this.geometry3js)}this.geometry3js.computeCentroids();this.geometry3js.computeFaceNormals();this.geometry3js.computeVertexNormals();this.geometry3js.computeBoundingBox();return this};aO.prototype.handlePrimitive=function(s,t){var u=0,v,x,y=s.p,A=s.inputs,B,C,D,E,G=0,H=3,I=[];for(v=0;v<A.length;v++){switch(B=A[v],B.semantic){case"TEXCOORD":I.push(B.set)}}for(;u<y.length;){var K=[],L=[],N={},Q=[];s.vcount&&(H=s.vcount[G++]);for(v=0;v<H;v++){for(x=0;x<A.length;x++){switch(B=A[x],E=ap[B.source],C=y[u+v*A.length+B.offset],D=E.accessor.params.length,D*=C,B.semantic){case"VERTEX":K.push(C);break;case"NORMAL":L.push(az(E.data,D));break;case"TEXCOORD":void 0===N[B.set]&&(N[B.set]=[]);N[B.set].push(new THREE.UV(E.data[D],1-E.data[D+1]));break;case"COLOR":Q.push((new THREE.Color).setRGB(E.data[D],E.data[D+1],E.data[D+2]))}}}x=null;v=[];if(3===H){v.push(new THREE.Face3(K[0],K[1],K[2],[L[0],L[1],L[2]],Q.length?Q:new THREE.Color))}else{if(4===H){v.push(new THREE.Face4(K[0],K[1],K[2],K[3],[L[0],L[1],L[2],L[3]],Q.length?Q:new THREE.Color))}else{if(4<H&&aN.subdivideFaces){Q=Q.length?Q:new THREE.Color;for(x=1;x<H-1;){v.push(new THREE.Face3(K[0],K[x],K[x+1],[L[0],L[x++],L[x]],Q))}}}}if(v.length){K=0;for(L=v.length;K<L;K++){x=v[K];x.daeMaterial=s.material;t.faces.push(x);for(x=0;x<I.length;x++){Q=N[I[x]],Q=4<H?[Q[0],Q[K+1],Q[K+2]]:4===H?[Q[0],Q[1],Q[2],Q[3]]:[Q[0],Q[1],Q[2]],t.faceVertexUvs[x]||(t.faceVertexUvs[x]=[]),t.faceVertexUvs[x].push(Q)}}}else{console.log("dropped face with vcount "+H+" for geometry with id: "+t.id)}u+=A.length*H}};aQ.prototype=new aT;aQ.prototype.constructor=aQ;aT.prototype.setVertices=function(c){for(var d=0;d<this.inputs.length;d++){if(this.inputs[d].source==c.id){this.inputs[d].source=c.input.POSITION.source}}};aT.prototype.parse=function(d){this.inputs=[];this.material=d.getAttribute("material");this.count=aR(d,"count",0);for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];switch(f.nodeName){case"input":this.inputs.push((new U).parse(d.childNodes[e]));break;case"vcount":this.vcount=ai(f.textContent);break;case"p":this.p=ai(f.textContent)}}return this};aU.prototype.parse=function(e){this.params=[];this.source=e.getAttribute("source");this.count=aR(e,"count",0);this.stride=aR(e,"stride",0);for(var f=0;f<e.childNodes.length;f++){var g=e.childNodes[f];if("param"==g.nodeName){var h={};h.name=g.getAttribute("name");h.type=g.getAttribute("type");this.params.push(h)}}return this};aY.prototype.parse=function(d){this.id=d.getAttribute("id");for(var e=0;e<d.childNodes.length;e++){if("input"==d.childNodes[e].nodeName){var f=(new U).parse(d.childNodes[e]);this.input[f.semantic]=f}}return this};U.prototype.parse=function(b){this.semantic=b.getAttribute("semantic");this.source=b.getAttribute("source").replace(/^#/,"");this.set=aR(b,"set",-1);this.offset=aR(b,"offset",0);if("TEXCOORD"==this.semantic&&0>this.set){this.set=0}return this};ad.prototype.parse=function(g){this.id=g.getAttribute("id");for(var h=0;h<g.childNodes.length;h++){var i=g.childNodes[h];switch(i.nodeName){case"bool_array":for(var j=aP(i.textContent),k=[],l=0;l<j.length;l++){k.push("true"==j[l]||"1"==j[l]?!0:!1)}this.data=k;this.type=i.nodeName;break;case"float_array":this.data=a0(i.textContent);this.type=i.nodeName;break;case"int_array":this.data=ai(i.textContent);this.type=i.nodeName;break;case"IDREF_array":case"Name_array":this.data=aP(i.textContent);this.type=i.nodeName;break;case"technique_common":for(j=0;j<i.childNodes.length;j++){if("accessor"==i.childNodes[j].nodeName){this.accessor=(new aU).parse(i.childNodes[j]);break}}}}return this};ad.prototype.read=function(){var d=[],e=this.accessor.params[0];switch(e.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(e=0;e<this.data.length;e+=16){var f=this.data.slice(e,e+16),f=am(f);d.push(f)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+e.type+".")}return d};aa.prototype.parse=function(c){this.id=c.getAttribute("id");this.name=c.getAttribute("name");for(var d=0;d<c.childNodes.length;d++){if("instance_effect"==c.childNodes[d].nodeName){this.instance_effect=(new ay).parse(c.childNodes[d]);break}}return this};J.prototype.isColor=function(){return null==this.texture};J.prototype.isTexture=function(){return null!=this.texture};J.prototype.parse=function(d){for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"color":f=a0(f.textContent);this.color=new THREE.Color(0);this.color.setRGB(f[0],f[1],f[2]);this.color.a=f[3];break;case"texture":this.texture=f.getAttribute("texture"),this.texcoord=f.getAttribute("texcoord"),this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1},this.parseTexture(f)}}}return this};J.prototype.parseTexture=function(d){if(!d.childNodes){return this}d.childNodes[1]&&"extra"===d.childNodes[1].nodeName&&(d=d.childNodes[1],d.childNodes[1]&&"technique"===d.childNodes[1].nodeName&&(d=d.childNodes[1]));for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];switch(f.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[f.nodeName]=parseFloat(f.textContent);break;case"wrapU":case"wrapV":this.texOpts[f.nodeName]=parseInt(f.textContent);break;default:this.texOpts[f.nodeName]=f.textContent}}return this};ao.prototype.parse=function(g){for(var h=0;h<g.childNodes.length;h++){var i=g.childNodes[h];if(1==i.nodeType){switch(i.nodeName){case"ambient":case"emission":case"diffuse":case"specular":case"transparent":this[i.nodeName]=(new J).parse(i);break;case"shininess":case"reflectivity":case"transparency":var j;j=aV.evaluate(".//dae:float",i,aW,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);for(var k=j.iterateNext(),l=[];k;){l.push(k),k=j.iterateNext()}j=l;0<j.length&&(this[i.nodeName]=parseFloat(j[0].textContent))}}}this.create();return this};ao.prototype.create=function(){var f={},g=void 0!==this.transparency&&1>this.transparency,h;for(h in this){switch(h){case"ambient":case"emission":case"diffuse":case"specular":var i=this[h];if(i instanceof J){if(i.isTexture()){if(this.effect.sampler&&this.effect.surface&&this.effect.sampler.source==this.effect.surface.sid){var j=aK[this.effect.surface.init_from];if(j){j=THREE.ImageUtils.loadTexture(at+j.init_from),j.wrapS=i.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,j.wrapT=i.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,j.offset.x=i.texOpts.offsetU,j.offset.y=i.texOpts.offsetV,j.repeat.x=i.texOpts.repeatU,j.repeat.y=i.texOpts.repeatV,f.map=j}}}else{"diffuse"==h?f.color=i.color.getHex():g||(f[h]=i.color.getHex())}}break;case"shininess":case"reflectivity":f[h]=this[h];break;case"transparency":if(g){f.transparent=!0,f.opacity=this[h],g=!0}}}f.shading=aZ;return this.material=new THREE.MeshLambertMaterial(f)};ar.prototype.parse=function(d){for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"init_from":this.init_from=f.textContent;break;case"format":this.format=f.textContent;break;default:console.log("unhandled Surface prop: "+f.nodeName)}}}return this};aF.prototype.parse=function(d){for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"source":this.source=f.textContent;break;case"minfilter":this.minfilter=f.textContent;break;case"magfilter":this.magfilter=f.textContent;break;case"mipfilter":this.mipfilter=f.textContent;break;case"wrap_s":this.wrap_s=f.textContent;break;case"wrap_t":this.wrap_t=f.textContent;break;default:console.log("unhandled Sampler2D prop: "+f.nodeName)}}}return this};w.prototype.create=function(){if(null==this.shader){return null}};w.prototype.parse=function(d){this.id=d.getAttribute("id");this.name=d.getAttribute("name");this.shader=null;for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"profile_COMMON":this.parseTechnique(this.parseProfileCOMMON(f))}}}return this};w.prototype.parseNewparam=function(e){for(var f=e.getAttribute("sid"),g=0;g<e.childNodes.length;g++){var h=e.childNodes[g];if(1==h.nodeType){switch(h.nodeName){case"surface":this.surface=(new ar(this)).parse(h);this.surface.sid=f;break;case"sampler2D":this.sampler=(new aF(this)).parse(h);this.sampler.sid=f;break;case"extra":break;default:console.log(h.nodeName)}}}};w.prototype.parseProfileCOMMON=function(e){for(var f,g=0;g<e.childNodes.length;g++){var h=e.childNodes[g];if(1==h.nodeType){switch(h.nodeName){case"profile_COMMON":this.parseProfileCOMMON(h);break;case"technique":f=h;break;case"newparam":this.parseNewparam(h);break;case"extra":break;default:console.log(h.nodeName)}}}return f};w.prototype.parseTechnique=function(d){for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=(new ao(f.nodeName,this)).parse(f)}}}};ay.prototype.parse=function(b){this.url=b.getAttribute("url").replace(/^#/,"");return this};aJ.prototype.parse=function(d){this.id=d.getAttribute("id");this.name=d.getAttribute("name");this.source={};for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"source":f=(new ad).parse(f);this.source[f.id]=f;break;case"sampler":this.sampler.push((new al(this)).parse(f));break;case"channel":this.channel.push((new aB(this)).parse(f))}}}return this};aB.prototype.parse=function(f){this.source=f.getAttribute("source").replace(/^#/,"");this.target=f.getAttribute("target");var g=this.target.split("/");g.shift();var f=g.shift(),h=0<=f.indexOf("."),i=0<=f.indexOf("(");if(h){g=f.split("."),this.sid=g.shift(),this.member=g.shift()}else{if(i){g=f.split("(");this.sid=g.shift();for(var j=0;j<g.length;j++){g[j]=parseInt(g[j].replace(/\)/,""))}this.arrIndices=g}else{this.sid=f}}this.fullSid=f;this.dotSyntax=h;this.arrSyntax=i;return this};al.prototype.parse=function(d){this.id=d.getAttribute("id");this.inputs=[];for(var e=0;e<d.childNodes.length;e++){var f=d.childNodes[e];if(1==f.nodeType){switch(f.nodeName){case"input":this.inputs.push((new U).parse(f))}}}return this};al.prototype.create=function(){for(var d=0;d<this.inputs.length;d++){var e=this.inputs[d],f=this.animation.source[e.source];switch(e.semantic){case"INPUT":this.input=f.read();break;case"OUTPUT":this.output=f.read();this.strideOut=f.accessor.stride;break;case"INTERPOLATION":this.interpolation=f.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(e.semantic)}}this.duration=this.endTime=this.startTime=0;if(this.input.length){this.startTime=100000000;this.endTime=-100000000;for(d=0;d<this.input.length;d++){this.startTime=Math.min(this.startTime,this.input[d]),this.endTime=Math.max(this.endTime,this.input[d])}this.duration=this.endTime-this.startTime}};al.prototype.getData=function(e,f){var g;if(1<this.strideOut){g=[];for(var f=f*this.strideOut,h=0;h<this.strideOut;++h){g[h]=this.output[f+h]}if(3===this.strideOut){switch(e){case"rotate":case"translate":aM(g,-1);break;case"scale":aM(g,1)}}}else{g=this.output[f]}return g};au.prototype.addTarget=function(e,f,g,h){this.targets.push({sid:e,member:g,transform:f,data:h})};au.prototype.apply=function(d){for(var e=0;e<this.targets.length;++e){var f=this.targets[e];(!d||f.sid===d)&&f.transform.update(f.data,f.member)}};au.prototype.getTarget=function(c){for(var d=0;d<this.targets.length;++d){if(this.targets[d].sid===c){return this.targets[d]}}return null};au.prototype.hasTarget=function(c){for(var d=0;d<this.targets.length;++d){if(this.targets[d].sid===c){return !0}}return !1};au.prototype.interpolate=function(j,k){for(var l=0;l<this.targets.length;++l){var m=this.targets[l],n=j.getTarget(m.sid);if(n){var o=(k-this.time)/(j.time-this.time),p=n.data,q=m.data;if(0>o||1<o){console.log("Key.interpolate: Warning! Scale out of bounds:"+o),o=0>o?0:1}if(q.length){for(var n=[],r=0;r<q.length;++r){n[r]=q[r]+(p[r]-q[r])*o}}else{n=q+(p-q)*o}}else{n=m.data}m.transform.update(n,m.member)}};return{load:function(a,g,h){var i=0;if(document.implementation&&document.implementation.createDocument){var j=new XMLHttpRequest;j.overrideMimeType&&j.overrideMimeType("text/xml");j.onreadystatechange=function(){if(4==j.readyState){if(0==j.status||200==j.status){j.responseXML?(ae=g,F(j.responseXML,void 0,a)):console.error("ColladaLoader: Empty or non-existing file ("+a+")")}}else{3==j.readyState&&h&&(0==i&&(i=j.getResponseHeader("Content-Length")),h({total:i,loaded:j.responseText.length}))}};j.open("GET",a,!0);j.send(null)}else{alert("Don't know how to parse XML!")}},parse:F,setPreferredShading:function(b){aZ=b},applySkin:ah,geometries:M,options:aN}};THREE.JSONLoader=function(b){THREE.Loader.call(this,b)};THREE.JSONLoader.prototype=new THREE.Loader;THREE.JSONLoader.prototype.constructor=THREE.JSONLoader;THREE.JSONLoader.prototype.supr=THREE.Loader.prototype;THREE.JSONLoader.prototype.load=function(d,e,f){if(d instanceof Object){console.warn("DEPRECATED: JSONLoader( parameters ) is now JSONLoader( url, callback, texturePath )."),f=d,d=f.model,e=f.callback,f=f.texture_path}f=f?f:this.extractUrlbase(d);this.onLoadStart();this.loadAjaxJSON(this,d,e,f)};THREE.JSONLoader.prototype.loadAjaxJSON=function(h,i,j,k,l){var m=new XMLHttpRequest,n=0;m.onreadystatechange=function(){if(4==m.readyState){if(200==m.status||0==m.status){try{var a=JSON.parse(m.responseText)}catch(b){console.warn("DEPRECATED: ["+i+"] seems to be using old model format")}h.createModel(a,j,k);h.onLoadComplete()}else{console.error("Couldn't load ["+i+"] ["+m.status+"]")}}else{3==m.readyState?l&&(0==n&&(n=m.getResponseHeader("Content-Length")),l({total:n,loaded:m.responseText.length})):2==m.readyState&&(n=m.getResponseHeader("Content-Length"))}};m.open("GET",i,!0);m.overrideMimeType&&m.overrideMimeType("text/plain; charset=x-user-defined");m.setRequestHeader("Content-Type","text/plain");m.send(null)};THREE.JSONLoader.prototype.createModel=function(f,g,h){var i=new THREE.Geometry,j=void 0!==f.scale?1/f.scale:1;this.initMaterials(i,f.materials,h);(function(a){if(void 0===f.metadata||void 0===f.metadata.formatVersion||3!==f.metadata.formatVersion){console.error("Deprecated file format.")}else{var w,z,A,E,C,G,J,H,I,F,K,L,M,N,O=f.faces;G=f.vertices;var P=f.normals,d=f.colors,y=0;for(w=0;w<f.uvs.length;w++){f.uvs[w].length&&y++}for(w=0;w<y;w++){i.faceUvs[w]=[],i.faceVertexUvs[w]=[]}E=0;for(C=G.length;E<C;){J=new THREE.Vertex,J.position.x=G[E++]*a,J.position.y=G[E++]*a,J.position.z=G[E++]*a,i.vertices.push(J)}E=0;for(C=O.length;E<C;){a=O[E++];G=a&1;A=a&2;w=a&4;z=a&8;H=a&16;J=a&32;F=a&64;a&=128;G?(K=new THREE.Face4,K.a=O[E++],K.b=O[E++],K.c=O[E++],K.d=O[E++],G=4):(K=new THREE.Face3,K.a=O[E++],K.b=O[E++],K.c=O[E++],G=3);if(A){A=O[E++],K.materialIndex=A}A=i.faces.length;if(w){for(w=0;w<y;w++){L=f.uvs[w],I=O[E++],N=L[2*I],I=L[2*I+1],i.faceUvs[w][A]=new THREE.UV(N,I)}}if(z){for(w=0;w<y;w++){L=f.uvs[w];M=[];for(z=0;z<G;z++){I=O[E++],N=L[2*I],I=L[2*I+1],M[z]=new THREE.UV(N,I)}i.faceVertexUvs[w][A]=M}}if(H){H=3*O[E++],z=new THREE.Vector3,z.x=P[H++],z.y=P[H++],z.z=P[H],K.normal=z}if(J){for(w=0;w<G;w++){H=3*O[E++],z=new THREE.Vector3,z.x=P[H++],z.y=P[H++],z.z=P[H],K.vertexNormals.push(z)}}if(F){J=O[E++],J=new THREE.Color(d[J]),K.color=J}if(a){for(w=0;w<G;w++){J=O[E++],J=new THREE.Color(d[J]),K.vertexColors.push(J)}}i.faces.push(K)}}})(j);(function(){var a,d,k,l;if(f.skinWeights){for(a=0,d=f.skinWeights.length;a<d;a+=2){k=f.skinWeights[a],l=f.skinWeights[a+1],i.skinWeights.push(new THREE.Vector4(k,l,0,0))}}if(f.skinIndices){for(a=0,d=f.skinIndices.length;a<d;a+=2){k=f.skinIndices[a],l=f.skinIndices[a+1],i.skinIndices.push(new THREE.Vector4(k,l,0,0))}}i.bones=f.bones;i.animation=f.animation})();(function(a){if(void 0!==f.morphTargets){var d,m,r,t,s,u,x,v,w;for(d=0,m=f.morphTargets.length;d<m;d++){i.morphTargets[d]={};i.morphTargets[d].name=f.morphTargets[d].name;i.morphTargets[d].vertices=[];v=i.morphTargets[d].vertices;w=f.morphTargets[d].vertices;for(r=0,t=w.length;r<t;r+=3){s=w[r]*a,u=w[r+1]*a,x=w[r+2]*a,v.push(new THREE.Vertex(new THREE.Vector3(s,u,x)))}}}if(void 0!==f.morphColors){for(d=0,m=f.morphColors.length;d<m;d++){i.morphColors[d]={};i.morphColors[d].name=f.morphColors[d].name;i.morphColors[d].colors=[];t=i.morphColors[d].colors;s=f.morphColors[d].colors;for(a=0,r=s.length;a<r;a+=3){u=new THREE.Color(16755200),u.setRGB(s[a],s[a+1],s[a+2]),t.push(u)}}}})(j);i.computeCentroids();i.computeFaceNormals();this.hasNormals(i)&&i.computeTangents();g(i)};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){}};THREE.SceneLoader.prototype.constructor=THREE.SceneLoader;THREE.SceneLoader.prototype.load=function(e,f){var g=this,h=new XMLHttpRequest;h.onreadystatechange=function(){if(4==h.readyState){if(200==h.status||0==h.status){try{var a=JSON.parse(h.responseText);void 0===a.metadata||void 0===a.metadata.formatVersion||3!==a.metadata.formatVersion?console.error("Deprecated file format."):g.createScene(a,f,e)}catch(b){console.error(b),console.warn("DEPRECATED: ["+e+"] seems to be using old model format")}}else{console.error("Couldn't load ["+e+"] ["+h.status+"]")}}};h.open("GET",e,!0);h.overrideMimeType&&h.overrideMimeType("text/plain; charset=x-user-defined");h.setRequestHeader("Content-Type","text/plain");h.send(null)};THREE.SceneLoader.prototype.createScene=function(z,J,O){function R(c,d){return"relativeToHTML"==d?c:ag+"/"+c}function T(){var c;for(an in af.objects){if(!ax.objects[an]){if(aq=af.objects[an],void 0!==aq.geometry){if(aa=ax.geometries[aq.geometry]){c=!1;for(U=0;U<aq.materials.length;U++){w=ax.materials[aq.materials[U]],c=w instanceof THREE.ShaderMaterial}c&&aa.computeTangents();au=aq.position;aw=aq.rotation;M=aq.quaternion;S=aq.scale;M=0;0==w.length&&(w=new THREE.MeshFaceMaterial);1<w.length&&(w=new THREE.MeshFaceMaterial);c=new THREE.Mesh(aa,w);c.name=an;c.position.set(au[0],au[1],au[2]);M?(c.quaternion.set(M[0],M[1],M[2],M[3]),c.useQuaternion=!0):c.rotation.set(aw[0],aw[1],aw[2]);c.scale.set(S[0],S[1],S[2]);c.visible=aq.visible;ax.scene.add(c);ax.objects[an]=c;if(aq.meshCollider){var d=THREE.CollisionUtils.MeshColliderWBox(c);ax.scene.collisions.colliders.push(d)}if(aq.castsShadow){d=new THREE.ShadowVolume(aa),ax.scene.add(d),d.position=c.position,d.rotation=c.rotation,d.scale=c.scale}aq.trigger&&"none"!=aq.trigger.toLowerCase()&&(d={type:aq.trigger,object:aq},ax.triggers[c.name]=d)}}else{au=aq.position,aw=aq.rotation,M=aq.quaternion,S=aq.scale,M=0,c=new THREE.Object3D,c.name=an,c.position.set(au[0],au[1],au[2]),M?(c.quaternion.set(M[0],M[1],M[2],M[3]),c.useQuaternion=!0):c.rotation.set(aw[0],aw[1],aw[2]),c.scale.set(S[0],S[1],S[2]),c.visible=void 0!==aq.visible?aq.visible:!1,ax.scene.add(c),ax.objects[an]=c,ax.empties[an]=c,aq.trigger&&"none"!=aq.trigger.toLowerCase()&&(d={type:aq.trigger,object:aq},ax.triggers[c.name]=d)}}}}function V(b){return function(a){ax.geometries[b]=a;T();ah-=1;ab.onLoadComplete();Z()}}function X(b){return function(a){ax.geometries[b]=a}}function Z(){ab.callbackProgress({totalModels:ad,totalTextures:av,loadedModels:ad-ah,loadedTextures:av-Y},ax);ab.onLoadProgress();0==ah&&0==Y&&J(ax)}var ab=this,ag=THREE.Loader.prototype.extractUrlbase(O),ae,aj,an,al,am,ai,ap,aq,ar,at,au,aw,M,S,P,F,aa,ac,ak,w,af,ao,ah,Y,ad,av,ax;af=z;O=new THREE.BinaryLoader;ao=new THREE.JSONLoader;Y=ah=0;ax={scene:new THREE.Scene,geometries:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},triggers:{},empties:{}};z=!1;for(an in af.objects){if(aq=af.objects[an],aq.meshCollider){z=!0;break}}if(z){ax.scene.collisions=new THREE.CollisionSystem}if(af.transform){z=af.transform.position,ar=af.transform.rotation,P=af.transform.scale,z&&ax.scene.position.set(z[0],z[1],z[2]),ar&&ax.scene.rotation.set(ar[0],ar[1],ar[2]),P&&ax.scene.scale.set(P[0],P[1],P[2]),(z||ar||P)&&ax.scene.updateMatrix()}z=function(){Y-=1;Z();ab.onLoadComplete()};for(am in af.cameras){P=af.cameras[am],"perspective"==P.type?ac=new THREE.PerspectiveCamera(P.fov,P.aspect,P.near,P.far):"ortho"==P.type&&(ac=new THREE.OrthographicCamera(P.left,P.right,P.top,P.bottom,P.near,P.far)),au=P.position,ar=P.target,P=P.up,ac.position.set(au[0],au[1],au[2]),ac.target=new THREE.Vector3(ar[0],ar[1],ar[2]),P&&ac.up.set(P[0],P[1],P[2]),ax.cameras[am]=ac}for(al in af.lights){ar=af.lights[al],am=void 0!==ar.color?ar.color:16777215,ac=void 0!==ar.intensity?ar.intensity:1,"directional"==ar.type?(au=ar.direction,at=new THREE.DirectionalLight(am,ac),at.position.set(au[0],au[1],au[2]),at.position.normalize()):"point"==ar.type?(au=ar.position,at=ar.distance,at=new THREE.PointLight(am,ac,at),at.position.set(au[0],au[1],au[2])):"ambient"==ar.type&&(at=new THREE.AmbientLight(am)),ax.scene.add(at),ax.lights[al]=at}for(ai in af.fogs){al=af.fogs[ai],"linear"==al.type?ak=new THREE.Fog(0,al.near,al.far):"exp2"==al.type&&(ak=new THREE.FogExp2(0,al.density)),P=al.color,ak.color.setRGB(P[0],P[1],P[2]),ax.fogs[ai]=ak}if(ax.cameras&&af.defaults.camera){ax.currentCamera=ax.cameras[af.defaults.camera]}if(ax.fogs&&af.defaults.fog){ax.scene.fog=ax.fogs[af.defaults.fog]}P=af.defaults.bgcolor;ax.bgColor=new THREE.Color;ax.bgColor.setRGB(P[0],P[1],P[2]);ax.bgColorAlpha=af.defaults.bgalpha;for(ae in af.geometries){if(ai=af.geometries[ae],"bin_mesh"==ai.type||"ascii_mesh"==ai.type){ah+=1,ab.onLoadStart()}}ad=ah;for(ae in af.geometries){ai=af.geometries[ae],"cube"==ai.type?(aa=new THREE.CubeGeometry(ai.width,ai.height,ai.depth,ai.segmentsWidth,ai.segmentsHeight,ai.segmentsDepth,null,ai.flipped,ai.sides),ax.geometries[ae]=aa):"plane"==ai.type?(aa=new THREE.PlaneGeometry(ai.width,ai.height,ai.segmentsWidth,ai.segmentsHeight),ax.geometries[ae]=aa):"sphere"==ai.type?(aa=new THREE.SphereGeometry(ai.radius,ai.segmentsWidth,ai.segmentsHeight),ax.geometries[ae]=aa):"cylinder"==ai.type?(aa=new THREE.CylinderGeometry(ai.topRad,ai.botRad,ai.height,ai.radSegs,ai.heightSegs),ax.geometries[ae]=aa):"torus"==ai.type?(aa=new THREE.TorusGeometry(ai.radius,ai.tube,ai.segmentsR,ai.segmentsT),ax.geometries[ae]=aa):"icosahedron"==ai.type?(aa=new THREE.IcosahedronGeometry(ai.subdivisions),ax.geometries[ae]=aa):"bin_mesh"==ai.type?O.load(R(ai.url,af.urlBaseType),V(ae)):"ascii_mesh"==ai.type?ao.load(R(ai.url,af.urlBaseType),V(ae)):"embedded_mesh"==ai.type&&(ai=af.embeds[ai.id])&&ao.createModel(ai,X(ae),"")}for(ap in af.textures){if(ae=af.textures[ap],ae.url instanceof Array){Y+=ae.url.length;for(ai=0;ai<ae.url.length;ai++){ab.onLoadStart()}}else{Y+=1,ab.onLoadStart()}}av=Y;for(ap in af.textures){ae=af.textures[ap];if(void 0!=ae.mapping&&void 0!=THREE[ae.mapping]){ae.mapping=new THREE[ae.mapping]}if(ae.url instanceof Array){ai=[];for(var U=0;U<ae.url.length;U++){ai[U]=R(ae.url[U],af.urlBaseType)}ai=THREE.ImageUtils.loadTextureCube(ai,ae.mapping,z)}else{ai=THREE.ImageUtils.loadTexture(R(ae.url,af.urlBaseType),ae.mapping,z);if(void 0!=THREE[ae.minFilter]){ai.minFilter=THREE[ae.minFilter]}if(void 0!=THREE[ae.magFilter]){ai.magFilter=THREE[ae.magFilter]}if(ae.repeat){ai.repeat.set(ae.repeat[0],ae.repeat[1]);if(1!=ae.repeat[0]){ai.wrapS=THREE.RepeatWrapping}if(1!=ae.repeat[1]){ai.wrapT=THREE.RepeatWrapping}}ae.offset&&ai.offset.set(ae.offset[0],ae.offset[1]);if(ae.wrap){ak={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(void 0!==ak[ae.wrap[0]]){ai.wrapS=ak[ae.wrap[0]]}if(void 0!==ak[ae.wrap[1]]){ai.wrapT=ak[ae.wrap[1]]}}}ax.textures[ap]=ai}for(aj in af.materials){ap=af.materials[aj];for(F in ap.parameters){if("envMap"==F||"map"==F||"lightMap"==F){ap.parameters[F]=ax.textures[ap.parameters[F]]}else{if("shading"==F){ap.parameters[F]="flat"==ap.parameters[F]?THREE.FlatShading:THREE.SmoothShading}else{if("blending"==F){ap.parameters[F]=THREE[ap.parameters[F]]?THREE[ap.parameters[F]]:THREE.NormalBlending}else{if("combine"==F){ap.parameters[F]="MixOperation"==ap.parameters[F]?THREE.MixOperation:THREE.MultiplyOperation}else{if("vertexColors"==F){if("face"==ap.parameters[F]){ap.parameters[F]=THREE.FaceColors}else{if(ap.parameters[F]){ap.parameters[F]=THREE.VertexColors}}}}}}}}if(void 0!==ap.parameters.opacity&&1>ap.parameters.opacity){ap.parameters.transparent=!0}if(ap.parameters.normalMap){ae=THREE.ShaderUtils.lib.normal;z=THREE.UniformsUtils.clone(ae.uniforms);ai=ap.parameters.color;ak=ap.parameters.specular;O=ap.parameters.ambient;ao=ap.parameters.shininess;z.tNormal.texture=ax.textures[ap.parameters.normalMap];if(ap.parameters.normalMapFactor){z.uNormalScale.value=ap.parameters.normalMapFactor}if(ap.parameters.map){z.tDiffuse.texture=ap.parameters.map,z.enableDiffuse.value=!0}if(ap.parameters.lightMap){z.tAO.texture=ap.parameters.lightMap,z.enableAO.value=!0}if(ap.parameters.specularMap){z.tSpecular.texture=ax.textures[ap.parameters.specularMap],z.enableSpecular.value=!0}z.uDiffuseColor.value.setHex(ai);z.uSpecularColor.value.setHex(ak);z.uAmbientColor.value.setHex(O);z.uShininess.value=ao;if(ap.parameters.opacity){z.uOpacity.value=ap.parameters.opacity}ap=new THREE.ShaderMaterial({fragmentShader:ae.fragmentShader,vertexShader:ae.vertexShader,uniforms:z,lights:!0,fog:!0})}else{ap=new THREE[ap.type](ap.parameters)}ax.materials[aj]=ap}T();ab.callbackSync(ax);Z()};THREE.UTF8Loader=function(){};THREE.UTF8Loader.prototype=new THREE.UTF8Loader;THREE.UTF8Loader.prototype.constructor=THREE.UTF8Loader;THREE.UTF8Loader.prototype.load=function(i,j,k){if(i instanceof Object){console.warn("DEPRECATED: UTF8Loader( parameters ) is now UTF8Loader( url, callback, metaData )."),k=i,i=k.model,j=k.callback,k={scale:k.scale,offsetX:k.offsetX,offsetY:k.offsetY,offsetZ:k.offsetZ}}var l=new XMLHttpRequest,m=void 0!==k.scale?k.scale:1,n=void 0!==k.offsetX?k.offsetX:0,o=void 0!==k.offsetY?k.offsetY:0,p=void 0!==k.offsetZ?k.offsetZ:0;l.onreadystatechange=function(){4==l.readyState?200==l.status||0==l.status?THREE.UTF8Loader.prototype.createModel(l.responseText,j,m,n,o,p):alert("Couldn't load ["+i+"] ["+l.status+"]"):3!=l.readyState&&2==l.readyState&&l.getResponseHeader("Content-Length")};l.open("GET",i,!0);l.send(null)};THREE.UTF8Loader.prototype.decompressMesh=function(i){var j=i.charCodeAt(0);57344<=j&&(j-=2048);j++;for(var k=new Float32Array(8*j),l=1,m=0;8>m;m++){for(var n=0,o=0;o<j;++o){var p=i.charCodeAt(o+l),n=n+(p>>1^-(p&1));k[8*o+m]=n}l+=j}j=i.length-l;n=new Uint16Array(j);for(m=o=0;m<j;m++){p=i.charCodeAt(m+l),n[m]=o-p,0==p&&o++}return[k,n]};THREE.UTF8Loader.prototype.createModel=function(h,i,j,k,l,m){var n=function(){var a=this;a.materials=[];THREE.Geometry.call(this);var c=THREE.UTF8Loader.prototype.decompressMesh(h),e=[],d=[];(function(b,f,o){for(var p,q,t,u=b.length;o<u;o+=f){p=b[o],q=b[o+1],t=b[o+2],p=p/16383*j,q=q/16383*j,t=t/16383*j,p+=k,q+=l,t+=m,a.vertices.push(new THREE.Vertex(new THREE.Vector3(p,q,t)))}})(c[0],8,0);(function(g,o,p){for(var q,r,s=g.length;p<s;p+=o){q=g[p],r=g[p+1],q/=1023,r/=1023,d.push(q,1-r)}})(c[0],8,3);(function(o,p,q){for(var r,s,t,u=o.length;q<u;q+=p){r=o[q],s=o[q+1],t=o[q+2],r=(r-512)/511,s=(s-512)/511,t=(t-512)/511,e.push(r,s,t)}})(c[0],8,5);(function(b){var q,s,y,z,E,G,K,L,M,N=b.length;for(q=0;q<N;q+=3){s=b[q];y=b[q+1];z=b[q+2];E=a;L=s;M=y;G=z;var p=e[3*y],w=e[3*y+1],r=e[3*y+2],o=e[3*z],F=e[3*z+1],J=e[3*z+2];K=new THREE.Vector3(e[3*s],e[3*s+1],e[3*s+2]);p=new THREE.Vector3(p,w,r);o=new THREE.Vector3(o,F,J);E.faces.push(new THREE.Face3(L,M,G,[K,p,o],null,0));E=d[2*s];s=d[2*s+1];G=d[2*y];K=d[2*y+1];L=d[2*z];M=d[2*z+1];z=a.faceVertexUvs[0];y=G;G=K;K=[];K.push(new THREE.UV(E,s));K.push(new THREE.UV(y,G));K.push(new THREE.UV(L,M));z.push(K)}})(c[1]);this.computeCentroids();this.computeFaceNormals()};n.prototype=new THREE.Geometry;n.prototype.constructor=n;i(new n)};THREE.MarchingCubes=function(c,d){THREE.Object3D.call(this);this.material=d;this.init=function(b){this.resolution=b;this.isolation=80;this.size=b;this.size2=this.size*this.size;this.size3=this.size2*this.size;this.halfsize=this.size/2;this.delta=2/this.size;this.yd=this.size;this.zd=this.size2;this.field=new Float32Array(this.size3);this.normal_cache=new Float32Array(3*this.size3);this.vlist=new Float32Array(36);this.nlist=new Float32Array(36);this.firstDraw=!0;this.maxCount=4096;this.count=0;this.hasNormal=this.hasPos=!1;this.positionArray=new Float32Array(3*this.maxCount);this.normalArray=new Float32Array(3*this.maxCount)};this.lerp=function(f,g,h){return f+(g-f)*h};this.VIntX=function(j,m,o,p,q,r,s,u,t,v){q=(q-t)/(v-t);t=this.normal_cache;m[p]=r+q*this.delta;m[p+1]=s;m[p+2]=u;o[p]=this.lerp(t[j],t[j+3],q);o[p+1]=this.lerp(t[j+1],t[j+4],q);o[p+2]=this.lerp(t[j+2],t[j+5],q)};this.VIntY=function(j,m,o,p,q,r,s,u,t,v){q=(q-t)/(v-t);t=this.normal_cache;m[p]=r;m[p+1]=s+q*this.delta;m[p+2]=u;m=j+3*this.yd;o[p]=this.lerp(t[j],t[m],q);o[p+1]=this.lerp(t[j+1],t[m+1],q);o[p+2]=this.lerp(t[j+2],t[m+2],q)};this.VIntZ=function(j,m,o,p,q,r,s,u,t,v){q=(q-t)/(v-t);t=this.normal_cache;m[p]=r;m[p+1]=s;m[p+2]=u+q*this.delta;m=j+3*this.zd;o[p]=this.lerp(t[j],t[m],q);o[p+1]=this.lerp(t[j+1],t[m+1],q);o[p+2]=this.lerp(t[j+2],t[m+2],q)};this.compNorm=function(e){var f=3*e;0===this.normal_cache[f]&&(this.normal_cache[f]=this.field[e-1]-this.field[e+1],this.normal_cache[f+1]=this.field[e-this.yd]-this.field[e+this.yd],this.normal_cache[f+2]=this.field[e-this.zd]-this.field[e+this.zd])};this.polygonize=function(j,y,G,J,K,L){var N=J+1,Q=J+this.yd,P=J+this.zd,S=N+this.yd,V=N+this.zd,T=J+this.yd+this.zd,U=N+this.yd+this.zd,R=0,W=this.field[J],X=this.field[N],Y=this.field[Q],Z=this.field[S],aa=this.field[P],ab=this.field[V],z=this.field[T],F=this.field[U];W<K&&(R|=1);X<K&&(R|=2);Y<K&&(R|=8);Z<K&&(R|=4);aa<K&&(R|=16);ab<K&&(R|=32);z<K&&(R|=128);F<K&&(R|=64);var E=THREE.edgeTable[R];if(0===E){return 0}var w=this.delta,M=j+w,O=y+w,w=G+w;E&1&&(this.compNorm(J),this.compNorm(N),this.VIntX(3*J,this.vlist,this.nlist,0,K,j,y,G,W,X));E&2&&(this.compNorm(N),this.compNorm(S),this.VIntY(3*N,this.vlist,this.nlist,3,K,M,y,G,X,Z));E&4&&(this.compNorm(Q),this.compNorm(S),this.VIntX(3*Q,this.vlist,this.nlist,6,K,j,O,G,Y,Z));E&8&&(this.compNorm(J),this.compNorm(Q),this.VIntY(3*J,this.vlist,this.nlist,9,K,j,y,G,W,Y));E&16&&(this.compNorm(P),this.compNorm(V),this.VIntX(3*P,this.vlist,this.nlist,12,K,j,y,w,aa,ab));E&32&&(this.compNorm(V),this.compNorm(U),this.VIntY(3*V,this.vlist,this.nlist,15,K,M,y,w,ab,F));E&64&&(this.compNorm(T),this.compNorm(U),this.VIntX(3*T,this.vlist,this.nlist,18,K,j,O,w,z,F));E&128&&(this.compNorm(P),this.compNorm(T),this.VIntY(3*P,this.vlist,this.nlist,21,K,j,y,w,aa,z));E&256&&(this.compNorm(J),this.compNorm(P),this.VIntZ(3*J,this.vlist,this.nlist,24,K,j,y,G,W,aa));E&512&&(this.compNorm(N),this.compNorm(V),this.VIntZ(3*N,this.vlist,this.nlist,27,K,M,y,G,X,ab));E&1024&&(this.compNorm(S),this.compNorm(U),this.VIntZ(3*S,this.vlist,this.nlist,30,K,M,O,G,Z,F));E&2048&&(this.compNorm(Q),this.compNorm(T),this.VIntZ(3*Q,this.vlist,this.nlist,33,K,j,O,G,Y,z));R<<=4;for(K=J=0;-1!=THREE.triTable[R+K];){j=R+K,y=j+1,G=j+2,this.posnormtriv(this.vlist,this.nlist,3*THREE.triTable[j],3*THREE.triTable[y],3*THREE.triTable[G],L),K+=3,J++}return J};this.posnormtriv=function(j,k,l,m,n,o){var p=3*this.count;this.positionArray[p]=j[l];this.positionArray[p+1]=j[l+1];this.positionArray[p+2]=j[l+2];this.positionArray[p+3]=j[m];this.positionArray[p+4]=j[m+1];this.positionArray[p+5]=j[m+2];this.positionArray[p+6]=j[n];this.positionArray[p+7]=j[n+1];this.positionArray[p+8]=j[n+2];this.normalArray[p]=k[l];this.normalArray[p+1]=k[l+1];this.normalArray[p+2]=k[l+2];this.normalArray[p+3]=k[m];this.normalArray[p+4]=k[m+1];this.normalArray[p+5]=k[m+2];this.normalArray[p+6]=k[n];this.normalArray[p+7]=k[n+1];this.normalArray[p+8]=k[n+2];this.hasNormal=this.hasPos=!0;this.count+=3;this.count>=this.maxCount-3&&o(this)};this.begin=function(){this.count=0;this.hasNormal=this.hasPos=!1};this.end=function(e){if(0!==this.count){for(var f=3*this.count;f<this.positionArray.length;f++){this.positionArray[f]=0}e(this)}};this.addBall=function(j,w,x,y,z){var A=this.size*Math.sqrt(y/z),B=x*this.size,D=w*this.size,C=j*this.size,F=Math.floor(B-A);1>F&&(F=1);B=Math.floor(B+A);B>this.size-1&&(B=this.size-1);var I=Math.floor(D-A);1>I&&(I=1);D=Math.floor(D+A);D>this.size-1&&(D=this.size-1);var G=Math.floor(C-A);1>G&&(G=1);A=Math.floor(C+A);A>this.size-1&&(A=this.size-1);for(var H,E,J,K,L,M,N,C=F;C<B;C++){J=this.size2*C;L=C/this.size-x;M=L*L;for(F=I;F<D;F++){E=J+this.size*F;H=F/this.size-w;N=H*H;for(H=G;H<A;H++){K=H/this.size-j,K=y/(1e-06+K*K+N+M)-z,0<K&&(this.field[E+H]+=K)}}}};this.addPlaneX=function(j,m){var p,r,s,t,u,w=this.size,v=this.yd,x=this.zd,z=this.field,y=w*Math.sqrt(j/m);y>w&&(y=w);for(p=0;p<y;p++){if(r=p/w,r*=r,t=j/(0.0001+r)-m,0<t){for(r=0;r<w;r++){u=p+r*v;for(s=0;s<w;s++){z[x*s+u]+=t}}}}};this.addPlaneY=function(j,m){var r,s,t,u,v,x,w=this.size,y=this.yd,B=this.zd,z=this.field,A=w*Math.sqrt(j/m);A>w&&(A=w);for(s=0;s<A;s++){if(r=s/w,r*=r,u=j/(0.0001+r)-m,0<u){v=s*y;for(r=0;r<w;r++){x=v+r;for(t=0;t<w;t++){z[B*t+x]+=u}}}}};this.addPlaneZ=function(j,m){var r,s,t,u,v,x,w=this.size,y=this.yd,B=this.zd,z=this.field,A=w*Math.sqrt(j/m);A>w&&(A=w);for(t=0;t<A;t++){if(r=t/w,r*=r,u=j/(0.0001+r)-m,0<u){v=B*t;for(s=0;s<w;s++){x=v+s*y;for(r=0;r<w;r++){z[x+r]+=u}}}}};this.reset=function(){var b;for(b=0;b<this.size3;b++){this.normal_cache[3*b]=0,this.field[b]=0}};this.render=function(j){this.begin();var m,o,p,r,s,t,v,u,w,x=this.size-2;for(r=1;r<x;r++){w=this.size2*r;v=(r-this.halfsize)/this.halfsize;for(p=1;p<x;p++){u=w+this.size*p;t=(p-this.halfsize)/this.halfsize;for(o=1;o<x;o++){s=(o-this.halfsize)/this.halfsize,m=u+o,this.polygonize(s,t,v,m,this.isolation,j)}}}this.end(j)};this.generateGeometry=function(){var f=0,g=new THREE.Geometry,h=[];this.render(function(a){var b,e,j,p,m,r,t,s;for(b=0;b<a.count;b++){t=3*b,m=t+1,s=t+2,e=a.positionArray[t],j=a.positionArray[m],p=a.positionArray[s],r=new THREE.Vector3(e,j,p),e=a.normalArray[t],j=a.normalArray[m],p=a.normalArray[s],t=new THREE.Vector3(e,j,p),t.normalize(),m=new THREE.Vertex(r),g.vertices.push(m),h.push(t)}r=a.count/3;for(b=0;b<r;b++){t=3*(f+b),m=t+1,s=t+2,e=h[t],j=h[m],p=h[s],t=new THREE.Face3(t,m,s,[e,j,p]),g.faces.push(t)}f+=r;a.count=0});return g};this.init(c)};THREE.MarchingCubes.prototype=new THREE.Object3D;THREE.MarchingCubes.prototype.constructor=THREE.MarchingCubes;THREE.edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]);THREE.triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]);THREE.LensFlare=function(f,g,h,i,j){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==f&&this.add(f,g,h,i,j)};THREE.LensFlare.prototype=new THREE.Object3D;THREE.LensFlare.prototype.constructor=THREE.LensFlare;THREE.LensFlare.prototype.supr=THREE.Object3D.prototype;THREE.LensFlare.prototype.add=function(g,h,i,j,k,l){void 0===h&&(h=-1);void 0===i&&(i=0);void 0===l&&(l=1);void 0===k&&(k=new THREE.Color(16777215));if(void 0===j){j=THREE.NormalBlending}i=Math.min(i,Math.max(0,i));this.lensFlares.push({texture:g,size:h,distance:i,x:0,y:0,z:0,scale:1,rotation:1,opacity:l,color:k,blending:j})};THREE.LensFlare.prototype.updateLensFlares=function(){var f,g=this.lensFlares.length,h,i=2*-this.positionScreen.x,j=2*-this.positionScreen.y;for(f=0;f<g;f++){h=this.lensFlares[f],h.x=this.positionScreen.x+i*h.distance,h.y=this.positionScreen.y+j*h.distance,h.wantedRotation=0.25*h.x*Math.PI,h.rotation+=0.25*(h.wantedRotation-h.rotation)}};THREE.LensFlarePlugin=function(){function j(b){var f=m.createProgram(),g=m.createShader(m.FRAGMENT_SHADER),h=m.createShader(m.VERTEX_SHADER);m.shaderSource(g,b.fragmentShader);m.shaderSource(h,b.vertexShader);m.compileShader(g);m.compileShader(h);m.attachShader(f,g);m.attachShader(f,h);m.linkProgram(f);return f}var m,p,r,s,t,u,v,w,y,x,z,B,A;this.init=function(a){m=a.context;p=a;r=new Float32Array(16);s=new Uint16Array(6);a=0;r[a++]=-1;r[a++]=-1;r[a++]=0;r[a++]=0;r[a++]=1;r[a++]=-1;r[a++]=1;r[a++]=0;r[a++]=1;r[a++]=1;r[a++]=1;r[a++]=1;r[a++]=-1;r[a++]=1;r[a++]=0;r[a++]=1;a=0;s[a++]=0;s[a++]=1;s[a++]=2;s[a++]=0;s[a++]=2;s[a++]=3;t=m.createBuffer();u=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,t);m.bufferData(m.ARRAY_BUFFER,r,m.STATIC_DRAW);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,u);m.bufferData(m.ELEMENT_ARRAY_BUFFER,s,m.STATIC_DRAW);v=m.createTexture();w=m.createTexture();m.bindTexture(m.TEXTURE_2D,v);m.texImage2D(m.TEXTURE_2D,0,m.RGB,16,16,0,m.RGB,m.UNSIGNED_BYTE,null);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);m.bindTexture(m.TEXTURE_2D,w);m.texImage2D(m.TEXTURE_2D,0,m.RGBA,16,16,0,m.RGBA,m.UNSIGNED_BYTE,null);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST);m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST);0>=m.getParameter(m.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(y=!1,x=j(THREE.ShaderFlares.lensFlare)):(y=!0,x=j(THREE.ShaderFlares.lensFlareVertexTexture));z={};B={};z.vertex=m.getAttribLocation(x,"position");z.uv=m.getAttribLocation(x,"uv");B.renderType=m.getUniformLocation(x,"renderType");B.map=m.getUniformLocation(x,"map");B.occlusionMap=m.getUniformLocation(x,"occlusionMap");B.opacity=m.getUniformLocation(x,"opacity");B.color=m.getUniformLocation(x,"color");B.scale=m.getUniformLocation(x,"scale");B.rotation=m.getUniformLocation(x,"rotation");B.screenPosition=m.getUniformLocation(x,"screenPosition");A=!1};this.render=function(c,i,l,J){var c=c.__webglFlares,M=c.length;if(M){var O=new THREE.Vector3,P=J/l,R=0.5*l,g=0.5*J,k=16/J,h=new THREE.Vector2(k*P,k),f=new THREE.Vector3(1,1,0),n=new THREE.Vector2(1,1),o=B,k=z;m.useProgram(x);A||(m.enableVertexAttribArray(z.vertex),m.enableVertexAttribArray(z.uv),A=!0);m.uniform1i(o.occlusionMap,0);m.uniform1i(o.map,1);m.bindBuffer(m.ARRAY_BUFFER,t);m.vertexAttribPointer(k.vertex,2,m.FLOAT,!1,16,0);m.vertexAttribPointer(k.uv,2,m.FLOAT,!1,16,8);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,u);m.disable(m.CULL_FACE);m.depthMask(!1);var F,b,q,G,E;for(F=0;F<M;F++){if(k=16/J,h.set(k*P,k),G=c[F],O.set(G.matrixWorld.n14,G.matrixWorld.n24,G.matrixWorld.n34),i.matrixWorldInverse.multiplyVector3(O),i.projectionMatrix.multiplyVector3(O),f.copy(O),n.x=f.x*R+R,n.y=f.y*g+g,y||0<n.x&&n.x<l&&0<n.y&&n.y<J){m.activeTexture(m.TEXTURE1);m.bindTexture(m.TEXTURE_2D,v);m.copyTexImage2D(m.TEXTURE_2D,0,m.RGB,n.x-8,n.y-8,16,16,0);m.uniform1i(o.renderType,0);m.uniform2f(o.scale,h.x,h.y);m.uniform3f(o.screenPosition,f.x,f.y,f.z);m.disable(m.BLEND);m.enable(m.DEPTH_TEST);m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0);m.activeTexture(m.TEXTURE0);m.bindTexture(m.TEXTURE_2D,w);m.copyTexImage2D(m.TEXTURE_2D,0,m.RGBA,n.x-8,n.y-8,16,16,0);m.uniform1i(o.renderType,1);m.disable(m.DEPTH_TEST);m.activeTexture(m.TEXTURE1);m.bindTexture(m.TEXTURE_2D,v);m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0);G.positionScreen.copy(f);G.customUpdateCallback?G.customUpdateCallback(G):G.updateLensFlares();m.uniform1i(o.renderType,2);m.enable(m.BLEND);for(b=0,q=G.lensFlares.length;b<q;b++){if(E=G.lensFlares[b],0.001<E.opacity&&0.001<E.scale){f.x=E.x,f.y=E.y,f.z=E.z,k=E.size*E.scale/J,h.x=k*P,h.y=k,m.uniform3f(o.screenPosition,f.x,f.y,f.z),m.uniform2f(o.scale,h.x,h.y),m.uniform1f(o.rotation,E.rotation),m.uniform1f(o.opacity,E.opacity),m.uniform3f(o.color,E.color.r,E.color.g,E.color.b),p.setBlending(E.blending),p.setTexture(E.texture,1),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0)}}}}m.enable(m.CULL_FACE);m.enable(m.DEPTH_TEST);m.depthMask(!0)}}};THREE.ShadowMapPlugin=function(){var g,h,i,j,k=new THREE.Frustum,l=new THREE.Matrix4;this.init=function(a){g=a.context;h=a;var a=THREE.ShaderLib.depthRGBA,b=THREE.UniformsUtils.clone(a.uniforms);i=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:b});j=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:b,morphTargets:!0});i._shadowPass=!0;j._shadowPass=!0};this.render=function(b,d){h.shadowMapEnabled&&h.shadowMapAutoUpdate&&this.update(b,d)};this.update=function(a){var b,c,e,d,s,v,t,u,f,w=a.lights;g.clearColor(1,1,1,1);g.disable(g.BLEND);h.shadowMapCullFrontFaces&&g.cullFace(g.FRONT);h.setDepthTest(!0);for(b=0,c=w.length;b<c;b++){if(u=w[b],u.castShadow){if(!u.shadowMap){u.shadowMap=new THREE.WebGLRenderTarget(u.shadowMapWidth,u.shadowMapHeight,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat}),u.shadowMapSize=new THREE.Vector2(u.shadowMapWidth,u.shadowMapHeight),u.shadowMatrix=new THREE.Matrix4}if(!u.shadowCamera){if(u instanceof THREE.SpotLight){u.shadowCamera=new THREE.PerspectiveCamera(u.shadowCameraFov,u.shadowMapWidth/u.shadowMapHeight,u.shadowCameraNear,u.shadowCameraFar)}else{if(u instanceof THREE.DirectionalLight){u.shadowCamera=new THREE.OrthographicCamera(u.shadowCameraLeft,u.shadowCameraRight,u.shadowCameraTop,u.shadowCameraBottom,u.shadowCameraNear,u.shadowCameraFar)}else{console.error("Unsupported light type for shadow");continue}}a.add(u.shadowCamera);h.autoUpdateScene&&a.updateMatrixWorld()}if(u.shadowCameraVisible&&!u.cameraHelper){u.cameraHelper=new THREE.CameraHelper(u.shadowCamera),u.shadowCamera.add(u.cameraHelper)}e=u.shadowMap;d=u.shadowMatrix;s=u.shadowCamera;s.position.copy(u.matrixWorld.getPosition());s.lookAt(u.target.matrixWorld.getPosition());s.updateMatrixWorld();s.matrixWorldInverse.getInverse(s.matrixWorld);if(u.cameraHelper){u.cameraHelper.lines.visible=u.shadowCameraVisible}u.shadowCameraVisible&&u.cameraHelper.update(u.shadowCamera);d.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);d.multiplySelf(s.projectionMatrix);d.multiplySelf(s.matrixWorldInverse);if(!s._viewMatrixArray){s._viewMatrixArray=new Float32Array(16)}s.matrixWorldInverse.flattenToArray(s._viewMatrixArray);if(!s._projectionMatrixArray){s._projectionMatrixArray=new Float32Array(16)}s.projectionMatrix.flattenToArray(s._projectionMatrixArray);l.multiply(s.projectionMatrix,s.matrixWorldInverse);k.setFromMatrix(l);h.setRenderTarget(e);h.clear();f=a.__webglObjects;for(e=0,d=f.length;e<d;e++){if(v=f[e],u=v.object,v.render=!1,u.visible&&u.castShadow&&(!(u instanceof THREE.Mesh)||!u.frustumCulled||k.contains(u))){u.matrixWorld.flattenToArray(u._objectMatrixArray),u._modelViewMatrix.multiplyToArray(s.matrixWorldInverse,u.matrixWorld,u._modelViewMatrixArray),v.render=!0}}for(e=0,d=f.length;e<d;e++){if(v=f[e],v.render){u=v.object,v=v.buffer,h.setObjectFaces(u),t=u.customDepthMaterial?u.customDepthMaterial:u.geometry.morphTargets.length?j:i,v instanceof THREE.BufferGeometry?h.renderBufferDirect(s,w,null,t,v,u):h.renderBuffer(s,w,null,t,v,u)}}f=a.__webglObjectsImmediate;for(e=0,d=f.length;e<d;e++){v=f[e],u=v.object,u.visible&&u.castShadow&&(u.matrixAutoUpdate&&u.matrixWorld.flattenToArray(u._objectMatrixArray),u._modelViewMatrix.multiplyToArray(s.matrixWorldInverse,u.matrixWorld,u._modelViewMatrixArray),h.renderImmediateObject(s,w,null,i,u))}}}a=h.getClearColor();b=h.getClearAlpha();g.clearColor(a.r,a.g,a.b,b);g.enable(g.BLEND);h.shadowMapCullFrontFaces&&g.cullFace(g.BACK)}};THREE.SpritePlugin=function(){function j(c,d){return d.z-c.z}var m,n,o,p,q,r,s,t,v,u;this.init=function(b){m=b.context;n=b;o=new Float32Array(16);p=new Uint16Array(6);b=0;o[b++]=-1;o[b++]=-1;o[b++]=0;o[b++]=1;o[b++]=1;o[b++]=-1;o[b++]=1;o[b++]=1;o[b++]=1;o[b++]=1;o[b++]=1;o[b++]=0;o[b++]=-1;o[b++]=1;o[b++]=0;b=o[b++]=0;p[b++]=0;p[b++]=1;p[b++]=2;p[b++]=0;p[b++]=2;p[b++]=3;q=m.createBuffer();r=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,q);m.bufferData(m.ARRAY_BUFFER,o,m.STATIC_DRAW);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,r);m.bufferData(m.ELEMENT_ARRAY_BUFFER,p,m.STATIC_DRAW);var b=THREE.ShaderSprite.sprite,e=m.createProgram(),c=m.createShader(m.FRAGMENT_SHADER),d=m.createShader(m.VERTEX_SHADER);m.shaderSource(c,b.fragmentShader);m.shaderSource(d,b.vertexShader);m.compileShader(c);m.compileShader(d);m.attachShader(e,c);m.attachShader(e,d);m.linkProgram(e);s=e;t={};v={};t.position=m.getAttribLocation(s,"position");t.uv=m.getAttribLocation(s,"uv");v.uvOffset=m.getUniformLocation(s,"uvOffset");v.uvScale=m.getUniformLocation(s,"uvScale");v.rotation=m.getUniformLocation(s,"rotation");v.scale=m.getUniformLocation(s,"scale");v.alignment=m.getUniformLocation(s,"alignment");v.color=m.getUniformLocation(s,"color");v.map=m.getUniformLocation(s,"map");v.opacity=m.getUniformLocation(s,"opacity");v.useScreenCoordinates=m.getUniformLocation(s,"useScreenCoordinates");v.affectedByDistance=m.getUniformLocation(s,"affectedByDistance");v.screenPosition=m.getUniformLocation(s,"screenPosition");v.modelViewMatrix=m.getUniformLocation(s,"modelViewMatrix");v.projectionMatrix=m.getUniformLocation(s,"projectionMatrix");u=!1};this.render=function(b,c,g,h){var b=b.__webglSprites,f=b.length;if(f){var i=t,k=v,l=h/g,g=0.5*g,w=0.5*h,y=!0;m.useProgram(s);u||(m.enableVertexAttribArray(i.position),m.enableVertexAttribArray(i.uv),u=!0);m.disable(m.CULL_FACE);m.enable(m.BLEND);m.depthMask(!0);m.bindBuffer(m.ARRAY_BUFFER,q);m.vertexAttribPointer(i.position,2,m.FLOAT,!1,16,0);m.vertexAttribPointer(i.uv,2,m.FLOAT,!1,16,8);m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,r);m.uniformMatrix4fv(k.projectionMatrix,!1,c._projectionMatrixArray);m.activeTexture(m.TEXTURE0);m.uniform1i(k.map,0);for(var z,a=[],i=0;i<f;i++){if(z=b[i],z.visible&&0!==z.opacity){z.useScreenCoordinates?z.z=-z.position.z:(z._modelViewMatrix.multiplyToArray(c.matrixWorldInverse,z.matrixWorld,z._modelViewMatrixArray),z.z=-z._modelViewMatrix.n34)}}b.sort(j);for(i=0;i<f;i++){z=b[i],z.visible&&0!==z.opacity&&z.map&&z.map.image&&z.map.image.width&&(z.useScreenCoordinates?(m.uniform1i(k.useScreenCoordinates,1),m.uniform3f(k.screenPosition,(z.position.x-g)/g,(w-z.position.y)/w,Math.max(0,Math.min(1,z.position.z)))):(m.uniform1i(k.useScreenCoordinates,0),m.uniform1i(k.affectedByDistance,z.affectedByDistance?1:0),m.uniformMatrix4fv(k.modelViewMatrix,!1,z._modelViewMatrixArray)),c=z.map.image.width/(z.scaleByViewport?h:1),a[0]=c*l*z.scale.x,a[1]=c*z.scale.y,m.uniform2f(k.uvScale,z.uvScale.x,z.uvScale.y),m.uniform2f(k.uvOffset,z.uvOffset.x,z.uvOffset.y),m.uniform2f(k.alignment,z.alignment.x,z.alignment.y),m.uniform1f(k.opacity,z.opacity),m.uniform3f(k.color,z.color.r,z.color.g,z.color.b),m.uniform1f(k.rotation,z.rotation),m.uniform2fv(k.scale,a),z.mergeWith3D&&!y?(m.enable(m.DEPTH_TEST),y=!0):!z.mergeWith3D&&y&&(m.disable(m.DEPTH_TEST),y=!1),n.setBlending(z.blending),n.setTexture(z.map,0),m.drawElements(m.TRIANGLES,6,m.UNSIGNED_SHORT,0))}m.enable(m.CULL_FACE);m.enable(m.DEPTH_TEST);m.depthMask(!0)}}};if(THREE.WebGLRenderer){THREE.AnaglyphWebGLRenderer=function(j){THREE.WebGLRenderer.call(this,j);this.autoUpdateScene=!1;var r=this,s=this.setSize,t=this.render,u=new THREE.PerspectiveCamera,v=new THREE.PerspectiveCamera,w=new THREE.Matrix4,x=new THREE.Matrix4,y,A,z,C;u.matrixAutoUpdate=v.matrixAutoUpdate=!1;var j={minFilter:THREE.LinearFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat},F=new THREE.WebGLRenderTarget(512,512,j),D=new THREE.WebGLRenderTarget(512,512,j),E=new THREE.PerspectiveCamera(53,1,1,10000);E.position.z=2;var j=new THREE.ShaderMaterial({uniforms:{mapLeft:{type:"t",value:0,texture:F},mapRight:{type:"t",value:1,texture:D}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, 1.0 - uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D mapLeft;\nuniform sampler2D mapRight;\nvarying vec2 vUv;\nvoid main() {\nvec4 colorL, colorR;\nvec2 uv = vUv;\ncolorL = texture2D( mapLeft, uv );\ncolorR = texture2D( mapRight, uv );\ngl_FragColor = vec4( colorL.g * 0.7 + colorL.b * 0.3, colorR.g, colorR.b, colorL.a + colorR.a ) * 1.1;\n}"}),B=new THREE.Scene;B.add(new THREE.Mesh(new THREE.PlaneGeometry(2,2),j));B.add(E);this.setSize=function(b,c){s.call(r,b,c);F.width=b;F.height=c;D.width=b;D.height=c};this.render=function(b,e){b.updateMatrixWorld();if(y!==e.aspect||A!==e.near||z!==e.far||C!==e.fov){y=e.aspect;A=e.near;z=e.far;C=e.fov;var f=e.projectionMatrix.clone(),g=0.5*(125/30),h=g*A/125,i=A*Math.tan(C*Math.PI/360),d;w.n14=g;x.n14=-g;g=-i*y+h;d=i*y+h;f.n11=2*A/(d-g);f.n13=(d+g)/(d-g);u.projectionMatrix.copy(f);g=-i*y-h;d=i*y-h;f.n11=2*A/(d-g);f.n13=(d+g)/(d-g);v.projectionMatrix.copy(f)}u.matrixWorld.copy(e.matrixWorld).multiplySelf(x);u.position.copy(e.position);u.near=e.near;u.far=e.far;t.call(r,b,u,F,!0);v.matrixWorld.copy(e.matrixWorld).multiplySelf(w);v.position.copy(e.position);v.near=e.near;v.far=e.far;t.call(r,b,v,D,!0);B.updateMatrixWorld();t.call(r,B,E)}}}if(THREE.WebGLRenderer){THREE.CrosseyedWebGLRenderer=function(i){THREE.WebGLRenderer.call(this,i);this.autoClear=!1;var j=this,k=this.setSize,l=this.render,m,n,o=new THREE.PerspectiveCamera;o.target=new THREE.Vector3(0,0,0);var p=new THREE.PerspectiveCamera;p.target=new THREE.Vector3(0,0,0);j.separation=10;if(i&&void 0!==i.separation){j.separation=i.separation}this.setSize=function(b,c){k.call(j,b,c);m=b/2;n=c};this.render=function(b,d){this.clear();o.fov=d.fov;o.aspect=0.5*d.aspect;o.near=d.near;o.far=d.far;o.updateProjectionMatrix();o.position.copy(d.position);o.target.copy(d.target);o.translateX(j.separation);o.lookAt(o.target);p.projectionMatrix=o.projectionMatrix;p.position.copy(d.position);p.target.copy(d.target);p.translateX(-j.separation);p.lookAt(p.target);this.setViewport(0,0,m,n);l.call(j,b,o);this.setViewport(m,0,m,n);l.call(j,b,p,!1)}}}THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform sampler2D map;\nuniform float opacity;\nuniform int renderType;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},lensFlare:{vertexShader:"uniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform int renderType;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"precision mediump float;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform int renderType;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int affectedByDistance;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( affectedByDistance == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",fragmentShader:"precision mediump float;\nuniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\n}"}};
/*
 * JQuery URL Parser plugin, v2.2.1
 * Developed and maintanined by Mark Perkins, mark@allmarkedup.com
 * Source repository: https://github.com/allmarkedup/jQuery-URL-Parser
 * Licensed under an MIT-style license. See https://github.com/allmarkedup/jQuery-URL-Parser/blob/master/LICENSE for details.
 */
(function(a){if(typeof define==="function"&&define.amd){if(typeof jQuery!=="undefined"){define(["jquery"],a)}else{define([],a)}}else{if(typeof jQuery!=="undefined"){a(jQuery)}else{a()}}})(function(a,t){var r={a:"href",img:"src",form:"action",base:"href",script:"src",iframe:"src",link:"href"},f=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","fragment"],b={anchor:"fragment"},k={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},s=Object.prototype.toString,e=/^[0-9]+$/;function m(z,x){var w=decodeURI(z),v=k[x||false?"strict":"loose"].exec(w),y={attr:{},param:{},seg:{}},u=14;while(u--){y.attr[f[u]]=v[u]||""}y.param.query=l(y.attr.query);y.param.fragment=l(y.attr.fragment);y.seg.path=y.attr.path.replace(/^\/+|\/+$/g,"").split("/");y.seg.fragment=y.attr.fragment.replace(/^\/+|\/+$/g,"").split("/");y.attr.base=y.attr.host?(y.attr.protocol?y.attr.protocol+"://"+y.attr.host:y.attr.host)+(y.attr.port?":"+y.attr.port:""):"";return y}function c(u){var v=u.tagName;if(typeof v!=="undefined"){return r[v.toLowerCase()]}return v}function n(w,v){if(w[v].length==0){return w[v]={}}var x={};for(var u in w[v]){x[u]=w[v][u]}w[v]=x;return x}function j(y,w,u,z){var x=y.shift();if(!x){if(d(w[u])){w[u].push(z)}else{if("object"==typeof w[u]){w[u]=z}else{if("undefined"==typeof w[u]){w[u]=z}else{w[u]=[w[u],z]}}}}else{var v=w[u]=w[u]||[];if("]"==x){if(d(v)){if(""!=z){v.push(z)}}else{if("object"==typeof v){v[g(v).length]=z}else{v=w[u]=[w[u],z]}}}else{if(~x.indexOf("]")){x=x.substr(0,x.length-1);if(!e.test(x)&&d(v)){v=n(w,u)}j(y,v,x,z)}else{if(!e.test(x)&&d(v)){v=n(w,u)}j(y,v,x,z)}}}}function i(y,v,B){if(~v.indexOf("]")){var z=v.split("["),x=z.length,w=x-1;j(z,y,"base",B)}else{if(!e.test(v)&&d(y.base)){var A={};for(var u in y.base){A[u]=y.base[u]}y.base=A}q(y.base,v,B)}return y}function l(u){return p(String(u).split(/&|;/),function(A,z){try{z=decodeURIComponent(z.replace(/\+/g," "))}catch(w){}var x=z.indexOf("="),v=h(z),y=z.substr(0,v||x),B=z.substr(v||x,z.length),B=B.substr(B.indexOf("=")+1,B.length);if(""==y){y=z,B=""}return i(A,y,B)},{base:{}}).base}function q(w,u,y){var x=w[u];if(t===x){w[u]=y}else{if(d(x)){x.push(y)}else{w[u]=[x,y]}}}function h(y){var x=y.length,u,v;for(var w=0;w<x;++w){v=y[w];if("]"==v){u=false}if("["==v){u=true}if("="==v&&!u){return w}}}function p(y,u){var w=0,x=y.length>>0,v=arguments[2];while(w<x){if(w in y){v=u.call(t,v,y[w],w,y)}++w}return v}function d(u){return Object.prototype.toString.call(u)==="[object Array]"}function g(v){var u=[];for(prop in v){if(v.hasOwnProperty(prop)){u.push(prop)}}return u}function o(v,u){if(arguments.length===1&&v===true){u=true;v=t}u=u||false;v=v||window.location.toString();return{data:m(v,u),attr:function(w){w=b[w]||w;return typeof w!=="undefined"?this.data.attr[w]:this.data.attr},param:function(w){return typeof w!=="undefined"?this.data.param.query[w]:this.data.param.query},fparam:function(w){return typeof w!=="undefined"?this.data.param.fragment[w]:this.data.param.fragment},segment:function(w){if(typeof w==="undefined"){return this.data.seg.path}else{w=w<0?this.data.seg.path.length+w:w-1;return this.data.seg.path[w]}},fsegment:function(w){if(typeof w==="undefined"){return this.data.seg.fragment}else{w=w<0?this.data.seg.fragment.length+w:w-1;return this.data.seg.fragment[w]}}}}if(typeof a!=="undefined"){a.fn.url=function(u){var v="";if(this.length){v=a(this).attr(c(this[0]))||""}return o(v,u)};a.url=o}else{window.purl=o}});(function(a){var b=function(c){if(!(this instanceof b)){return new b(c)}return this.init(c)};b.prototype.init=function(d){var c=this;c.options=c.options||{autoPlay:false,autoStop:false,autoPlayDelay:0,audioRes:"",imageCount:0,loopTime:0};c.options=a.extend(c.options,d);if(!c.options.dom){throw"setting dom can't be null or undefine";return}c.dom=c.options.dom;c.loopedCount=0;c.audio=c.dom.find(">.mci-audio-i >audio")};b.prototype.handleEvent=function(c){var d=this;switch(c.type){case"click":break}};b.prototype.start=function(){var c=this;c.stoped=false;if(c.options.width){c.audio.attr("width",c.options.width+"px")}if(c.options.height){c.audio.attr("height",c.options.height+"px")}c.audio.on("error",function(d){c.audio.hide()});c.audio.on("ended",function(d){if(c.options.loopTime==-1&&c.stoped==false){c.audio[0].currentTime=0;c.audio[0].src=c.options.audioRes;c.audio[0].play()}else{if(c.stoped==false&&c.loopedCount<c.options.loopTime){c.loopedCount=c.loopedCount+1;c.audio[0].currentTime=0;c.audio[0].src=c.options.audioRes;c.audio[0].play()}}});c.audio[0].src=c.options.audioRes;if(c.options.autoPlay){if(c.options.autoPlayDelay>0){setTimeout(function(){c.loopedCount=c.loopedCount+1;c.audio[0].play()},c.options.autoPlayDelay)}else{c.loopedCount=c.loopedCount+1;c.audio[0].play()}}};b.prototype.stop=function(){var c=this;c.audio[0].pause();c.stoped=true;c.loopedCount=0};window.MciAudio=b})(jQuery);(function(a){a.path={};a.path.bezier=function(b){this.curentSeg=0;this.preSeg=-1;this.minI=0;this.reverse=b.reverse;this.aniObject=b.aniObject;this.getPoint=function(m){if(this.reverse){m=1-m;this.minI=0}for(var c=b.data.length-1;c>=this.minI;c--){var d=b.data[c];if(m>=d.startTime){m=m-d.startTime;m=m/d.timeRatio;this.startNext=false;if(this.preSeg!=c){this.setV(d);this.curentSeg=c;this.minI=c;this.startNext=true}this.preSeg=c;break}}m=m>1?1:m;var e={},f={},g={},h={},j={};var n=1-m;var o=3*m;var p=3*Math.pow(m,2);var q=Math.pow(m,3);var l=Math.pow(n,3);var k=Math.pow(n,2);e.x=l*this.start.x;e.y=l*this.start.y;f.x=k*this.startControl.x*o;f.y=k*this.startControl.y*o;g.x=p*n*this.endControl.x;g.y=p*n*this.endControl.y;h.x=q*this.end.x;h.y=q*this.end.y;j.x=e.x+f.x+g.x+h.x;j.y=e.y+f.y+g.y+h.y;return j};this.setV=function(c){this.start=c.start;this.end=c.end;this.startControl=c.startControl;this.endControl=c.endControl;this.timeRatio=c.timeRatio;this.startTime=c.startTime;this.css=c.css;this.reverseCss=c.reverseCss};this.pointToPostion=function(d){var c=this.getPoint(d);c.left=c.x+"px";c.top=c.y+"px";return c};this.getTransform=function(e){if(this.reverse){e=1-e}e=e>1?1:e;var g={};var h=this.css.zoomRateX;var i=this.css.zoomRateY;var f=parseInt(this.css.rotate,10);var c=parseInt(this.reverseCss.rotate,10);var d=(e-this.startTime)/this.timeRatio;g.zoomX=this.reverseCss.zoomRateX+(this.css.zoomRateX-this.reverseCss.zoomRateX)*d;g.zoomY=this.reverseCss.zoomRateY+(this.css.zoomRateY-this.reverseCss.zoomRateY)*d;g.rotate=c+(f-c)*d;return g}};a.fx.step.path=function(e){var c=e.end.pointToPostion(e.pos);e.elem.style.top=c.top;e.elem.style.left=c.left;var f=e.end.getTransform(e.pos);a(e.elem).css({transform:"translateZ(0) scale("+f.zoomX+","+f.zoomY+") rotate("+f.rotate+"deg)"});if(a.isFunction(e.end.aniObject.running)){if(e.end.reverse){e.end.aniObject.running(1-e.pos)}else{e.end.aniObject.running(e.pos)}}if(e.end.startNext===true){var d=e.end.timeRatio*e.options.duration;var b;if(!e.end.reverse){b=e.end.css}else{b=e.end.reverseCss}a(e.elem).children().animate(b,{duration:d,queue:false})}};a.fx.step.momentumScroll=function(d){var h=d.end.target;var e=new a.path.bezier(d.end.target.options);var g=d.end.startPos;var c=d.end.pos;var f=g+(c-g)*d.pos;var b=e.pointToPostion(f);var i=e.getTransform(f);h.$this.css({top:b.top,left:b.left,transform:"translateZ(0) scale("+i.zoomX+","+i.zoomY+") rotate("+i.rotate+"deg)"});h.lastPosition=f}})(jQuery);function MultiBezier(a){var b=this;var c=this;this.options=a;this.autoPlay=a.autoPlay;this.delay=a.delay;this.loop=a.loop;this.loopCount=a.loopCount;this.endToHead=a.endToHead;this.reverse=false;this.$this=a.$this;this.$this[0].holder=this;this.orginCss={};this.data=a.data;this.animateFinished=a.animateFinished||function(){};this.orginCss.opacity=1;this.orginCss.left=this.data[0].start.x+"px";this.orginCss.top=this.data[0].start.y+"px";this.orginCss.zoomRateX=this.data[0].reverseCss.zoomRateX;this.orginCss.zoomRateY=this.data[0].reverseCss.zoomRateY;this.orginCss.rotate=this.data[0].reverseCss.rotate;this.duration=a.duration;this.aniObj=null;this.infinte=false;this.started=false;if(this.loopCount==0){this.loopCount=1}if(this.loopCount==-1){this.infinte=true}if(!this.loop){this.loopCount=1;this.infinte=false}if(this.endToHead){this.loopCount*=2}if(!this.autoPlay){this.delay=0}this._finished=function(){if($.isFunction(this.animateFinished)){this.animateFinished(a)}};this.running=function(d){var e={};e.relativePosition=d;e.syncTo=c.options.syncTo;e.syncFrom=c.options.syncFrom;e.type=0;e.direction=0;if(e.syncTo==""&&e.syncFrom==""){return}else{if($.isFunction(c.options.syncMoving)){c.options.syncMoving(e)}}};this._syncMove=function(f){var g=new $.path.bezier(a);a.$this.stop();var d=g.pointToPostion(f.relativePosition);var i=g.getTransform(f.relativePosition);a.$this.css({top:d.top,left:d.left,transform:"translateZ(0) scale("+i.zoomX+","+i.zoomY+") rotate("+i.rotate+"deg)"});c.lastPosition=f.relativePosition;var h={};$.extend(h,f);h.syncTo="";h.syncFrom="";if(f.direction!=-1){h.syncTo=c.options.syncTo;c.options.syncMoving(h)}if(f.direction!=1){h.syncFrom=c.options.syncFrom;c.options.syncMoving(h)}};this._syncEnd=function(d){a.$this.stop().animate({momentumScroll:{target:c,time:d.time,pos:d.relativePosition,startPos:c.lastPosition}},{queue:true,easing:"linear",duration:d.time});var f={};$.extend(f,d);f.syncTo="";f.syncFrom="";if(d.direction!=-1){f.syncTo=b.options.syncTo;c.options.syncMoveEnd(f)}if(d.direction!=1){f.syncFrom=b.options.syncFrom;c.options.syncMoveEnd(f)}};this.start=function(d){if(this.started==true){return}this.show();this.run(d);if(this.childControl){var e=this.childControl;for(var f in e){if($.isFunction(e[f].start)){if(!e[f].isRunning){e[f].start();e[f].isRunning=true}}}}};this.run=function(d){if(this.autoPlay==true||d==true){this.$this.css({"pointer-events":"none"});this.started=true;this.aniFun(1)}else{this.$this.click(function(){this.holder.started=true;this.holder.aniFun(1)})}};this.loopBezier=function(d){this.reverse=!this.reverse;this.aniObj=this.aniObj.animate({path:new $.path.bezier({reverse:this.endToHead&&this.reverse,data:this.data,aniObject:c})},{queue:true,duration:this.duration,easing:"linear",complete:function(){d++;if(!this.holder.infinte&&d>this.holder.loopCount){b._finished();return}if(!this.holder.endToHead){this.holder.reset();this.holder.loopBezier(d)}else{this.holder.loopBezier(d)}}})};this.aniFun=function(d){this.reverse=false;this.aniObj=this.stop().delay(this.delay).animate({path:new $.path.bezier({reverse:this.reverse,data:this.data,aniObject:c})},{queue:true,easing:"linear",duration:this.duration,complete:function(){d++;if(!this.holder.infinte&&d>this.holder.loopCount){b._finished();return}if(!this.holder.endToHead){this.holder.reset();this.holder.loopBezier(d)}else{this.holder.loopBezier(d)}}})};this.stop=function(){if(this.aniObj!==null){return this.aniObj.stop().css(this.orginCss).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"})}return this.$this};this.reset=function(){var f=this;if(this.started==true){if(this.aniObj){this.aniObj.stop().css(this.orginCss).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"})}this.isRunning=false;this.started=false;if(this.childControl){var d=this.childControl;for(var e in d){if($.isFunction(d[e].reset)){d[e].reset()}}}}};this.hide=function(){};this.show=function(){};this._setCss=function(d){var e=this;e.$this.css(d).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"})}}(function(a){var b=function(c){if(!(this instanceof b)){return new b(c)}return this.init(c)};b.prototype.init=function(d){var c=this;c.options=c.options||{defaultSelected:false,actionType:"",targetId:"",targetRes:"",reqNavConfirm:"",normalRes:"",clickedRes:"",normalResImg:"",clickedResImg:"",width:0,heigth:0,_return:""};c.options=a.extend(c.options,d);c.selected=c.options.defaultSelected;if(!c.options.dom){throw"setting dom can't be null or undefine";return}c.options.dom.find(">.mci-btn-i").css({width:c.options.width+"px",height:c.options.height+"px"});if(c.options.openIn=="browser"){a(c.options.dom).wrap('<a class="display:block;border:none;"  href="'+c.options.targetRes+'" target="_blank"></a>')}else{if(Support.touch||window.navigator.msPointerEnabled){a(c.options.dom)[0].addEventListener(Support.touchStartEvent,c,false)}else{a(c.options.dom)[0].addEventListener("click",c,false)}}a(c.options.dom).css({"pointer-events":"auto"})};b.prototype.handleEvent=function(c){var d=this;switch(c.type){case"click":d._click(c);break;case Support.touchStartEvent:d._click(c);break}};b.prototype._click=function(d){var f=this;d.stopPropagation();d.preventDefault();switch(f.options.actionType){case"gotoPage":f.gotoPage(d);break;case"gotoState":f.gotoState(d);break;case"gotoWeb":f.gotoWebPage(d);break;case"sharePicture":break;case"play":f.play(d);break;case"stop":f.stop(d);break}var c=f.options.dom.find(">.mci-btn-i >.mci-btn-state");if(!f.selected){f._setButtonState(true);f.setButtonSelected(true);if(f.options._return==""){a(f.options.dom).css({"pointer-events":"none"});a(f.options.dom).find("div").css({"pointer-events":"none"})}}else{f.setButtonSelected(false)}},b.prototype.resFilter=function(e){var f=this;var d=f.options.dom.find(">.mci-btn-i >.mci-btn-state");var c=null;d.each(function(){if(a(this).attr("id")==e){c=a(this)}});return c};b.prototype.setButtonSelected=function(d){var e=this;var c=e.options.dom.find(">.mci-btn-i >.mci-btn-state");e.selected=d;if(d){if(e.options.clickedRes&&e.options.targetRes!="next"&&e.options.targetRes!="previous"){var f=e.resFilter(e.options.clickedRes);if(f){a(c).removeClass("show");if(f.find("div,img").length==0){setTimeout(function(){e.resFilter(e.options.normalRes).addClass("show")},50)}else{a(f).addClass("show")}}}}else{a(e.options.dom).css({"pointer-events":"auto"});a(e.options.dom).find("div").css({"pointer-events":"auto"});if(e.options.targetRes!="next"&&e.options.targetRes!="previous"){var f=e.resFilter(e.options.normalRes);if(f){a(c).removeClass("show");a(f).addClass("show")}}}};b.prototype._setButtonState=function(c){var d=this;if(c){if(d._parent){a(d._parent.childList).each(function(){if((this instanceof b)&&this.options.targetId==d.options.targetId&&d.options.actionType==this.options.actionType){if(this.selected==true){this.setButtonSelected(false);this.selected=false}}})}}};b.prototype.gotoPage=function(c){var d=this;if(a.isFunction(this.options.gotoPage)){this.options.gotoPage(this.options)}};b.prototype.gotoState=function(c){var d=this;if(a.isFunction(d.options.gotoState)){this.options.selected=d.selected;d.options.gotoState(d.options)}};b.prototype.play=function(c){var d=this;if(a.isFunction(d.options.play)){d.options.play(d.options)}};b.prototype.stop=function(c){var d=this;if(a.isFunction(d.options.stop)){d.options.stop(d.options)}};b.prototype.gotoWebPage=(function(d){var h=this;var g=window.pageWidth||window.innerWidth;var f=window.pageHeight||window.innerHeight;if(a("#web_container").length>0){a("#web_container").remove()}var c=a('<div id="web_container"><div class="title"><span class="close">返回</span><img src="img/loading.gif" class="loading" alt="loading..."/></div><iframe id="web_con_iframe" name="web_con_iframe" frameborder="0" scrolling="no"></iframe></div>');c.css({width:g+"px",height:f+"px",position:"absolute",top:""+f+"px",left:"0","z-index":"9999",transform:Support.transform3d?"translate3d(0,0,0)":"translate(0,0)"});var i=c.find("#web_con_iframe");i.on("load",function(j){c.find(".loading").hide()});i.css({height:(f-34)+"px",width:g+"px"});i.attr("src",h.options.targetRes);c.appendTo(a("body"));c.on("click",function(j){j.preventDefault();j.stopPropagation()});c.find(".close").on("click",function(){c.css({transform:Support.transform3d?"translate3d(0,0,0)":"translate(0,0)"});h.setButtonSelected(false);setTimeout(function(){a("#web_container").remove()},355)});setTimeout(function(){c.css({transition:Support.getCSSVal("transform")+" 350ms ease",transform:Support.transform3d?"translate3d(0,-"+f+"px,0)":"translate(0,-"+f+"px)"})},80);if(window.isIPSViewer){if(a.isFunction(window.hiddenViewerToolBar)){window.hiddenViewerToolBar()}}});window.Button=b})(jQuery);(function(a){var d=Support.touch;var g=Support.touchStartEvent;var f=Support.touchMoveEvent;var e=Support.touchEndEvent;var c=function(h){if(!(this instanceof c)){return new c(h)}return this.init(h)};function b(h,i){return d?h.changedTouches[0][i]:h[i]}c.prototype.init=function(i){var h=this;h.options=h.options||{initialZoomRate:0,initialOffsetX:0,initialOffsetY:0,largerView:false,scrollView:false,converRes:"",src:""};h.options=a.extend(h.options,i);h.dom=h.options.dom;h.moveDom=h.dom.find(">.mci-imagepan-w > .mci-imagepan-i ");if(Support.transform3d){h.moveDom.css({transform:"translate3d("+h.options.initialOffsetX+"px,"+h.options.initialOffsetY+"px,0)"})}else{h.moveDom.css({transform:"translate("+h.options.initialOffsetX+"px,"+h.options.initialOffsetY+"px)"})}if(!h.options.dom){throw"setting dom can't be null or undefine";return}h.dom=h.options.dom;if(h.options.largerView&&h.options.scrollerView=="zoom"){a(h.options.dom)[0].addEventListener("click",h,false);h.dom[0].addEventListener(g,h,false);h.dom[0].addEventListener(f,h,false);h.dom[0].addEventListener(e,h,false)}else{if(h.options.scrollerView!="zoom"){h.dom[0].addEventListener(g,h,false);h.dom[0].addEventListener(f,h,false);h.dom[0].addEventListener(e,h,false);if(!Support.touch){h.dom[0].addEventListener(Support.mouseOut,h,false)}}}h.currentPosition={x:h.options.initialOffsetX,y:h.options.initialOffsetY};h.scrolling=false};c.prototype.handleEvent=function(h){var i=this;switch(h.type){case"click":i._click(h);break;case g:i._touchStart(h);break;case f:i._touchMove(h);break;case e:i._touchEnd(h);break;case Support.mouseOut:i._touchEnd(h);break}};c.prototype._click=function(h){var i=this;h.stopPropagation();h.preventDefault();if(i.canZoom){i._Zoom(h)}};c.prototype._touchStart=function(h){var i=this;if(i.scrolling){return}i.startPageX=b(h,"pageX");i.startPageY=b(h,"pageY");i.basePageX=i.startPageX;i.basePageY=i.startPageY;i.scrolling=true;i.moveReady=false;i.canZoom=true};c.prototype._touchMove=function(j){var q=this;if(!q.scrolling){return}var o=b(j,"pageX"),p=b(j,"pageY"),h=0,i=0,k=0,l=0;var m=0,n=0;if(q.options.scrollerView=="zoom"){q.canZoom=false;return}if(q.moveReady){j.preventDefault();j.stopPropagation();h=o-q.basePageX;i=p-q.basePageY;m=q.currentPosition.x+h;n=q.currentPosition.y+i;q._setPosition({x:m,y:n})}else{k=Math.abs(o-q.startPageX);l=Math.abs(p-q.startPageY);var r=false;var s=false;if(k>5){r=true}if(l>5){s=true}if(q.options.scrollerView=="both"){if(r||s){if(q._canMoved(o-q.startPageX,-1)&&r){q.moveReady=true}if(q._canMoved(p-q.startPageY,1)&&s){q.moveReady=true}}}else{if(r&&q.options.scrollerView=="horizontal"){if(q._canMoved(o-q.startPageX,-1)&&r){q.moveReady=true}}if(s&&q.options.scrollerView=="vertical"){if(q._canMoved(p-q.startPageY,1)&&s){q.moveReady=true}}}if(q.moveReady){j.preventDefault();j.stopPropagation();q.dom[0].addEventListener("click",q,false)}}q.basePageX=o;q.basePageY=p};c.prototype._touchEnd=function(h){var i=this;i.scrolling=false;if(i.moveReady){setTimeout(function(){i.dom[0].removeEventListener("click",i,false)},100);i.moveReady=false}};c.prototype._canMoved=function(i,h){var l=this;var m=0,n=0,j=0,k=0;if(l.options.initialOffsetX>0){m=l.options.initialOffsetX}if(l.options.initialOffsetY>0){n=l.options.initialOffsetY}j=l.options.maxX;k=l.options.maxY;if(h==1){if(l.currentPosition.y>-l.options.maxY&&i<0){return true}else{if(i>0&&l.currentPosition.y<n){return true}}}if(h==-1){if(l.currentPosition.x>-l.options.maxX&&i<0){return true}else{if(i>0&&l.currentPosition.x<m){return true}}}return false};c.prototype._Zoom=function(l){var A=this;if(A.options.largerView){var o=A.dom.find(">.mci-imagepan-w > .mci-imagepan-i.lager");var t=0,s=0;if(t==0||s==0){var p=o.find(">.text-separated >.text-sperate");var y=0;var z=0;for(var n=0;n<p.length;n++){var B=parseInt(p.eq(n).css("top"),10);var q=parseInt(p.eq(n).css("left"),10);var E=parseInt(p.eq(n).width(),10);var m=parseInt(p.eq(n).height(),10);if(n==0){z=-B;y=-q;if(s<m){s=m}if(t<E){t=E}}else{if(s<B+m){s=B+m}if(t<E+q){t=E+q}}}}var v=A.options.width;var x=0;if(t!=0){x=v/t}var u=1;var D=window.pageWidth||a("body").width();var C=window.pageHeight||a("body").height();if(t>=D){u=(t-100)/t;t=t-100;s=u*s}var B=(C-s)/2;var q=(D-t)/2;B=B+z;q=q+y;var k=a('<div class="mci-imagpan-max" style="z-index:9911;width:'+t+"px;height:"+s+"px;position:absolute;left:"+A.options.pageLeft+"px;top:"+A.options.pageTop+'px;display: block;visibility:visible;"></div>');var j=a(o).clone();k.css({transform:"scale("+x+")"});k.append(j);a("body").append(k);var r=new Mask({conDom:o.parent(),top:A.options.top,left:A.options.left,width:D,height:C,hiddenChanged:function(){k.css({transition:"all 1s ease",transform:"scale("+x+")",left:A.options.pageLeft+"px",top:A.options.pageTop+"px"});setTimeout(function(){a(k).remove()},1000)}});r.show();k.css({transition:"all 1s ease",transform:"scale("+u+")","z-index":"9911",visibility:"visible",top:B+"px",left:q+"px"})}};c.prototype._setPosition=function(j){var k=this;if(k.options.scrollerView!="zoom"){var l={x:0,y:0};switch(k.options.scrollerView){case"both":l=j;break;case"vertical":l.x=k.currentPosition.x;l.y=j.y;break;case"horizontal":l.y=k.currentPosition.y;l.x=j.x;break}var m=0,n=0,h=0,i=0;if(k.options.initialOffsetX>0){m=k.options.initialOffsetX}if(k.options.initialOffsetY>0){n=k.options.initialOffsetY}h=k.options.maxX;i=k.options.maxY;if(l.x>m){l.x=m}if(l.y>n){l.y=n}if(l.y<-i){l.y=-i}if(l.x<-h){l.x=-h}k.currentPosition=l;if(Support.transform3d){k.moveDom.css({transform:"translate3d("+l.x+"px,"+l.y+"px,0px)"})}else{k.moveDom.css({transform:"translate("+l.x+"px,"+l.y+"px)"})}}};window.ImagePan=c})(jQuery);(function(a){var b=function(c){if(!(this instanceof b)){return new b(c)}return this.init(c)};b.prototype.init=function(e){var d=this;d.options=d.options||{hiddenChanged:function(){}};d.options=a.extend(d.options,e);var c=document.createElement("div");c.className="mci-mask";c.setAttribute("id","mci-mask");if(d.options.width){c.style.width=d.options.width+"px"}if(d.options.height){c.style.height=d.options.height+"px"}a("body").append(c);d.dom=a("#mci-mask");d.dom[0].addEventListener("click",d,false)};b.prototype.handleEvent=function(c){var d=this;switch(c.type){case"click":d._click(c);break}};b.prototype.show=function(){var c=this;c.dom.show()};b.prototype.hide=function(){var c=this;c.dom.remove();if(a.isFunction(c.options.hiddenChanged)){c.options.hiddenChanged()}};b.prototype._click=function(c){var d=this;c.stopPropagation();c.preventDefault();d.hide()};window.Mask=b})(jQuery);(function(){function a(b){if(!(this instanceof a)){return new a(b)}return this.init(b)}a.prototype.init=function(c){var b=this;b.options=b.options||{dom:null,count:0,width:768,height:1024};b.options=$.extend(b.options,c);b.dom=b.options.dom;if(!b.dom){return null}b.itemIndex=0;b.sectionIndex=0;b.currentX=0;b.currentY=0;b.itemsCount=b.dom.find(".cpage").length;return b};a.prototype._syncMove=function(b){var c=this;c.moving=false;if(b.slideDirection==1){if(overlaySections[b.pageIndex][b.from]!=overlaySections[b.pageIndex][b.to]){var f=b.dist+c.currentY;c.moving=true;c._setSectionTransition(false);c._setY(f,b)}}else{if(overlaySections[b.pageIndex][b.sectionIndex]!=overlaySections[b.to][0]){var d=b.dist+c.currentX;c.moving=true;c._setTransition(false);c._setX(d,b)}}};a.prototype._syncMoveEnd=function(b){var c=this;if(b.slideDirection==1){if(b.to>overlaySections[b.pageIndex].length-1){b.to=overlaySections[b.pageIndex].length-1}if(b.to==-1){b.to=0}if(c.moving||overlaySections[b.pageIndex][b.from]!=overlaySections[b.pageIndex][b.to]){c.moving=false;var f=-(c.sectionIndex+b.incre)*c.options.height;c._setSectionTransition(true);b.direction=0;if(f-c.currentY>0){b.direction=-1}else{if(f-c.currentY<0){b.direction=1}}c._setY(f,b);c.sectionIndex=c.sectionIndex+b.incre;if(b.incre!=0){if($.isFunction(c.options.sectionChanged)){setTimeout(function(){var e={};e.type=1;e.sender=c;c.options.sectionChanged(e)},255)}}}}else{if(b.to>overlaySections.length-1){b.to=overlaySections.length-1}if(b.to==-1){b.to=0}if(c.moving||overlaySections[b.from][b.sectionIndex]!=overlaySections[b.to][0]){c.moving=false;if(b.incre!=0){c.sectionIndex=0;c.currentY=0}var d=-(c.itemIndex+b.incre)*c.options.width;c._setTransition(true);b.direction=0;if(d-c.currentX>0){b.direction=-1}else{if(d-c.currentX<0){b.direction=1}}c._setX(d,b);c.itemIndex=c.itemIndex+b.incre;if(b.incre!=0){if($.isFunction(c.options.sectionChanged)){setTimeout(function(){var e={};e.type=-1;e.sender=c;c.options.sectionChanged(e)},255)}}}}};a.prototype._setX=function(j,d){var i=this;i.currentX=j;var h=i.dom.find(".cpage");if(d.direction<0){if(i.currentX>0&&i.itemIndex==0){var c=h.eq(1);c.remove().css({transition:"",transform:i._getTranslate(0,0,0)});i.toPage=null;i.toSection=null;c.find(".cpage-i").html("");var g=c.find(".cpage-i:first-child");if(d.to!=-1){g.html(CommonSections["_"+overlaySections[d.to][0]])}i.dom.prepend(c);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=g;f.type=-1;i.options.sectionChanging(f)}i.currentX=i.currentX-i.options.width;i.itemIndex=i.itemIndex+1}else{h.eq(0).css({transition:"",transform:i._getTranslate(0,0,0)});if(!i.toPage){h.eq(0).find(".cpage-i:first-child").html("");h.eq(0).find(".cpage-i:first-child").html(CommonSections["_"+overlaySections[d.to][0]]);i.toSection=null;if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=h.eq(0).find(".cpage-i:first-child");f.type=-1;i.options.sectionChanging(f)}}}}else{if(d.direction>0){if(i.currentX<-i.options.width&&i.itemIndex==1){var b=h.eq(0);b.remove().css({transition:"",transform:i._getTranslate(0,0,0)});b.find(".cpage-i").html("");if(d.to!=-1){b.find(".cpage-i:first-child").html(CommonSections["_"+overlaySections[d.to][0]])}i.toPage=null;i.toSection=null;i.dom.append(b);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=b.find(".cpage-i:first-child");f.type=-1;i.options.sectionChanging(f)}i.itemIndex=i.itemIndex-1;i.currentX=i.currentX+i.options.width}else{h.eq(1).css({transition:"",transform:i._getTranslate(0,0,0)});if(!i.toPage){h.eq(1).find(".cpage-i:first-child").html("");h.eq(1).find(".cpage-i:first-child").html(CommonSections["_"+overlaySections[d.to][0]]);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=h.eq(1).find(".cpage-i:first-child");f.type=-1;i.options.sectionChanging(f)}}}}}i._setContainerStyle({transform:i._getTranslate(i.currentX,0,0)})};a.prototype._setY=function(j,d){var i=this;i.currentY=j;var g=i.dom.find(".cpage").eq(i.itemIndex);var h=g.find(".cpage-i");if(d.direction<0){if(i.currentY>0&&i.sectionIndex==0){var c=h.eq(1);c.remove().html("");i.toSection=null;if(d.to!=-1){c.html(CommonSections["_"+overlaySections[d.pageIndex][d.to]])}g.prepend(c);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=c;f.type=1;i.options.sectionChanging(f)}i.currentY=i.currentY-i.options.height;i.sectionIndex=i.sectionIndex+1}else{if(!i.toSection){h.eq(0).html("");h.eq(0).html(CommonSections["_"+overlaySections[d.pageIndex][d.to]]);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=h.eq(0);f.type=1;i.options.sectionChanging(f)}}}}else{if(d.direction>0){if(i.currentY<-i.options.height&&i.sectionIndex==1){var b=h.eq(0);b.remove().html("");i.toSection=null;if(d.to!=-1){b.html(CommonSections["_"+overlaySections[d.pageIndex][d.to]])}g.append(b);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=b;f.type=1;i.options.sectionChanging(f)}i.currentY=i.currentY+i.options.height;i.sectionIndex=i.sectionIndex-1}else{if(!i.toSection){h.eq(1).html("");h.eq(1).html(CommonSections["_"+overlaySections[d.pageIndex][d.to]]);if($.isFunction(i.options.sectionChanging)){var f={};f.sender=i;f.dom=h.eq(1);f.type=1;i.options.sectionChanging(f)}}}}}i._setSectionContainerStyle({transform:i._getTranslate(0,i.currentY,0)})};a.prototype._setSectionContainerStyle=function(d){var c=this;if(d){var b=c.dom.find(".cpage").eq(c.itemIndex);b.css(d)}};a.prototype._getTranslate=function(c,d,e){var b=this;var c=c||"0";var d=d||"0";var e=e||"0";return Support.transform3d?"translate3d("+c+"px, "+d+"px, "+e+"px)":"translate("+c+"px, "+d+"px)"};a.prototype._setContainerStyle=function(b){var c=this;if(b){c.dom.css(b)}};a.prototype._setSectionTransition=function(b){var c=this;if(b){c._setSectionContainerStyle({transition:Support.getCSSVal("transform")+" 250ms ease"})}else{c._setSectionContainerStyle({transition:""})}};a.prototype._setTransition=function(b){var c=this;if(b){c._setContainerStyle({transition:Support.getCSSVal("transform")+" 250ms ease"})}else{c._setContainerStyle({transition:""})}};a.prototype.start=function(b){var e=this;var c=e.dom.find(".cpage").eq(e.itemIndex);var d=c.find(".cpage-i");d.eq(e.sectionIndex).html(b);return d.eq(e.sectionIndex)};a.prototype.getSectionContainer=function(){var d=this;var b=d.dom.find(".cpage").eq(d.itemIndex);var c=b.find(".cpage-i")};window.Overlaypage=a})();
/*
* created by yangyin@mcitech.cn 2012.10.23
*  mci.page.js
* 
* use:	
*   new Mcipage(".mcipage")  or Mcipage('.mcipage') 【基础使用】
*   var mcipage = Mcipage('.mcipage', { distance: 1024}); 【控制每页距离（可以小于当前页做成类win8效果）】
*   mcipage.goToPage([num]);  【跳到某页】
*/
(function(a){var b=document.createElement("div");var h=["webkit","moz","o","ms"];var i={};var l={};l.transform3d=Support.transform3d;l.transform=Support.transform;l.transition=Support.transition;l.touch=Support.touch;l.cssAnimation=(Support.transform3d||Support.transform)&&Support.transition;var o=Support.touchStartEvent;var n=Support.touchMoveEvent;var m=Support.touchEndEvent;var g=Support.mouseOut;function f(r,s){if(!(this instanceof f)){return new f(r,s)}return this.init(r,s)}f.prototype._enablePageAnimation=function(s){var t=this;var r="0ms";if(s==true){r="350ms"}if(l.cssAnimation){t._setStyle({transitionDuration:r})}else{t.animation=s}};f.prototype.init=function(r,s){var t=this;t.element=r;t.dom=a(r);if(typeof r==="string"){t.element=document.querySelector(r)}if(!t.element){throw new Error("element not found")}s=s||{};t.distance=(s.distance===undefined)?null:s.distance;t.sectionDistance=s.sectionDistance||"1024";t.maxPage=(s.maxPage===undefined)?null:(s.maxPage-1);t.disableTouch=(s.disableTouch===undefined)?false:s.disableTouch;t.disable3d=(s.disable3d===undefined)?false:s.disable3d;t.itemCls=s.itemCls||".mpage-c";t.sectionContainer=s.sectionConCls||"section.item";t.sectionCls=s.sectionCls||"article";t.itemCount=s.itemCount||4;t.pageChanged=s.pageChanged||null;t.pageChanging=s.pageChanging||null;t.sectionChanged=s.sectionChanged;t.syncMoving=s.syncMoving;t.syncMoveEnd=s.syncMoveEnd;t.secFlowAttr=s.secFlowAttr||"flow";t.currentItemIndex=0;t.currentPage=0;t.currentSection=0;t.currentX=0;t.currentY=0;t.directionX=0;t.directionY=0;t.animation=false;t.use3d=l.transform3d;if(t.disable3d===true){t.use3d=false}if(l.cssAnimation){t._setStyle({transitionProperty:c("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:t._getTranslate(0)});t._setSectionContainerStyle({transitionProperty:c("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:t._getTranslate(0)})}else{t._setStyle({position:"relative",left:"0px"});t._setStyle({position:"relative",top:"0px"})}t.element.addEventListener(o,t,false);t.element.addEventListener(n,t,false);t.element.addEventListener(m,t,false);if(!l.touch){t.element.addEventListener(g,t,false)}a(t.element).on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(v){if(t.changeEvent!=null){var u=t.changeEvent;t.changeEvent=null;t._pageChangedHanlder(u)}});return t};f.prototype.handleEvent=function(r){var s=this;switch(r.type){case o:s._touchStart(r);break;case n:s._touchMove(r);break;case m:s._touchEnd(r);break;case g:s._touchEnd(r);break;case"click":s._click(r);break;case"changeEvent":break}};f.prototype.refresh=function(){};f.prototype._setSectionContainerStyle=function(v){var t=this;if(v){var r=t.dom.find(t.itemCls).eq(t.currentItemIndex).find(t.sectionContainer);if(r.length>0){var u=r[0].style;for(var s in v){j(u,s,v[s])}}}};f.prototype.hasNext=function(){var r=this;return r.currentPage<r.maxPage};f.prototype.hasPrev=function(){var r=this;return r.currentPage>0};f.prototype.toNext=function(){var r=this;if(!r.hasNext()){return}r.goToPage(r.currentPage+1)};f.prototype.toPrev=function(){var r=this;if(!r.hasPrev()){return}r.goToPage(r.currentPage-1)};f.prototype.pageChanged=null;f.prototype.goToPage=function(u,v){var w=this;var r=w.currentPage;var t=0;if(u===undefined){u=w.currentPage}if(u<=0){w.currentPage=0;u=0}else{if(u>=w.maxPage){u=w.currentPage=w.maxPage}else{w.currentPage=parseInt(u,10)}}w._enablePageAnimation(true);if(u>r){t=1;w.currentItemIndex++}else{if(u<r){w.currentItemIndex--;t=-1}}w.changeEvent=null;if(u!=undefined&&r!=u){var s={};s.oldPage=r;s.newPage=u;s.itemIndex=w.currentItemIndex;s.jumpToSection=v;if(r<u){w.directionX=1}else{if(u<r){w.directionX=-1}}s.direction=w.directionX;w.changeEvent=s}w._setX(-w.currentItemIndex*w.distance);if(a.isFunction(w.syncMoveEnd)){var x={};x.pageIndex=w.currentPage;x.sectionIndex=w.currentSection;x.from=r;x.to=u;x.incre=t;x.slideDirection=-1;w.syncMoveEnd(x)}};f.prototype.jumpToPage=function(y,A){var B=this;if(y==B.currentPage){if(typeof A!=undefined){B.goToSection(A)}return}if(y==B.currentPage+1||y==B.currentPage-1){B.goToPage(y,A);return}var r=B.currentPage;if(y===undefined){y=B.currentPage}if(y<=0){B.currentPage=0;y=0}else{if(y>=B.maxPage){y=B.currentPage=B.maxPage}else{B.currentPage=parseInt(y,10)}}B._enablePageAnimation(true);var u=B.currentItemIndex;var w=0;if(y>r){B.directionX=1;B.currentItemIndex++;w=1}else{if(y<r){B.currentItemIndex--;B.directionX=-1;w=-1}}if(a.isFunction(B.pageChanging)){var z={fromItemIndex:u,toItemIndex:B.currentItemIndex,toPage:y};z.dom=B.dom.find(B.itemCls).eq(B.currentItemIndex);z.oldPage=r;B.pageChanging(z)}if(y!=undefined&&r!=y){var s={};s.oldPage=r;s.newPage=y;s.itemIndex=B.currentItemIndex;s.direction=B.directionX;s.changedDoms=[];s.isJump=true;s.jumpToSection=A;var x=B.dom.find(B.itemCls);for(var v=0;v<x.length;v++){if(v!=B.currentItemIndex){var t=x.eq(v);t.pageIndex=B.currentPage+(v-B.currentItemIndex);t.oldPageIndex=(r+B.directionX)+(v-B.currentItemIndex);s.changedDoms.push(t)}}B.changeEvent=s}B._setX(-B.currentItemIndex*B.distance);if(a.isFunction(B.syncMoveEnd)){var C={};C.pageIndex=B.currentPage;C.sectionIndex=B.currentSection;C.from=r;C.to=y;C.incre=w;C.slideDirection=-1;B.syncMoveEnd(C)}};f.prototype._getSectionHeight=function(){var r=this;return r.dom.find(r.itemCls).eq(r.currentItemIndex).find(r.sectionCls).eq(r.currentSection).height()};f.prototype._getSectionCount=function(){var r=this;return r.dom.find(r.itemCls).eq(r.currentItemIndex).find(r.sectionCls).length};f.prototype.goToSection=function(t){var w=this;var u=w.dom.find(w.itemCls).eq(w.currentItemIndex).find(w.sectionCls).length;var r=w.currentSection;if(t==undefined||t==null){t=w.currentSection}if(t<0){t=w.currentSection=0}else{if(t>=u){t=w.currentSection=u-1}else{w.currentSection=t}}if(l.cssAnimation){w._setSectionContainerStyle({transitionProperty:c("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"450ms"})}else{w.animation=true}var y=t;var v=w.sectionDistance||w._getSectionHeight();w._setY(-w.currentSection*v);var s=0;if(r>y){s=-1}else{if(y>r){s=1}}if(a.isFunction(w.syncMoveEnd)){var x={};x.from=r;x.to=y;x.pageIndex=w.currentPage;x.sectionIndex=w.currentSection;x.incre=s;x.slideDirection=1;w.syncMoveEnd(x)}if(r!=y){setTimeout(function(){if(a.isFunction(w.sectionChanged)){var z={from:r,to:y,dom:w.dom.find(w.itemCls).eq(w.currentItemIndex)};z.pageIndex=w.currentPage;w.sectionChanged(z)}},250)}};f.prototype._pageChangedHanlder=function(s){var w=this;s.changedDoms=s.changedDoms||[];w.currentSection=0;w.currentY=0;s.currentPage=w.currentPage;w._setSectionContainerStyle({transitionProperty:c("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:w._getTranslate(0)});if(w.currentItemIndex==2&&w.currentPage+2<=w.maxPage&&s.direction>0){w._enablePageAnimation(false);var u=w.dom.find(w.itemCls+":first-child");var r=u;r.pageIndex=w.currentPage+2;r.oldPageIndex=w.currentPage-2;s.changedDoms.push(r);r.html("").appendTo(w.dom);w._setX(-w.distance);w.currentItemIndex=1;w.currentX=-w.distance;setTimeout(function(){w._enablePageAnimation(true)},50)}else{if(w.currentItemIndex==0&&w.currentPage-1>=0&&s.direction<0){w._enablePageAnimation(false);var v=w.dom.find(w.itemCls+":last-child");var t=v;t.pageIndex=w.currentPage-1;t.oldPageIndex=w.currentPage+3;s.changedDoms.push(t);t.html("").insertBefore(w.dom.find(w.itemCls+":first-child"));w._setX(-w.distance);w.currentItemIndex=1;w.currentX=-w.distance;setTimeout(function(){w._enablePageAnimation(true)},50)}}if(a.isFunction(w.pageChanged)){w.pageChanged(s)}if(typeof s.jumpToSection!=undefined){w.goToSection(s.jumpToSection)}};f.prototype._setX=function(s){var r=this;if(r.currentX==s){return}r.currentX=s;if(l.cssAnimation){r.element.style[i.transform]=r._getTranslate(s)}else{if(r.animation){r._animate(s);setTimeout(function(){if(r.changeEvent!=null){var t=r.changeEvent;r.changeEvent=null;r._pageChangedHanlder(t)}},360)}else{r.element.style.left=s+"px"}}};f.prototype._setY=function(t){var s=this;if(s.currentY==t){return}s.currentY=t;var r=s.dom.find(s.itemCls).eq(s.currentItemIndex).find(s.sectionContainer).get(0);r.style[i.transform]=s._getTranslate(0,t)};f.prototype._touchStart=function(r){var s=this;if(s.disableTouch){return}if(!l.touch){r.preventDefault()}s._setSectionContainerStyle({transitionDuration:"0ms"});s._enablePageAnimation(false);s.scrolling=true;s.moveReady=false;s.startPageX=d(r,"pageX");s.startPageY=d(r,"pageY");s.basePageX=s.startPageX;s.basePageY=s.startPageY;s.direction=0;s.directionX=0;s.directionY=0;s.startTime=r.timeStamp};f.prototype._touchMove=function(y){var E=this;if(!E.scrolling){return}var B=d(y,"pageX"),C=d(y,"pageY"),w,x,z,A,u,v;u=Math.abs(B-E.startPageX);v=Math.abs(C-E.startPageY);if(E.moveReady&&E.direction!=0){y.preventDefault();y.stopPropagation();w=B-E.basePageX;x=C-E.basePageY;if(E.direction===-1){var r=E.currentX;z=E.currentX+w;E.directionX=(w===0?E.directionX:(w>0?-1:1));if((E.currentPage==E.maxPage&&E.directionX>0)||(E.currentPage==0&&E.directionX<0)){z=E.currentX+w/4}E._setX(z);if(a.isFunction(E.syncMoving)){var F={};F.dist=z-r;F.slideDirection=-1;F.direction=0;F.pageIndex=E.currentPage;F.sectionIndex=E.currentSection;F.from=E.currentPage;F.to=E.currentPage;var t=Math.abs(E.currentItemIndex*E.distance);if(t>Math.abs(z)){F.to=E.currentPage-1;if(F.to<0){F.to=0}}else{if(t<Math.abs(z)){F.to=E.currentPage+1;if(F.to>E.maxPage){F.to=E.maxPage}if(z>0){F.to=0}}}if(F.to>F.from){F.direction=1}else{if(F.to<F.from){F.direction=-1}}E.syncMoving(F)}}else{if(E.direction===1){var s=E.currentY;A=E.currentY+x;E.directionY=x===0?E.directionY:(x>0?-1:1);var D=E._getSectionCount()-1;if((E.currentSection==D&&E.directionY>0)||(E.currentSection==0&&E.directionY<0)){A=E.currentY+x/4}E._setY(A);if(a.isFunction(E.syncMoving)){var F={};F.dist=A-s;F.slideDirection=1;F.direction=0;F.pageIndex=E.currentPage;F.sectionIndex=E.currentSection;F.from=E.currentSection;F.to=E.currentSection;var t=Math.abs(E.currentSection*E.sectionDistance);if(t>Math.abs(A)){F.to=E.currentSection-1;if(F.to<0){F.to=0}}else{if(t<Math.abs(A)){F.to=E.currentSection+1;if(F.to>D){F.to=D}if(A>0){F.to=0}}}if(F.to>F.from){F.direction=1}else{if(F.to<F.from){F.direction=-1}}E.syncMoving(F)}}}}else{if(u>5||v>5){if(E._canMoved(B-E.basePageX,C-E.basePageY)===true){y.preventDefault();y.stopPropagation();E.moveReady=true;E.element.addEventListener("click",E,true)}else{E.direction=0}}}E.basePageX=B;E.basePageY=C};f.prototype._canMoved=function(t,u){var x=this;var s=0;if(Math.abs(u)>Math.abs(t)){s=1}else{s=-1}if(s==1){x.direction=1;if(Support.touch){var y=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop;var r=parseInt(a(document).height());var z=parseInt(a(window).height());var v=true;if(a(document).scrollTop()<=0&&u>0){v=false}if(u<0&&y>=(r-z)){v=false}if(u<0&&parseInt(a(document).scrollTop())-u>=r-z){v=false}if(a(document).scrollTop()-u<=0&&u>0){v=false}if(v){return false}}var w=x._getSectionCount()-1;if(u<0&&x.currentSection<w){x.direction=1;return true}else{if(u>0&&x.currentSection>0){x.direction=1;return true}}}else{if(t>5&&x.direction!=1){x.direction=-1;return true}}return false};f.prototype._touchEnd=function(r){var w=this;if(!w.scrolling){return}w.scrolling=false;if(w.direction>0){var s=w.dom.find(w.itemCls).eq(w.currentItemIndex).find(w.sectionContainer).attr(w.secFlowAttr);if(s=="1"){var t=w.sectionDistance-w.dom.find(w.itemCls).eq(w.currentItemIndex).find(w.sectionContainer).innerHeight();w._setSectionContainerStyle({transitionDuration:"350ms"});if(w.currentY>0){w._setY(0)}else{if(w.currentY<=t){w._setY(t)}}return}var v=0;var v=w.basePageY-w.startPageY;if(v>0){w.directionY=-1}else{w.directionY=1}if(Math.abs(v)<100){w.goToSection(w.currentSection)}else{w.goToSection(w.currentSection+w.directionY*1)}if(Math.abs(u)>0){r.preventDefault();r.stopPropagation()}}else{if(w.direction<0){var u=w.basePageX-w.startPageX;if(u>0){w.directionX=-1}else{w.directionX=1}if(Math.abs(u)<100){w.goToPage(w.currentPage)}else{w.goToPage(w.currentPage+w.directionX*1)}if(Math.abs(v)>0){r.preventDefault();r.stopPropagation()}}}setTimeout(function(){w.element.removeEventListener("click",w,true)},200)};f.prototype._click=function(r){var s=this;r.stopPropagation();r.preventDefault()};f.prototype._setStyle=function(u){var s=this;var t=s.element.style;for(var r in u){j(t,r,u[r])}};f.prototype._animate=function(A){var w=this;var u=w.element;var r=+new Date();var v=parseInt(u.style.left,10);var z=A;var s=350;var t=function(B,x){return -(B/=x)*(B-2)};var y=setInterval(function(){var C=new Date()-r;var B,x;if(C>s){clearInterval(y);x=z}else{B=t(C,s);x=B*(z-v)+v}u.style.left=x+"px"},10)};f.prototype.destroy=function(){var r=this;r.element.removeEventListener(o,r);r.element.removeEventListener(n,r);r.element.removeEventListener(m,r)};f.prototype._getTranslate=function(s,t,u){var r=this;var s=s||"0";var t=t||"0";var u=u||"0";return r.use3d?"translate3d("+s+"px, "+t+"px, "+u+"px)":"translate("+s+"px, "+t+"px)"};function d(r,s){if(window.navigator.msPointerEnabled){return r[s]}return l.touch?r.changedTouches[0][s]:r[s]}function e(r){return k(r,function(s){return b.style[s]!==undefined})}function j(t,s,u){var r=i[s];if(r){t[r]=u}else{if(t[s]!==undefined){i[s]=s;t[s]=u}else{k(h,function(v){var w=q(v)+q(s);if(t[w]!==undefined){i[s]=w;t[w]=u;return true}})}}}function c(r){if(b.style[r]!==undefined){return r}else{var s;k(h,function(t){var u=q(t)+q(r);if(b.style[u]!==undefined){s="-"+t+"-"+r;return true}});return s}}function q(r){return r.charAt(0).toUpperCase()+r.substr(1)}function k(r,s){for(var t=0,u=r.length;t<u;t++){if(s(r[t],t)){return true}}return false}function p(t,v,r,s){var u=document.createEvent("Event");u.initEvent(v,r,s);t.dispatchEvent(u)}window.Mcipage=f})(jQuery);(function(a){var c=Support.touch;var g=Support.touchStartEvent;var f=Support.touchMoveEvent;var e=Support.touchEndEvent;function b(h,i){return c?h.changedTouches[0][i]:h[i]}var d=function(h){if(!(this instanceof d)){return new d(h)}return this.init(h)};d.prototype.init=function(i){var h=this;h.options=h.options||{width:0,height:0,fullscreen:true};h.options=a.extend(h.options,i);if(!h.options.dom){throw"setting dom can't be null or undefine";return}h.dom=h.options.dom;h.showing=false;if(h.options.fullscreen){h.dom[0].addEventListener("click",h,false)}else{h.startShow()}};d.prototype.handleEvent=function(h){var i=this;switch(h.type){case g:i._touchStart(h);break;case f:i._touchMove(h);break;case e:i._touchEnd(h);break;case"click":i._click(h);break}};d.prototype._touchStart=function(h){var i=this;h.preventDefault();i.isUserInteracting=true;i.onPointerDownPointerX=b(h,"pageX");i.onPointerDownPointerY=b(h,"pageY");i.onPointerDownLon=i.point.lon;i.onPointerDownLat=i.point.lat};d.prototype._touchMove=function(h){var i=this;h.preventDefault();h.stopPropagation();if(i.isUserInteracting){i.point.lon=(i.onPointerDownPointerX-b(h,"pageX"))*0.1+i.onPointerDownLon;i.point.lat=(b(h,"pageY")-i.onPointerDownPointerY)*0.1+i.onPointerDownLat;i.render()}};d.prototype._touchEnd=function(h){var i=this;i.isUserInteracting=false;i.render()};d.prototype._click=function(h){var i=this;h.preventDefault();h.stopPropagation();i.startShow()};d.prototype._loadMaterial=function(l){var j=this;var k=new THREE.Texture(j.viewElement);var i=new THREE.MeshBasicMaterial({map:k,overdraw:true});var h=new Image();h.onload=function(){k.needsUpdate=true;i.map.image=this;j.render()};h.src=l;return i};d.prototype._loadMaterial$Dom=function(k){var o=this;var l=a(k).find("> img");if(l.length>=2){var p=new THREE.Texture(o.viewElement);var m=new THREE.MeshBasicMaterial({map:p,overdraw:true});var n=new Image();n.onload=function(){p.needsUpdate=true;m.map.image=this;o.render()};var i=document.createElement("canvas");i.width=o.options.width;i.height=o.options.height;var j=i.getContext("2d");var h=function(t){if(t>=l.length){return}var q=l[t];var v=a(q).parent();var w=parseInt(a(q).css("top"))||0;var u=parseInt(a(q).css("left"))||0;var x=parseInt(a(q).width());var r=parseInt(a(q).height());var s=new Image();s.src=a(q).attr("src");s.onload=function(){j.drawImage(s,u,w,x,r);var y=i.toDataURL();n.src=y;h(t+1)}};h(0)}else{return o._loadMaterial(l[0].src)}return m};d.prototype.render=function(){var h=this;h.point.lat=Math.max(-85,Math.min(85,h.point.lat));h.point.phi=(90-h.point.lat)*Math.PI/180;var i=h.point.lon*Math.PI/180;h.target.x=500*Math.sin(h.point.phi)*Math.cos(i);h.target.y=500*Math.cos(h.point.phi);h.target.z=500*Math.sin(h.point.phi)*Math.sin(i);h.camera.lookAt(h.target);h.renderer.render(h.scene,h.camera)};d.prototype.startShow=function(){var n=this;if(n.showing){return}var m=window.pageWidth||window.innerWidth;var l=window.pageHeight||window.innerHeight;if(!n.options.fullscreen){n.container=n.dom.find(">.mci-panorama-i >.mci-panorama-con")}else{n.container=a('<div id="panorama_fullscreen"><div class="close"></div></div>').appendTo(a("body"));n.container.css({position:"absolute",top:""+l+"px",left:"0","z-index":"9999",transform:Support.transform3d?"translate3d(0,0,0)":"translate(0,0)"});n.container.find(">.close").on("click",function(){n.close()});setTimeout(function(){n.showing=true;n.container.css({transition:Support.getCSSVal("transform")+" 350ms ease",transform:Support.transform3d?"translate3d(0,-"+l+"px,0)":"translate(0,-"+l+"px)"})},80)}n.viewElement=document.createElement("canvas");n.viewElement.width=(n.options.width==0?m:n.options.width);n.viewElement.height=(n.options.height==0?l:n.options.height);var h=n.viewElement.getContext("2d");h.fillStyle="rgb(200,200,200)";h.fillRect(0,0,n.viewElement.width,n.viewElement.height);n.camera=new THREE.PerspectiveCamera(75,m/l,1,1100);n.scene=new THREE.Scene();n.scene.add(n.camera);n.target=new THREE.Vector3();var j=n.dom.find(">.mci-panorama-i >.mci-panorama-pic");n.point={lon:90,lat:0,phi:0};var k=[n._loadMaterial$Dom(j[3]),n._loadMaterial$Dom(j[2]),n._loadMaterial$Dom(j[4]),n._loadMaterial$Dom(j[5]),n._loadMaterial$Dom(j[1]),n._loadMaterial$Dom(j[0])];n.mesh=new THREE.Mesh(new THREE.CubeGeometry(300,300,300,7,7,7,k),new THREE.MeshFaceMaterial());n.mesh.scale.x=-1;n.scene.add(n.mesh);n.renderer=new THREE.CanvasRenderer();if(n.options.fullscreen){n.renderer.setSize(m,l)}else{n.renderer.setSize(n.options.width,n.options.height)}n.container.append(n.renderer.domElement);var i=null;if(!n.options.fullscreen){i=n.dom[0]}else{i=n.container[0]}i.addEventListener(g,n,false);i.addEventListener(f,n,false);i.addEventListener(e,n,false)};d.prototype.close=function(){var h=this;h.showing=false;h.container.css({transition:Support.getCSSVal("transform")+" 350ms ease",transform:Support.transform3d?"translate3d(0,0,0)":"translate(0,0)"});setTimeout(function(){a(h.container).remove()},350)};window.Panorama=d})(jQuery);(function(a){var c=Support.touch;var g=Support.touchStartEvent;var f=Support.touchMoveEvent;var e=Support.touchEndEvent;var d=function(h){if(!(this instanceof d)){return new d(h)}return this.init(h)};function b(h,i){return c?h.changedTouches[0][i]:h[i]}d.prototype.init=function(i){var h=this;h.options=h.options||{description:"",url:"",eraseEffect:"",allowErase:false,allowShare:false,allowCollect:false,finger:20};h.options=a.extend(h.options,i);h.dom=h.options.dom;h.canvasWrap=h.dom.find(">.mci-picture-canvas");h.canvas=h.canvasWrap.find(">canvas")[0];if(!h.options.dom){throw"setting dom can't be null or undefine";return}h.scrolling=false;if(h.options.eraseEffect!="0"&&h.options.allowErase==true){h._drawImg()}else{h.dom.find(">.mci-picture-i").show();h.dom.css({"pointer-events":"none"})}if(h.options.allowErase==true){h.dom[0].addEventListener(g,h,false);h.dom[0].addEventListener(f,h,false);h.dom[0].addEventListener(e,h,false)}};d.prototype._drawImg=function(){var j=this;var h=j.canvas.getContext("2d");var i=j.dom.find(">.mci-picture-i >img");if(i.length==0){i=j.dom.find(">.mci-picture-i > .text-separated > .sperate-img >img")}a(i).each(function(){var m=a(this).parent();var n=parseInt(a(m).css("top"))||0;var l=parseInt(a(m).css("left"))||0;var k=new Image();k.src=a(this).attr("src");k.onload=function(){h.drawImage(k,l,n)}});j.readyEarse=true};d.prototype.handleEvent=function(h){var i=this;switch(h.type){case"click":break;case g:i._touchStart(h);break;case f:i._touchMove(h);break;case e:i._touchEnd(h);break}};d.prototype._touchStart=function(h){var i=this;if(i.scrolling){return}h.preventDefault();h.stopPropagation();i.startPageX=b(h,"pageX");i.startPageY=b(h,"pageY");i.basePageX=i.startPageX;i.basePageY=i.startPageY;i.scrolling=true;i.moveReady=false};d.prototype._touchMove=function(k){var m=this;if(!m.scrolling){return}var j=m.canvas.getContext("2d");var l=a(m.canvas).offset();var n=b(k,"pageX")-l.left;var o=b(k,"pageY")-l.top;var h=m.options.finger||20;var i=h/2;if(n<i||o<i){return false}j.save();j.arc(n,o,h,0,Math.PI*2,false);j.clip();j.clearRect(n-h-1,o-h-1,h*2+2,h*2+2);j.restore()};d.prototype._touchEnd=function(h){var i=this;i.scrolling=false};window.Picture=d})(jQuery);
/* created by yangyin@mcitech.cn 2012.11.5
*  mci.slideshow.js
* 2012.11.13  yangyin添加幻灯片触发按钮参数
* 2013.02.26 添加scroll惯性效果
* TODO:reset ,hide,show
*
*/
(function(a){var d=function(e){if(!(this instanceof d)){return new d(e)}return this.init(e)};function c(e,f){return Support.touch?e.changedTouches[0][f]:e[f]}function b(f,l,k){var m=this;var i=f;var e=+new Date();var j=parseInt(i.style[l],10);var o=k;var g=350;var h=function(q,p){return -(q/=p)*(q-2)};var n=setInterval(function(){var r=new Date()-e;var q,p;if(r>g){clearInterval(n);p=o}else{q=h(r,g);p=q*(o-j)+j}i.style[l]=p+"px"},10)}d.prototype.init=function(g){var f=this;f.options=f.options||{itemWidth:100,itemHeight:100,itemContainerCls:"> .mci-ss-oh >.mci-ss-w",itemCls:".mci-ss-i",itemCount:0,crossEffectType:"fade",crossEffectTime:500,autoPlay:false,autoPlayInterval:0,clickSupport:false,slideSupport:false,slideDirection:-1,defaultDirection:4,loop:true,loopTime:1,use3d:true,defaultIndex:0,itemChanged:function(h){},syncMoving:function(h){},syncMoveEnd:function(h){}};f.options=a.extend(f.options,g);f.itemIndex=0;f.itemChanged=f.options.itemChanged;f.loopHandler=null;f.loopHandlerCount=0;f.itemChanging=false;f.dom=f.options.dom;f.itemContainerDom=f.dom.find(f.options.itemContainerCls+":first-child");f.itemCount=f.itemContainerDom.children().length;f.scrollerWidth=f.itemCount*f.options.itemWidth;f.scrollerHeight=f.itemCount*f.options.itemHeight;f.scrollWidth=(f.itemCount-1)*f.options.itemWidth;f.scrollHeight=(f.itemCount-1)*f.options.itemHeight;f.isStoped=true;f.currentX=0;f.currentY=0;f.directionX=0;f.directionY=0;if(f.options.defaultIndex>=0){f.itemIndex=f.options.defaultIndex;if(f.options.defaultDirection==2||f.options.defaultDirection==3){f.itemIndex=f.itemCount-1-f.options.defaultIndex}}if(f.options.crossEffectType=="scroll"||f.options.crossEffectType=="slide"){var e=0;switch(f.options.defaultDirection){case 1:e=f.options.defaultIndex*f.options.itemHeight;f._setY(-e);break;case 2:e=(f.itemCount-f.options.defaultIndex-1)*f.options.itemWidth;f._setX(-e);break;case 3:e=(f.itemCount-f.options.defaultIndex-1)*f.options.itemHeight;f._setY(-e);break;case 4:e=f.options.defaultIndex*f.options.itemWidth;f._setX(-e);break;default:e=f.options.defaultIndex*f.options.itemWidth;f._setX(-e);break}if(f.options.slideDirection==-1){f._setItemContainerStyle({width:f.options.itemWidth*f.itemCount+"px",height:f.options.itemHeight+"px"})}else{f._setItemContainerStyle({height:f.options.itemHeight*f.itemCount+"px",width:f.options.itemWidth+"px"})}}else{f._setItemContainerStyle({width:f.options.itemWidth+"px",height:f.options.itemHeight+"px"})}if(f.options.crossEffectType=="none"){switch(f.options.defaultDirection){case 2:e=(f.itemCount-f.options.defaultIndex-1)*f.options.itemWidth;f._setX(-e);break;case 3:e=(f.itemCount-f.options.defaultIndex-1)*f.options.itemHeight;f._setY(-e);break}}if(f.options.crossEffectType=="flip"){f.itemIndex=f.options.defaultIndex}return f};d.prototype.hasNext=function(){var e=this;if(e.itemIndex<e.itemCount-1){return true}return false};d.prototype.hasPrev=function(){var e=this;if(e.itemIndex>0){return true}return false};d.prototype.goToNext=function(){var e=this;var f=0;if(e.hasNext()){f=e.itemIndex+1}e.goToItem(f);if(e.options.crossEffectType!="none"){e._triggerSyncEnd(f/(e.itemCount-1),e.options.crossEffectTime)}};d.prototype.goToPrev=function(){var e=this;var f=0;if(e.hasPrev()){f=e.itemIndex-1;e.goToItem(f)}else{f=e.itemCount-1;e.goToItem(f)}if(e.options.crossEffectType!="none"){e._triggerSyncEnd(f/(e.itemCount-1),e.options.crossEffectTime)}};d.prototype.goToItem=function(f){var e=this;if(e.itemChanging){return false}switch(e.options.crossEffectType){case"fade":e._fade(f);break;case"slide":e._slide(f);break;case"fly":e._zoomIn(f);break;case"fall":e._zoomOut(f);break;case"null":e._nothing(f);break;case"flip":e._flip(f);break;case"none":e._acceler(f);break;case"scroll":e._scroll(f);break;default:break}};d.prototype.goToState=function(j){var h=this;if(j=="next"){h.goToNext()}else{if(j=="previous"){h.goToPrev()}else{if(j===0){h.goToItem(0);if(h.options.crossEffectType!="none"){h._triggerSyncEnd(f/(h.itemCount-1),h.options.crossEffectTime)}return}var f=h.itemContainerDom.children("#"+j).index();if(f==-1&&j.indexOf(" ")>=0){var g=h.itemContainerDom.children();for(var e=0;e<g.length;e++){if(g[e].id==j){f=e;break}}}if(f!=-1){h.goToItem(f);if(h.options.crossEffectType!="none"){h._triggerSyncEnd(f/(h.itemCount-1),h.options.crossEffectTime)}}}}};d.prototype._fade=function(g){var f=this;if(g<0){g=f.itemCount-1}else{if(g>f.itemCount-1){g=0}}f.itemChanging=false;f.currentX=-g*f.options.itemWidth;var e=f.dom.find(f.options.itemContainerCls).children();if(f._itemIndex){e.eq(f._itemIndex).stop(true,true)}e.eq(f.itemIndex).stop(true,true).fadeOut(f.options.crossEffectTime);e.eq(g).stop(true,true).fadeIn(f.options.crossEffectTime,function(){f._changeItemIndex(g)});f._itemIndex=g};d.prototype._slide=function(f){var e=this;if(f<0){if(e.options.loop==true){f=e.itemCount-1}else{f=0}}else{if(f>e.itemCount-1){if(e.options.loop==true){f=0}else{f=e.itemCount-1}}}if(f>=0&&f<=e.itemCount-1){e.itemChanging=true;e._setTransition(true);if(e.options.slideDirection==-1){e._setX(-f*e.options.itemWidth)}else{e._setY(-f*e.options.itemHeight)}if(f!=undefined&&f!=e.itemIndex){setTimeout(function(){e._changeItemIndex(f)},e.options.crossEffectTime)}else{e.itemChanging=false}}};d.prototype._scroll=function(f){var e=this;if(f<0){if(e.options.loop==true){f=e.itemCount-1}else{f=0}}else{if(f>e.itemCount-1){if(e.options.loop==true){f=0}else{f=e.itemCount-1}}}if(f>=0&&f<=e.itemCount-1){e.itemChanging=true;e._setTransition(true);if(e.options.slideDirection==-1){e._setX(-f*e.options.itemWidth)}else{e._setY(-f*e.options.itemHeight)}if(f!=undefined&&f!=e.itemIndex){setTimeout(function(){e._changeItemIndex(f)},e.options.crossEffectTime)}else{e.itemChanging=false}}};d.prototype._zoomIn=function(h){var g=this;if(h<0){h=g.itemCount-1}if(h>g.itemCount-1){h=0}if(g.options.slideDirection==-1){g.currentX=-h*g.options.itemWidth}else{g.currentY=-h*g.options.itemHeight}if(g._itemIndex!=undefined){g.itemIndex=g._itemIndex}if(g.itemIndex==h){return}g.itemChanging=true;var f=g.dom.find(g.options.itemContainerCls+":first-child").children();var e=g.options.crossEffectTime/2;f.eq(g.itemIndex).css({transition:Support.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease"});f.eq(g.itemIndex).css({opacity:"0",transform:"scale(2)"});f.eq(h).css({transition:Support.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease",display:"block",transform:"scale(0)"});setTimeout(function(){f.eq(g.itemIndex).css({transition:"",display:"none",transform:"scale(0)"});f.eq(h).css({opacity:"1",transform:"scale(1)",display:"block"});g._changeItemIndex(h)},e);g._itemIndex=h};d.prototype._zoomOut=function(h){var g=this;if(h<0){h=g.itemCount-1}if(h>g.itemCount-1){h=0}if(g.options.slideDirection==-1){g.currentX=-h*g.options.itemWidth}else{g.currentY=-h*g.options.itemHeight}if(g._itemIndex!=undefined){g.itemIndex=g._itemIndex}if(g.itemIndex==h){return}g.itemChanging=true;var f=g.dom.find(g.options.itemContainerCls+":first-child").children();var e=g.options.crossEffectTime;f.eq(g.itemIndex).css({transition:Support.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease"});f.eq(g.itemIndex).css({opacity:"0",transform:"scale(0)"});f.eq(h).css({opacity:"0",display:"block",transform:"scale(2)"});setTimeout(function(){f.eq(g.itemIndex).css({transition:"",display:"none",transform:"scale(0)"});f.eq(h).css({transition:Support.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease",opacity:"1",transform:"scale(1)",display:"block"});g._changeItemIndex(h)},e);g._itemIndex=h};d.prototype._flip=function(k){var i=this;if(k<0){k=i.itemCount-1}if(k>i.itemCount-1){k=0}if(i.options.slideDirection==-1){i.currentX=-k*i.options.itemWidth}else{i.currentY=-k*i.options.itemHeight}if(i._itemIndex!=undefined){i.itemIndex=i._itemIndex}if(i.itemIndex==k){return}i.itemChanging=true;var h=i.itemContainerDom.children();if(i.flipRotated==undefined){i.flipRotated=0}var f=h.eq(k);var g=h.eq(i.itemIndex);var e=i.options.crossEffectTime;if(Support.transform3d&&!a.browser.msie){if(i.options.slideDirection==-1){f.css({display:"block",transform:"rotateY("+(i.flipRotated+180)+"deg)",transition:""});if((i.options.defaultDirection==2&&k>i.itemIndex)||(i.options.defaultDirection==4&&k<i.itemIndex)){f.css({transform:"rotateY("+(i.flipRotated-180)+"deg)"});i.flipRotated=i.flipRotated-180}else{i.flipRotated=i.flipRotated+180}i.itemContainerDom.css({transition:Support.getCSSVal("transform")+" "+e+"ms ease",transform:"perspective(800px) rotateY("+i.flipRotated+"deg)"})}else{f.css({display:"block",transform:"rotateX("+(i.flipRotated+180)+"deg)",transition:""});if((i.options.defaultDirection==3&&k>i.itemIndex)||(i.options.defaultDirection==1&&k<i.itemIndex)){f.css({transform:"rotateX("+(i.flipRotated-180)+"deg)"});i.flipRotated=i.flipRotated-180}else{i.flipRotated=i.flipRotated+180}i.itemContainerDom.css({transition:Support.getCSSVal("transform")+" "+e+"ms ease",transform:"perspective(800px) rotateX("+i.flipRotated+"deg)"})}}else{var j=1;if(i.options.slideDirection==-1){if((i.options.defaultDirection==2&&k>i.itemIndex)||(i.options.defaultDirection==4&&k<i.itemIndex)){j=-1}f.css({transform:"skewY("+(50*j)+"deg) scale(0,1)",transition:""});g.css({transform:"skewY("+(50*j)+"deg) scale(0,1)",transition:Support.getCSSVal("transform")+" "+e/2+"ms ease"});setTimeout(function(){f.css({display:"block",transform:"skewY(0deg) scale(1,1)",transition:Support.getCSSVal("transform")+" "+e/2+"ms ease"})},e/2+1)}else{if((i.options.defaultDirection==3&&k>i.itemIndex)||(i.options.defaultDirection==1&&k<i.itemIndex)){j=-1}f.css({transform:"skewX("+(50*j)+"deg) scale(1,0)",transition:""});g.css({transform:"skewX("+(50*j)+"deg) scale(1,0)",transition:Support.getCSSVal("transform")+" "+e/2+"ms ease"});setTimeout(function(){f.css({display:"block",transform:"skewX(0deg) scale(1,1)",transition:Support.getCSSVal("transform")+" "+e/2+"ms ease"})},e/2+1)}}setTimeout(function(){g.css({display:"none"});i._changeItemIndex(k)},e+5);i._itemIndex=k};d.prototype._nothing=function(g){var f=this;if(g<0){g=f.itemCount-1}if(g>f.itemCount-1){g=0}f.itemChanging=true;if(f.options.slideDirection==-1){f.currentX=-g*f.options.itemWidth}else{f.currentY=-g*f.options.itemHeight}var e=f.dom.find(f.options.itemContainerCls).children();e.eq(f.itemIndex).css({display:"none"});e.eq(g).css({display:"block"});f._changeItemIndex(g)};d.prototype._acceler=function(m){var k=this;var g=Math.floor(k.options.itemWidth/(k.itemCount*2));if(!k._goToItemEvent){return}var i=k._goToItemEvent.moved;var h=k._momentum(k._goToItemEvent.moved,k.duration);i=h.dist+i;var f=Math.floor(Math.abs(i)/g);k.itemChanging=true;if(f==0&&Math.abs(i)>0){f++}var l=(h.time)/(f+1);var j=k.itemIndex;function e(){if(f==0||k.scrolling==true){k.itemChanging=false;k._changeItemIndex(j);return}f--;var n=k._goToItemEvent.direction+j;if((k.options.slideDirection==-1&&k.options.defaultDirection==2)||(k.options.slideDirection==1&&k.options.defaultDirection==3)){n=-1*k._goToItemEvent.direction+j}if(n<0){if(k.options.loop){n=k.itemCount-1}else{return}}else{if(n>k.itemCount-1){if(k.options.loop){n=0}else{return}}}if(k.options.slideDirection==-1){k.currentX=-n*k.options.itemWidth}else{k.currentY=-n*k.options.itemHeight}var o=k.dom.find(k.options.itemContainerCls).children();o.eq(j).css({display:"none"});o.eq(n).css({display:"block"});k.itemIndex=j=n;setTimeout(function(){e()},l)}if(f>0){e()}else{k.itemChanging=false}};d.prototype._changeItemIndex=function(h){var g=this;var e={fromItem:g.itemIndex,toItem:h};var f=g.dom.find(g.options.itemContainerCls).children();e.fromId=f.eq(e.fromItem).attr("id");e.toId=f.eq(e.toItem).attr("id");e.targetControlId=g.dom.attr("id");g.itemIndex=h;g.itemChanging=false;if(a.isFunction(g.itemChanged)){g.itemChanged(e)}if(e.fromId!=e.toId){g._startChildControl()}};d.prototype._setTransition=function(e){var f=this;if(e){f._setItemContainerStyle({transition:Support.getCSSVal("transform")+" "+f.options.crossEffectTime+"ms ease"})}else{f._setItemContainerStyle({transition:""})}};d.prototype._setX=function(q){var o=this;if(o.options.crossEffectType=="none"){var m=o.accMoving;if(Math.abs(m-o.accMoved)>=(o.options.itemWidth*0.65/o.itemCount)){var k=m-o.accMoved<0?1:-1;if(o.options.defaultDirection==2){if((m-o.accMoved)>0){k=1}else{k=-1}}var h=o.itemIndex+k;if(h<0){if(o.options.loop){h=o.itemCount-1}else{return}}else{if(h>o.itemCount-1){if(o.options.loop){h=0}else{return}}}o.accMoved=m;o._nothing(h)}return}var l=o.currentX;o.currentX=q;if(o.options.loop==true&&o.itemCount>1&&(o.currentX!=l)){var j=o.itemContainerDom.children();if(o.directionX>0){var g=j.eq((o.itemIndex%o.itemCount)).index();if(o.currentX<(-o.options.itemWidth*o.options.itemCount-1)&&g==o.itemCount-1){var e=j.eq(0);e.remove();a(o.itemContainerDom).append(e);o.itemIndex=o.itemIndex-1;o.currentX=parseInt(o.currentX)+parseInt(o.options.itemWidth)}}else{if(o.directionX<0){var g=j.eq((o.itemIndex%o.itemCount)).index();if(o.currentX>0&&g==0){var f=j.eq(o.itemCount-1);f.remove();a(o.itemContainerDom).prepend(f);o.itemIndex=o.itemIndex+1;o.currentX=o.currentX-o.options.itemWidth}}}}if(o.options.use3d){o._setItemContainerStyle({transform:o._getTranslate(o.currentX,0,0)})}else{b(o.itemContainerDom[0],"left",o.currentX)}if(o.options.crossEffectType=="scroll"){var n=Math.abs(o.currentX)%o.options.itemWidth;var i=parseInt(Math.abs(q)/o.options.itemWidth,10);if(n>=(o.options.itemWidth*0.5)){i=i+1}var p=i;if(o.itemIndex!=p){o._changeItemIndex(p)}}};d.prototype.scrollTo=function(j,k,h){var g=this;g.currentX=j;g.currentY=k;if(g.options.use3d){g._setItemContainerStyle({transform:g._getTranslate(j,k,0),transition:Support.getCSSVal("transform")+" "+h+"ms ease"})}else{g.itemContainerDom.animate({left:j+"px",top:k+"px"},h)}if(g.options.crossEffectType=="scroll"){var f=0,e=0,i=0;if(g.options.slideDirection==-1){f=Math.abs(g.currentX)%g.options.itemWidth;e=parseInt(Math.abs(g.currentX)/g.options.itemWidth,10);if(f>=(g.options.itemWidth*0.5)){e=e+1}i=e;if(g.itemIndex!=i){setTimeout(function(){g._changeItemIndex(i)},h)}}else{if(g.options.slideDirection==1){f=Math.abs(g.currentY)%g.options.itemHeight;e=parseInt(Math.abs(g.currentY)/g.options.itemHeight,10);if(f>=(g.options.itemHeight*0.5)){e=e+1}i=e;if(g.itemIndex!=i){setTimeout(function(){g._changeItemIndex(i)},h)}}}}};d.prototype._setY=function(q){var o=this;if(o.options.crossEffectType=="none"){var m=o.accMoving;if(Math.abs(o.accMoving-o.accMoved)>=(o.options.itemHeight*0.65/o.itemCount)){var k=(m-o.accMoved)<0?1:-1;if(o.options.defaultDirection==3){if((m-o.accMoved)>0){k=1}else{k=-1}}var h=o.itemIndex+k;if(h<0){if(o.options.loop){h=o.itemCount-1}else{return}}else{if(h>o.itemCount-1){if(o.options.loop){h=0}else{return}}}o.accMoved=m;o._nothing(h)}return}var l=o.currentY;o.currentY=q;if(o.options.loop==true&&o.itemCount>1&&(o.currentY!=l)){var j=o.itemContainerDom.children();if(o.directionY>0){var g=j.eq((o.itemIndex%o.itemCount)).index();if(o.currentY<(-o.options.itemHeight*o.options.itemCount-1)&&g==o.itemCount-1){var e=j.eq(0);e.remove();a(o.itemContainerDom).append(e);o.itemIndex=o.itemIndex-1;o.currentY=parseInt(o.currentY)+parseInt(o.options.itemHeight)}}else{if(o.directionY<0){var g=j.eq((o.itemIndex%o.itemCount)).index();if(o.currentY>0&&g==0){var f=j.eq(o.itemCount-1);f.remove();a(o.itemContainerDom).prepend(f);o.itemIndex=o.itemIndex+1;o.currentY=o.currentY-o.options.itemHeight}}}}if(o.options.use3d){o._setItemContainerStyle({transform:o._getTranslate(0,o.currentY,0)})}else{b(o.itemContainerDom[0],"top",o.currentY)}if(o.options.crossEffectType=="scroll"){var n=Math.abs(o.currentY)%o.options.itemHeight;var i=parseInt(Math.abs(o.currentY)/o.options.itemHeight,10);if(n>=(o.options.itemHeight*0.5)){i=i+1}var p=i;if(o.itemIndex!=p){o._changeItemIndex(p)}}};d.prototype._setItemContainerStyle=function(e){var f=this;if(e){f.itemContainerDom.css(e)}};d.prototype._getTranslate=function(f,g,h){var e=this;var f=f||"0";var g=g||"0";var h=h||"0";return Support.transform3d?"translate3d("+f+"px, "+g+"px, "+h+"px)":"translate("+f+"px, "+g+"px)"};d.prototype._itemClick=function(f){var g=this;var h=0;if(!g.options.clickSupport){return}if(g.hasNext()){h=g.itemIndex+1}f.stopPropagation();f.preventDefault();switch(g.options.crossEffectType){case"fade":g.goToItem(h);break;case"slide":g.goToItem(h);break;case"fly":g.goToItem(h);break;case"fall":g.goToItem(h);break;case"null":g.goToItem(h);break;case"flip":g.goToItem(h);break;default:break}if(h>=0&&h<=g.itemCount-1){g._triggerSyncEnd(h/(g.itemCount-1),g.options.crossEffectTime)}};d.prototype._touchStart=function(f){var g=this;if(g.scrolling){return}if(!g.moveReadyEnable){f.preventDefault();f.stopPropagation()}g.startPageX=c(f,"pageX");g.startPageY=c(f,"pageY");g.basePageX=g.startPageX;g.basePageY=g.startPageY;g.accMoving=0;g.accMoved=0;g.scrolling=true;g.moveReady=false;g.duration=0;g.timeStamp=f.timeStamp||(new Date()).getTime();g._setTransition(false)};d.prototype._touchMove=function(h){var r=this;if(!r.scrolling){return}var p=c(h,"pageX"),q=c(h,"pageY"),f=0,g=0,l=0,m=0;var n=0,o=0;if(r.moveReady){h.preventDefault();h.stopPropagation();f=p-r.basePageX;g=q-r.basePageY;if(r.options.slideDirection==-1){r.accMoving=r.accMoving+f;n=r.currentX+f;r.directionX=f===0?r.directionX:(f>0?-1:1);if(r.options.crossEffectType=="scroll"){var j=(r.itemCount-1)*r.options.itemWidth;if(n>0){n=0}if(Math.abs(n)>j){n=-j}r._setX(n);if(a.isFunction(r.options.syncMoving)){var s={};s.relativePosition=Math.abs(r.currentX)/r.scrollWidth;if(r.options.defaultDirection==2){s.relativePosition=(r.scrollWidth-Math.abs(r.currentX))/r.scrollWidth}s.syncTo=r.options.syncTo;s.syncFrom=r.options.syncFrom;s.direction=0;s.type=0;r.options.syncMoving(s)}}else{if(r.moveReadyEnable){r._setX(n);if(a.isFunction(r.options.syncMoving)){var s={};s.relativePosition=Math.abs(r.currentX)/r.scrollWidth;if(r.options.defaultDirection==2&&r.options.crossEffectType!="flip"){s.relativePosition=(r.scrollWidth-Math.abs(r.currentX))/r.scrollWidth}s.syncTo=r.options.syncTo;s.syncFrom=r.options.syncFrom;s.type=1;s.direction=0;r.options.syncMoving(s)}}}}else{if(r.options.slideDirection==1){o=r.currentY+g;r.accMoving=r.accMoving+g;r.directionY=g===0?r.directionY:(g>0?-1:1);if(r.options.crossEffectType=="scroll"){var k=(r.itemCount-1)*r.options.itemHeight;if(o>0){o=0}if(Math.abs(o)>k){o=-k}var i=r.currentY;r._setY(o);if(a.isFunction(r.options.syncMoving)){var s={};s.relativePosition=Math.abs(r.currentY)/r.scrollHeight;s.dist=g/r.scrollerHeight;s.slideDirection=r.directionY;if(r.options.defaultDirection==3){s.relativePosition=(r.scrollHeight-Math.abs(r.currentY))/r.scrollHeight;s.dist=-1*s.dist;s.slideDirection=-1*s.slideDirection}s.syncTo=r.options.syncTo;s.syncFrom=r.options.syncFrom;s.direction=0;s.type=0;r.options.syncMoving(s)}}else{if(r.moveReadyEnable){r._setY(o);if(a.isFunction(r.options.syncMoving)){var s={};s.dist=g/r.scrollerHeight;s.slideDirection=r.directionY;s.relativePosition=Math.abs(r.currentY)/r.scrollHeight;if(r.options.defaultDirection==3&&r.options.crossEffectType!="flip"){s.relativePosition=(r.scrollHeight-Math.abs(r.currentY))/r.scrollHeight;s.dist=-1*s.dist;s.slideDirection=-1*s.slideDirection}s.syncTo=r.options.syncTo;s.syncFrom=r.options.syncFrom;s.type=1;s.direction=0;r.options.syncMoving(s)}}}}}}else{l=Math.abs(p-r.startPageX);m=Math.abs(q-r.startPageY);if(r.options.slideDirection==-1){if(l>5&&l>m){if(!r._canMoved(p-r.startPageX,r.options.slideDirection)){return}h.preventDefault();h.stopPropagation();r.moveReady=true}}else{if(r.options.slideDirection==1){if(m>5&&m>l){if(!r._canMoved(q-r.startPageY,r.options.slideDirection)){return}h.preventDefault();h.stopPropagation();r.moveReady=true}}}}var t=h.timeStamp||(new Date()).getTime();r.basePageX=p;r.basePageY=q};d.prototype._touchEnd=function(f){var i=this;if(!i.scrolling){return}i.scrolling=false;if(!i.moveReady){return}i.duration=(f.timeStamp||(new Date()).getTime())-i.timeStamp;i.scrolling=false;var g={};if(i.options.slideDirection==-1){g.slideDirection=-1;g.direction=0;g.moved=(i.basePageX-i.startPageX);if(g.moved>0){g.direction=-1}else{if(g.moved<0){g.direction=1}}}else{if(i.options.slideDirection==1){g.slideDirection=1;g.direction=0;var h=0;var j=i.options.itemHeight;g.moved=(i.basePageY-i.startPageY);if(g.moved>0){g.direction=-1}else{if(g.moved<0){g.direction=1}}}}g.duration=i.duration;i._setTransition(true);i._touchEndHandler(g)};d.prototype._canMoved=function(f,e){var g=this;if(g.options.loop==true){return true}if(e==1){if(Math.abs(g.currentY)>=(g.itemCount-1)*g.options.itemHeight&&f<0){return false}else{if(f>0&&g.currentY>=0){return false}}}if(e==-1){if(Math.abs(g.currentX)>=(g.itemCount-1)*g.options.itemWidth&&f<0){return false}else{if(f>0&&g.currentX>=0){return false}}}return true};d.prototype._syncStateMove=function(f){var i=this;var g=0;if(f.type==0){if(i.options.slideDirection==-1){var k=-i.scrollWidth*f.relativePosition;if(i.options.defaultDirection==2&&i.options.crossEffectType!="flip"){k=-i.scrollWidth+i.scrollWidth*f.relativePosition}var h=Math.abs(k)%i.options.itemWidth;g=parseInt(Math.abs(k)/i.options.itemWidth,10);if(h>=(i.options.itemWidth*0.5)){g=g+1}if(g!=i.itemIndex){i.itemChanging=false;i._setTransition(false);i.goToItem(g)}}else{var l=-i.scrollHeight*f.relativePosition;if(i.options.defaultDirection==3&&i.options.crossEffectType!="flip"){l=-i.scrollHeight+i.scrollHeight*f.relativePosition}var h=Math.abs(l)%i.options.itemHeight;g=parseInt(Math.abs(l)/i.options.itemHeight,10);if(h>=(i.options.itemHeight*0.5)){g=g+1}if(g!=i.itemIndex){i.itemChanging=false;i._setTransition(false);i.goToItem(g)}}}var j={};a.extend(j,f);j.syncTo="";j.syncFrom="";if(f.direction==1){j.syncTo=i.options.syncTo;i.options.syncMoving(j)}if(f.direction==-1){j.syncFrom=i.options.syncFrom;i.options.syncMoving(j)}};d.prototype._syncMove=function(f){var g=this;if(g.options.crossEffectType=="scroll"||(g.options.crossEffectType=="slide"&&f.type==1)){g._setTransition(false);if(g.options.slideDirection==-1){var i=-g.scrollWidth*f.relativePosition;if(g.options.defaultDirection==2){i=-g.scrollWidth+g.scrollWidth*f.relativePosition}if(f.dist!=undefined&&g.options.loop==true){if(g.options.defaultDirection==2){g.directionX=-1*f.slideDirection;g._setX(g.currentX-f.dist*g.scrollerWidth)}else{g.directionX=f.slideDirection;g._setX(g.currentX+f.dist*g.scrollerWidth)}}else{g._setX(i)}var h={};a.extend(h,f);h.syncTo="";h.syncFrom="";if(f.direction==1){h.syncTo=g.options.syncTo;g.options.syncMoving(h)}if(f.direction==-1){h.syncFrom=g.options.syncFrom;g.options.syncMoving(h)}}else{if(g.options.slideDirection==1){var j=-g.scrollHeight*f.relativePosition;if(g.options.defaultDirection==3){j=-g.scrollHeight+g.scrollHeight*f.relativePosition}if(f.dist!=undefined&&g.options.loop==true){if(g.options.defaultDirection==3){g.directionY=-1*f.slideDirection;g._setY(g.currentY-f.dist*g.scrollerHeight)}else{g.directionY=f.slideDirection;g._setY(g.currentY+f.dist*g.scrollerHeight)}}else{g._setY(j)}var h={};a.extend(h,f);h.syncTo="";h.syncFrom="";if(f.direction!=-1){h.syncTo=g.options.syncTo;g.options.syncMoving(h)}if(f.direction!=1){h.syncFrom=g.options.syncFrom;g.options.syncMoving(h)}}}}else{g._syncStateMove(f)}};d.prototype._syncStateEnd=function(f){var i=this;var g=0;if(i.options.slideDirection==-1){var k=-i.scrollWidth*f.relativePosition;if(i.options.defaultDirection==2&&i.options.crossEffectType!="flip"){k=-i.scrollWidth+i.scrollWidth*f.relativePosition}var h=Math.abs(k)%i.options.itemWidth;g=parseInt(Math.abs(k)/i.options.itemWidth,10);if(h>=(i.options.itemWidth*0.5)){g=g+1}if(g*i.options.itemWidth!=Math.abs(i.currentX)){i.itemChanging=false;i._setTransition(false);i.goToItem(g)}}else{if(i.options.slideDirection==1){var l=-i.scrollHeight*f.relativePosition;if(i.options.defaultDirection==3&&i.options.crossEffectType!="flip"){l=-i.scrollHeight+i.scrollHeight*f.relativePosition}var h=Math.abs(l)%i.options.itemHeight;g=parseInt(Math.abs(l)/i.options.itemHeight,10);if(h>=(i.options.itemHeight*0.5)){g=g+1}if(g*i.options.itemHeight!=Math.abs(i.currentY)){i.itemChanging=false;i._setTransition(false);i.goToItem(g)}}}var j={};a.extend(j,f);j.syncTo="";j.syncFrom="";if(f.direction!=-1){j.syncTo=i.options.syncTo;i.options.syncMoveEnd(j)}if(f.direction!=1){j.syncFrom=i.options.syncFrom;i.options.syncMoveEnd(j)}};d.prototype._syncEnd=function(f){var g=this;if(g.options.crossEffectType=="scroll"){if(g.options.slideDirection==-1){var i=-g.scrollWidth*f.relativePosition;if(g.options.defaultDirection==2){i=-g.scrollWidth+g.scrollWidth*f.relativePosition}g.scrollTo(i,0,f.time);var h={};a.extend(h,f);h.syncTo="";h.syncFrom="";if(f.direction!=-1){h.syncTo=g.options.syncTo;g.options.syncMoveEnd(h)}if(f.direction!=1){h.syncFrom=g.options.syncFrom;g.options.syncMoveEnd(h)}}else{if(g.options.slideDirection==1){var j=-g.scrollHeight*f.relativePosition;if(g.options.defaultDirection==3){j=-g.scrollHeight+g.scrollHeight*f.relativePosition}g.scrollTo(0,j,f.time);var h={};a.extend(h,f);h.syncTo="";h.syncFrom="";if(f.direction!=-1){h.syncTo=g.options.syncTo;g.options.syncMoveEnd(h)}if(f.direction!=1){h.syncFrom=g.options.syncFrom;g.options.syncMoveEnd(h)}}}}else{g._syncStateEnd(f)}};d.prototype._momentum=function(f,j){var e=0.0006,i=Math.abs(f)/j,g=(i*i)/(2*e);var h=i/e;return{dist:g,time:h}};d.prototype._momentum2=function(f,m,h,g){var e=0.0006,l=Math.abs(f)/m,i=(l*l)/(2*e),j=0,k=0;if(f>0&&i>h){l=l*h/i;i=h}else{if(f<0&&i>g){l=l*g/i;i=g}}i=i*(f<0?-1:1);j=l/e;return{dist:Math.round(i),time:Math.round(j)}},d.prototype._touchEndHandler=function(f){var k=this;if(k.options.crossEffectType=="scroll"){k.scrolling=false;if(f.duration>=300){return}var j=0;var e=f.moved;var h=0,g=0;if(k.options.slideDirection==-1){if(Math.abs(k.currentX)==(k.itemCount-1)*k.options.itemWidth){e=0}h=-k.currentX;g=k.currentX+k.scrollerWidth-k.options.itemWidth}else{if(k.options.slideDirection==1){if(Math.abs(k.currentY)==(k.itemCount-1)*k.options.itemHeight){e=0}h=-k.currentY;g=k.currentY+k.scrollerHeight-k.options.itemHeight}else{return}}var i=k._momentum2(e,f.duration,h,g);if(e!=0){var l={};l.syncTo=k.options.syncTo;l.syncFrom=k.options.syncFrom;l.direction=0;l.type=0;if(k.options.slideDirection==-1){k.scrollTo(k.currentX+i.dist,0,i.time);l.relativePosition=Math.abs(k.currentX)/k.scrollWidth;if(k.options.defaultDirection==2){l.relativePosition=(k.scrollWidth-Math.abs(k.currentX))/k.scrollWidth}l.time=i.time;k.options.syncMoveEnd(l)}else{if(k.options.slideDirection==1){k.scrollTo(0,k.currentY+i.dist,i.time);l.relativePosition=Math.abs(k.currentY)/k.scrollHeight;if(k.options.defaultDirection==3){l.relativePosition=(k.scrollHeight-Math.abs(k.currentY))/k.scrollHeight}l.time=i.time;k.options.syncMoveEnd(l)}}}return}if(k.options.crossEffectType=="none"){k.scrolling=false;k._goToItemEvent=f;k.goToItem(k.itemIndex+1);return}if(k.options.crossEffectType=="slide"){var m=k.itemIndex;if(f.slideDirection==-1){if(Math.abs(f.moved)>=50){m=m+f.direction}}else{if(Math.abs(f.moved)>=50){m=m+f.direction}}k.goToItem(m);if(k.options.slideDirection==-1){k._triggerSyncEnd(Math.abs(k.currentX)/k.scrollWidth,k.options.crossEffectTime)}else{if(k.options.slideDirection==1){k._triggerSyncEnd(Math.abs(k.currentY)/k.scrollHeight,k.options.crossEffectTime)}}return}k.goToItem(k.itemIndex+1);if(k.options.crossEffectType!="none"){k._triggerSyncEnd((k.itemIndex+1)/(k.itemCount-1),k.options.crossEffectTime)}};d.prototype._triggerSyncEnd=function(e,h){var f=this;var g={};g.syncTo=f.options.syncTo;g.syncFrom=f.options.syncFrom;g.direction=0;g.type=1;g.relativePosition=e;if(f.options.defaultDirection==2||f.options.defaultDirection==3){if(f.options.crossEffectType!="flip"){g.relativePosition=1-e}}g.time=h;f.options.syncMoveEnd(g)};d.prototype.handleEvent=function(e){var f=this;switch(e.type){case Support.touchStartEvent:f._touchStart(e);break;case Support.touchMoveEvent:f._touchMove(e);break;case Support.touchEndEvent:f._touchEnd(e);break;case"click":f._itemClick(e);break;case Support.mouseOut:f._touchEnd(e);break}};d.prototype.start=function(){var f=this;if(!f.isStoped){return true}f.moveReadyEnable=true;if(f.options.crossEffectType=="fly"||f.options.crossEffectType=="fade"||f.options.crossEffectType=="fall"||f.options.crossEffectType=="flip"){f.moveReadyEnable=false}if(f.options.crossEffectType=="null"){f.moveReadyEnable=false}if(f.options.slideSupport){f.dom[0].addEventListener(Support.touchStartEvent,f,false);f.dom[0].addEventListener(Support.touchMoveEvent,f,false);f.dom[0].addEventListener(Support.touchEndEvent,f,false);if(!Support.touch){f.dom[0].addEventListener(Support.mouseOut,f,false)}}if(f.options.clickSupport){f.dom[0].addEventListener("click",f,false)}if(!f.options.clickSupport&&!f.options.slideSupport){f.dom.css({"pointer-events":"none"});f.dom.find(">.mci-ss-oh").css({"pointer-events":"none"});f.dom.find(">.mci-ss-oh >.mci-ss-w").css({"pointer-events":"none"});f.itemContainerDom.find(f.options.itemCls).css({"pointer-events":"none"})}else{f.dom.css({"pointer-events":"auto",cursor:"pointer"})}var e=f.options.autoPlayInterval+f.options.crossEffectTime;if(f.options.autoPlay==true){setTimeout(function(){f.loopHandlerCount=1;f.loopHandler=setInterval(function(){if(f.options.loopTime!=-1){if(f.loopHandlerCount>=f.options.loopTime*f.itemCount){clearInterval(f.loopHandler);return}}if(f.options.defaultDirection==2||f.options.defaultDirection==3){f.goToPrev()}else{f.goToNext()}f.loopHandlerCount=f.loopHandlerCount+1},e)},f.options.autoPlayDelay||1000)}if(a.isFunction(f.options.startedHanlder)){f.options.startedHanlder(this)}f._startChildControl()};d.prototype._startChildControl=function(){var h=this;var f=a(h.itemContainerDom).children().eq(h.itemIndex).attr("id");if(h.childControl){var e=h.childControl;for(var g in e){if(e[g].options.boundTargetRes==f&&a.isFunction(e[g].start)){if(!e[g].isRunning){e[g].start();e[g].isRunning=true}}}}};d.prototype.stop=function(){var e=this;e.dom[0].removeEventListener("click",e);if(e.loopHandler!=undefined){clearInterval(e.loopHandler)}if(e.options.slideSupport){e.dom[0].removeEventListener(Support.touchStartEvent,e);e.dom[0].removeEventListener(Support.touchMoveEvent,e);e.dom[0].removeEventListener(Support.touchEndEvent,e)}e.isStoped=true;e.isPlay=false};d.prototype.play=function(){var f=this;if(f.isPlay==true){return}f.isPlay=true;var e=f.options.autoPlayInterval+f.options.crossEffectTime;if(f.options.loopTime>=1||f.options.loop==true){setTimeout(function(){f.loopHandlerCount=1;f.loopHandler=setInterval(function(){if(f.options.loopTime!=-1){if(f.loopHandlerCount>=f.options.loopTime*f.itemCount){clearInterval(f.loopHandler);return}}if(f.options.defaultDirection==2||f.options.defaultDirection==3){f.goToPrev()}else{f.goToNext()}f.loopHandlerCount=f.loopHandlerCount+1},e)},f.options.autoPlayDelay||1000)}};d.prototype.reset=function(){var e=this;if(e.itemIndex!=e.options.defaultIndex){e.goToItem(e.options.defaultIndex)}};window.SlideShow=d})(jQuery);(function(a){var b=function(c){if(!(this instanceof b)){return new b(c)}return this.init(c)};b.prototype.init=function(d){var c=this;c.options=c.options||{autoPlay:false,autoStop:false,autoPlayDelay:0,videoRes:"",coverRes:"",fullscreen:false,controlBar:false,loopTime:0};c.options=a.extend(c.options,d);if(!c.options.dom){throw"setting dom can't be null or undefine";return}c.dom=c.options.dom;c.video=c.dom.find(">.mci-video-i >video");c.videoContainer=c.dom.find(">.mci-video-i.video");c.cover=c.dom.find(">.mci-video-i.cover");c.loopedCount=0};b.prototype.handleEvent=function(c){var d=this;switch(c.type){case"click":break}};b.prototype._createFullScreenVideo=function(){var f=this;var e=window.pageWidth||a("body").height();var d=window.pageHeight||a("body").width();var c=a('<div id="mci-f-v-wrap" class="mci-video-fullsreen"><span class="close"></span></div>');f.video.appendTo(c);c.find(".close").on("click",function(g){g.preventDefault();g.stopPropagation();f.stop()});f.video.css({height:d+"px",width:e+"px"});a("body").append(c)};b.prototype._exitFullScreenVideo=function(){var c=this;c.video.appendTo(c.videoContainer);a("#mci-f-v-wrap").remove();c.video.css({height:c.options.height+"px",width:c.options.width+"px"})};b.prototype._bindEvent=function(){var c=this;c.video.on("error",function(d){if(c.options.fullscreen){c._exitFullScreenVideo()}c.cover.removeClass("hidden");c.video.hide()});c.video.on("ended",function(d){if(c.options.loopTime==-1&&c.stoped==false){c.video[0].currentTime=0;c.loadVideo(c.options.videoRes);c.video[0].play()}else{if(c.stoped==false&&c.loopedCount<c.options.loopTime){c.loopedCount=c.loopedCount+1;c.video[0].currentTime=0;c.loadVideo(c.options.videoRes);c.video[0].play()}else{c.stop()}}})};b.prototype.start=function(){var c=this;c.stoped=false;if(c.options.controlBar){c.video.attr("controls","controls")}c.cover.removeClass("hidden");if(c.options.width){c.video.attr("width",c.options.width+"px")}if(c.options.height){c.video.attr("height",c.options.height+"px")}c._bindEvent();c.loadVideo(c.options.videoRes);if(c.options.autoPlay){if(c.options.fullscreen){c._createFullScreenVideo()}if(c.options.autoPlayDelay>0){setTimeout(function(){c.cover.addClass("hidden");c.video[0].play();c.loopedCount=c.loopedCount+1},c.options.autoPlayDelay)}else{c.loopedCount=c.loopedCount+1;c.cover.addClass("hidden");c.video[0].play()}}else{c.cover.on("click",function(d){d.preventDefault();d.stopPropagation();c.loopedCount=1;c.cover.addClass("hidden");if(c.options.fullscreen){c._createFullScreenVideo()}c.loadVideo(c.options.videoRes);c.video[0].play()})}};b.prototype.loadVideo=function(d){var c=this;c.video.html("");c.video.append('<source src="'+d.replace(".mp4",".ogv")+'" type=\'video/ogg; codecs="theora, vorbis"\'/>');c.video.append('<source src="'+d.replace(".mp4",".webm")+"\" type='video/webm' >");c.video.append('<source src="'+d+"\" type='video/mp4' >")};b.prototype.stop=function(){var c=this;c.stoped=true;if(c.options.fullscreen){c._exitFullScreenVideo()}c.cover.removeClass("hidden");c.video[0].pause();c.loopedCount=0};window.MciVideo=b})(jQuery);(function(a){var c=Support.touch;var g=Support.touchStartEvent;var e=Support.touchMoveEvent;var d=Support.touchEndEvent;var f=Support.mouseOut;var h="click";var i=function(j){if(!(this instanceof i)){return new i(j)}return this.init(j)};function b(j,k){return c?j.changedTouches[0][k]:j[k]}i.prototype.init=function(l){var k=this;k.options=k.options||{url:"",autoScaleToFit:"",autoPlay:"",autoPlayDelay:"",coverRes:"",uiSupport:false,bgTransparent:""};k.options=a.extend(k.options,l);if(!k.options.dom){throw"setting dom can't be null or undefine";return}k.dom=k.options.dom;k.iframeDom=k.dom.find(">iframe");k.iframeConver=k.dom.find(">.mci-wb-state");k.iframeDom.attr("allowtransparency","true");if(!k.options.uiSupport){k.dom.find(">.mci-wb-bg").removeClass("none");var j=k.dom.find(">.mci-wb-bg")[0];k.iframeDom.on("load",function(){var m=k.iframeDom[0].contentWindow.document.body;var o=m.scrollTop;var n=m.scrollLeft;k.scrollHeight=m.scrollHeight;k.scrollWidth=m.scrollWidth;k.scrollDirection={x:false,y:false};k.currentPosition={x:n,y:o};if(k.currentPosition.y+k.options.height<k.scrollHeight){k.scrollDirection.y=true}if(k.currentPosition.x+k.options.width<k.scrollWidth){k.scrollDirection.x=true}if(k.scrollDirection.x==true||k.scrollDirection.y==true){j.addEventListener(g,k,false);j.addEventListener(e,k,false);j.addEventListener(d,k,false);if(!c){j.addEventListener(f,k,false)}}})}};i.prototype.handleEvent=function(j){var k=this;switch(j.type){case h:k._click(j);break;case g:k._touchStart(j);break;case e:k._touchMove(j);break;case d:k._touchEnd(j);break;case f:k._touchOut(j);break}};i.prototype._touchStart=function(j){var k=this;if(k.scrolling){return}k.startPageX=b(j,"pageX");k.startPageY=b(j,"pageY");k.basePageX=k.startPageX;k.basePageY=k.startPageY;k.scrolling=true;k.moveReady=false};i.prototype._touchMove=function(l){var s=this;if(!s.scrolling){return}var q=b(l,"pageX"),r=b(l,"pageY"),j=0,k=0,m=0,n=0;var o=0,p=0;if(s.moveReady){l.preventDefault();l.stopPropagation();j=q-s.basePageX;k=r-s.basePageY;o=s.currentPosition.x-j;p=s.currentPosition.y-k;s._setPosition({x:o,y:p})}else{m=Math.abs(q-s.startPageX);n=Math.abs(r-s.startPageY);var t=false;var u=false;if(m>5){t=true}if(n>5){u=true}if(m>=n){if(s.scrollDirection.x){s.moveReady=true}}else{if(s.scrollDirection.y){s.moveReady=true}}}s.basePageX=q;s.basePageY=r};i.prototype._setPosition=function(j){var k=this;if(k.scrollDirection.x==true){k.currentPosition.x=j.x;if(j.x<=0){k.currentPosition.x=0}if(j.y+k.options.width>k.scrollWidth){k.currentPosition.x=k.scrollWidth-k.options.width}}if(k.scrollDirection.y==true){k.currentPosition.y=j.y;if(j.y<=0){k.currentPosition.y=0}if(j.y+k.options.height>k.scrollHeight){k.currentPosition.y=k.scrollHeight-k.options.height}}k.iframeDom[0].contentWindow.document.body.scrollLeft=k.currentPosition.x;k.iframeDom[0].contentWindow.document.body.scrollTop=k.currentPosition.y};i.prototype._touchEnd=function(j){var k=this;k.scrolling=false};i.prototype._touchOut=function(j){var k=this;k.scrolling=false};i.prototype._click=function(j){var k=this;if(k.options.autoPlay==false&&k.options.coverRes!=""){j.preventDefault();j.stopPropagation();k.iframeDom.attr("src",k.options.url).css({"z-index":"1"});k.iframeConver.css({"z-index":"0"});k.iframeConver[0].removeEventListener(h,k,false)}};i.prototype.start=function(j){var k=this;if(k.options.autoPlay){if(k.options.autoPlayDelay>0){setTimeout(function(){k.iframeDom.attr("src",k.options.url)},k.options.autoPlayDelay)}else{k.iframeDom.attr("src",k.options.url)}k.iframeConver.css({"z-index":"0"});k.iframeDom.css({"z-index":"1"})}else{if(k.options.coverRes!=""&&k.options.uiSupport){k.iframeConver[0].addEventListener(h,k,false);k.iframeConver.css({"z-index":"1"});k.iframeDom.css({"z-index":"0"})}}};window.WebBrowser=i})(jQuery);var Mci={};(function(a){var b=function(){this.callGet=function(e,d,c){a.ajax({url:e,type:"GET",cache:true,dataType:"html",error:function(f){if(a.isFunction(c)){c(f)}else{a(".mcipage").html("Error loading XML document"+f+"")}},success:function(f){if(a.isFunction(d)){d(f)}else{a(".mcipage").html("Error loading XML document"+f+"")}}})}};Mci.mifService=new b()})(jQuery);
/* created by yangyin@mcitech.cn 2012.11.9
*  Magazine.js
* 
* use:	
*
*/
(function($){var Magazine=function(setting){if(!(this instanceof Magazine)){return new Magazine(setting)}return this.init(setting)};Magazine.prototype.init=function(setting){var self=this;self.options=self.options||{};self.childList=[];self._eventList=[];self._bodyTag=1;$("body").click(function(){if(self._bodyTag==1){self._bodyTag=0}else{self._bodyTag=1}$(self._eventList).each(function(){if($.isFunction(this)){this(self._bodyTag)}})})};Magazine.prototype.addPage=function($page,pageIndex){var self=this;var page={dom:$page,pageIndex:pageIndex};self._initPage(page)};Magazine.prototype.removePage=function(pageIndex){var self=this;var i=0;for(var p in self.childList){if(p.pageIndex==pageIndex){self.childList.splice(i,1);break}i++}};Magazine.prototype._initPage=function(page){var self=this;page.childList=[];$(page.dom).find(".item > article").each(function(){var section={};section.dom=this;self._initControls(section);page.childList.push(section)});self.childList.push(page)};Magazine.prototype._initControls=function(section){var self=this;section.childList=[];section.objectList=[];self._initAnimate(section);self._initSlideShow(section);self._initButton(section);self._initImagePan(section);self._initPicture(section);self._initWebBrowser(section);self._initVideo(section);self._initPanorama(section);self._initAudio(section);for(var i=0;i<section.childList.length;i++){var control=section.childList[i];var bindId=control.options.boundTargetId;if(bindId!=""){var ix=$.inArray(bindId,section.objectList);if(ix>-1){var targetControl=section.childList[ix];if(targetControl){control.parentControl=targetControl;if(!targetControl.childControl){targetControl.childControl=[]}control.nested=true;targetControl.childControl.push(control)}}}}section.childControl=[];for(var i=0;i<section.childList.length;i++){var control=section.childList[i];if(!control.nested){section.childControl.push(control)}}};Magazine.prototype._initAnimate=function(section){var alist=$(section.dom).find("div[type='Animator']");alist.each(function(){var arrStr=$(this).attr("pathstr");var json=eval("("+arrStr+")");json.animateFinished=function(ev){if(ev.actionType=="gotoState"){$(section.childList).each(function(){if(this._id==ev.targetId){this.goToState(ev.targetRes);return true}})}else{if(ev.actionType=="play"){$(section.childList).each(function(){if(this._id==ev.targetId){if(this instanceof SlideShow){if($.isFunction(this.play)){this.play()}}else{if($.isFunction(this.start)){this.start(true)}}return true}})}else{if(ev.actionType=="hide"){$(section.childList).each(function(){if(this._id==ev.targetId){if($.isFunction(this.hide)){this.hide()}return true}})}else{if(ev.actionType=="stop"){$(section.childList).each(function(){if(this._id==ev.targetId){if($.isFunction(this.stop)){this.stop()}return true}})}}}}};json.syncMoving=function(ev){$(section.childList).each(function(){if(this instanceof SlideShow||this instanceof MultiBezier){var o=this;if(this._id==ev.syncTo&&ev.syncTo!=""){ev.direction=1;o._syncMove(ev)}else{if(this._id==ev.syncFrom&&ev.syncFrom!=""){ev.direction=-1;o._syncMove(ev)}}}})};json.syncMoveEnd=function(ev){if(this instanceof SlideShow||this instanceof MultiBezier){var o=this;if(this._id==ev.syncTo&&ev.syncTo!=""){ev.direction=1;o._syncEnd(ev)}else{if(this._id==ev.syncFrom&&ev.syncFrom!=""){ev.direction=-1;o._syncEnd(ev)}}}};if(json.data.length>0){json.$this=$(this);var mb=new MultiBezier(json);mb._id=$(this).attr("id");section.childList.push(mb);section.objectList.push(mb._id)}})};Magazine.prototype._initSlideShow=function(section){var $items=$(section.dom).find(".mci-ss");$items.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{itemChanged:function(ev){$(section.childList).each(function(){if(this instanceof Button){if(this.options.targetId==ev.targetControlId){if(this.options.targetRes==ev.fromId){if(this.selected==true){this.setButtonSelected(false)}}else{if(this.options.targetRes==ev.toId){if(this.selected==false){this.setButtonSelected(true)}}}}}else{if(this instanceof MultiBezier){if(this.options.boundTargetId==ev.targetControlId){if(this.options.boundTargetRes==ev.fromId){if(this.started){this.reset();this.isRunning=false}}}}else{if(this instanceof MciAudio){if(this.options.boundTargetId==ev.targetControlId){if(this.options.boundTargetRes==ev.fromId){this.stop();this.isRunning=false}}}else{if(this.options.boundTargetId==ev.targetControlId){if(this.options.boundTargetRes==ev.fromId){if($.isFunction(this.reset)){this.reset();this.isRunning=false}}}}}}})},syncMoving:function(ev){$(section.childList).each(function(){if(this instanceof SlideShow||this instanceof MultiBezier){var o=this;if(this._id==ev.syncTo&&ev.syncTo!=""){ev.direction=1;o._syncMove(ev)}else{if(this._id==ev.syncFrom&&ev.syncFrom!=""){ev.direction=-1;o._syncMove(ev)}}}})},syncMoveEnd:function(ev){$(section.childList).each(function(){if(this instanceof SlideShow||this instanceof MultiBezier){var o=this;if(this._id==ev.syncTo&&ev.syncTo!=""){ev.direction=1;o._syncEnd(ev)}else{if(this._id==ev.syncFrom&&ev.syncFrom!=""){ev.direction=-1;o._syncEnd(ev)}}}})},dom:$item});var ss=new SlideShow(op);ss._id=$item.attr("id");section.childList.push(ss);section.objectList.push(ss._id)})};Magazine.prototype._initButton=function(section){var self=this;var $buttons=$(section.dom).find(".mci-btn-w");$buttons.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item,gotoPage:function(e){var to=e.targetRes.split("#");var pageIndex=pageDict.indexOf(to[0]);var sectionIndex=undefined;if(to.length==2){sectionIndex=parseInt(to[1])}if(pageIndex!=-1){self.mcipage.jumpToPage(pageIndex,sectionIndex)}},gotoState:function(e){$(section.childList).each(function(){if(this._id==e.targetId){if(this.options.autoPlay){clearInterval(this.loopHandler)}if(e.selected==true){this.goToState(0)}else{this.goToState(e.targetRes)}return false}})},play:function(e){$(section.childList).each(function(){if(this._id==e.targetId){if(this instanceof SlideShow){if($.isFunction(this.play)){this.play()}}else{if($.isFunction(this.start)){this.start(true)}}return false}})},stop:function(e){$(section.childList).each(function(){if(this._id==e.targetId){if($.isFunction(this.stop)){this.stop()}return false}})}});var btn=new Button(op);btn._id=$item.attr("id");btn._parent=section;section.childList.push(btn);section.objectList.push(btn._id)})};Magazine.prototype._initImagePan=function(section){var self=this;var $buttons=$(section.dom).find(".mci-imagepan");$buttons.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var imagePan=new ImagePan(op);imagePan._id=$item.attr("id");section.childList.push(imagePan);section.objectList.push(imagePan._id)})};Magazine.prototype._initPicture=function(section){var self=this;var $pictures=$(section.dom).find(".mci-picture-w");$pictures.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var pic=new Picture(op);pic._id=$item.attr("id");section.childList.push(pic);section.objectList.push(pic._id)})};Magazine.prototype._initWebBrowser=function(section){var self=this;var $webBrowsers=$(section.dom).find(".mci-wb-w");$webBrowsers.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var wb=new WebBrowser(op);wb._id=$item.attr("id");section.childList.push(wb);section.objectList.push(wb._id)})};Magazine.prototype._initVideo=function(section){var self=this;var $videos=$(section.dom).find(".mci-video-w");$videos.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var v=new MciVideo(op);v._id=$item.attr("id");section.childList.push(v);section.objectList.push(v._id)})};Magazine.prototype._initAudio=function(section){var self=this;var $audios=$(section.dom).find(".mci-audio-w");$audios.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var au=new MciAudio(op);au._id=$item.attr("id");section.childList.push(au);section.objectList.push(au._id)})};Magazine.prototype._initPanorama=function(section){var self=this;var $panoramas=$(section.dom).find(".mci-panorama-w");$panoramas.each(function(){var $item=$(this);var op=$.extend(eval("("+$(this).attr("param")+")"),{dom:$item});var v=new Panorama(op);v._id=$item.attr("id");section.childList.push(v);section.objectList.push(v._id)})};Magazine.prototype.start=function(pageIndex,sectionIndex){var self=this;$(self.childList).each(function(){if(this.pageIndex==pageIndex){var controls=this.childList[sectionIndex].childControl;for(var o in controls){if($.isFunction(controls[o].start)){if(!controls[o].isRunning){controls[o].start();controls[o].isRunning=true}}}}})};Magazine.prototype.addEvent=function(fn){var self=this;self._eventList.push(fn)};Magazine.prototype.initOverlayPage=function($page){var self=this;var page={dom:$page};page.childList=[];$(page.dom).find(" article").each(function(){var section={};section.dom=this;self._initControls(section);page.childList.push(section)});return page};Magazine.prototype.startOverlayPage=function(page){var self=this;if(page){if(page.childList.length>0){var controls=page.childList[0].childControl;for(var o in controls){if($.isFunction(controls[o].start)){if(!controls[o].isRunning){controls[o].start();controls[o].isRunning=true}}}}}};window.Magazine=Magazine})(jQuery);$(document).ready(function(){var a=function(){var d=$.url().data.param.fragment.pn;if(d!==undefined){window.mcipage.jumpToPage(parseInt(d));return}var e=$.url().data.param.fragment.prev;if(e!==undefined){window.mcipage.toPrev();return}var c=$.url().data.param.fragment.next;if(c!==undefined){window.mcipage.toNext();return}};b();$(window).on("orientationchange",function(){b()});$(window).on("hashchange",function(c){a()});function b(){var c=$(document).width();if(window.pageWidth){$("meta[name=viewport]").attr("content","target-densitydpi=device-dpi,width="+window.pageWidth+"px,minimal-ui")}}});