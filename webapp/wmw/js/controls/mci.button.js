/**
* h5player v0.0.1 by yangyin 
* Copyright 2014 yangyin@mcitech.cn http://weibo.com/nodersolar
*/
!function(a){"function"==typeof define&&define.amd?define("mci.button",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";var c=function(a){return this instanceof c?this.init(a):new c(a)};return c.prototype.init=function(c){var d=this;if(d.options=d.options||{defaultSelected:!1,actionType:"",targetId:"",targetRes:"",reqNavConfirm:"",normalRes:"",clickedRes:"",normalResImg:"",clickedResImg:"",width:0,heigth:0,_return:""},d.options=a.extend(d.options,c),d.selected=d.options.defaultSelected,!d.options.dom)throw"setting dom can't be null or undefine";d.options.dom.find(">.mci-btn-i").css({width:d.options.width+"px",height:d.options.height+"px"}),"browser"==d.options.openIn?a(d.options.dom).wrap('<a class="display:block;border:none;"  href="'+d.options.targetRes+'" target="_blank"></a>'):b.touch||window.navigator.msPointerEnabled?a(d.options.dom)[0].addEventListener(b.touchStartEvent,d,!1):a(d.options.dom)[0].addEventListener("click",d,!1),a(d.options.dom).css({"pointer-events":"auto"})},c.prototype.handleEvent=function(a){var c=this;switch(a.type){case"click":c._click(a);break;case b.touchStartEvent:c._click(a)}},c.prototype._click=function(b){var c=this;switch(b.stopPropagation(),b.preventDefault(),c.options.actionType){case"gotoPage":c.gotoPage(b);break;case"gotoState":c.gotoState(b);break;case"gotoWeb":c.gotoWebPage(b);break;case"sharePicture":break;case"play":c.play(b);break;case"stop":c.stop(b)}c.options.dom.find(">.mci-btn-i >.mci-btn-state");c.selected?c.setButtonSelected(!1):(c._setButtonState(!0),c.setButtonSelected(!0),""==c.options._return&&(a(c.options.dom).css({"pointer-events":"none"}),a(c.options.dom).find("div").css({"pointer-events":"none"})))},c.prototype.resFilter=function(b){var c=this,d=c.options.dom.find(">.mci-btn-i >.mci-btn-state"),e=null;return d.each(function(){a(this).attr("id")==b&&(e=a(this))}),e},c.prototype.setButtonSelected=function(b){var c=this,d=c.options.dom.find(">.mci-btn-i >.mci-btn-state");if(c.selected=b,b){if(c.options.clickedRes&&"next"!=c.options.targetRes&&"previous"!=c.options.targetRes){var e=c.resFilter(c.options.clickedRes);e&&(a(d).removeClass("show"),0==e.find("div,img").length?setTimeout(function(){c.resFilter(c.options.normalRes).addClass("show")},50):a(e).addClass("show"))}}else if(a(c.options.dom).css({"pointer-events":"auto"}),a(c.options.dom).find("div").css({"pointer-events":"auto"}),"next"!=c.options.targetRes&&"previous"!=c.options.targetRes){var e=c.resFilter(c.options.normalRes);e&&(a(d).removeClass("show"),a(e).addClass("show"))}},c.prototype._setButtonState=function(b){var d=this;b&&d._parent&&a(d._parent.childList).each(function(){this instanceof c&&this.options.targetId==d.options.targetId&&d.options.actionType==this.options.actionType&&1==this.selected&&(this.setButtonSelected(!1),this.selected=!1)})},c.prototype.gotoPage=function(){a.isFunction(this.options.gotoPage)&&this.options.gotoPage(this.options)},c.prototype.gotoState=function(){var b=this;a.isFunction(b.options.gotoState)&&(this.options.selected=b.selected,b.options.gotoState(b.options))},c.prototype.play=function(){var b=this;a.isFunction(b.options.play)&&b.options.play(b.options)},c.prototype.stop=function(){var b=this;a.isFunction(b.options.stop)&&b.options.stop(b.options)},c.prototype.gotoWebPage=function(){var c=this,d=window.pageWidth||window.innerWidth,e=window.pageHeight||window.innerHeight;a("#web_container").length>0&&a("#web_container").remove();var f=a('<div id="web_container"><div class="title"><span class="close">返回</span><img src="img/loading.gif" class="loading" alt="loading..."/></div><iframe id="web_con_iframe" name="web_con_iframe" frameborder="0" scrolling="no"></iframe></div>');f.css({width:d+"px",height:e+"px",position:"absolute",top:""+e+"px",left:"0","z-index":"9999",transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"});var g=f.find("#web_con_iframe");g.on("load",function(){f.find(".loading").hide()}),g.css({height:e-34+"px",width:d+"px"}),g.attr("src",c.options.targetRes),f.appendTo(a("body")),f.on("click",function(a){a.preventDefault(),a.stopPropagation()}),f.find(".close").on("click",function(){f.css({transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"}),c.setButtonSelected(!1),setTimeout(function(){a("#web_container").remove()},355)}),setTimeout(function(){f.css({transition:b.getCSSVal("transform")+" 350ms ease",transform:b.transform3d?"translate3d(0,-"+e+"px,0)":"translate(0,-"+e+"px)"})},80),window.isIPSViewer&&a.isFunction(window.hiddenViewerToolBar)&&window.hiddenViewerToolBar()},window.Button=c,c});