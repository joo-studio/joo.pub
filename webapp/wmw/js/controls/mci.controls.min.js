/**
* h5player v0.0.1 by yangyin 
* Copyright 2014 yangyin@mcitech.cn http://weibo.com/nodersolar
*/
!function(a){"function"==typeof define&&define.amd?define("mci.support",["jquery"],a):a(jQuery)}(function(){"use strict";function a(a){return d(a,function(a){return void 0!==e.style[a]})}function b(a){if(void 0!==e.style[a])return a;var b;return d(f,function(d){var f=c(d)+c(a);return void 0!==e.style[f]?(b="-"+d+"-"+a,!0):void 0}),b}function c(a){return a.charAt(0).toUpperCase()+a.substr(1)}function d(a,b){for(var c=0,d=a.length;d>c;c++)if(b(a[c],c))return!0;return!1}var e=document.createElement("div"),f=["webkit","moz","o","ms"],g={};return g.transform3d=a(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),g.transform=a(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"]),g.transition=a(["transitionProperty","WebkitTransitionProperty","MozTransitionProperty","OTransitionProperty","msTransitionProperty"]),g.touch="ontouchstart"in window,g.cssAnimation=(g.transform3d||g.transform)&&g.transition,g.touchStartEvent=g.touch?"touchstart":"mousedown",g.touchMoveEvent=g.touch?"touchmove":"mousemove",g.touchEndEvent=g.touch?"touchend":"mouseup",g.mouseOut="mouseout",window.navigator.msPointerEnabled&&(g.touchStartEvent="MSPointerDown",g.touchMoveEvent="MSPointerMove",g.touchEndEvent="MSPointerUp",g.mouseOut="MSPointerOut"),g.getCSSVal=b,window.Support=g,g}),function(a){"function"==typeof define&&define.amd?define("mci.audio",["jquery"],a):a(jQuery)}(function(a){"use strict";var b=function(a){return this instanceof b?this.init(a):new b(a)};return b.prototype.init=function(b){var c=this;if(c.options=c.options||{autoPlay:!1,autoStop:!1,autoPlayDelay:0,audioRes:"",imageCount:0,loopTime:0},c.options=a.extend(c.options,b),!c.options.dom)throw"setting dom can't be null or undefine";c.dom=c.options.dom,c.loopedCount=0,c.audio=c.dom.find(">.mci-audio-i >audio")},b.prototype.handleEvent=function(a){switch(a.type){case"click":}},b.prototype.start=function(){var a=this;a.stoped=!1,a.options.width&&a.audio.attr("width",a.options.width+"px"),a.options.height&&a.audio.attr("height",a.options.height+"px"),a.audio.on("error",function(){a.audio.hide()}),a.audio.on("ended",function(){-1==a.options.loopTime&&0==a.stoped?(a.audio[0].currentTime=0,a.audio[0].src=a.options.audioRes,a.audio[0].play()):0==a.stoped&&a.loopedCount<a.options.loopTime&&(a.loopedCount=a.loopedCount+1,a.audio[0].currentTime=0,a.audio[0].src=a.options.audioRes,a.audio[0].play())}),a.audio[0].src=a.options.audioRes,a.options.autoPlay&&(a.options.autoPlayDelay>0?setTimeout(function(){a.loopedCount=a.loopedCount+1,a.audio[0].play()},a.options.autoPlayDelay):(a.loopedCount=a.loopedCount+1,a.audio[0].play()))},b.prototype.stop=function(){var a=this;a.audio[0].pause(),a.stoped=!0,a.loopedCount=0},window.MciAudio=b,b}),function(a){"function"==typeof define&&define.amd?define("mci.bezier.animate",["jquery"],a):a(jQuery)}(function(a){function b(b){var c=this,d=this;this.options=b,this.autoPlay=b.autoPlay,this.delay=b.delay,this.loop=b.loop,this.loopCount=b.loopCount,this.endToHead=b.endToHead,this.reverse=!1,this.$this=b.$this,this.$this[0].holder=this,this.orginCss={},this.data=b.data,this.animateFinished=b.animateFinished||function(){},this.orginCss.opacity=1,this.orginCss.left=this.data[0].start.x+"px",this.orginCss.top=this.data[0].start.y+"px",this.orginCss.zoomRateX=this.data[0].reverseCss.zoomRateX,this.orginCss.zoomRateY=this.data[0].reverseCss.zoomRateY,this.orginCss.rotate=this.data[0].reverseCss.rotate,this.duration=b.duration,this.aniObj=null,this.infinte=!1,this.started=!1,0==this.loopCount&&(this.loopCount=1),-1==this.loopCount&&(this.infinte=!0),this.loop||(this.loopCount=1,this.infinte=!1),this.endToHead&&(this.loopCount*=2),this.autoPlay||(this.delay=0),this._finished=function(){a.isFunction(this.animateFinished)&&this.animateFinished(b)},this.running=function(b){var c={};c.relativePosition=b,c.syncTo=d.options.syncTo,c.syncFrom=d.options.syncFrom,c.type=0,c.direction=0,(""!=c.syncTo||""!=c.syncFrom)&&a.isFunction(d.options.syncMoving)&&d.options.syncMoving(c)},this._syncMove=function(c){var e=new a.path.bezier(b);b.$this.stop();var f=e.pointToPostion(c.relativePosition),g=e.getTransform(c.relativePosition);b.$this.css({top:f.top,left:f.left,transform:"translateZ(0) scale("+g.zoomX+","+g.zoomY+") rotate("+g.rotate+"deg)"}),d.lastPosition=c.relativePosition;var h={};a.extend(h,c),h.syncTo="",h.syncFrom="",-1!=c.direction&&(h.syncTo=d.options.syncTo,d.options.syncMoving(h)),1!=c.direction&&(h.syncFrom=d.options.syncFrom,d.options.syncMoving(h))},this._syncEnd=function(e){b.$this.stop().animate({momentumScroll:{target:d,time:e.time,pos:e.relativePosition,startPos:d.lastPosition}},{queue:!0,easing:"linear",duration:e.time});var f={};a.extend(f,e),f.syncTo="",f.syncFrom="",-1!=e.direction&&(f.syncTo=c.options.syncTo,d.options.syncMoveEnd(f)),1!=e.direction&&(f.syncFrom=c.options.syncFrom,d.options.syncMoveEnd(f))},this.start=function(b){if(1!=this.started&&(this.show(),this.run(b),this.childControl)){var c=this.childControl;for(var d in c)a.isFunction(c[d].start)&&(c[d].isRunning||(c[d].start(),c[d].isRunning=!0))}},this.run=function(a){1==this.autoPlay||1==a?(this.$this.css({"pointer-events":"none"}),this.started=!0,this.aniFun(1)):this.$this.click(function(){this.holder.started=!0,this.holder.aniFun(1)})},this.loopBezier=function(b){this.reverse=!this.reverse,this.aniObj=this.aniObj.animate({path:new a.path.bezier({reverse:this.endToHead&&this.reverse,data:this.data,aniObject:d})},{queue:!0,duration:this.duration,easing:"linear",complete:function(){return b++,!this.holder.infinte&&b>this.holder.loopCount?void c._finished():void(this.holder.endToHead?this.holder.loopBezier(b):(this.holder.reset(),this.holder.loopBezier(b)))}})},this.aniFun=function(b){this.reverse=!1,this.aniObj=this.stop().delay(this.delay).animate({path:new a.path.bezier({reverse:this.reverse,data:this.data,aniObject:d})},{queue:!0,easing:"linear",duration:this.duration,complete:function(){return b++,!this.holder.infinte&&b>this.holder.loopCount?void c._finished():void(this.holder.endToHead?this.holder.loopBezier(b):(this.holder.reset(),this.holder.loopBezier(b)))}})},this.stop=function(){return null!==this.aniObj?this.aniObj.stop().css(this.orginCss).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"}):this.$this},this.reset=function(){if(1==this.started&&(this.aniObj&&this.aniObj.stop().css(this.orginCss).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"}),this.isRunning=!1,this.started=!1,this.childControl)){var b=this.childControl;for(var c in b)a.isFunction(b[c].reset)&&b[c].reset()}},this.hide=function(){},this.show=function(){},this._setCss=function(a){var b=this;b.$this.css(a).css({transform:"translateZ(0) scale("+this.orginCss.zoomRateX+","+this.orginCss.zoomRateY+") rotate("+this.orginCss.rotate+"deg)"})}}return a.path={},a.path.bezier=function(a){this.curentSeg=0,this.preSeg=-1,this.minI=0,this.reverse=a.reverse,this.aniObject=a.aniObject,this.getPoint=function(b){this.reverse&&(b=1-b,this.minI=0);for(var c=a.data.length-1;c>=this.minI;c--){var d=a.data[c];if(b>=d.startTime){b-=d.startTime,b/=d.timeRatio,this.startNext=!1,this.preSeg!=c&&(this.setV(d),this.curentSeg=c,this.minI=c,this.startNext=!0),this.preSeg=c;break}}b=b>1?1:b;var e={},f={},g={},h={},i={},j=1-b,k=3*b,l=3*Math.pow(b,2),m=Math.pow(b,3),n=Math.pow(j,3),o=Math.pow(j,2);return e.x=n*this.start.x,e.y=n*this.start.y,f.x=o*this.startControl.x*k,f.y=o*this.startControl.y*k,g.x=l*j*this.endControl.x,g.y=l*j*this.endControl.y,h.x=m*this.end.x,h.y=m*this.end.y,i.x=e.x+f.x+g.x+h.x,i.y=e.y+f.y+g.y+h.y,i},this.setV=function(a){this.start=a.start,this.end=a.end,this.startControl=a.startControl,this.endControl=a.endControl,this.timeRatio=a.timeRatio,this.startTime=a.startTime,this.css=a.css,this.reverseCss=a.reverseCss},this.pointToPostion=function(a){var b=this.getPoint(a);return b.left=b.x+"px",b.top=b.y+"px",b},this.getTransform=function(a){this.reverse&&(a=1-a),a=a>1?1:a;var b={},c=(this.css.zoomRateX,this.css.zoomRateY,parseInt(this.css.rotate,10)),d=parseInt(this.reverseCss.rotate,10),e=(a-this.startTime)/this.timeRatio;return b.zoomX=this.reverseCss.zoomRateX+(this.css.zoomRateX-this.reverseCss.zoomRateX)*e,b.zoomY=this.reverseCss.zoomRateY+(this.css.zoomRateY-this.reverseCss.zoomRateY)*e,b.rotate=d+(c-d)*e,b}},a.fx.step.path=function(b){var c=b.end.pointToPostion(b.pos);b.elem.style.top=c.top,b.elem.style.left=c.left;var d=b.end.getTransform(b.pos);if(a(b.elem).css({transform:"translateZ(0) scale("+d.zoomX+","+d.zoomY+") rotate("+d.rotate+"deg)"}),a.isFunction(b.end.aniObject.running)&&b.end.aniObject.running(b.end.reverse?1-b.pos:b.pos),b.end.startNext===!0){var e,f=b.end.timeRatio*b.options.duration;e=b.end.reverse?b.end.reverseCss:b.end.css,a(b.elem).children().animate(e,{duration:f,queue:!1})}},a.fx.step.momentumScroll=function(b){var c=b.end.target,d=new a.path.bezier(b.end.target.options),e=b.end.startPos,f=b.end.pos,g=e+(f-e)*b.pos,h=d.pointToPostion(g),i=d.getTransform(g);c.$this.css({top:h.top,left:h.left,transform:"translateZ(0) scale("+i.zoomX+","+i.zoomY+") rotate("+i.rotate+"deg)"}),c.lastPosition=g},window.MultiBezier=b,b}),function(a){"function"==typeof define&&define.amd?define("mci.button",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";var c=function(a){return this instanceof c?this.init(a):new c(a)};return c.prototype.init=function(c){var d=this;if(d.options=d.options||{defaultSelected:!1,actionType:"",targetId:"",targetRes:"",reqNavConfirm:"",normalRes:"",clickedRes:"",normalResImg:"",clickedResImg:"",width:0,heigth:0,_return:""},d.options=a.extend(d.options,c),d.selected=d.options.defaultSelected,!d.options.dom)throw"setting dom can't be null or undefine";d.options.dom.find(">.mci-btn-i").css({width:d.options.width+"px",height:d.options.height+"px"}),"browser"==d.options.openIn?a(d.options.dom).wrap('<a class="display:block;border:none;"  href="'+d.options.targetRes+'" target="_blank"></a>'):b.touch||window.navigator.msPointerEnabled?a(d.options.dom)[0].addEventListener(b.touchStartEvent,d,!1):a(d.options.dom)[0].addEventListener("click",d,!1),a(d.options.dom).css({"pointer-events":"auto"})},c.prototype.handleEvent=function(a){var c=this;switch(a.type){case"click":c._click(a);break;case b.touchStartEvent:c._click(a)}},c.prototype._click=function(b){var c=this;switch(b.stopPropagation(),b.preventDefault(),c.options.actionType){case"gotoPage":c.gotoPage(b);break;case"gotoState":c.gotoState(b);break;case"gotoWeb":c.gotoWebPage(b);break;case"sharePicture":break;case"play":c.play(b);break;case"stop":c.stop(b)}c.options.dom.find(">.mci-btn-i >.mci-btn-state");c.selected?c.setButtonSelected(!1):(c._setButtonState(!0),c.setButtonSelected(!0),""==c.options._return&&(a(c.options.dom).css({"pointer-events":"none"}),a(c.options.dom).find("div").css({"pointer-events":"none"})))},c.prototype.resFilter=function(b){var c=this,d=c.options.dom.find(">.mci-btn-i >.mci-btn-state"),e=null;return d.each(function(){a(this).attr("id")==b&&(e=a(this))}),e},c.prototype.setButtonSelected=function(b){var c=this,d=c.options.dom.find(">.mci-btn-i >.mci-btn-state");if(c.selected=b,b){if(c.options.clickedRes&&"next"!=c.options.targetRes&&"previous"!=c.options.targetRes){var e=c.resFilter(c.options.clickedRes);e&&(a(d).removeClass("show"),0==e.find("div,img").length?setTimeout(function(){c.resFilter(c.options.normalRes).addClass("show")},50):a(e).addClass("show"))}}else if(a(c.options.dom).css({"pointer-events":"auto"}),a(c.options.dom).find("div").css({"pointer-events":"auto"}),"next"!=c.options.targetRes&&"previous"!=c.options.targetRes){var e=c.resFilter(c.options.normalRes);e&&(a(d).removeClass("show"),a(e).addClass("show"))}},c.prototype._setButtonState=function(b){var d=this;b&&d._parent&&a(d._parent.childList).each(function(){this instanceof c&&this.options.targetId==d.options.targetId&&d.options.actionType==this.options.actionType&&1==this.selected&&(this.setButtonSelected(!1),this.selected=!1)})},c.prototype.gotoPage=function(){a.isFunction(this.options.gotoPage)&&this.options.gotoPage(this.options)},c.prototype.gotoState=function(){var b=this;a.isFunction(b.options.gotoState)&&(this.options.selected=b.selected,b.options.gotoState(b.options))},c.prototype.play=function(){var b=this;a.isFunction(b.options.play)&&b.options.play(b.options)},c.prototype.stop=function(){var b=this;a.isFunction(b.options.stop)&&b.options.stop(b.options)},c.prototype.gotoWebPage=function(){var c=this,d=window.pageWidth||window.innerWidth,e=window.pageHeight||window.innerHeight;a("#web_container").length>0&&a("#web_container").remove();var f=a('<div id="web_container"><div class="title"><span class="close">返回</span><img src="img/loading.gif" class="loading" alt="loading..."/></div><iframe id="web_con_iframe" name="web_con_iframe" frameborder="0" scrolling="no"></iframe></div>');f.css({width:d+"px",height:e+"px",position:"absolute",top:""+e+"px",left:"0","z-index":"9999",transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"});var g=f.find("#web_con_iframe");g.on("load",function(){f.find(".loading").hide()}),g.css({height:e-34+"px",width:d+"px"}),g.attr("src",c.options.targetRes),f.appendTo(a("body")),f.on("click",function(a){a.preventDefault(),a.stopPropagation()}),f.find(".close").on("click",function(){f.css({transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"}),c.setButtonSelected(!1),setTimeout(function(){a("#web_container").remove()},355)}),setTimeout(function(){f.css({transition:b.getCSSVal("transform")+" 350ms ease",transform:b.transform3d?"translate3d(0,-"+e+"px,0)":"translate(0,-"+e+"px)"})},80),window.isIPSViewer&&a.isFunction(window.hiddenViewerToolBar)&&window.hiddenViewerToolBar()},window.Button=c,c}),function(a){"function"==typeof define&&define.amd?define("mci.imagepan",["jquery","mci.support","mci.mask"],a):a(jQuery,Support)}(function(a,b,c){"use strict";function d(a,b){return e?a.changedTouches[0][b]:a[b]}var e=b.touch,f=b.touchStartEvent,g=b.touchMoveEvent,h=b.touchEndEvent,i=function(a){return this instanceof i?this.init(a):new i(a)};return i.prototype.init=function(c){var d=this;if(d.options=d.options||{initialZoomRate:0,initialOffsetX:0,initialOffsetY:0,largerView:!1,scrollView:!1,converRes:"",src:""},d.options=a.extend(d.options,c),!d.options.dom)throw"setting dom can't be null or undefine";d.dom=d.options.dom,d.moveDom=d.dom.find(">.mci-imagepan-w > .mci-imagepan-i "),d.moveDom.css(b.transform3d?{transform:"translate3d("+d.options.initialOffsetX+"px,"+d.options.initialOffsetY+"px,0)"}:{transform:"translate("+d.options.initialOffsetX+"px,"+d.options.initialOffsetY+"px)"}),d.options.largerView&&"zoom"==d.options.scrollerView?(a(d.options.dom)[0].addEventListener("click",d,!1),d.dom[0].addEventListener(f,d,!1),d.dom[0].addEventListener(g,d,!1),d.dom[0].addEventListener(h,d,!1)):"zoom"!=d.options.scrollerView&&(d.dom[0].addEventListener(f,d,!1),d.dom[0].addEventListener(g,d,!1),d.dom[0].addEventListener(h,d,!1),b.touch||d.dom[0].addEventListener(b.mouseOut,d,!1)),d.currentPosition={x:d.options.initialOffsetX,y:d.options.initialOffsetY},d.scrolling=!1},i.prototype.handleEvent=function(a){var c=this;switch(a.type){case"click":c._click(a);break;case f:c._touchStart(a);break;case g:c._touchMove(a);break;case h:c._touchEnd(a);break;case b.mouseOut:c._touchEnd(a)}},i.prototype._click=function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.canZoom&&b._Zoom(a)},i.prototype._touchStart=function(a){var b=this;b._setTransition(!1),b.scrolling||(b.startPageX=d(a,"pageX"),b.startPageY=d(a,"pageY"),b.basePageX=b.startPageX,b.basePageY=b.startPageY,b.scrolling=!0,b.moveReady=!1,b.canZoom=!0,b.duration=0,b.timeStamp=a.timeStamp||(new Date).getTime())},i.prototype._touchMove=function(a){var b=this;if(b.scrolling){if("zoom"==b.options.scrollerView)return void(b.canZoom=!1);var c=d(a,"pageX"),e=d(a,"pageY"),f=0,g=0,h=0,i=0,j=0,k=0;if(b.moveReady)a.preventDefault(),a.stopPropagation(),f=c-b.basePageX,g=e-b.basePageY,j=b.currentPosition.x+f,k=b.currentPosition.y+g,b.currentX=j,b.currentY=k,b._setPosition({x:j,y:k});else{var l=!1,m=!1;h=Math.abs(c-b.startPageX),i=Math.abs(e-b.startPageY),h>5&&(l=!0),i>5&&(m=!0),"both"==b.options.scrollerView?(l||m)&&(b._canMoved(c-b.startPageX,-1)&&l&&(b.moveReady=!0),b._canMoved(e-b.startPageY,1)&&m&&(b.moveReady=!0)):(l&&"horizontal"==b.options.scrollerView&&b._canMoved(c-b.startPageX,-1)&&l&&(b.moveReady=!0),m&&"vertical"==b.options.scrollerView&&b._canMoved(e-b.startPageY,1)&&m&&(b.moveReady=!0)),b.moveReady&&(a.preventDefault(),a.stopPropagation(),b.dom[0].addEventListener("click",b,!1))}b.basePageX=c,b.basePageY=e}},i.prototype._touchEnd=function(a){var b=this;if(b.scrolling=!1,b.duration=(a.timeStamp||(new Date).getTime())-b.timeStamp,b.moveReady&&(setTimeout(function(){b.dom[0].removeEventListener("click",b,!1)},100),b.moveReady=!1),a.duration=b.duration,!(a.duration>=300)){var c=a.duration,e=d(a,"pageX"),f=d(a,"pageY"),g=0,h=0;g=e-b.startPageX,h=f-b.startPageY;var i=0,j=0,k=0,l=0;i=b.options.maxX-Math.abs(b.currentX),j=Math.abs(b.currentX),k=b.options.maxY-Math.abs(b.currentY),l=Math.abs(b.currentY);var m=b._momentum(g,c,i,j),n=b._momentum(h,c,k,l),o=b.currentX+m.dist,p=b.currentY+n.dist;o>=0?o=0:o<=-b.options.maxX&&(o=-b.options.maxX),p>=0?p=0:p<=-b.options.maxY&&(p=-b.options.maxY),(0!=g||0!=h)&&b.scrollTo(o,p,m.time>n.time?m.time:n.time)}},i.prototype._canMoved=function(a,b){var c=this,d=0,e=0,f=0,g=0;if(f=c.options.maxX,g=c.options.maxY,c.options.initialOffsetX>0&&(d=c.options.initialOffsetX),c.options.initialOffsetY>0&&(e=c.options.initialOffsetY),1==b){if(c.currentPosition.y>-c.options.maxY&&0>a)return!0;if(a>0&&c.currentPosition.y<e)return!0}if(-1==b){if(c.currentPosition.x>-c.options.maxX&&0>a)return!0;if(a>0&&c.currentPosition.x<d)return!0}return!1},i.prototype._Zoom=function(){var b=this;if(b.options.largerView){var d=b.dom.find(">.mci-imagepan-w > .mci-imagepan-i.lager"),e=0,f=0;if(0==e||0==f)for(var g=d.find(">.text-separated >.text-sperate"),h=0,i=0,j=0;j<g.length;j++){var k=parseInt(g.eq(j).css("top"),10),l=parseInt(g.eq(j).css("left"),10),m=parseInt(g.eq(j).width(),10),n=parseInt(g.eq(j).height(),10);0==j?(i=-k,h=-l,n>f&&(f=n),m>e&&(e=m)):(k+n>f&&(f=k+n),m+l>e&&(e=m+l))}var o=b.options.width,p=0;0!=e&&(p=o/e);var q=1,r=window.pageWidth||a("body").width(),s=window.pageHeight||a("body").height();e>=r&&(q=(e-100)/e,e-=100,f=q*f);var k=(s-f)/2,l=(r-e)/2;k+=i,l+=h;var t=a('<div class="mci-imagpan-max" style="z-index:9911;width:'+e+"px;height:"+f+"px;position:absolute;left:"+b.options.pageLeft+"px;top:"+b.options.pageTop+'px;display: block;visibility:visible;"></div>'),u=a(d).clone();t.css({transform:"scale("+p+")"}),t.append(u),a("body").append(t);var v=new c({conDom:d.parent(),top:b.options.top,left:b.options.left,width:r,height:s,hiddenChanged:function(){t.css({transition:"all 1s ease",transform:"scale("+p+")",left:b.options.pageLeft+"px",top:b.options.pageTop+"px"}),setTimeout(function(){a(t).remove()},1e3)}});v.show(),t.css({transition:"all 1s ease",transform:"scale("+q+")","z-index":"9911",visibility:"visible",top:k+"px",left:l+"px"})}},i.prototype._setPosition=function(a){var c=this;if("zoom"!=c.options.scrollerView){var d={x:0,y:0};switch(c.options.scrollerView){case"both":d=a;break;case"vertical":d.x=c.currentPosition.x,d.y=a.y;break;case"horizontal":d.y=c.currentPosition.y,d.x=a.x}var e=0,f=0,g=0,h=0;c.options.initialOffsetX>0&&(e=c.options.initialOffsetX),c.options.initialOffsetY>0&&(f=c.options.initialOffsetY),g=c.options.maxX,h=c.options.maxY,d.x>e&&(d.x=e),d.y>f&&(d.y=f),d.y<-h&&(d.y=-h),d.x<-g&&(d.x=-g),c.currentPosition=d,c.moveDom.css(b.transform3d?{transform:"translate3d("+d.x+"px,"+d.y+"px,0px)"}:{transform:"translate("+d.x+"px,"+d.y+"px)"})}},i.prototype._momentum=function(a,b,c,d){var e=6e-4,f=Math.abs(a)/b,g=f*f/(2*e),h=0;return a>0&&g>c?(f=f*c/g,g=c):0>a&&g>d&&(f=f*d/g,g=d),g*=0>a?-1:1,h=f/e,{dist:Math.round(g),time:Math.round(h)}},i.prototype._setItemContainerStyle=function(a){var b=this;a&&b.moveDom.css(a)},i.prototype._getTranslate=function(a,c,d){var a=a||"0",c=c||"0",d=d||"0";return b.transform3d?"translate3d("+a+"px, "+c+"px, "+d+"px)":"translate("+a+"px, "+c+"px)"},i.prototype.scrollTo=function(a,c,d){var e=this;e.currentX=a,e.currentY=c,e.currentPosition.x=a,e.currentPosition.y=c,b.transform3d?e._setItemContainerStyle({transform:e._getTranslate(e.currentX,e.currentY,0),transition:b.getCSSVal("transform")+" "+d+"ms ease"}):e.itemContainerDom.animate({position:"relative",left:a+"px",top:c+"px"},d)},i.prototype._setTransition=function(a){var c=this;c._setItemContainerStyle(a?{transition:b.getCSSVal("transform")+" "+c.options.crossEffectTime+"ms ease"}:{transition:""})},window.ImagePan=i,i}),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){a.fn.loadSources=function(b){var c=(a(this),a(this).find("img")),d=c.length,e=0,f=0,g=a.Deferred();return a(c).each(function(){var c=a(this);1==c[0].complete?(e++,b(e,d),e+f>=d&&g.resolve()):(c.load(function(){e++,b(e,d),e+f>=d&&g.resolve()}),c.error(function(){f++,b(e,d),e+f>=d&&g.resolve()}))}),0==d&&setTimeout(function(){g.resolve()},10),g}}),function(a){"function"==typeof define&&define.amd?define("mci.panorama",["jquery","mci.support"],a):a(jQuery,Support,THREE)}(function(a,b,c){"use strict";function d(a,b){return e?a.changedTouches[0][b]:a[b]}var e=b.touch,f=b.touchStartEvent,g=b.touchMoveEvent,h=b.touchEndEvent,i=function(a){return this instanceof i?this.init(a):new i(a)};return i.prototype.init=function(b){var c=this;if(c.options=c.options||{width:0,height:0,fullscreen:!0},c.options=a.extend(c.options,b),!c.options.dom)throw"setting dom can't be null or undefine";c.dom=c.options.dom,c.showing=!1,c.options.fullscreen?c.dom[0].addEventListener("click",c,!1):c.startShow()},i.prototype.handleEvent=function(a){var b=this;switch(a.type){case f:b._touchStart(a);break;case g:b._touchMove(a);break;case h:b._touchEnd(a);break;case"click":b._click(a)}},i.prototype._touchStart=function(a){var b=this;a.preventDefault(),b.isUserInteracting=!0,b.onPointerDownPointerX=d(a,"pageX"),b.onPointerDownPointerY=d(a,"pageY"),b.onPointerDownLon=b.point.lon,b.onPointerDownLat=b.point.lat},i.prototype._touchMove=function(a){var b=this;a.preventDefault(),a.stopPropagation(),b.isUserInteracting&&(b.point.lon=.1*(b.onPointerDownPointerX-d(a,"pageX"))+b.onPointerDownLon,b.point.lat=.1*(d(a,"pageY")-b.onPointerDownPointerY)+b.onPointerDownLat,b.render())},i.prototype._touchEnd=function(){var a=this;a.isUserInteracting=!1,a.render()},i.prototype._click=function(a){var b=this;a.preventDefault(),a.stopPropagation(),b.startShow()},i.prototype._loadMaterial=function(a){var b=this,d=new c.Texture(b.viewElement),e=new c.MeshBasicMaterial({map:d,overdraw:!0}),f=new Image;return f.onload=function(){d.needsUpdate=!0,e.map.image=this,b.render()},f.src=a,e},i.prototype._loadMaterial$Dom=function(b){var d=this,e=a(b).find("> img");if(!(e.length>=2))return d._loadMaterial(e[0].src);var f=new c.Texture(d.viewElement),g=new c.MeshBasicMaterial({map:f,overdraw:!0}),h=new Image;h.onload=function(){f.needsUpdate=!0,g.map.image=this,d.render()};var i=document.createElement("canvas");i.width=d.options.width,i.height=d.options.height;var j=i.getContext("2d"),k=function(b){if(!(b>=e.length)){var c=e[b],d=(a(c).parent(),parseInt(a(c).css("top"))||0),f=parseInt(a(c).css("left"))||0,g=parseInt(a(c).width()),l=parseInt(a(c).height()),m=new Image;m.src=a(c).attr("src"),m.onload=function(){j.drawImage(m,f,d,g,l);var a=i.toDataURL();h.src=a,k(b+1)}}};return k(0),g},i.prototype.render=function(){var a=this;a.point.lat=Math.max(-85,Math.min(85,a.point.lat)),a.point.phi=(90-a.point.lat)*Math.PI/180;var b=a.point.lon*Math.PI/180;a.target.x=500*Math.sin(a.point.phi)*Math.cos(b),a.target.y=500*Math.cos(a.point.phi),a.target.z=500*Math.sin(a.point.phi)*Math.sin(b),a.camera.lookAt(a.target),a.renderer.render(a.scene,a.camera)},i.prototype.startShow=function(){var d=this;if(!d.showing){var e=window.pageWidth||window.innerWidth,i=window.pageHeight||window.innerHeight;d.options.fullscreen?(d.container=a('<div id="panorama_fullscreen"><div class="close"></div></div>').appendTo(a("body")),d.container.css({position:"absolute",top:""+i+"px",left:"0","z-index":"9999",transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"}),d.container.find(">.close").on("click",function(){d.close()}),setTimeout(function(){d.showing=!0,d.container.css({transition:b.getCSSVal("transform")+" 350ms ease",transform:b.transform3d?"translate3d(0,-"+i+"px,0)":"translate(0,-"+i+"px)"})},80)):d.container=d.dom.find(">.mci-panorama-i >.mci-panorama-con"),d.viewElement=document.createElement("canvas"),d.viewElement.width=0==d.options.width?e:d.options.width,d.viewElement.height=0==d.options.height?i:d.options.height;var j=d.viewElement.getContext("2d");j.fillStyle="rgb(200,200,200)",j.fillRect(0,0,d.viewElement.width,d.viewElement.height),d.camera=new c.PerspectiveCamera(75,e/i,1,1100),d.scene=new c.Scene,d.scene.add(d.camera),d.target=new c.Vector3;var k=d.dom.find(">.mci-panorama-i >.mci-panorama-pic");d.point={lon:90,lat:0,phi:0};var l=[d._loadMaterial$Dom(k[3]),d._loadMaterial$Dom(k[2]),d._loadMaterial$Dom(k[4]),d._loadMaterial$Dom(k[5]),d._loadMaterial$Dom(k[1]),d._loadMaterial$Dom(k[0])];d.mesh=new c.Mesh(new c.CubeGeometry(300,300,300,7,7,7,l),new c.MeshFaceMaterial),d.mesh.scale.x=-1,d.scene.add(d.mesh),d.renderer=new c.CanvasRenderer,d.options.fullscreen?d.renderer.setSize(e,i):d.renderer.setSize(d.options.width,d.options.height),d.container.append(d.renderer.domElement);var m=null;m=d.options.fullscreen?d.container[0]:d.dom[0],m.addEventListener(f,d,!1),m.addEventListener(g,d,!1),m.addEventListener(h,d,!1)}},i.prototype.close=function(){var c=this;c.showing=!1,c.container.css({transition:b.getCSSVal("transform")+" 350ms ease",transform:b.transform3d?"translate3d(0,0,0)":"translate(0,0)"}),setTimeout(function(){a(c.container).remove()},350)},window.Panorama=i,i}),function(a){"function"==typeof define&&define.amd?define("mci.picture",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";function c(a,b){return d?a.changedTouches[0][b]:a[b]}var d=b.touch,e=b.touchStartEvent,f=b.touchMoveEvent,g=b.touchEndEvent,h=function(a){return this instanceof h?this.init(a):new h(a)};return h.prototype.init=function(b){var c=this;if(c.options=c.options||{description:"",url:"",eraseEffect:"",allowErase:!1,allowShare:!1,allowCollect:!1,finger:20},c.options=a.extend(c.options,b),c.dom=c.options.dom,c.canvasWrap=c.dom.find(">.mci-picture-canvas"),c.canvas=c.canvasWrap.find(">canvas")[0],!c.options.dom)throw"setting dom can't be null or undefine";c.scrolling=!1,"0"!=c.options.eraseEffect&&1==c.options.allowErase?c._drawImg():(c.dom.find(">.mci-picture-i").show(),c.dom.css({"pointer-events":"none"})),1==c.options.allowErase&&(c.dom[0].addEventListener(e,c,!1),c.dom[0].addEventListener(f,c,!1),c.dom[0].addEventListener(g,c,!1))},h.prototype._drawImg=function(){var b=this,c=b.canvas.getContext("2d"),d=b.dom.find(">.mci-picture-i >img");0==d.length&&(d=b.dom.find(">.mci-picture-i > .text-separated > .sperate-img >img")),a(d).each(function(){var b=a(this).parent(),d=parseInt(a(b).css("top"))||0,e=parseInt(a(b).css("left"))||0,f=new Image;f.src=a(this).attr("src"),f.onload=function(){c.drawImage(f,e,d)}}),b.readyEarse=!0},h.prototype.handleEvent=function(a){var b=this;switch(a.type){case"click":break;case e:b._touchStart(a);break;case f:b._touchMove(a);break;case g:b._touchEnd(a)}},h.prototype._touchStart=function(a){var b=this;b.scrolling||(a.preventDefault(),a.stopPropagation(),b.startPageX=c(a,"pageX"),b.startPageY=c(a,"pageY"),b.basePageX=b.startPageX,b.basePageY=b.startPageY,b.scrolling=!0,b.moveReady=!1)},h.prototype._touchMove=function(b){var d=this;if(d.scrolling){var e=d.canvas.getContext("2d"),f=a(d.canvas).offset(),g=c(b,"pageX")-f.left,h=c(b,"pageY")-f.top,i=d.options.finger||20,j=i/2;if(j>g||j>h)return!1;e.save(),e.arc(g,h,i,0,2*Math.PI,!1),e.clip(),e.clearRect(g-i-1,h-i-1,2*i+2,2*i+2),e.restore()}},h.prototype._touchEnd=function(){var a=this;a.scrolling=!1},window.Picture=h,h}),function(a){"function"==typeof define&&define.amd?define("mci.slideshow",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";function c(a,c){return b.touch?a.changedTouches[0][c]:a[c]}function d(a,b,c){var d=a,e=+new Date,f=parseInt(d.style[b],10),g=c,h=350,i=function(a,b){return-(a/=b)*(a-2)},j=setInterval(function(){var a,c,k=new Date-e;k>h?(clearInterval(j),c=g):(a=i(k,h),c=a*(g-f)+f),d.style[b]=c+"px"},10)}var e=function(a){return this instanceof e?this.init(a):new e(a)};return e.prototype.init=function(b){var c=this;if(c.options=c.options||{itemWidth:100,itemHeight:100,itemContainerCls:"> .mci-ss-oh >.mci-ss-w",itemCls:".mci-ss-i",itemCount:0,crossEffectType:"fade",crossEffectTime:500,autoPlay:!1,autoPlayInterval:0,clickSupport:!1,slideSupport:!1,slideDirection:-1,defaultDirection:4,loop:!0,loopTime:1,use3d:!0,defaultIndex:0,itemChanged:function(){},syncMoving:function(){},syncMoveEnd:function(){}},c.options=a.extend(c.options,b),c.itemIndex=0,c.itemChanged=c.options.itemChanged,c.loopHandler=null,c.loopHandlerCount=0,c.itemChanging=!1,c.dom=c.options.dom,c.itemContainerDom=c.dom.find(c.options.itemContainerCls+":first-child"),c.itemCount=c.itemContainerDom.children().length,c.scrollerWidth=c.itemCount*c.options.itemWidth,c.scrollerHeight=c.itemCount*c.options.itemHeight,c.scrollWidth=(c.itemCount-1)*c.options.itemWidth,c.scrollHeight=(c.itemCount-1)*c.options.itemHeight,c.isStoped=!0,c.currentX=0,c.currentY=0,c.directionX=0,c.directionY=0,c.options.defaultIndex>=0&&(c.itemIndex=c.options.defaultIndex,(2==c.options.defaultDirection||3==c.options.defaultDirection)&&(c.itemIndex=c.itemCount-1-c.options.defaultIndex)),"scroll"==c.options.crossEffectType||"slide"==c.options.crossEffectType){var d=0;switch(c.options.defaultDirection){case 1:d=c.options.defaultIndex*c.options.itemHeight,c._setY(-d);break;case 2:d=(c.itemCount-c.options.defaultIndex-1)*c.options.itemWidth,c._setX(-d);break;case 3:d=(c.itemCount-c.options.defaultIndex-1)*c.options.itemHeight,c._setY(-d);break;case 4:d=c.options.defaultIndex*c.options.itemWidth,c._setX(-d);break;default:d=c.options.defaultIndex*c.options.itemWidth,c._setX(-d)}c._setItemContainerStyle(-1==c.options.slideDirection?{width:c.options.itemWidth*c.itemCount+"px",height:c.options.itemHeight+"px"}:{height:c.options.itemHeight*c.itemCount+"px",width:c.options.itemWidth+"px"})}else c._setItemContainerStyle({width:c.options.itemWidth+"px",height:c.options.itemHeight+"px"});if("none"==c.options.crossEffectType)switch(c.options.defaultDirection){case 2:d=(c.itemCount-c.options.defaultIndex-1)*c.options.itemWidth,c._setX(-d);break;case 3:d=(c.itemCount-c.options.defaultIndex-1)*c.options.itemHeight,c._setY(-d)}return"flip"==c.options.crossEffectType&&(c.itemIndex=c.options.defaultIndex),c},e.prototype.hasNext=function(){var a=this;return a.itemIndex<a.itemCount-1?!0:!1},e.prototype.hasPrev=function(){var a=this;return a.itemIndex>0?!0:!1},e.prototype.goToNext=function(){var a=this,b=0;a.hasNext()&&(b=a.itemIndex+1),a.goToItem(b),"none"!=a.options.crossEffectType&&a._triggerSyncEnd(b/(a.itemCount-1),a.options.crossEffectTime)},e.prototype.goToPrev=function(){var a=this,b=0;a.hasPrev()?(b=a.itemIndex-1,a.goToItem(b)):(b=a.itemCount-1,a.goToItem(b)),"none"!=a.options.crossEffectType&&a._triggerSyncEnd(b/(a.itemCount-1),a.options.crossEffectTime)},e.prototype.goToItem=function(a){var b=this;if(b.itemChanging)return!1;switch(b.options.crossEffectType){case"fade":b._fade(a);break;case"slide":b._slide(a);break;case"fly":b._zoomIn(a);break;case"fall":b._zoomOut(a);break;case"null":b._nothing(a);break;case"flip":b._flip(a);break;case"none":b._acceler(a);
break;case"scroll":b._scroll(a)}},e.prototype.goToState=function(a){var b=this;if("next"==a)b.goToNext();else if("previous"==a)b.goToPrev();else{if(0===a)return b.goToItem(0),void("none"!=b.options.crossEffectType&&b._triggerSyncEnd(c/(b.itemCount-1),b.options.crossEffectTime));var c=b.itemContainerDom.children("#"+a).index();if(-1==c&&a.indexOf(" ")>=0)for(var d=b.itemContainerDom.children(),e=0;e<d.length;e++)if(d[e].id==a){c=e;break}-1!=c&&(b.goToItem(c),"none"!=b.options.crossEffectType&&b._triggerSyncEnd(c/(b.itemCount-1),b.options.crossEffectTime))}},e.prototype._fade=function(a){var b=this;0>a?a=b.itemCount-1:a>b.itemCount-1&&(a=0),b.itemChanging=!1,b.currentX=-a*b.options.itemWidth;var c=b.dom.find(b.options.itemContainerCls).children();b._itemIndex&&c.eq(b._itemIndex).stop(!0,!0),c.eq(b.itemIndex).stop(!0,!0).fadeOut(b.options.crossEffectTime),c.eq(a).stop(!0,!0).fadeIn(b.options.crossEffectTime,function(){b._changeItemIndex(a)}),b._itemIndex=a},e.prototype._slide=function(a){var b=this;0>a?a=1==b.options.loop?b.itemCount-1:0:a>b.itemCount-1&&(a=1==b.options.loop?0:b.itemCount-1),a>=0&&a<=b.itemCount-1&&(b.itemChanging=!0,b._setTransition(!0),-1==b.options.slideDirection?b._setX(-a*b.options.itemWidth):b._setY(-a*b.options.itemHeight),void 0!=a&&a!=b.itemIndex?setTimeout(function(){b._changeItemIndex(a)},b.options.crossEffectTime):b.itemChanging=!1)},e.prototype._scroll=function(a){var b=this;0>a?a=1==b.options.loop?b.itemCount-1:0:a>b.itemCount-1&&(a=1==b.options.loop?0:b.itemCount-1),a>=0&&a<=b.itemCount-1&&(b.itemChanging=!0,b._setTransition(!0),-1==b.options.slideDirection?b._setX(-a*b.options.itemWidth):b._setY(-a*b.options.itemHeight),void 0!=a&&a!=b.itemIndex?setTimeout(function(){b._changeItemIndex(a)},b.options.crossEffectTime):b.itemChanging=!1)},e.prototype._zoomIn=function(a){var c=this;if(0>a&&(a=c.itemCount-1),a>c.itemCount-1&&(a=0),-1==c.options.slideDirection?c.currentX=-a*c.options.itemWidth:c.currentY=-a*c.options.itemHeight,void 0!=c._itemIndex&&(c.itemIndex=c._itemIndex),c.itemIndex!=a){c.itemChanging=!0;var d=c.dom.find(c.options.itemContainerCls+":first-child").children(),e=c.options.crossEffectTime/2;d.eq(c.itemIndex).css({transition:b.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease"}),d.eq(c.itemIndex).css({opacity:"0",transform:"scale(2)"}),d.eq(a).css({transition:b.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease",display:"block",transform:"scale(0)"}),setTimeout(function(){d.eq(c.itemIndex).css({transition:"",display:"none",transform:"scale(0)"}),d.eq(a).css({opacity:"1",transform:"scale(1)",display:"block"}),c._changeItemIndex(a)},e),c._itemIndex=a}},e.prototype._zoomOut=function(a){var c=this;if(0>a&&(a=c.itemCount-1),a>c.itemCount-1&&(a=0),-1==c.options.slideDirection?c.currentX=-a*c.options.itemWidth:c.currentY=-a*c.options.itemHeight,void 0!=c._itemIndex&&(c.itemIndex=c._itemIndex),c.itemIndex!=a){c.itemChanging=!0;var d=c.dom.find(c.options.itemContainerCls+":first-child").children(),e=c.options.crossEffectTime;d.eq(c.itemIndex).css({transition:b.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease"}),d.eq(c.itemIndex).css({opacity:"0",transform:"scale(0)"}),d.eq(a).css({opacity:"0",display:"block",transform:"scale(2)"}),setTimeout(function(){d.eq(c.itemIndex).css({transition:"",display:"none",transform:"scale(0)"}),d.eq(a).css({transition:b.getCSSVal("transform")+" "+e+"ms ease,opacity "+e+"ms ease",opacity:"1",transform:"scale(1)",display:"block"}),c._changeItemIndex(a)},e),c._itemIndex=a}},e.prototype._flip=function(c){var d=this;if(0>c&&(c=d.itemCount-1),c>d.itemCount-1&&(c=0),-1==d.options.slideDirection?d.currentX=-c*d.options.itemWidth:d.currentY=-c*d.options.itemHeight,void 0!=d._itemIndex&&(d.itemIndex=d._itemIndex),d.itemIndex!=c){d.itemChanging=!0;var e=d.itemContainerDom.children();void 0==d.flipRotated&&(d.flipRotated=0);var f=e.eq(c),g=e.eq(d.itemIndex),h=d.options.crossEffectTime;if(b.transform3d&&!a.browser.msie)-1==d.options.slideDirection?(f.css({display:"block",transform:"rotateY("+(d.flipRotated+180)+"deg)",transition:""}),2==d.options.defaultDirection&&c>d.itemIndex||4==d.options.defaultDirection&&c<d.itemIndex?(f.css({transform:"rotateY("+(d.flipRotated-180)+"deg)"}),d.flipRotated=d.flipRotated-180):d.flipRotated=d.flipRotated+180,d.itemContainerDom.css({transition:b.getCSSVal("transform")+" "+h+"ms ease",transform:"perspective(800px) rotateY("+d.flipRotated+"deg)"})):(f.css({display:"block",transform:"rotateX("+(d.flipRotated+180)+"deg)",transition:""}),3==d.options.defaultDirection&&c>d.itemIndex||1==d.options.defaultDirection&&c<d.itemIndex?(f.css({transform:"rotateX("+(d.flipRotated-180)+"deg)"}),d.flipRotated=d.flipRotated-180):d.flipRotated=d.flipRotated+180,d.itemContainerDom.css({transition:b.getCSSVal("transform")+" "+h+"ms ease",transform:"perspective(800px) rotateX("+d.flipRotated+"deg)"}));else{var i=1;-1==d.options.slideDirection?((2==d.options.defaultDirection&&c>d.itemIndex||4==d.options.defaultDirection&&c<d.itemIndex)&&(i=-1),f.css({transform:"skewY("+50*i+"deg) scale(0,1)",transition:""}),g.css({transform:"skewY("+50*i+"deg) scale(0,1)",transition:b.getCSSVal("transform")+" "+h/2+"ms ease"}),setTimeout(function(){f.css({display:"block",transform:"skewY(0deg) scale(1,1)",transition:b.getCSSVal("transform")+" "+h/2+"ms ease"})},h/2+1)):((3==d.options.defaultDirection&&c>d.itemIndex||1==d.options.defaultDirection&&c<d.itemIndex)&&(i=-1),f.css({transform:"skewX("+50*i+"deg) scale(1,0)",transition:""}),g.css({transform:"skewX("+50*i+"deg) scale(1,0)",transition:b.getCSSVal("transform")+" "+h/2+"ms ease"}),setTimeout(function(){f.css({display:"block",transform:"skewX(0deg) scale(1,1)",transition:b.getCSSVal("transform")+" "+h/2+"ms ease"})},h/2+1))}setTimeout(function(){g.css({display:"none"}),d._changeItemIndex(c)},h+5),d._itemIndex=c}},e.prototype._nothing=function(a){var b=this;0>a&&(a=b.itemCount-1),a>b.itemCount-1&&(a=0),b.itemChanging=!0,-1==b.options.slideDirection?b.currentX=-a*b.options.itemWidth:b.currentY=-a*b.options.itemHeight;var c=b.dom.find(b.options.itemContainerCls).children();c.eq(b.itemIndex).css({display:"none"}),c.eq(a).css({display:"block"}),b._changeItemIndex(a)},e.prototype._acceler=function(){function a(){if(0==f||1==b.scrolling)return b.itemChanging=!1,void b._changeItemIndex(h);f--;var c=b._goToItemEvent.direction+h;if((-1==b.options.slideDirection&&2==b.options.defaultDirection||1==b.options.slideDirection&&3==b.options.defaultDirection)&&(c=-1*b._goToItemEvent.direction+h),0>c){if(!b.options.loop)return;c=b.itemCount-1}else if(c>b.itemCount-1){if(!b.options.loop)return;c=0}-1==b.options.slideDirection?b.currentX=-c*b.options.itemWidth:b.currentY=-c*b.options.itemHeight;var d=b.dom.find(b.options.itemContainerCls).children();d.eq(h).css({display:"none"}),d.eq(c).css({display:"block"}),b.itemIndex=h=c,setTimeout(function(){a()},g)}var b=this,c=Math.floor(b.options.itemWidth/(2*b.itemCount));if(b._goToItemEvent){var d=b._goToItemEvent.moved,e=b._momentum(b._goToItemEvent.moved,b.duration);d=e.dist+d;var f=Math.floor(Math.abs(d)/c);b.itemChanging=!0,0==f&&Math.abs(d)>0&&f++;var g=e.time/(f+1),h=b.itemIndex;f>0?a():b.itemChanging=!1}},e.prototype._stopVideoAndAudio=function(b){b.find("video").each(function(){a(this)[0].pause()}),b.find("audio").each(function(){a(this)[0].pause()})},e.prototype._changeItemIndex=function(b){var c=this,d={fromItem:c.itemIndex,toItem:b},e=c.dom.find(c.options.itemContainerCls).children();d.fromId=e.eq(d.fromItem).attr("id"),d.toId=e.eq(d.toItem).attr("id"),d.targetControlId=c.dom.attr("id"),c.itemIndex=b,c._stopVideoAndAudio(e.eq(d.fromItem)),c.itemChanging=!1,a.isFunction(c.itemChanged)&&c.itemChanged(d),d.fromId!=d.toId&&c._startChildControl()},e.prototype._setTransition=function(a){var c=this;c._setItemContainerStyle(a?{transition:b.getCSSVal("transform")+" "+c.options.crossEffectTime+"ms ease"}:{transition:""})},e.prototype._setX=function(b){var c=this;if("none"!=c.options.crossEffectType){var e=c.currentX;if(c.currentX=b,1==c.options.loop&&c.itemCount>1&&c.currentX!=e){var f=c.itemContainerDom.children();if(c.directionX>0){var g=f.eq(c.itemIndex%c.itemCount).index();if(c.currentX<-c.options.itemWidth*c.options.itemCount-1&&g==c.itemCount-1){var h=f.eq(0);h.remove(),a(c.itemContainerDom).append(h),c.itemIndex=c.itemIndex-1,c.currentX=parseInt(c.currentX)+parseInt(c.options.itemWidth)}}else if(c.directionX<0){var g=f.eq(c.itemIndex%c.itemCount).index();if(c.currentX>0&&0==g){var i=f.eq(c.itemCount-1);i.remove(),a(c.itemContainerDom).prepend(i),c.itemIndex=c.itemIndex+1,c.currentX=c.currentX-c.options.itemWidth}}}if(c.options.use3d?c._setItemContainerStyle({transform:c._getTranslate(c.currentX,0,0)}):d(c.itemContainerDom[0],"left",c.currentX),"scroll"==c.options.crossEffectType){var j=Math.abs(c.currentX)%c.options.itemWidth,k=parseInt(Math.abs(b)/c.options.itemWidth,10);j>=.5*c.options.itemWidth&&(k+=1);var l=k;c.itemIndex!=l&&c._changeItemIndex(l)}}else{var m=c.accMoving;if(Math.abs(m-c.accMoved)>=.65*c.options.itemWidth/c.itemCount){var n=m-c.accMoved<0?1:-1;2==c.options.defaultDirection&&(n=m-c.accMoved>0?1:-1);var o=c.itemIndex+n;if(0>o){if(!c.options.loop)return;o=c.itemCount-1}else if(o>c.itemCount-1){if(!c.options.loop)return;o=0}c.accMoved=m,c._nothing(o)}}},e.prototype.scrollTo=function(a,c,d){var e=this;if(e.currentX=a,e.currentY=c,e.options.use3d?e._setItemContainerStyle({transform:e._getTranslate(a,c,0),transition:b.getCSSVal("transform")+" "+d+"ms ease"}):e.itemContainerDom.animate({left:a+"px",top:c+"px"},d),"scroll"==e.options.crossEffectType){var f=0,g=0,h=0;-1==e.options.slideDirection?(f=Math.abs(e.currentX)%e.options.itemWidth,g=parseInt(Math.abs(e.currentX)/e.options.itemWidth,10),f>=.5*e.options.itemWidth&&(g+=1),h=g,e.itemIndex!=h&&setTimeout(function(){e._changeItemIndex(h)},d)):1==e.options.slideDirection&&(f=Math.abs(e.currentY)%e.options.itemHeight,g=parseInt(Math.abs(e.currentY)/e.options.itemHeight,10),f>=.5*e.options.itemHeight&&(g+=1),h=g,e.itemIndex!=h&&setTimeout(function(){e._changeItemIndex(h)},d))}},e.prototype._setY=function(b){var c=this;if("none"!=c.options.crossEffectType){var e=c.currentY;if(c.currentY=b,1==c.options.loop&&c.itemCount>1&&c.currentY!=e){var f=c.itemContainerDom.children();if(c.directionY>0){var g=f.eq(c.itemIndex%c.itemCount).index();if(c.currentY<-c.options.itemHeight*c.options.itemCount-1&&g==c.itemCount-1){var h=f.eq(0);h.remove(),a(c.itemContainerDom).append(h),c.itemIndex=c.itemIndex-1,c.currentY=parseInt(c.currentY)+parseInt(c.options.itemHeight)}}else if(c.directionY<0){var g=f.eq(c.itemIndex%c.itemCount).index();if(c.currentY>0&&0==g){var i=f.eq(c.itemCount-1);i.remove(),a(c.itemContainerDom).prepend(i),c.itemIndex=c.itemIndex+1,c.currentY=c.currentY-c.options.itemHeight}}}if(c.options.use3d?c._setItemContainerStyle({transform:c._getTranslate(0,c.currentY,0)}):d(c.itemContainerDom[0],"top",c.currentY),"scroll"==c.options.crossEffectType){var j=Math.abs(c.currentY)%c.options.itemHeight,k=parseInt(Math.abs(c.currentY)/c.options.itemHeight,10);j>=.5*c.options.itemHeight&&(k+=1);var l=k;c.itemIndex!=l&&c._changeItemIndex(l)}}else{var m=c.accMoving;if(Math.abs(c.accMoving-c.accMoved)>=.65*c.options.itemHeight/c.itemCount){var n=m-c.accMoved<0?1:-1;3==c.options.defaultDirection&&(n=m-c.accMoved>0?1:-1);var o=c.itemIndex+n;if(0>o){if(!c.options.loop)return;o=c.itemCount-1}else if(o>c.itemCount-1){if(!c.options.loop)return;o=0}c.accMoved=m,c._nothing(o)}}},e.prototype._setItemContainerStyle=function(a){var b=this;a&&b.itemContainerDom.css(a)},e.prototype._getTranslate=function(a,c,d){var a=a||"0",c=c||"0",d=d||"0";return b.transform3d?"translate3d("+a+"px, "+c+"px, "+d+"px)":"translate("+a+"px, "+c+"px)"},e.prototype._itemClick=function(a){var b=this,c=0;if(b.options.clickSupport){switch(b.hasNext()&&(c=b.itemIndex+1),a.stopPropagation(),a.preventDefault(),b.options.crossEffectType){case"fade":b.goToItem(c);break;case"slide":b.goToItem(c);break;case"fly":b.goToItem(c);break;case"fall":b.goToItem(c);break;case"null":b.goToItem(c);break;case"flip":b.goToItem(c)}c>=0&&c<=b.itemCount-1&&b._triggerSyncEnd(c/(b.itemCount-1),b.options.crossEffectTime)}},e.prototype._touchStart=function(a){var b=this;b.scrolling||(b.moveReadyEnable||(a.preventDefault(),a.stopPropagation()),b.startPageX=c(a,"pageX"),b.startPageY=c(a,"pageY"),b.basePageX=b.startPageX,b.basePageY=b.startPageY,b.accMoving=0,b.accMoved=0,b.scrolling=!0,b.moveReady=!1,b.duration=0,b.timeStamp=a.timeStamp||(new Date).getTime(),b._setTransition(!1))},e.prototype._touchMove=function(b){var d=this;if(d.scrolling){var e=c(b,"pageX"),f=c(b,"pageY"),g=0,h=0,i=0,j=0,k=0,l=0;if(d.moveReady){if(b.preventDefault(),b.stopPropagation(),g=e-d.basePageX,h=f-d.basePageY,-1==d.options.slideDirection){if(d.accMoving=d.accMoving+g,k=d.currentX+g,d.directionX=0===g?d.directionX:g>0?-1:1,"scroll"==d.options.crossEffectType){var m=(d.itemCount-1)*d.options.itemWidth;if(k>0&&(k=0),Math.abs(k)>m&&(k=-m),d._setX(k),a.isFunction(d.options.syncMoving)){var n={};n.relativePosition=Math.abs(d.currentX)/d.scrollWidth,2==d.options.defaultDirection&&(n.relativePosition=(d.scrollWidth-Math.abs(d.currentX))/d.scrollWidth),n.syncTo=d.options.syncTo,n.syncFrom=d.options.syncFrom,n.direction=0,n.type=0,d.options.syncMoving(n)}}else if(d.moveReadyEnable&&(d._setX(k),a.isFunction(d.options.syncMoving))){var n={};n.relativePosition=Math.abs(d.currentX)/d.scrollWidth,2==d.options.defaultDirection&&"flip"!=d.options.crossEffectType&&(n.relativePosition=(d.scrollWidth-Math.abs(d.currentX))/d.scrollWidth),n.syncTo=d.options.syncTo,n.syncFrom=d.options.syncFrom,n.type=1,n.direction=0,d.options.syncMoving(n)}}else if(1==d.options.slideDirection)if(l=d.currentY+h,d.accMoving=d.accMoving+h,d.directionY=0===h?d.directionY:h>0?-1:1,"scroll"==d.options.crossEffectType){var o=(d.itemCount-1)*d.options.itemHeight;l>0&&(l=0),Math.abs(l)>o&&(l=-o);{d.currentY}if(d._setY(l),a.isFunction(d.options.syncMoving)){var n={};n.relativePosition=Math.abs(d.currentY)/d.scrollHeight,n.dist=h/d.scrollerHeight,n.slideDirection=d.directionY,3==d.options.defaultDirection&&(n.relativePosition=(d.scrollHeight-Math.abs(d.currentY))/d.scrollHeight,n.dist=-1*n.dist,n.slideDirection=-1*n.slideDirection),n.syncTo=d.options.syncTo,n.syncFrom=d.options.syncFrom,n.direction=0,n.type=0,d.options.syncMoving(n)}}else if(d.moveReadyEnable&&(d._setY(l),a.isFunction(d.options.syncMoving))){var n={};n.dist=h/d.scrollerHeight,n.slideDirection=d.directionY,n.relativePosition=Math.abs(d.currentY)/d.scrollHeight,3==d.options.defaultDirection&&"flip"!=d.options.crossEffectType&&(n.relativePosition=(d.scrollHeight-Math.abs(d.currentY))/d.scrollHeight,n.dist=-1*n.dist,n.slideDirection=-1*n.slideDirection),n.syncTo=d.options.syncTo,n.syncFrom=d.options.syncFrom,n.type=1,n.direction=0,d.options.syncMoving(n)}}else if(i=Math.abs(e-d.startPageX),j=Math.abs(f-d.startPageY),-1==d.options.slideDirection){if(i>5&&i>j){if(!d._canMoved(e-d.startPageX,d.options.slideDirection))return;b.preventDefault(),b.stopPropagation(),d.moveReady=!0}}else if(1==d.options.slideDirection&&j>5&&j>i){if(!d._canMoved(f-d.startPageY,d.options.slideDirection))return;b.preventDefault(),b.stopPropagation(),d.moveReady=!0}{b.timeStamp||(new Date).getTime()}d.basePageX=e,d.basePageY=f}},e.prototype._touchEnd=function(a){var b=this;if(b.scrolling&&(b.scrolling=!1,b.moveReady)){b.duration=(a.timeStamp||(new Date).getTime())-b.timeStamp,b.scrolling=!1;var c={};if(-1==b.options.slideDirection)c.slideDirection=-1,c.direction=0,c.moved=b.basePageX-b.startPageX,c.moved>0?c.direction=-1:c.moved<0&&(c.direction=1);else if(1==b.options.slideDirection){c.slideDirection=1,c.direction=0;{b.options.itemHeight}c.moved=b.basePageY-b.startPageY,c.moved>0?c.direction=-1:c.moved<0&&(c.direction=1)}c.duration=b.duration,b._setTransition(!0),b._touchEndHandler(c)}},e.prototype._canMoved=function(a,b){var c=this;if(1==c.options.loop)return!0;if(1==b){if(Math.abs(c.currentY)>=(c.itemCount-1)*c.options.itemHeight&&0>a)return!1;if(a>0&&c.currentY>=0)return!1}if(-1==b){if(Math.abs(c.currentX)>=(c.itemCount-1)*c.options.itemWidth&&0>a)return!1;if(a>0&&c.currentX>=0)return!1}return!0},e.prototype._syncStateMove=function(b){var c=this,d=0;if(0==b.type)if(-1==c.options.slideDirection){var e=-c.scrollWidth*b.relativePosition;2==c.options.defaultDirection&&"flip"!=c.options.crossEffectType&&(e=-c.scrollWidth+c.scrollWidth*b.relativePosition);var f=Math.abs(e)%c.options.itemWidth;d=parseInt(Math.abs(e)/c.options.itemWidth,10),f>=.5*c.options.itemWidth&&(d+=1),d!=c.itemIndex&&(c.itemChanging=!1,c._setTransition(!1),c.goToItem(d))}else{var g=-c.scrollHeight*b.relativePosition;3==c.options.defaultDirection&&"flip"!=c.options.crossEffectType&&(g=-c.scrollHeight+c.scrollHeight*b.relativePosition);var f=Math.abs(g)%c.options.itemHeight;d=parseInt(Math.abs(g)/c.options.itemHeight,10),f>=.5*c.options.itemHeight&&(d+=1),d!=c.itemIndex&&(c.itemChanging=!1,c._setTransition(!1),c.goToItem(d))}var h={};a.extend(h,b),h.syncTo="",h.syncFrom="",1==b.direction&&(h.syncTo=c.options.syncTo,c.options.syncMoving(h)),-1==b.direction&&(h.syncFrom=c.options.syncFrom,c.options.syncMoving(h))},e.prototype._syncMove=function(b){var c=this;if("scroll"==c.options.crossEffectType||"slide"==c.options.crossEffectType&&1==b.type){if(c._setTransition(!1),-1==c.options.slideDirection){var d=-c.scrollWidth*b.relativePosition;2==c.options.defaultDirection&&(d=-c.scrollWidth+c.scrollWidth*b.relativePosition),void 0!=b.dist&&1==c.options.loop?2==c.options.defaultDirection?(c.directionX=-1*b.slideDirection,c._setX(c.currentX-b.dist*c.scrollerWidth)):(c.directionX=b.slideDirection,c._setX(c.currentX+b.dist*c.scrollerWidth)):c._setX(d);var e={};a.extend(e,b),e.syncTo="",e.syncFrom="",1==b.direction&&(e.syncTo=c.options.syncTo,c.options.syncMoving(e)),-1==b.direction&&(e.syncFrom=c.options.syncFrom,c.options.syncMoving(e))}else if(1==c.options.slideDirection){var f=-c.scrollHeight*b.relativePosition;3==c.options.defaultDirection&&(f=-c.scrollHeight+c.scrollHeight*b.relativePosition),void 0!=b.dist&&1==c.options.loop?3==c.options.defaultDirection?(c.directionY=-1*b.slideDirection,c._setY(c.currentY-b.dist*c.scrollerHeight)):(c.directionY=b.slideDirection,c._setY(c.currentY+b.dist*c.scrollerHeight)):c._setY(f);var e={};a.extend(e,b),e.syncTo="",e.syncFrom="",-1!=b.direction&&(e.syncTo=c.options.syncTo,c.options.syncMoving(e)),1!=b.direction&&(e.syncFrom=c.options.syncFrom,c.options.syncMoving(e))}}else c._syncStateMove(b)},e.prototype._syncStateEnd=function(b){var c=this,d=0;if(-1==c.options.slideDirection){var e=-c.scrollWidth*b.relativePosition;2==c.options.defaultDirection&&"flip"!=c.options.crossEffectType&&(e=-c.scrollWidth+c.scrollWidth*b.relativePosition);var f=Math.abs(e)%c.options.itemWidth;d=parseInt(Math.abs(e)/c.options.itemWidth,10),f>=.5*c.options.itemWidth&&(d+=1),d*c.options.itemWidth!=Math.abs(c.currentX)&&(c.itemChanging=!1,c._setTransition(!1),c.goToItem(d))}else if(1==c.options.slideDirection){var g=-c.scrollHeight*b.relativePosition;3==c.options.defaultDirection&&"flip"!=c.options.crossEffectType&&(g=-c.scrollHeight+c.scrollHeight*b.relativePosition);var f=Math.abs(g)%c.options.itemHeight;d=parseInt(Math.abs(g)/c.options.itemHeight,10),f>=.5*c.options.itemHeight&&(d+=1),d*c.options.itemHeight!=Math.abs(c.currentY)&&(c.itemChanging=!1,c._setTransition(!1),c.goToItem(d))}var h={};a.extend(h,b),h.syncTo="",h.syncFrom="",-1!=b.direction&&(h.syncTo=c.options.syncTo,c.options.syncMoveEnd(h)),1!=b.direction&&(h.syncFrom=c.options.syncFrom,c.options.syncMoveEnd(h))},e.prototype._syncEnd=function(b){var c=this;if("scroll"==c.options.crossEffectType){if(-1==c.options.slideDirection){var d=-c.scrollWidth*b.relativePosition;2==c.options.defaultDirection&&(d=-c.scrollWidth+c.scrollWidth*b.relativePosition),c.scrollTo(d,0,b.time);var e={};a.extend(e,b),e.syncTo="",e.syncFrom="",-1!=b.direction&&(e.syncTo=c.options.syncTo,c.options.syncMoveEnd(e)),1!=b.direction&&(e.syncFrom=c.options.syncFrom,c.options.syncMoveEnd(e))}else if(1==c.options.slideDirection){var f=-c.scrollHeight*b.relativePosition;3==c.options.defaultDirection&&(f=-c.scrollHeight+c.scrollHeight*b.relativePosition),c.scrollTo(0,f,b.time);var e={};a.extend(e,b),e.syncTo="",e.syncFrom="",-1!=b.direction&&(e.syncTo=c.options.syncTo,c.options.syncMoveEnd(e)),1!=b.direction&&(e.syncFrom=c.options.syncFrom,c.options.syncMoveEnd(e))}}else c._syncStateEnd(b)},e.prototype._momentum=function(a,b){var c=6e-4,d=Math.abs(a)/b,e=d*d/(2*c),f=d/c;return{dist:e,time:f}},e.prototype._momentum2=function(a,b,c,d){var e=6e-4,f=Math.abs(a)/b,g=f*f/(2*e),h=0;return a>0&&g>c?(f=f*c/g,g=c):0>a&&g>d&&(f=f*d/g,g=d),g*=0>a?-1:1,h=f/e,{dist:Math.round(g),time:Math.round(h)}},e.prototype._touchEndHandler=function(a){var b=this;if("scroll"!=b.options.crossEffectType){if("none"==b.options.crossEffectType)return b.scrolling=!1,b._goToItemEvent=a,void b.goToItem(b.itemIndex+1);if("slide"==b.options.crossEffectType){var c=b.itemIndex;return-1==a.slideDirection?Math.abs(a.moved)>=50&&(c+=a.direction):Math.abs(a.moved)>=50&&(c+=a.direction),b.goToItem(c),void(-1==b.options.slideDirection?b._triggerSyncEnd(Math.abs(b.currentX)/b.scrollWidth,b.options.crossEffectTime):1==b.options.slideDirection&&b._triggerSyncEnd(Math.abs(b.currentY)/b.scrollHeight,b.options.crossEffectTime))}b.goToItem(b.itemIndex+1),"none"!=b.options.crossEffectType&&b._triggerSyncEnd((b.itemIndex+1)/(b.itemCount-1),b.options.crossEffectTime)}else{if(b.scrolling=!1,a.duration>=300)return;var d=a.moved,e=0,f=0;if(-1==b.options.slideDirection)Math.abs(b.currentX)==(b.itemCount-1)*b.options.itemWidth&&(d=0),e=-b.currentX,f=b.currentX+b.scrollerWidth-b.options.itemWidth;else{if(1!=b.options.slideDirection)return;Math.abs(b.currentY)==(b.itemCount-1)*b.options.itemHeight&&(d=0),e=-b.currentY,f=b.currentY+b.scrollerHeight-b.options.itemHeight}var g=b._momentum2(d,a.duration,e,f);if(0!=d){var h={};h.syncTo=b.options.syncTo,h.syncFrom=b.options.syncFrom,h.direction=0,h.type=0,-1==b.options.slideDirection?(b.scrollTo(b.currentX+g.dist,0,g.time),h.relativePosition=Math.abs(b.currentX)/b.scrollWidth,2==b.options.defaultDirection&&(h.relativePosition=(b.scrollWidth-Math.abs(b.currentX))/b.scrollWidth),h.time=g.time,b.options.syncMoveEnd(h)):1==b.options.slideDirection&&(b.scrollTo(0,b.currentY+g.dist,g.time),h.relativePosition=Math.abs(b.currentY)/b.scrollHeight,3==b.options.defaultDirection&&(h.relativePosition=(b.scrollHeight-Math.abs(b.currentY))/b.scrollHeight),h.time=g.time,b.options.syncMoveEnd(h))}}},e.prototype._triggerSyncEnd=function(a,b){var c=this,d={};d.syncTo=c.options.syncTo,d.syncFrom=c.options.syncFrom,d.direction=0,d.type=1,d.relativePosition=a,(2==c.options.defaultDirection||3==c.options.defaultDirection)&&"flip"!=c.options.crossEffectType&&(d.relativePosition=1-a),d.time=b,c.options.syncMoveEnd(d)},e.prototype.handleEvent=function(a){var c=this;switch(a.type){case b.touchStartEvent:c._touchStart(a);break;case b.touchMoveEvent:c._touchMove(a);break;case b.touchEndEvent:c._touchEnd(a);break;case"click":c._itemClick(a);break;case b.mouseOut:c._touchEnd(a)}},e.prototype.start=function(){var c=this;if(!c.isStoped)return!0;c.moveReadyEnable=!0,("fly"==c.options.crossEffectType||"fade"==c.options.crossEffectType||"fall"==c.options.crossEffectType||"flip"==c.options.crossEffectType)&&(c.moveReadyEnable=!1),"null"==c.options.crossEffectType&&(c.moveReadyEnable=!1),c.options.slideSupport&&(c.dom[0].addEventListener(b.touchStartEvent,c,!1),c.dom[0].addEventListener(b.touchMoveEvent,c,!1),c.dom[0].addEventListener(b.touchEndEvent,c,!1),b.touch||c.dom[0].addEventListener(b.mouseOut,c,!1)),c.options.clickSupport&&c.dom[0].addEventListener("click",c,!1),c.options.clickSupport||c.options.slideSupport?c.dom.css({"pointer-events":"auto",cursor:"pointer"}):(c.dom.css({"pointer-events":"none"}),c.dom.find(">.mci-ss-oh").css({"pointer-events":"none"}),c.dom.find(">.mci-ss-oh >.mci-ss-w").css({"pointer-events":"none"}),c.itemContainerDom.find(c.options.itemCls).css({"pointer-events":"none"}));var d=c.options.autoPlayInterval+c.options.crossEffectTime;1==c.options.autoPlay&&setTimeout(function(){c.loopHandlerCount=1,c.loopHandler=setInterval(function(){return-1!=c.options.loopTime&&c.loopHandlerCount>=c.options.loopTime*c.itemCount?void clearInterval(c.loopHandler):(2==c.options.defaultDirection||3==c.options.defaultDirection?c.goToPrev():c.goToNext(),void(c.loopHandlerCount=c.loopHandlerCount+1))},d)},c.options.autoPlayDelay||1e3),a.isFunction(c.options.startedHanlder)&&c.options.startedHanlder(this),c._startChildControl()},e.prototype._startChildControl=function(){var b=this,c=a(b.itemContainerDom).children().eq(b.itemIndex).attr("id");if(b.childControl){var d=b.childControl;for(var e in d)d[e].options.boundTargetRes==c&&a.isFunction(d[e].start)&&(d[e].isRunning||(d[e].start(),d[e].isRunning=!0))}},e.prototype.stop=function(){var a=this;a.dom[0].removeEventListener("click",a),void 0!=a.loopHandler&&clearInterval(a.loopHandler),a.options.slideSupport&&(a.dom[0].removeEventListener(b.touchStartEvent,a),a.dom[0].removeEventListener(b.touchMoveEvent,a),a.dom[0].removeEventListener(b.touchEndEvent,a)),a.isStoped=!0,a.isPlay=!1},e.prototype.play=function(){var a=this;if(1!=a.isPlay){a.isPlay=!0;var b=a.options.autoPlayInterval+a.options.crossEffectTime;(a.options.loopTime>=1||1==a.options.loop)&&setTimeout(function(){a.loopHandlerCount=1,a.loopHandler=setInterval(function(){return-1!=a.options.loopTime&&a.loopHandlerCount>=a.options.loopTime*a.itemCount?void clearInterval(a.loopHandler):(2==a.options.defaultDirection||3==a.options.defaultDirection?a.goToPrev():a.goToNext(),void(a.loopHandlerCount=a.loopHandlerCount+1))},b)},a.options.autoPlayDelay||1e3)}},e.prototype.reset=function(){var a=this;a.itemIndex!=a.options.defaultIndex&&a.goToItem(a.options.defaultIndex)},window.SlideShow=e,e}),function(a){"function"==typeof define&&define.amd?define("mci.video",["jquery"],a):a(jQuery)}(function(a){"use strict";var b=function(a){return this instanceof b?this.init(a):new b(a)};return b.prototype.init=function(b){var c=this;if(c.options=c.options||{autoPlay:!1,autoStop:!1,autoPlayDelay:0,videoRes:"",coverRes:"",fullscreen:!1,controlBar:!1,loopTime:0},c.options=a.extend(c.options,b),!c.options.dom)throw"setting dom can't be null or undefine";c.dom=c.options.dom,c.video=c.dom.find(">.mci-video-i >video"),c.videoContainer=c.dom.find(">.mci-video-i.video"),c.cover=c.dom.find(">.mci-video-i.cover"),c.loopedCount=0},b.prototype.handleEvent=function(a){switch(a.type){case"click":}},b.prototype._createFullScreenVideo=function(){var b=this,c=window.pageWidth||a("body").height(),d=window.pageHeight||a("body").width(),e=a('<div id="mci-f-v-wrap" class="mci-video-fullsreen"><span class="close"></span></div>');b.video.appendTo(e),e.find(".close").on("click",function(a){a.preventDefault(),a.stopPropagation(),b.stop()}),b.video.css({height:d+"px",width:c+"px"}),a("body").append(e)},b.prototype._exitFullScreenVideo=function(){var b=this;b.video.appendTo(b.videoContainer),a("#mci-f-v-wrap").remove(),b.video.css({height:b.options.height+"px",width:b.options.width+"px"})},b.prototype._bindEvent=function(){var a=this;a.video.on("error",function(){a.options.fullscreen&&a._exitFullScreenVideo(),a.cover.removeClass("hidden"),a.video.hide()}),a.video.on("ended",function(){-1==a.options.loopTime&&0==a.stoped?(a.video[0].currentTime=0,a.loadVideo(a.options.videoRes),a.video[0].play()):0==a.stoped&&a.loopedCount<a.options.loopTime?(a.loopedCount=a.loopedCount+1,a.video[0].currentTime=0,a.loadVideo(a.options.videoRes),a.video[0].play()):a.stop()})},b.prototype.start=function(){var a=this;a.stoped=!1,a.options.controlBar&&a.video.attr("controls","controls"),a.cover.removeClass("hidden"),a.options.width&&a.video.attr("width",a.options.width+"px"),a.options.height&&a.video.attr("height",a.options.height+"px"),a._bindEvent(),a.loadVideo(a.options.videoRes),a.options.autoPlay?(a.options.fullscreen&&a._createFullScreenVideo(),a.options.autoPlayDelay>0?setTimeout(function(){a.cover.addClass("hidden"),a.video[0].play(),a.loopedCount=a.loopedCount+1},a.options.autoPlayDelay):(a.loopedCount=a.loopedCount+1,a.cover.addClass("hidden"),a.video[0].play())):a.cover.on("click",function(b){b.preventDefault(),b.stopPropagation(),a.loopedCount=1,a.cover.addClass("hidden"),a.options.fullscreen&&a._createFullScreenVideo(),a.loadVideo(a.options.videoRes),a.video[0].play()})},b.prototype.loadVideo=function(a){var b=this;b.video.html(""),b.video.append('<source src="'+a.replace(".mp4",".ogv")+'" type=\'video/ogg; codecs="theora, vorbis"\'/>'),b.video.append('<source src="'+a.replace(".mp4",".webm")+"\" type='video/webm' >"),b.video.append('<source src="'+a+"\" type='video/mp4' >")},b.prototype.stop=function(){var a=this;a.stoped=!0,a.options.fullscreen&&a._exitFullScreenVideo(),a.cover.removeClass("hidden"),a.video[0].pause(),a.loopedCount=0},window.MciVideo=b,MciVideo}),function(a){"function"==typeof define&&define.amd?define("mci.webbrowser",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";function c(a,b){return d?a.changedTouches[0][b]:a[b]}var d=b.touch,e=b.touchStartEvent,f=b.touchMoveEvent,g=b.touchEndEvent,h=b.mouseOut,i="click",j=function(a){return this instanceof j?this.init(a):new j(a)};return j.prototype.init=function(b){var c=this;if(c.options=c.options||{url:"",autoScaleToFit:"",autoPlay:"",autoPlayDelay:"",coverRes:"",uiSupport:!1,bgTransparent:""},c.options=a.extend(c.options,b),!c.options.dom)throw"setting dom can't be null or undefine";if(c.dom=c.options.dom,c.iframeDom=c.dom.find(">iframe"),c.iframeConver=c.dom.find(">.mci-wb-state"),c.iframeDom.attr("allowtransparency","true"),!c.options.uiSupport){c.dom.find(">.mci-wb-bg").removeClass("none");var i=c.dom.find(">.mci-wb-bg")[0];c.iframeDom.on("load",function(){var a=c.iframeDom[0].contentWindow.document.body,b=a.scrollTop,j=a.scrollLeft;c.scrollHeight=a.scrollHeight,c.scrollWidth=a.scrollWidth,c.scrollDirection={x:!1,y:!1},c.currentPosition={x:j,y:b},c.currentPosition.y+c.options.height<c.scrollHeight&&(c.scrollDirection.y=!0),c.currentPosition.x+c.options.width<c.scrollWidth&&(c.scrollDirection.x=!0),(1==c.scrollDirection.x||1==c.scrollDirection.y)&&(i.addEventListener(e,c,!1),i.addEventListener(f,c,!1),i.addEventListener(g,c,!1),d||i.addEventListener(h,c,!1))})}},j.prototype.handleEvent=function(a){var b=this;switch(a.type){case i:b._click(a);break;case e:b._touchStart(a);break;case f:b._touchMove(a);break;case g:b._touchEnd(a);break;case h:b._touchOut(a)}},j.prototype._touchStart=function(a){var b=this;b.scrolling||(b.startPageX=c(a,"pageX"),b.startPageY=c(a,"pageY"),b.basePageX=b.startPageX,b.basePageY=b.startPageY,b.scrolling=!0,b.moveReady=!1)},j.prototype._touchMove=function(a){var b=this;if(b.scrolling){var d=c(a,"pageX"),e=c(a,"pageY"),f=0,g=0,h=0,i=0,j=0,k=0;if(b.moveReady)a.preventDefault(),a.stopPropagation(),f=d-b.basePageX,g=e-b.basePageY,j=b.currentPosition.x-f,k=b.currentPosition.y-g,b._setPosition({x:j,y:k});else{h=Math.abs(d-b.startPageX),i=Math.abs(e-b.startPageY);var l=!1,m=!1;h>5&&(l=!0),i>5&&(m=!0),h>=i?b.scrollDirection.x&&(b.moveReady=!0):b.scrollDirection.y&&(b.moveReady=!0)}b.basePageX=d,b.basePageY=e}},j.prototype._setPosition=function(a){var b=this;1==b.scrollDirection.x&&(b.currentPosition.x=a.x,a.x<=0&&(b.currentPosition.x=0),a.y+b.options.width>b.scrollWidth&&(b.currentPosition.x=b.scrollWidth-b.options.width)),1==b.scrollDirection.y&&(b.currentPosition.y=a.y,a.y<=0&&(b.currentPosition.y=0),a.y+b.options.height>b.scrollHeight&&(b.currentPosition.y=b.scrollHeight-b.options.height)),b.iframeDom[0].contentWindow.document.body.scrollLeft=b.currentPosition.x,b.iframeDom[0].contentWindow.document.body.scrollTop=b.currentPosition.y},j.prototype._touchEnd=function(){var a=this;a.scrolling=!1},j.prototype._touchOut=function(){var a=this;a.scrolling=!1},j.prototype._click=function(a){var b=this;
0==b.options.autoPlay&&""!=b.options.coverRes&&(a.preventDefault(),a.stopPropagation(),b.iframeDom.attr("src",b.options.url).css({"z-index":"1"}),b.iframeConver.css({"z-index":"0"}),b.iframeConver[0].removeEventListener(i,b,!1))},j.prototype.start=function(){var a=this;a.options.autoPlay?(a.options.autoPlayDelay>0?setTimeout(function(){a.iframeDom.attr("src",a.options.url)},a.options.autoPlayDelay):a.iframeDom.attr("src",a.options.url),a.iframeConver.css({"z-index":"0"}),a.iframeDom.css({"z-index":"1"})):""!=a.options.coverRes&&a.options.uiSupport&&(a.iframeConver[0].addEventListener(i,a,!1),a.iframeConver.css({"z-index":"1"}),a.iframeDom.css({"z-index":"0"}))},window.WebBrowser=j,j}),function(a){"function"==typeof define&&define.amd?define("mci.mask",["jquery"],a):a(jQuery)}(function(a){"use strict";var b=function(a){return this instanceof b?this.init(a):new b(a)};return b.prototype.init=function(b){var c=this;c.options=c.options||{hiddenChanged:function(){}},c.options=a.extend(c.options,b);var d=document.createElement("div");d.className="mci-mask",d.setAttribute("id","mci-mask"),c.options.width&&(d.style.width=c.options.width+"px"),c.options.height&&(d.style.height=c.options.height+"px"),a("body").append(d),c.dom=a("#mci-mask"),c.dom[0].addEventListener("click",c,!1)},b.prototype.handleEvent=function(a){var b=this;switch(a.type){case"click":b._click(a)}},b.prototype.show=function(){var a=this;a.dom.show()},b.prototype.hide=function(){var b=this;b.dom.remove(),a.isFunction(b.options.hiddenChanged)&&b.options.hiddenChanged()},b.prototype._click=function(a){var b=this;a.stopPropagation(),a.preventDefault(),b.hide()},window.Mask=b,b}),function(a){"function"==typeof define&&define.amd?define("mci.page",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){"use strict";function c(a,b){return this instanceof c?this.init(a,b):new c(a,b)}function d(a,b){return window.navigator.msPointerEnabled?a[b]:l.touch?a.changedTouches[0][b]:a[b]}function e(a,b,c){var d=k[b];d?a[d]=c:void 0!==a[b]?(k[b]=b,a[b]=c):h(j,function(d){var e=g(d)+g(b);return void 0!==a[e]?(k[b]=e,a[e]=c,!0):void 0})}function f(a){if(void 0!==i.style[a])return a;var b;return h(j,function(c){var d=g(c)+g(a);return void 0!==i.style[d]?(b="-"+c+"-"+a,!0):void 0}),b}function g(a){return a.charAt(0).toUpperCase()+a.substr(1)}function h(a,b){for(var c=0,d=a.length;d>c;c++)if(b(a[c],c))return!0;return!1}var i=document.createElement("div"),j=["webkit","moz","o","ms"],k={},l={};l.transform3d=b.transform3d,l.transform=b.transform,l.transition=b.transition,l.touch=b.touch,l.cssAnimation=(b.transform3d||b.transform)&&b.transition;var m=b.touchStartEvent,n=b.touchMoveEvent,o=b.touchEndEvent,p=b.mouseOut;return c.prototype._enablePageAnimation=function(a){var b=this,c="0ms";1==a&&(c="350ms"),l.cssAnimation?b._setStyle({transitionDuration:c}):b.animation=a},c.prototype.init=function(b,c){var d=this;if(d.element=b,d.dom=a(b),"string"==typeof b&&(d.element=document.querySelector(b)),!d.element)throw new Error("element not found");return c=c||{},d.distance=void 0===c.distance?null:c.distance,d.sectionDistance=c.sectionDistance||"1024",d.maxPage=void 0===c.maxPage?null:c.maxPage-1,d.disableTouch=void 0===c.disableTouch?!1:c.disableTouch,d.disable3d=void 0===c.disable3d?!1:c.disable3d,d.itemCls=c.itemCls||".mpage-c",d.sectionContainer=c.sectionConCls||"section.item",d.sectionCls=c.sectionCls||"article",d.itemCount=c.itemCount||4,d.pageChanged=c.pageChanged||null,d.pageChanging=c.pageChanging||null,d.sectionChanged=c.sectionChanged,d.syncMoving=c.syncMoving,d.syncMoveEnd=c.syncMoveEnd,d.secFlowAttr=c.secFlowAttr||"flow",d.currentItemIndex=0,d.currentPage=0,d.currentSection=0,d.currentX=0,d.currentY=0,d.directionX=0,d.directionY=0,d.animation=!1,d.use3d=l.transform3d,d.disable3d===!0&&(d.use3d=!1),l.cssAnimation?(d._setStyle({transitionProperty:f("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:d._getTranslate(0)}),d._setSectionContainerStyle({transitionProperty:f("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:d._getTranslate(0)})):(d._setStyle({position:"relative",left:"0px"}),d._setStyle({position:"relative",top:"0px"})),d.element.addEventListener(m,d,!1),d.element.addEventListener(n,d,!1),d.element.addEventListener(o,d,!1),l.touch||d.element.addEventListener(p,d,!1),a(d.element).on("webkitTransitionEnd transitionend msTransitionEnd oTransitionEnd",function(){if(null!=d.changeEvent){var a=d.changeEvent;d.changeEvent=null,d._pageChangedHanlder(a)}}),d},c.prototype.handleEvent=function(a){var b=this;switch(a.type){case m:b._touchStart(a);break;case n:b._touchMove(a);break;case o:b._touchEnd(a);break;case p:b._touchEnd(a);break;case"click":b._click(a);break;case"changeEvent":}},c.prototype.refresh=function(){},c.prototype._setSectionContainerStyle=function(a){var b=this;if(a){var c=b.dom.find(b.itemCls).eq(b.currentItemIndex).find(b.sectionContainer);if(c.length>0){var d=c[0].style;for(var f in a)e(d,f,a[f])}}},c.prototype.hasNext=function(){var a=this;return a.currentPage<a.maxPage},c.prototype.hasPrev=function(){var a=this;return a.currentPage>0},c.prototype.toNext=function(){var a=this;a.hasNext()&&a.goToPage(a.currentPage+1)},c.prototype.toPrev=function(){var a=this;a.hasPrev()&&a.goToPage(a.currentPage-1)},c.prototype.pageChanged=null,c.prototype.goToPage=function(b,c){var d=this,e=d.currentPage,f=0;if(void 0===b&&(b=d.currentPage),0>=b?(d.currentPage=0,b=0):b>=d.maxPage?b=d.currentPage=d.maxPage:d.currentPage=parseInt(b,10),d._enablePageAnimation(!0),b>e?(f=1,d.currentItemIndex++):e>b&&(d.currentItemIndex--,f=-1),d.changeEvent=null,void 0!=b&&e!=b){var g={};g.oldPage=e,g.newPage=b,g.itemIndex=d.currentItemIndex,g.jumpToSection=c,b>e?d.directionX=1:e>b&&(d.directionX=-1),g.direction=d.directionX,d.changeEvent=g}if(d._setX(-d.currentItemIndex*d.distance),a.isFunction(d.syncMoveEnd)){var h={};h.pageIndex=d.currentPage,h.sectionIndex=d.currentSection,h.from=e,h.to=b,h.incre=f,h.slideDirection=-1,d.syncMoveEnd(h)}},c.prototype.jumpToPage=function(b,c){var d=this;if(b==d.currentPage)return void(void 0!=typeof c&&d.goToSection(c));if(b==d.currentPage+1||b==d.currentPage-1)return void d.goToPage(b,c);var e=d.currentPage;void 0===b&&(b=d.currentPage),0>=b?(d.currentPage=0,b=0):b>=d.maxPage?b=d.currentPage=d.maxPage:d.currentPage=parseInt(b,10),d._enablePageAnimation(!0);var f=d.currentItemIndex,g=0;if(b>e?(d.directionX=1,d.currentItemIndex++,g=1):e>b&&(d.currentItemIndex--,d.directionX=-1,g=-1),a.isFunction(d.pageChanging)){var h={fromItemIndex:f,toItemIndex:d.currentItemIndex,toPage:b};h.dom=d.dom.find(d.itemCls).eq(d.currentItemIndex),h.oldPage=e,d.pageChanging(h)}if(void 0!=b&&e!=b){var i={};i.oldPage=e,i.newPage=b,i.itemIndex=d.currentItemIndex,i.direction=d.directionX,i.changedDoms=[],i.isJump=!0,i.jumpToSection=c;for(var j=d.dom.find(d.itemCls),k=0;k<j.length;k++)if(k!=d.currentItemIndex){var l=j.eq(k);l.pageIndex=d.currentPage+(k-d.currentItemIndex),l.oldPageIndex=e+d.directionX+(k-d.currentItemIndex),i.changedDoms.push(l)}d.changeEvent=i}if(d._setX(-d.currentItemIndex*d.distance),a.isFunction(d.syncMoveEnd)){var m={};m.pageIndex=d.currentPage,m.sectionIndex=d.currentSection,m.from=e,m.to=b,m.incre=g,m.slideDirection=-1,d.syncMoveEnd(m)}},c.prototype._getSectionHeight=function(){var b=this;return window.pageWidth=a(window).width(),window.pageHeight=a(window).height(),b.sectionDistance=window.pageHeight,b.distance=window.pageWidth,window.pageHeight},c.prototype._getPageWidth=function(){var b=this;return window.pageWidth=a(window).width(),window.pageHeight=a(window).height(),b.sectionDistance=window.pageHeight,b.distance=window.pageWidth,window.pageWidth},c.prototype._getSectionCount=function(){var a=this;return a.dom.find(a.itemCls).eq(a.currentItemIndex).find(a.sectionCls).length},c.prototype.goToSection=function(b){var c=this,d=c.dom.find(c.itemCls).eq(c.currentItemIndex).find(c.sectionCls).length,e=c.currentSection;(void 0==b||null==b)&&(b=c.currentSection),0>b?b=c.currentSection=0:b>=d?b=c.currentSection=d-1:c.currentSection=b,l.cssAnimation?c._setSectionContainerStyle({transitionProperty:f("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"450ms"}):c.animation=!0;var g=b,h=c.sectionDistance||c._getSectionHeight();c._setY(-g*h);var i=0;if(e>g?i=-1:g>e&&(i=1),a.isFunction(c.syncMoveEnd)){var j={};j.from=e,j.to=g,j.pageIndex=c.currentPage,j.sectionIndex=c.currentSection,j.incre=i,j.slideDirection=1,c.syncMoveEnd(j)}e!=g&&setTimeout(function(){if(a.isFunction(c.sectionChanged)){var b={from:e,to:g,dom:c.dom.find(c.itemCls).eq(c.currentItemIndex)};b.pageIndex=c.currentPage,c.sectionChanged(b)}},250)},c.prototype._pageChangedHanlder=function(b){var c=this;if(b.changedDoms=b.changedDoms||[],c.currentSection=0,c.currentY=0,b.currentPage=c.currentPage,c._setSectionContainerStyle({transitionProperty:f("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:c._getTranslate(0)}),2==c.currentItemIndex&&c.currentPage+2<=c.maxPage&&b.direction>0){c._enablePageAnimation(!1);var d=c.dom.find(c.itemCls+":first-child"),e=d;e.pageIndex=c.currentPage+2,e.oldPageIndex=c.currentPage-2,b.changedDoms.push(e),e.html("").appendTo(c.dom),c._setX(-c.distance),c.currentItemIndex=1,c.currentX=-c.distance,setTimeout(function(){c._enablePageAnimation(!0)},50)}else if(0==c.currentItemIndex&&c.currentPage-1>=0&&b.direction<0){c._enablePageAnimation(!1);var g=c.dom.find(c.itemCls+":last-child"),h=g;h.pageIndex=c.currentPage-1,h.oldPageIndex=c.currentPage+3,b.changedDoms.push(h),h.html("").insertBefore(c.dom.find(c.itemCls+":first-child")),c._setX(-c.distance),c.currentItemIndex=1,c.currentX=-c.distance,setTimeout(function(){c._enablePageAnimation(!0)},50)}a.isFunction(c.pageChanged)&&c.pageChanged(b),void 0!=typeof b.jumpToSection&&c.goToSection(b.jumpToSection)},c.prototype._setX=function(b){var c=this;c.currentX!=b&&(c.currentX=b,a(c.element).attr("data-offset",b),l.cssAnimation?c.element.style[k.transform]=c._getTranslate(b):c.animation?(c._animate(b),setTimeout(function(){if(null!=c.changeEvent){var a=c.changeEvent;c.changeEvent=null,c._pageChangedHanlder(a)}},360)):(-1==b.toString().indexOf("%")&&(b+="px"),c.element.style.left=b))},c.prototype._setY=function(b){var c=this;if(c.currentY!=b){c.currentY=b;var d=c.dom.find(c.itemCls).eq(c.currentItemIndex).find(c.sectionContainer).get(0);a(d).attr("data-offset",b),d.style[k.transform]=c._getTranslate(0,b)}},c.prototype._touchStart=function(a){var b=this;b.disableTouch||(l.touch||a.preventDefault(),b._setSectionContainerStyle({transitionDuration:"0ms"}),b._enablePageAnimation(!1),b.scrolling=!0,b.moveReady=!1,b.startPageX=d(a,"pageX"),b.startPageY=d(a,"pageY"),b.basePageX=b.startPageX,b.basePageY=b.startPageY,b.direction=0,b.directionX=0,b.directionY=0,b.startTime=a.timeStamp,b.currentY=-b.currentSection*b._getSectionHeight(),b.currentX=-b.currentItemIndex*b._getPageWidth())},c.prototype._touchMove=function(b){var c=this;if(c.scrolling){var e,f,g,h,i,j,k=d(b,"pageX"),l=d(b,"pageY");if(i=Math.abs(k-c.startPageX),j=Math.abs(l-c.startPageY),c.moveReady&&0!=c.direction){if(b.preventDefault(),b.stopPropagation(),e=k-c.basePageX,f=l-c.basePageY,-1===c.direction){var m=c.currentX;if(g=c.currentX+e,c.directionX=0===e?c.directionX:e>0?-1:1,(c.currentPage==c.maxPage&&c.directionX>0||0==c.currentPage&&c.directionX<0)&&(g=c.currentX+e/4),c._setX(g),a.isFunction(c.syncMoving)){var n={};n.dist=g-m,n.slideDirection=-1,n.direction=0,n.pageIndex=c.currentPage,n.sectionIndex=c.currentSection,n.from=c.currentPage,n.to=c.currentPage;var o=Math.abs(c.currentItemIndex*c.distance);o>Math.abs(g)?(n.to=c.currentPage-1,n.to<0&&(n.to=0)):o<Math.abs(g)&&(n.to=c.currentPage+1,n.to>c.maxPage&&(n.to=c.maxPage),g>0&&(n.to=0)),n.to>n.from?n.direction=1:n.to<n.from&&(n.direction=-1),c.syncMoving(n)}}else if(1===c.direction){var p=c.currentY;h=c.currentY+f,c.directionY=0===f?c.directionY:f>0?-1:1;var q=c._getSectionCount()-1;if((c.currentSection==q&&c.directionY>0||0==c.currentSection&&c.directionY<0)&&(h=c.currentY+f/4),c._setY(h),a.isFunction(c.syncMoving)){var n={};n.dist=h-p,n.slideDirection=1,n.direction=0,n.pageIndex=c.currentPage,n.sectionIndex=c.currentSection,n.from=c.currentSection,n.to=c.currentSection;var o=Math.abs(c.currentSection*c.sectionDistance);o>Math.abs(h)?(n.to=c.currentSection-1,n.to<0&&(n.to=0)):o<Math.abs(h)&&(n.to=c.currentSection+1,n.to>q&&(n.to=q),h>0&&(n.to=0)),n.to>n.from?n.direction=1:n.to<n.from&&(n.direction=-1),c.syncMoving(n)}}}else(i>5||j>5)&&(c._canMoved(k-c.basePageX,l-c.basePageY,b)===!0?(b.preventDefault(),b.stopPropagation(),c.moveReady=!0,c.element.addEventListener("click",c,!0)):c.direction=0);c.basePageX=k,c.basePageY=l}},c.prototype._canMoved=function(c,d,e){var f=this,g=0;if(g=Math.abs(d)>Math.abs(c)?1:-1,1==g){if(f.direction=1,b.touch){var h=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,i=parseInt(a(document).height()),j=parseInt(a(window).height()),k=!0;if(a(document).scrollTop()<=0&&d>0&&(k=!1),0>d&&h>=i-j&&(k=!1),0>d&&parseInt(a(document).scrollTop())-d>=i-j&&(k=!1),a(document).scrollTop()-d<=0&&d>0&&(k=!1),k)return!1}var l=f._getSectionCount()-1;if(0>d&&f.currentSection<l)return f.direction=1,!0;if(d>0&&f.currentSection>0)return f.direction=1,!0}else{if(0>c&&f.currentPage<f.maxPage){if(1!=f.direction)return f.direction=-1,!0}else if(c>0&&f.currentPage>0&&1!=f.direction)return f.direction=-1,!0;0>c&&f.currentPage==f.maxPage&&e.stopPropagation(),c>0&&0==f.currentPage&&e.stopPropagation()}return!1},c.prototype._touchEnd=function(a){var b=this;if(b.scrolling){if(b.scrolling=!1,b.direction>0){var c=b.dom.find(b.itemCls).eq(b.currentItemIndex).find(b.sectionContainer).attr(b.secFlowAttr);if("1"==c){var d=b.sectionDistance-b.dom.find(b.itemCls).eq(b.currentItemIndex).find(b.sectionContainer).innerHeight();return b._setSectionContainerStyle({transitionDuration:"350ms"}),void(b.currentY>0?b._setY(0):b.currentY<=d&&b._setY(d))}var e=0,e=b.basePageY-b.startPageY;b.directionY=e>0?-1:1,b.goToSection(Math.abs(e)<100?b.currentSection:b.currentSection+1*b.directionY),Math.abs(f)>0&&(a.preventDefault(),a.stopPropagation())}else if(b.direction<0){var f=b.basePageX-b.startPageX;b.directionX=f>0?-1:1,b.goToPage(Math.abs(f)<100?b.currentPage:b.currentPage+1*b.directionX),Math.abs(e)>0&&(a.preventDefault(),a.stopPropagation())}setTimeout(function(){b.element.removeEventListener("click",b,!0)},200)}},c.prototype._click=function(a){a.stopPropagation(),a.preventDefault()},c.prototype._setStyle=function(a){var b=this,c=b.element.style;for(var d in a)e(c,d,a[d])},c.prototype._animate=function(a){var b=this,c=b.element,d=+new Date,e=parseInt(c.style.left,10),f=a,g=350,h=function(a,b){return-(a/=b)*(a-2)},i=setInterval(function(){var a,b,j=new Date-d;j>g?(clearInterval(i),b=f):(a=h(j,g),b=a*(f-e)+e),c.style.left=b+"px"},10)},c.prototype.destroy=function(){var a=this;a.element.removeEventListener(m,a),a.element.removeEventListener(n,a),a.element.removeEventListener(o,a)},c.prototype._getTranslate=function(a,b,c){var d=this,a=a||"0",b=b||"0",c=c||"0";return-1==b.toString().indexOf("%")&&(b+="px"),-1==a.toString().indexOf("%")&&(a+="px"),d.use3d?"translate3d("+a+", "+b+", "+c+"px)":"translate("+a+", "+b+")"},c.prototype._resizeView=function(){var b=this,c=b.sectionDistance,d=b.distance;window.pageWidth=a(window).width(),window.pageHeight=a(window).height(),b.sectionDistance=window.pageHeight,b.distance=window.pageWidth,b._setSectionContainerStyle({transitionDuration:"0ms"}),b._enablePageAnimation(!1);var e=a(b.element).attr("data-offset");e&&0/0!=e||(e=0),b._setX(b.distance*e/d);for(var f=b.dom.find(b.itemCls),g=0;g<f.length;g++)if(g==b.currentItemIndex){var h=f.eq(b.currentItemIndex).find(b.sectionContainer).attr("data-offset");h&&0/0!=h||(h=0),b._setY(b.sectionDistance*h/c)}else b.dom.find(b.itemCls).eq(g).find(b.sectionContainer).css({transform:b._getTranslate(0,0,0)})},window.Mcipage=c,c}),function(a){"function"==typeof define&&define.amd?define("mci.overlaypage",["jquery","mci.support"],a):a(jQuery,Support)}(function(a,b){function c(a){return this instanceof c?this.init(a):new c(a)}var d=window.overlaySections,e=window.CommonSections;return c.prototype.init=function(b){var c=this;return c.options=c.options||{dom:null,count:0,width:768,height:1024},c.options=a.extend(c.options,b),c.dom=c.options.dom,c.dom?(c.itemIndex=0,c.sectionIndex=0,c.currentX=0,c.currentY=0,c.itemsCount=c.dom.find(".cpage").length,c):null},c.prototype._getPageHeight=function(){var b=this;return window.pageWidth=a(window).width(),window.pageHeight=a(window).height(),b.options.height=window.pageHeight,b.options.width=window.pageWidth,window.pageHeight},c.prototype._getPageWidth=function(){var b=this;return window.pageWidth=a(window).width(),window.pageHeight=a(window).height(),b.options.height=window.pageHeight,b.options.width=window.pageWidth,window.pageWidth},c.prototype._getCurrentY=function(){var a=this;return a._getPageHeight(),a.currentY},c.prototype._getCurrentX=function(){var a=this;return a._getPageHeight(),a.currentX},c.prototype._syncMove=function(a){var b=this;if(b.moving=!1,1==a.slideDirection){if(d[a.pageIndex][a.from]!=d[a.pageIndex][a.to]){b._getCurrentY();var c=a.dist+b.currentY;b.moving=!0,b._setSectionTransition(!1),b._setY(c,a)}}else if(d[a.pageIndex][a.sectionIndex]!=d[a.to][0]){b._getCurrentX();var e=a.dist+b.currentX;b.moving=!0,b._setTransition(!1),b._setX(e,a)}},c.prototype._syncMoveEnd=function(b){var c=this;if(1==b.slideDirection){if(c._getCurrentY(),b.to>d[b.pageIndex].length-1&&(b.to=d[b.pageIndex].length-1),-1==b.to&&(b.to=0),c.moving||d[b.pageIndex][b.from]!=d[b.pageIndex][b.to]){c.moving=!1;var e=-(c.sectionIndex+b.incre)*c.options.height;c._setSectionTransition(!0),b.direction=0,e-c.currentY>0?b.direction=-1:e-c.currentY<0&&(b.direction=1),c._setY(e,b),c.sectionIndex=c.sectionIndex+b.incre,0!=b.incre&&a.isFunction(c.options.sectionChanged)&&setTimeout(function(){var a={};a.type=1,a.sender=c,c.options.sectionChanged(a)},255)}}else if(c._getCurrentX(),b.to>d.length-1&&(b.to=d.length-1),-1==b.to&&(b.to=0),c.moving||d[b.from][b.sectionIndex]!=d[b.to][0]){c.moving=!1,0!=b.incre&&(c.sectionIndex=0,c.currentY=0);var f=-(c.itemIndex+b.incre)*c.options.width;c._setTransition(!0),b.direction=0,f-c.currentX>0?b.direction=-1:f-c.currentX<0&&(b.direction=1),c._setX(f,b),c.itemIndex=c.itemIndex+b.incre,0!=b.incre&&a.isFunction(c.options.sectionChanged)&&setTimeout(function(){var a={};a.type=-1,a.sender=c,c.options.sectionChanged(a)},255)}},c.prototype._setX=function(b,c){var f=this;f.currentX=b;var g=f.dom.find(".cpage");if(c.direction<0){if(f.currentX>0&&0==f.itemIndex){var h=g.eq(1);h.remove().css({transition:"",transform:f._getTranslate(0,0,0)}),f.toPage=null,f.toSection=null,h.find(".cpage-i").html("");var i=h.find(".cpage-i:first-child");if(-1!=c.to&&i.html(e["_"+d[c.to][0]]),f.dom.prepend(h),a.isFunction(f.options.sectionChanging)){var j={};j.sender=f,j.dom=i,j.type=-1,f.options.sectionChanging(j)}f.currentX=f.currentX-f.options.width,f.itemIndex=f.itemIndex+1}else if(g.eq(0).css({transition:"",transform:f._getTranslate(0,0,0)}),!f.toPage&&(g.eq(0).find(".cpage-i:first-child").html(""),g.eq(0).find(".cpage-i:first-child").html(e["_"+d[c.to][0]]),f.toSection=null,a.isFunction(f.options.sectionChanging))){var j={};j.sender=f,j.dom=g.eq(0).find(".cpage-i:first-child"),j.type=-1,f.options.sectionChanging(j)}}else if(c.direction>0)if(f.currentX<-f.options.width&&1==f.itemIndex){var k=g.eq(0);if(k.remove().css({transition:"",transform:f._getTranslate(0,0,0)}),k.find(".cpage-i").html(""),-1!=c.to&&k.find(".cpage-i:first-child").html(e["_"+d[c.to][0]]),f.toPage=null,f.toSection=null,f.dom.append(k),a.isFunction(f.options.sectionChanging)){var j={};j.sender=f,j.dom=k.find(".cpage-i:first-child"),j.type=-1,f.options.sectionChanging(j)}f.itemIndex=f.itemIndex-1,f.currentX=f.currentX+f.options.width}else if(g.eq(1).css({transition:"",transform:f._getTranslate(0,0,0)}),!f.toPage&&(g.eq(1).find(".cpage-i:first-child").html(""),g.eq(1).find(".cpage-i:first-child").html(e["_"+d[c.to][0]]),a.isFunction(f.options.sectionChanging))){var j={};j.sender=f,j.dom=g.eq(1).find(".cpage-i:first-child"),j.type=-1,f.options.sectionChanging(j)}f.dom.attr("data-offset",f.currentX),f._setContainerStyle({transform:f._getTranslate(f.currentX,0,0)})},c.prototype._setY=function(b,c){var f=this;f.currentY=b;var g=f.dom.find(".cpage").eq(f.itemIndex),h=g.find(".cpage-i");if(c.direction<0){if(f.currentY>0&&0==f.sectionIndex){var i=h.eq(1);if(i.remove().html(""),f.toSection=null,-1!=c.to&&i.html(e["_"+d[c.pageIndex][c.to]]),g.prepend(i),a.isFunction(f.options.sectionChanging)){var j={};j.sender=f,j.dom=i,j.type=1,f.options.sectionChanging(j)}f.currentY=f.currentY-f.options.height,f.sectionIndex=f.sectionIndex+1}else if(!f.toSection&&(h.eq(0).html(""),h.eq(0).html(e["_"+d[c.pageIndex][c.to]]),a.isFunction(f.options.sectionChanging))){var j={};j.sender=f,j.dom=h.eq(0),j.type=1,f.options.sectionChanging(j)}}else if(c.direction>0)if(f.currentY<-f.options.height&&1==f.sectionIndex){var k=h.eq(0);if(k.remove().html(""),f.toSection=null,-1!=c.to&&k.html(e["_"+d[c.pageIndex][c.to]]),g.append(k),a.isFunction(f.options.sectionChanging)){var j={};j.sender=f,j.dom=k,j.type=1,f.options.sectionChanging(j)}f.currentY=f.currentY+f.options.height,f.sectionIndex=f.sectionIndex-1}else if(!f.toSection&&(h.eq(1).html(""),h.eq(1).html(e["_"+d[c.pageIndex][c.to]]),a.isFunction(f.options.sectionChanging))){var j={};j.sender=f,j.dom=h.eq(1),j.type=1,f.options.sectionChanging(j)}f.dom.find(".cpage").eq(f.itemIndex).attr("data-offset",f.currentY),f._setSectionContainerStyle({transform:f._getTranslate(0,f.currentY,0)})},c.prototype._setSectionContainerStyle=function(a){var b=this;if(a){var c=b.dom.find(".cpage").eq(b.itemIndex);c.css(a)}},c.prototype._getTranslate=function(a,c,d){var a=a||"0",c=c||"0",d=d||"0";return-1==c.toString().indexOf("%")&&(c+="px"),-1==a.toString().indexOf("%")&&(a+="px"),b.transform3d?"translate3d("+a+", "+c+", "+d+"px)":"translate("+a+", "+c+")"},c.prototype._setContainerStyle=function(a){var b=this;a&&b.dom.css(a)},c.prototype._setSectionTransition=function(a){var c=this;c._setSectionContainerStyle(a?{transition:b.getCSSVal("transform")+" 250ms ease"}:{transition:""})},c.prototype._setTransition=function(a){var c=this;c._setContainerStyle(a?{transition:b.getCSSVal("transform")+" 250ms ease"}:{transition:""})},c.prototype.start=function(a){var b=this,c=b.dom.find(".cpage").eq(b.itemIndex),d=c.find(".cpage-i");return d.eq(b.sectionIndex).html(a),d.eq(b.sectionIndex)},c.prototype.getSectionContainer=function(){{var a=this,b=a.dom.find(".cpage").eq(a.itemIndex);b.find(".cpage-i")}},c.prototype._resizeView=function(){var b=this;b._setSectionTransition(!1),b._setTransition(!1),window.pageWidth=a(window).width(),window.pageHeight=a(window).height();var c=b.options.height,d=b.options.width;b.direction=0,b.options.height=window.pageHeight,b.options.width=window.pageWidth;var e=b.dom.attr("data-offset");e&&0/0!=e||(e=0),b._setX(b.options.width*e/d,{direction:0});for(var f=b.dom.find(".cpage"),g=0;g<f.length;g++)if(g==b.itemIndex){var h=f.eq(b.itemIndex).attr("data-offset");h&&0/0!=h||(h=0),b._setY(b.options.height*h/c,{direction:0})}else f.eq(g).css({transform:b._getTranslate(0,0,0)})},window.Overlaypage=c,c});