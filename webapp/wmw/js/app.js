/**
* h5player v0.0.1 by yangyin 
* Copyright 2014 yangyin@mcitech.cn http://weibo.com/nodersolar
*/
function getScale(){var a=$(window).width(),b=$(window).height();window.pageHeight=b,window.pageWidth=a;var c=a/window.oWidth,d=b/window.oHeight,e=c;e>d&&(e=d);var f=b-e*window.oHeight,f=f/2/e,g=a-e*window.oWidth,g=g/2/e;return window.viewScale={scale:e,top:f,left:g},window.viewScale}function resetSetting(){var a=$(window).width(),b=$(window).height();window.pageHeight=b,window.pageWidth=a,$("#mci_commonpage,#wrap,.mpage-c").css({height:b+"px"}),$("#wrap,#mcipage .mpage-c").css({width:window.pageWidth+"px",height:window.pageHeight+"px"}),$("#mcipage .item").css({width:"100%"}),$("#mcipage").css({width:4*window.pageWidth+"px",height:window.pageHeight+"px"}),$("#mcipage .mpage-c").css({width:window.pageWidth+"px"}),$("#mci_commonpage").css({width:2*window.pageWidth+"px",height:window.pageHeight+"px"}),$("#mci_commonpage").find(".cpage").css({width:window.pageWidth+"px",height:2*window.pageHeight+"px"}),$("#mci_commonpage").find(".cpage-i").css({width:window.pageWidth+"px",height:window.pageHeight+"px"})}require.config({baseUrl:"js/controls",shim:{Three:{exports:"THREE"}},paths:{jquery:"../lib/jquery-1.8.2","jquery.url":"../lib/jquery.url",Three:"../lib/Three",domReady:"../lib/domReady"}}),require(["domReady!","jquery"],function(){getScale(),resetSetting(),require(["jquery","Magazine","mci.support","mci.page","mci.overlaypage","jquery.url","mci.loadsource"],function(a,b,c,d,e){function f(){var b=a(window).width(),c=a(window).height();window.pageHeight=c,window.pageWidth=b,resetSetting();var d=window.getScale();a(" article > .article-content").css({transform:"scale("+d.scale+","+d.scale+") translate3d("+d.left+"px,"+d.top+"px,0)"}),a(".loading").css({width:b+"px",height:c+"px"}),g.mcipage._resizeView(),h._resizeView()}var g=new b,h=new e({dom:a("#mci_commonpage"),width:window.pageWidth,height:window.pageHeight,sectionChanging:function(a){1==a.type?a.sender.toSection=g.initOverlayPage(a.dom):a.sender.toPage=g.initOverlayPage(a.dom)},sectionChanged:function(a){1==a.type?(g.startOverlayPage(a.sender.toSection),self.curPage=a.sender.toSection):(g.startOverlayPage(a.sender.toPage),self.curPage=a.sender.toPage),a.sender.toPage=null,a.sender.toSection=null}});if(CommonSectionsCount>0){var i=h.start(window.CommonSections["_"+window.overlaySections[0][0]]);h.curPage=g.initOverlayPage(i),g.startOverlayPage(h.curPage)}mcipage=d("#mcipage",{distance:window.pageWidth,sectionDistance:window.pageHeight,maxPage:parseInt(a("#mcipage").attr("lastindex")),pageChanging:function(b){var c=a(b.dom);c.html("");var d=window.getPageContent(b.toPage+1);c.html(d),g.removePage(b.oldPage),g.addPage(c,b.toPage),b.oldPage==b.toPage&&g.start(b.toPage,0)},pageChanged:function(b){g.start(b.currentPage,0),a(b.changedDoms).each(function(){var b=a(this),c=this,d=window.getPageContent(this.pageIndex+1);b.html(d),g.removePage(c.oldPageIndex),g.addPage(b,c.pageIndex)}),a.isFunction(g.pageChangedHandler)&&g.pageChangedHandler(b)},sectionChanged:function(b){var d=(b.dom,b.to),e=b.pageIndex;c.touch&&a(document).scrollTop()>0&&a(document).scrollTop(0),g.start(e,d)},syncMoving:function(a){h._syncMove(a)},syncMoveEnd:function(a){h._syncMoveEnd(a)}});var j=a("#mcipage").find(".mpage-c");g.mcipage=mcipage;var k=getPageContent(1);j.eq(0).append(k),g.addPage(j.eq(0),0),g.start(0,0);var l=getPageContent(2);j.eq(1).append(l),g.addPage(j.eq(1),1);var m=getPageContent(3);j.eq(2).append(m),g.addPage(j.eq(2),2);var n=getPageContent(4);j.eq(3).append(n),g.addPage(j.eq(3),3);var o=function(){var b=a.url().data.param.fragment.pn;if(void 0!==b)return void window.mcipage.jumpToPage(parseInt(b));var c=a.url().data.param.fragment.prev;if(void 0!==c)return void window.mcipage.toPrev();var d=a.url().data.param.fragment.next;return void 0!==d?void window.mcipage.toNext():void 0};a(window).on("orientationchange",function(){f()}),a(window).resize(function(){f()}),a(window).on("hashchange",function(){o()}),f()})});